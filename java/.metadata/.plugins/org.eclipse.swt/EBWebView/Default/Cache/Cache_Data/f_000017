(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{64296:function(e,t,s){Promise.resolve().then(s.bind(s,22302))},22302:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return Home}});var a,n,r,o,i,l,c,d,u,m,p,x,h,g,f,y,v,C,w,b,N,S,j,E,I,T,k,R,_,D,A,P,M,L,O,F,B,q,U,G,Q,J,W,H,V,Y,Z,K,z=s(77e3),X=s(62525);(a=I||(I={})).DISCONNECTED="DISCONNECTED",a.CONNECTING="CONNECTING",a.CONNECTED="CONNECTED",a.READY="READY";var $=s(93994),ee=s(14220),et=s(9687),es=s(77153),ea=s(7707),en=s(56932),er=s(28208),eo=s(43753),ei=s(11260);(n=T||(T={}))[n.UNSPECIFIED=0]="UNSPECIFIED",n[n.CHAT=1]="CHAT",n[n.IDE=2]="IDE",en.w.util.setEnumType(T,"exa.chat_web_server_pb.ClientConnectionType",[{no:0,name:"CLIENT_CONNECTION_TYPE_UNSPECIFIED"},{no:1,name:"CLIENT_CONNECTION_TYPE_CHAT"},{no:2,name:"CLIENT_CONNECTION_TYPE_IDE"}]),(r=k||(k={}))[r.UNSPECIFIED=0]="UNSPECIFIED",r[r.TEXT_EDITOR=1]="TEXT_EDITOR",r[r.TERMINAL=2]="TERMINAL",en.w.util.setEnumType(k,"exa.chat_web_server_pb.ActiveEditorType",[{no:0,name:"ACTIVE_EDITOR_TYPE_UNSPECIFIED"},{no:1,name:"ACTIVE_EDITOR_TYPE_TEXT_EDITOR"},{no:2,name:"ACTIVE_EDITOR_TYPE_TERMINAL"}]);let ChatMessageWithFeedback=class ChatMessageWithFeedback extends er.v{static fromBinary(e,t){return new ChatMessageWithFeedback().fromBinary(e,t)}static fromJson(e,t){return new ChatMessageWithFeedback().fromJson(e,t)}static fromJsonString(e,t){return new ChatMessageWithFeedback().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(ChatMessageWithFeedback,e,t)}constructor(e){super(),this.feedback=ee.Cx.FEEDBACK_TYPE_UNSPECIFIED,this.streamId="",en.w.util.initPartial(e,this)}};ChatMessageWithFeedback.runtime=en.w,ChatMessageWithFeedback.typeName="exa.chat_web_server_pb.ChatMessageWithFeedback",ChatMessageWithFeedback.fields=en.w.util.newFieldList(()=>[{no:1,name:"message",kind:"message",T:ee.J},{no:2,name:"feedback",kind:"enum",T:en.w.getEnumType(ee.Cx)},{no:3,name:"stream_id",kind:"scalar",T:9}]);let FastApply=class FastApply extends er.v{static fromBinary(e,t){return new FastApply().fromBinary(e,t)}static fromJson(e,t){return new FastApply().fromJson(e,t)}static fromJsonString(e,t){return new FastApply().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(FastApply,e,t)}constructor(e){super(),en.w.util.initPartial(e,this)}};FastApply.runtime=en.w,FastApply.typeName="exa.chat_web_server_pb.FastApply",FastApply.fields=en.w.util.newFieldList(()=>[]);let PinnedSystemErrorFeedback=class PinnedSystemErrorFeedback extends er.v{static fromBinary(e,t){return new PinnedSystemErrorFeedback().fromBinary(e,t)}static fromJson(e,t){return new PinnedSystemErrorFeedback().fromJson(e,t)}static fromJsonString(e,t){return new PinnedSystemErrorFeedback().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(PinnedSystemErrorFeedback,e,t)}constructor(e){super(),this.type="",this.title="",this.message="",en.w.util.initPartial(e,this)}};PinnedSystemErrorFeedback.runtime=en.w,PinnedSystemErrorFeedback.typeName="exa.chat_web_server_pb.PinnedSystemErrorFeedback",PinnedSystemErrorFeedback.fields=en.w.util.newFieldList(()=>[{no:1,name:"type",kind:"scalar",T:9},{no:2,name:"title",kind:"scalar",T:9},{no:3,name:"message",kind:"scalar",T:9}]);let PinnedSystemFeedback=class PinnedSystemFeedback extends er.v{static fromBinary(e,t){return new PinnedSystemFeedback().fromBinary(e,t)}static fromJson(e,t){return new PinnedSystemFeedback().fromJson(e,t)}static fromJsonString(e,t){return new PinnedSystemFeedback().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(PinnedSystemFeedback,e,t)}constructor(e){super(),this.payload={case:void 0},en.w.util.initPartial(e,this)}};PinnedSystemFeedback.runtime=en.w,PinnedSystemFeedback.typeName="exa.chat_web_server_pb.PinnedSystemFeedback",PinnedSystemFeedback.fields=en.w.util.newFieldList(()=>[{no:1,name:"error",kind:"message",T:PinnedSystemErrorFeedback,oneof:"payload"},{no:2,name:"fast_apply",kind:"message",T:FastApply,oneof:"payload"}]);let ChatMessageState=class ChatMessageState extends er.v{static fromBinary(e,t){return new ChatMessageState().fromBinary(e,t)}static fromJson(e,t){return new ChatMessageState().fromJson(e,t)}static fromJsonString(e,t){return new ChatMessageState().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(ChatMessageState,e,t)}constructor(e){super(),this.messages=[],this.isReceivingMessage=!1,this.draftQuery="",en.w.util.initPartial(e,this)}};ChatMessageState.runtime=en.w,ChatMessageState.typeName="exa.chat_web_server_pb.ChatMessageState",ChatMessageState.fields=en.w.util.newFieldList(()=>[{no:1,name:"messages",kind:"message",T:ChatMessageWithFeedback,repeated:!0},{no:2,name:"is_receiving_message",kind:"scalar",T:8},{no:3,name:"user_settings",kind:"message",T:et.PGO},{no:4,name:"draft_query",kind:"scalar",T:9},{no:5,name:"pinned_system_feedback",kind:"message",T:PinnedSystemFeedback}]);let ClearConversation=class ClearConversation extends er.v{static fromBinary(e,t){return new ClearConversation().fromBinary(e,t)}static fromJson(e,t){return new ClearConversation().fromJson(e,t)}static fromJsonString(e,t){return new ClearConversation().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(ClearConversation,e,t)}constructor(e){super(),this.conversationId="",en.w.util.initPartial(e,this)}};ClearConversation.runtime=en.w,ClearConversation.typeName="exa.chat_web_server_pb.ClearConversation",ClearConversation.fields=en.w.util.newFieldList(()=>[{no:1,name:"conversation_id",kind:"scalar",T:9}]);let OpenFilePointer=class OpenFilePointer extends er.v{static fromBinary(e,t){return new OpenFilePointer().fromBinary(e,t)}static fromJson(e,t){return new OpenFilePointer().fromJson(e,t)}static fromJsonString(e,t){return new OpenFilePointer().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(OpenFilePointer,e,t)}constructor(e){super(),this.filePathMigrateMeToUri="",this.fileUri="",this.startLine=0,this.startCol=0,this.endLine=0,this.endCol=0,en.w.util.initPartial(e,this)}};OpenFilePointer.runtime=en.w,OpenFilePointer.typeName="exa.chat_web_server_pb.OpenFilePointer",OpenFilePointer.fields=en.w.util.newFieldList(()=>[{no:1,name:"file_path_migrate_me_to_uri",kind:"scalar",T:9},{no:6,name:"file_uri",kind:"scalar",T:9},{no:2,name:"start_line",kind:"scalar",T:5},{no:3,name:"start_col",kind:"scalar",T:5},{no:4,name:"end_line",kind:"scalar",T:5},{no:5,name:"end_col",kind:"scalar",T:5}]);let InsertCodeAtCursor=class InsertCodeAtCursor extends er.v{static fromBinary(e,t){return new InsertCodeAtCursor().fromBinary(e,t)}static fromJson(e,t){return new InsertCodeAtCursor().fromJson(e,t)}static fromJsonString(e,t){return new InsertCodeAtCursor().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(InsertCodeAtCursor,e,t)}constructor(e){super(),this.text="",this.editorType=0,en.w.util.initPartial(e,this)}};InsertCodeAtCursor.runtime=en.w,InsertCodeAtCursor.typeName="exa.chat_web_server_pb.InsertCodeAtCursor",InsertCodeAtCursor.fields=en.w.util.newFieldList(()=>[{no:1,name:"text",kind:"scalar",T:9},{no:2,name:"editor_type",kind:"enum",T:en.w.getEnumType(k)}]);let ApplyDiff=class ApplyDiff extends er.v{static fromBinary(e,t){return new ApplyDiff().fromBinary(e,t)}static fromJson(e,t){return new ApplyDiff().fromJson(e,t)}static fromJsonString(e,t){return new ApplyDiff().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(ApplyDiff,e,t)}constructor(e){super(),this.messageId="",this.filePathMigrateMeToUri="",this.providerSource=et.IGB.UNSPECIFIED,this.fileContentHash="",this.diffDocPrefix="",this.diffDocSuffix="",this.uri="",en.w.util.initPartial(e,this)}};ApplyDiff.runtime=en.w,ApplyDiff.typeName="exa.chat_web_server_pb.ApplyDiff",ApplyDiff.fields=en.w.util.newFieldList(()=>[{no:1,name:"message_id",kind:"scalar",T:9},{no:2,name:"file_path_migrate_me_to_uri",kind:"scalar",T:9},{no:3,name:"diff",kind:"message",T:eo.Nm},{no:4,name:"provider_source",kind:"enum",T:en.w.getEnumType(et.IGB)},{no:5,name:"file_content_hash",kind:"scalar",T:9},{no:6,name:"diff_doc_prefix",kind:"scalar",T:9},{no:7,name:"diff_doc_suffix",kind:"scalar",T:9},{no:8,name:"uri",kind:"scalar",T:9}]);let HideDiff=class HideDiff extends er.v{static fromBinary(e,t){return new HideDiff().fromBinary(e,t)}static fromJson(e,t){return new HideDiff().fromJson(e,t)}static fromJsonString(e,t){return new HideDiff().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(HideDiff,e,t)}constructor(e){super(),this.messageId="",this.filePathMigrateMeToUri="",this.providerSource=et.IGB.UNSPECIFIED,this.uri="",en.w.util.initPartial(e,this)}};HideDiff.runtime=en.w,HideDiff.typeName="exa.chat_web_server_pb.HideDiff",HideDiff.fields=en.w.util.newFieldList(()=>[{no:1,name:"message_id",kind:"scalar",T:9},{no:2,name:"file_path_migrate_me_to_uri",kind:"scalar",T:9},{no:3,name:"provider_source",kind:"enum",T:en.w.getEnumType(et.IGB)},{no:4,name:"uri",kind:"scalar",T:9}]);let HandshakeRequest=class HandshakeRequest extends er.v{static fromBinary(e,t){return new HandshakeRequest().fromBinary(e,t)}static fromJson(e,t){return new HandshakeRequest().fromJson(e,t)}static fromJsonString(e,t){return new HandshakeRequest().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(HandshakeRequest,e,t)}constructor(e){super(),this.userId="",en.w.util.initPartial(e,this)}};HandshakeRequest.runtime=en.w,HandshakeRequest.typeName="exa.chat_web_server_pb.HandshakeRequest",HandshakeRequest.fields=en.w.util.newFieldList(()=>[{no:1,name:"metadata",kind:"message",T:et.SFo},{no:9,name:"user_id",kind:"scalar",T:9}]);let ErrorResponse=class ErrorResponse extends er.v{static fromBinary(e,t){return new ErrorResponse().fromBinary(e,t)}static fromJson(e,t){return new ErrorResponse().fromJson(e,t)}static fromJsonString(e,t){return new ErrorResponse().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(ErrorResponse,e,t)}constructor(e){super(),this.error="",en.w.util.initPartial(e,this)}};ErrorResponse.runtime=en.w,ErrorResponse.typeName="exa.chat_web_server_pb.ErrorResponse",ErrorResponse.fields=en.w.util.newFieldList(()=>[{no:1,name:"error",kind:"scalar",T:9}]);let ChatExperimentStatus=class ChatExperimentStatus extends er.v{static fromBinary(e,t){return new ChatExperimentStatus().fromBinary(e,t)}static fromJson(e,t){return new ChatExperimentStatus().fromJson(e,t)}static fromJsonString(e,t){return new ChatExperimentStatus().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(ChatExperimentStatus,e,t)}constructor(e){super(),this.experimentKey=et.rpR.UNSPECIFIED,this.enabled=!1,en.w.util.initPartial(e,this)}};ChatExperimentStatus.runtime=en.w,ChatExperimentStatus.typeName="exa.chat_web_server_pb.ChatExperimentStatus",ChatExperimentStatus.fields=en.w.util.newFieldList(()=>[{no:1,name:"experiment_key",kind:"enum",T:en.w.getEnumType(et.rpR)},{no:2,name:"enabled",kind:"scalar",T:8}]);let HandshakeResponse=class HandshakeResponse extends er.v{static fromBinary(e,t){return new HandshakeResponse().fromBinary(e,t)}static fromJson(e,t){return new HandshakeResponse().fromJson(e,t)}static fromJsonString(e,t){return new HandshakeResponse().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(HandshakeResponse,e,t)}constructor(e){super(),this.languageServerAddress="",this.experiments=[],en.w.util.initPartial(e,this)}};HandshakeResponse.runtime=en.w,HandshakeResponse.typeName="exa.chat_web_server_pb.HandshakeResponse",HandshakeResponse.fields=en.w.util.newFieldList(()=>[{no:1,name:"user_status",kind:"message",T:et.J0j},{no:2,name:"initial_state",kind:"message",T:ChatMessageState},{no:3,name:"language_server_address",kind:"scalar",T:9},{no:4,name:"plan_info",kind:"message",T:et.mEC},{no:5,name:"experiments",kind:"message",T:ChatExperimentStatus,repeated:!0}]);let StateUpdate=class StateUpdate extends er.v{static fromBinary(e,t){return new StateUpdate().fromBinary(e,t)}static fromJson(e,t){return new StateUpdate().fromJson(e,t)}static fromJsonString(e,t){return new StateUpdate().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(StateUpdate,e,t)}constructor(e){super(),this.isPartialUpdate=!1,en.w.util.initPartial(e,this)}};StateUpdate.runtime=en.w,StateUpdate.typeName="exa.chat_web_server_pb.StateUpdate",StateUpdate.fields=en.w.util.newFieldList(()=>[{no:1,name:"state",kind:"message",T:ChatMessageState},{no:2,name:"is_partial_update",kind:"scalar",T:8}]);let CancelInfightMessage=class CancelInfightMessage extends er.v{static fromBinary(e,t){return new CancelInfightMessage().fromBinary(e,t)}static fromJson(e,t){return new CancelInfightMessage().fromJson(e,t)}static fromJsonString(e,t){return new CancelInfightMessage().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(CancelInfightMessage,e,t)}constructor(e){super(),this.streamId="",en.w.util.initPartial(e,this)}};CancelInfightMessage.runtime=en.w,CancelInfightMessage.typeName="exa.chat_web_server_pb.CancelInfightMessage",CancelInfightMessage.fields=en.w.util.newFieldList(()=>[{no:1,name:"stream_id",kind:"scalar",T:9}]);let Heartbeat=class Heartbeat extends er.v{static fromBinary(e,t){return new Heartbeat().fromBinary(e,t)}static fromJson(e,t){return new Heartbeat().fromJson(e,t)}static fromJsonString(e,t){return new Heartbeat().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(Heartbeat,e,t)}constructor(e){super(),en.w.util.initPartial(e,this)}};Heartbeat.runtime=en.w,Heartbeat.typeName="exa.chat_web_server_pb.Heartbeat",Heartbeat.fields=en.w.util.newFieldList(()=>[]);let UpdateUserSettingsRequest=class UpdateUserSettingsRequest extends er.v{static fromBinary(e,t){return new UpdateUserSettingsRequest().fromBinary(e,t)}static fromJson(e,t){return new UpdateUserSettingsRequest().fromJson(e,t)}static fromJsonString(e,t){return new UpdateUserSettingsRequest().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(UpdateUserSettingsRequest,e,t)}constructor(e){super(),en.w.util.initPartial(e,this)}};UpdateUserSettingsRequest.runtime=en.w,UpdateUserSettingsRequest.typeName="exa.chat_web_server_pb.UpdateUserSettingsRequest",UpdateUserSettingsRequest.fields=en.w.util.newFieldList(()=>[{no:1,name:"user_settings",kind:"message",T:et.PGO}]);let SetDraftQueryRequest=class SetDraftQueryRequest extends er.v{static fromBinary(e,t){return new SetDraftQueryRequest().fromBinary(e,t)}static fromJson(e,t){return new SetDraftQueryRequest().fromJson(e,t)}static fromJsonString(e,t){return new SetDraftQueryRequest().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(SetDraftQueryRequest,e,t)}constructor(e){super(),this.draftQuery="",en.w.util.initPartial(e,this)}};SetDraftQueryRequest.runtime=en.w,SetDraftQueryRequest.typeName="exa.chat_web_server_pb.SetDraftQueryRequest",SetDraftQueryRequest.fields=en.w.util.newFieldList(()=>[{no:1,name:"draft_query",kind:"scalar",T:9}]);let RetryLastMessage=class RetryLastMessage extends er.v{static fromBinary(e,t){return new RetryLastMessage().fromBinary(e,t)}static fromJson(e,t){return new RetryLastMessage().fromJson(e,t)}static fromJsonString(e,t){return new RetryLastMessage().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(RetryLastMessage,e,t)}constructor(e){super(),en.w.util.initPartial(e,this)}};RetryLastMessage.runtime=en.w,RetryLastMessage.typeName="exa.chat_web_server_pb.RetryLastMessage",RetryLastMessage.fields=en.w.util.newFieldList(()=>[]);let DismissPinnedSystemFeedback=class DismissPinnedSystemFeedback extends er.v{static fromBinary(e,t){return new DismissPinnedSystemFeedback().fromBinary(e,t)}static fromJson(e,t){return new DismissPinnedSystemFeedback().fromJson(e,t)}static fromJsonString(e,t){return new DismissPinnedSystemFeedback().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(DismissPinnedSystemFeedback,e,t)}constructor(e){super(),en.w.util.initPartial(e,this)}};DismissPinnedSystemFeedback.runtime=en.w,DismissPinnedSystemFeedback.typeName="exa.chat_web_server_pb.DismissPinnedSystemFeedback",DismissPinnedSystemFeedback.fields=en.w.util.newFieldList(()=>[]);let WebServerRequest=class WebServerRequest extends er.v{static fromBinary(e,t){return new WebServerRequest().fromBinary(e,t)}static fromJson(e,t){return new WebServerRequest().fromJson(e,t)}static fromJsonString(e,t){return new WebServerRequest().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(WebServerRequest,e,t)}constructor(e){super(),this.payload={case:void 0},en.w.util.initPartial(e,this)}};WebServerRequest.runtime=en.w,WebServerRequest.typeName="exa.chat_web_server_pb.WebServerRequest",WebServerRequest.fields=en.w.util.newFieldList(()=>[{no:1,name:"handshake_request",kind:"message",T:HandshakeRequest,oneof:"payload"},{no:2,name:"get_chat_message_request",kind:"message",T:ee.MK,oneof:"payload"},{no:3,name:"record_chat_feedback_request",kind:"message",T:ei.MpX,oneof:"payload"},{no:4,name:"clear_conversation",kind:"message",T:ClearConversation,oneof:"payload"},{no:5,name:"open_file_pointer",kind:"message",T:OpenFilePointer,oneof:"payload"},{no:6,name:"cancel_infight_message",kind:"message",T:CancelInfightMessage,oneof:"payload"},{no:7,name:"insert_at_cursor",kind:"message",T:InsertCodeAtCursor,oneof:"payload"},{no:8,name:"apply_diff",kind:"message",T:ApplyDiff,oneof:"payload"},{no:9,name:"heartbeat",kind:"message",T:Heartbeat,oneof:"payload"},{no:10,name:"update_user_settings",kind:"message",T:UpdateUserSettingsRequest,oneof:"payload"},{no:11,name:"set_draft_query",kind:"message",T:SetDraftQueryRequest,oneof:"payload"},{no:12,name:"hide_diff",kind:"message",T:HideDiff,oneof:"payload"},{no:13,name:"retry_last_message",kind:"message",T:RetryLastMessage,oneof:"payload"},{no:14,name:"dismiss_pinned_system_feedback",kind:"message",T:DismissPinnedSystemFeedback,oneof:"payload"}]);let WebServerResponse=class WebServerResponse extends er.v{static fromBinary(e,t){return new WebServerResponse().fromBinary(e,t)}static fromJson(e,t){return new WebServerResponse().fromJson(e,t)}static fromJsonString(e,t){return new WebServerResponse().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(WebServerResponse,e,t)}constructor(e){super(),this.payload={case:void 0},en.w.util.initPartial(e,this)}};WebServerResponse.runtime=en.w,WebServerResponse.typeName="exa.chat_web_server_pb.WebServerResponse",WebServerResponse.fields=en.w.util.newFieldList(()=>[{no:1,name:"handshake_response",kind:"message",T:HandshakeResponse,oneof:"payload"},{no:2,name:"state_update",kind:"message",T:StateUpdate,oneof:"payload"},{no:3,name:"open_file_pointer",kind:"message",T:OpenFilePointer,oneof:"payload"},{no:4,name:"insert_at_cursor",kind:"message",T:InsertCodeAtCursor,oneof:"payload"},{no:5,name:"apply_diff",kind:"message",T:ApplyDiff,oneof:"payload"},{no:6,name:"error_response",kind:"message",T:ErrorResponse,oneof:"payload"},{no:7,name:"heartbeat",kind:"message",T:Heartbeat,oneof:"payload"},{no:8,name:"hide_diff",kind:"message",T:HideDiff,oneof:"payload"},{no:9,name:"onboarding_state",kind:"message",T:OnboardingState,oneof:"payload"},{no:10,name:"update_user_settings",kind:"message",T:UpdateUserSettingsRequest,oneof:"payload"}]);let OnboardingState=class OnboardingState extends er.v{static fromBinary(e,t){return new OnboardingState().fromBinary(e,t)}static fromJson(e,t){return new OnboardingState().fromJson(e,t)}static fromJsonString(e,t){return new OnboardingState().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(OnboardingState,e,t)}constructor(e){super(),this.actionType=[],en.w.util.initPartial(e,this)}};OnboardingState.runtime=en.w,OnboardingState.typeName="exa.chat_web_server_pb.OnboardingState",OnboardingState.fields=en.w.util.newFieldList(()=>[{no:1,name:"action_type",kind:"enum",T:en.w.getEnumType(et.T9o),repeated:!0}]);let GetMatchingIndexedReposRequest=class GetMatchingIndexedReposRequest extends er.v{static fromBinary(e,t){return new GetMatchingIndexedReposRequest().fromBinary(e,t)}static fromJson(e,t){return new GetMatchingIndexedReposRequest().fromJson(e,t)}static fromJsonString(e,t){return new GetMatchingIndexedReposRequest().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(GetMatchingIndexedReposRequest,e,t)}constructor(e){super(),this.query="",this.maxItems=0,en.w.util.initPartial(e,this)}};GetMatchingIndexedReposRequest.runtime=en.w,GetMatchingIndexedReposRequest.typeName="exa.chat_web_server_pb.GetMatchingIndexedReposRequest",GetMatchingIndexedReposRequest.fields=en.w.util.newFieldList(()=>[{no:1,name:"metadata",kind:"message",T:et.SFo},{no:2,name:"query",kind:"scalar",T:9},{no:3,name:"max_items",kind:"scalar",T:5}]);let GetMatchingIndexedReposResponse=class GetMatchingIndexedReposResponse extends er.v{static fromBinary(e,t){return new GetMatchingIndexedReposResponse().fromBinary(e,t)}static fromJson(e,t){return new GetMatchingIndexedReposResponse().fromJson(e,t)}static fromJsonString(e,t){return new GetMatchingIndexedReposResponse().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(GetMatchingIndexedReposResponse,e,t)}constructor(e){super(),this.matchedRepositories=[],en.w.util.initPartial(e,this)}};GetMatchingIndexedReposResponse.runtime=en.w,GetMatchingIndexedReposResponse.typeName="exa.chat_web_server_pb.GetMatchingIndexedReposResponse",GetMatchingIndexedReposResponse.fields=en.w.util.newFieldList(()=>[{no:1,name:"matched_repositories",kind:"message",T:et.LMS,repeated:!0}]);let GetMatchingCodeContextRequest=class GetMatchingCodeContextRequest extends er.v{static fromBinary(e,t){return new GetMatchingCodeContextRequest().fromBinary(e,t)}static fromJson(e,t){return new GetMatchingCodeContextRequest().fromJson(e,t)}static fromJsonString(e,t){return new GetMatchingCodeContextRequest().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(GetMatchingCodeContextRequest,e,t)}constructor(e){super(),this.query="",this.allowedTypes=[],this.maxItems=0,en.w.util.initPartial(e,this)}};GetMatchingCodeContextRequest.runtime=en.w,GetMatchingCodeContextRequest.typeName="exa.chat_web_server_pb.GetMatchingCodeContextRequest",GetMatchingCodeContextRequest.fields=en.w.util.newFieldList(()=>[{no:1,name:"query",kind:"scalar",T:9},{no:3,name:"allowed_types",kind:"enum",T:en.w.getEnumType(et.fIx),repeated:!0},{no:4,name:"max_items",kind:"scalar",T:5}]);let GetMatchingCodeContextResponse=class GetMatchingCodeContextResponse extends er.v{static fromBinary(e,t){return new GetMatchingCodeContextResponse().fromBinary(e,t)}static fromJson(e,t){return new GetMatchingCodeContextResponse().fromJson(e,t)}static fromJsonString(e,t){return new GetMatchingCodeContextResponse().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(GetMatchingCodeContextResponse,e,t)}constructor(e){super(),this.matchedItems=[],en.w.util.initPartial(e,this)}};GetMatchingCodeContextResponse.runtime=en.w,GetMatchingCodeContextResponse.typeName="exa.chat_web_server_pb.GetMatchingCodeContextResponse",GetMatchingCodeContextResponse.fields=en.w.util.newFieldList(()=>[{no:1,name:"matched_items",kind:"message",T:et.$4G,repeated:!0}]);var el=s(26577);let getCurrentConversationID=e=>{if(0===e.length)return(0,el.getNonce)();let t=e[e.length-1].message;return(null==t?void 0:t.conversationId)?t.conversationId:(0,el.getNonce)()};var ec=s(44354),ed=s(31927);let getRelevantMessageHistory=(e,t)=>{let s=!1,a=[];for(let i=e.length-1;i>=0;i--){var n,r,o;if((null===(n=e[i].message)||void 0===n?void 0:n.content.case)==="error"){s=!0;continue}if(s){s=!1;continue}(null===(r=e[i].message)||void 0===r?void 0:r.content.case)!=="status"&&(null===(o=e[i].message)||void 0===o?void 0:o.conversationId)===t&&a.push(e[i])}return a.reverse()},eu=Error("Missing API key. Please make sure you are signed in to the Codeium plugin and close / reopen the chat window. If the problem persists, please restart the IDE."),getMetadata=e=>{let{ideName:t,ideVersion:s,extensionName:a,extensionVersion:n,apiKey:r,locale:o,userId:i}=e;if(!r)throw eu;let l={ideName:t,ideVersion:s,extensionName:a,extensionVersion:n,locale:o,apiKey:r};for(let[e,t]of Object.entries(l))if(!t)throw Error("Missing ".concat(e,". Please restart the IDE."));return i&&(l.userId=i),l},isWindsurf=e=>!!e&&("windsurf"===e||"windsurf-insiders"===e||"windsurf-next"===e);(o=R||(R={})).CHAT="chat",o.CONTEXT_SETTINGS="context-settings",o.SETTINGS="settings",o.CASCADE="cascade",o.DEBUG="debug";let em={tab:et.q80.UNSPECIFIED,changeTab:function(){throw Error("Function not implemented.")},handleOpenChat:function(){throw Error("Function not implemented.")},handleOpenSettings:function(){throw Error("Function not implemented.")},handleOpenCascade:function(){throw Error("Function not implemented.")},handleOpenDebug:function(){throw Error("Function not implemented.")},handleOpenContext:function(){throw Error("Function not implemented.")},view:"chat"},ep=(0,X.createContext)(em),NavigationContextProvider=e=>{let{children:t}=e,[s,a]=(0,X.useState)(!1),[n,r]=(0,X.useState)(et.q80.UNSPECIFIED),[o,i]=(0,X.useState)(!1),{defaultView:l}=useChatParamsContext(),[c,d]=(0,X.useState)(l),{isInitialized:u,state:{userSettings:m,isReceivingMessage:p},updateUserSettings:x,logEvent:h}=useServerConnectionContext(),g=(0,X.useCallback)(e=>{if(u){r(e);try{let t=m.clone();t.extensionPanelTab=e,x(t)}catch(e){console.warn(e)}}},[u,x,m]),f=(0,X.useCallback)(()=>{h(et.tbr.CHAT_OPEN_SETTINGS),d("settings")},[h]),y=(0,X.useCallback)(()=>{d("chat")},[]),v=(0,X.useCallback)(()=>{d("cascade")},[]),C=(0,X.useCallback)(()=>{d("debug")},[]),w=(0,X.useCallback)(()=>{h(et.tbr.CHAT_OPEN_CONTEXT_SETTINGS),d("context-settings")},[h]);return(0,X.useEffect)(()=>{o&&p||(p?(n!==et.q80.CHAT&&d("chat"),i(!0)):i(!1))},[p,g,n,o]),(0,X.useEffect)(()=>{let onMessage=e=>{"toggleFocus"===e.data.type&&n!==et.q80.CHAT&&g(et.q80.CHAT)};return window.addEventListener("message",onMessage),()=>{window.removeEventListener("message",onMessage)}},[n,g]),(0,X.useEffect)(()=>{s||(r(et.q80.CHAT),a(!0))},[s]),(0,z.jsx)(ep.Provider,{value:{view:c,tab:n,changeTab:g,handleOpenSettings:f,handleOpenCascade:v,handleOpenChat:y,handleOpenDebug:C,handleOpenContext:w},children:t})},useNavigationContext=()=>(0,X.useContext)(ep),ex={ready:!1,defaultView:R.CHAT},eh=(0,X.createContext)(ex),ChatParamsManager=e=>{let{children:t,...s}=e,a=(0,X.useMemo)(()=>({...ex,...s,ready:s.ready||!1}),[s]);return(0,z.jsx)(eh.Provider,{value:a,children:t})},useChatParamsContext=()=>(0,X.useContext)(eh),exponentialBackoffDelay=(e,t)=>{let s=(null==t?void 0:t.baseDelaySeconds)||2,a=(null==t?void 0:t.maxDelaySeconds)||60;return Math.min(s*Math.pow(2,e),a)};var eg=s(83001),ef=s(19270);let WebSocketBridge=class WebSocketBridge{connect(){this.socket=new WebSocket(this.serverUrl),this.socket.onopen=this.onOpen.bind(this),this.socket.onclose=this.onClose.bind(this),this.socket.onmessage=async e=>{let t=e.data,s=await t.arrayBuffer(),a=new Uint8Array(s),n=WebServerResponse.fromBinary(a);this.onMessage(n)},this.socket.onerror=e=>{if(e instanceof ErrorEvent){let t=Error("WebSocket error: ".concat(e.message));this.onError(t)}else this.onError(Error("WebSocket error: ".concat(JSON.stringify(e))))}}onOpen(){console.debug("[WebServerBridge] onOpen")}onMessage(e){console.debug("[WebServerBridge] onMessage",e)}onError(e){console.debug("[WebServerBridge] onError",e)}onClose(e){console.debug("[WebServerBridge] onClose",e)}send(e){var t;null===(t=this.socket)||void 0===t||t.send(e.toBinary())}close(e){var t;null===(t=this.socket)||void 0===t||t.close(e)}constructor(e){this.socket=null,this.bridgeType="websocket-bridge",this.serverUrl=e}};let findUserIntentFromResponse=(e,t)=>{var s,a,n,r,o,i,l,c;let d;if(0!==t.length){for(d=0;d<t.length&&(null===(a=t[d])||void 0===a?void 0:null===(s=a.message)||void 0===s?void 0:s.messageId)!==e;d++);for(;d>=0;d--)if((null===(o=t[d])||void 0===o?void 0:null===(r=o.message)||void 0===r?void 0:null===(n=r.content.value)||void 0===n?void 0:n.getType())===ee.LD)return null===(c=t[d])||void 0===c?void 0:null===(l=c.message)||void 0===l?void 0:null===(i=l.content.value)||void 0===i?void 0:i.clone()}},getNumTokens=e=>{switch(e.content.case){case"action":case"intent":return e.content.value.numTokens;default:return null}},getConversationTruncationIndex=(e,t)=>{let s=0;for(let a=0;a<e.length;a++){let n=e[a],r=(n.message?getNumTokens(n.message):0)||0;s+=r;let o=!!(r&&s>=t);if(o)return a}return null};var ey=s(43301),ev=s(55158),eC=s(42910);function GetChatMessageActionEditAbsoluteUri(e){return e.uri?eC.S.fromUri(e.uri):eC.S.fromPath(e.filePathMigrateMeToUri)}function GetIntentAbsolutePath(e){return e.uri?eC.S.fromUri(e.uri):eC.S.fromPath(e.filePathMigrateMeToUri)}var ew=s(69241),eb=s(25415);let eN={typeName:"exa.chat_web_server_pb.ChatWebServerService",methods:{getMatchingIndexedRepos:{name:"GetMatchingIndexedRepos",I:GetMatchingIndexedReposRequest,O:GetMatchingIndexedReposResponse,kind:eb.t.Unary},getMatchingCodeContext:{name:"GetMatchingCodeContext",I:GetMatchingCodeContextRequest,O:GetMatchingCodeContextResponse,kind:eb.t.Unary}}};var eS=s(31839),ej=s(70056),eE=s(39408);let useBrainConnect=e=>{let t=(0,X.useCallback)(async(t,s)=>{if(e)return(await e.newCortexPlan(new ei.Bcz({metadata:t,input:s,config:new eS.VWI({recordTelemetry:!0,useMacroPlanner:!1})}))).cortexId},[e]),s=(0,X.useCallback)(async t=>{if(e)return(await e.getCortexPlan(new ei.Z28({cortexId:t}))).state},[e]),a=(0,X.useCallback)(async function(t,s,a){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;if(e)return(await e.getSuggestedContextScopeItems(new ei.y8o({metadata:t,suggestionSources:s,query:a,autoExpandFileLimit:BigInt(n),maxItems:BigInt(r)}))).items},[e]),n=(0,X.useCallback)(async()=>{if(e)return(await e.getAllCortexPlans(new ei.L0l({}))).plans},[e]),r=(0,X.useCallback)(async(t,s)=>{e&&await e.commitCodingPlan(new ei.ZWv({metadata:t,planId:s}))},[e]),o=(0,X.useCallback)(async(t,s)=>{e&&await e.replanCodingPlan(new ei._Nw({planId:t,feedback:s}))},[e]),i=(0,X.useCallback)(async(t,s)=>{e&&await e.setPinnedGuideline(new ei.HEB({metadata:t,pinnedGuideline:new et.X8m({items:[new et.bbr({guideline:s})]})}))},[e]),l=(0,X.useCallback)(async(t,s)=>{e&&await e.setPinnedContext(new ei.a6y({metadata:t,pinnedScope:new et.CSl({items:s})}))},[e]),c=(0,X.useCallback)(async(t,s)=>{if(!e)return;let a=await e.getBrainStatus(new ei.a0o({metadata:t,forceRefresh:null!=s&&s}));return a.brainStatus?a.brainStatus:void 0},[e]),d=(0,X.useCallback)(async(t,s,a,n,r)=>{if(!e){console.error("No LS client in getMatchingSearchQueries");return}let o=[et.EGe.DIRECTORY,et.EGe.FILE,et.EGe.REPOSITORY,et.EGe.CODE_CONTEXT];a&&(o=a);try{let a=await e.getMatchingContextScopeItems(new ei.kxl({metadata:s,allowedTypes:o,allowedContextTypes:[et.fIx.FUNCTION,et.fIx.CLASS],query:t,fuzzyMatch:!0,maxItems:30,caseInsensitive:!0,repoFilter:null!=n?n:"",cancelToken:BigInt(null!=r?r:0)}));return null==a?void 0:a.items}catch(e){if(e instanceof ej.K&&e.code===eE.E.Canceled)return;throw e}},[e]),u=(0,X.useCallback)(async(t,s,a)=>{await (null==e?void 0:e.prepareAction(new ei.k_v({metadata:t,planId:s,actionIndex:a})))},[e]),m=(0,X.useCallback)(async(t,s,a)=>{await (null==e?void 0:e.applyAction(new ei.T$_({metadata:t,planId:s,actionIndex:a})))},[e]),p=(0,X.useCallback)(async(t,s,a,n)=>{await (null==e?void 0:e.editAction(new ei.g0U({metadata:t,planId:s,actionIndex:a,spec:n})))},[e]),x=(0,X.useCallback)(async(t,s,a,n)=>{await (null==e?void 0:e.recordCortexFeedback(new ei.J9H({metadata:t,cortexId:s,feedback:a,rating:n})))},[e]),h=(0,X.useCallback)(async(t,s)=>{await (null==e?void 0:e.submitCodingPlanSummary(new ei.dk4({planId:t,summary:s})))},[e]);return{setPinnedContextItems:l,setPinnedGuideline:i,getBrainStatus:c,getMatchingSearchQueries:d,prepareAction:u,applyAction:m,editAction:p,newCortexPlan:t,getCortexPlan:s,getCortexSummaries:n,commitCodingPlan:r,replanCodingPlan:o,recordCortexFeedback:x,getSuggestedContextScopeItems:a,submitCodingPlanSummary:h}},getCodeTheme=()=>{let e=document.querySelector(":root");if(!e)return;let t=getComputedStyle(e);return new ei.CvC({background:t.getPropertyValue("--vscode-editor-background").trim(),text:t.getPropertyValue("--vscode-editor-foreground").trim(),whitespace:t.getPropertyValue("--vscode-editorWhitespace-foreground").trim(),other:t.getPropertyValue("--vscode-editor-foreground").trim(),literal:t.getPropertyValue("--vscode-editor-foreground").trim(),literalString:t.getPropertyValue("--vscode-textPreformat-foreground").trim(),number:t.getPropertyValue("--vscode-debugTokenExpression-number").trim(),operator:t.getPropertyValue("--vscode-editor-foreground").trim(),punctuation:t.getPropertyValue("--vscode-editorBracketHighlight-foreground1").trim(),generic:t.getPropertyValue("--vscode-editorLink-activeForeground").trim(),name:t.getPropertyValue("--vscode-editor-foreground").trim(),keyword:t.getPropertyValue("--vscode-editorLink-activeForeground").trim(),comment:t.getPropertyValue("--vscode-disabledForeground").trim(),error:t.getPropertyValue("--vscode-editorError-foreground").trim()})};(i=_||(_={}))[i.UNSPECIFIED=0]="UNSPECIFIED",i[i.TEXT_EDITOR=1]="TEXT_EDITOR",i[i.TERMINAL=2]="TERMINAL",en.w.util.setEnumType(_,"exa.extension_server_pb.ActiveEditorType",[{no:0,name:"ACTIVE_EDITOR_TYPE_UNSPECIFIED"},{no:1,name:"ACTIVE_EDITOR_TYPE_TEXT_EDITOR"},{no:2,name:"ACTIVE_EDITOR_TYPE_TERMINAL"}]);let LanguageServerStartedRequest=class LanguageServerStartedRequest extends er.v{static fromBinary(e,t){return new LanguageServerStartedRequest().fromBinary(e,t)}static fromJson(e,t){return new LanguageServerStartedRequest().fromJson(e,t)}static fromJsonString(e,t){return new LanguageServerStartedRequest().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(LanguageServerStartedRequest,e,t)}constructor(e){super(),this.languageServerPort=0,this.lspPort=0,this.chatClientPort=0,this.csrfToken="",en.w.util.initPartial(e,this)}};LanguageServerStartedRequest.runtime=en.w,LanguageServerStartedRequest.typeName="exa.extension_server_pb.LanguageServerStartedRequest",LanguageServerStartedRequest.fields=en.w.util.newFieldList(()=>[{no:1,name:"language_server_port",kind:"scalar",T:5},{no:2,name:"lsp_port",kind:"scalar",T:5},{no:3,name:"chat_client_port",kind:"scalar",T:5},{no:4,name:"csrf_token",kind:"scalar",T:9}]);let LanguageServerStartedResponse=class LanguageServerStartedResponse extends er.v{static fromBinary(e,t){return new LanguageServerStartedResponse().fromBinary(e,t)}static fromJson(e,t){return new LanguageServerStartedResponse().fromJson(e,t)}static fromJsonString(e,t){return new LanguageServerStartedResponse().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(LanguageServerStartedResponse,e,t)}constructor(e){super(),en.w.util.initPartial(e,this)}};LanguageServerStartedResponse.runtime=en.w,LanguageServerStartedResponse.typeName="exa.extension_server_pb.LanguageServerStartedResponse",LanguageServerStartedResponse.fields=en.w.util.newFieldList(()=>[]);let OpenSettingRequest=class OpenSettingRequest extends er.v{static fromBinary(e,t){return new OpenSettingRequest().fromBinary(e,t)}static fromJson(e,t){return new OpenSettingRequest().fromJson(e,t)}static fromJsonString(e,t){return new OpenSettingRequest().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(OpenSettingRequest,e,t)}constructor(e){super(),this.settingId="",en.w.util.initPartial(e,this)}};OpenSettingRequest.runtime=en.w,OpenSettingRequest.typeName="exa.extension_server_pb.OpenSettingRequest",OpenSettingRequest.fields=en.w.util.newFieldList(()=>[{no:1,name:"setting_id",kind:"scalar",T:9}]);let OpenSettingResponse=class OpenSettingResponse extends er.v{static fromBinary(e,t){return new OpenSettingResponse().fromBinary(e,t)}static fromJson(e,t){return new OpenSettingResponse().fromJson(e,t)}static fromJsonString(e,t){return new OpenSettingResponse().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(OpenSettingResponse,e,t)}constructor(e){super(),en.w.util.initPartial(e,this)}};OpenSettingResponse.runtime=en.w,OpenSettingResponse.typeName="exa.extension_server_pb.OpenSettingResponse",OpenSettingResponse.fields=en.w.util.newFieldList(()=>[]);let OpenFilePointerRequest=class OpenFilePointerRequest extends er.v{static fromBinary(e,t){return new OpenFilePointerRequest().fromBinary(e,t)}static fromJson(e,t){return new OpenFilePointerRequest().fromJson(e,t)}static fromJsonString(e,t){return new OpenFilePointerRequest().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(OpenFilePointerRequest,e,t)}constructor(e){super(),this.fileUri="",this.startLine=0,this.startCol=0,this.endLine=0,this.endCol=0,this.isCascadeDiff=!1,en.w.util.initPartial(e,this)}};OpenFilePointerRequest.runtime=en.w,OpenFilePointerRequest.typeName="exa.extension_server_pb.OpenFilePointerRequest",OpenFilePointerRequest.fields=en.w.util.newFieldList(()=>[{no:1,name:"file_uri",kind:"scalar",T:9},{no:2,name:"start_line",kind:"scalar",T:5},{no:3,name:"start_col",kind:"scalar",T:5},{no:4,name:"end_line",kind:"scalar",T:5},{no:5,name:"end_col",kind:"scalar",T:5},{no:6,name:"is_cascade_diff",kind:"scalar",T:8}]);let OpenFilePointerResponse=class OpenFilePointerResponse extends er.v{static fromBinary(e,t){return new OpenFilePointerResponse().fromBinary(e,t)}static fromJson(e,t){return new OpenFilePointerResponse().fromJson(e,t)}static fromJsonString(e,t){return new OpenFilePointerResponse().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(OpenFilePointerResponse,e,t)}constructor(e){super(),en.w.util.initPartial(e,this)}};OpenFilePointerResponse.runtime=en.w,OpenFilePointerResponse.typeName="exa.extension_server_pb.OpenFilePointerResponse",OpenFilePointerResponse.fields=en.w.util.newFieldList(()=>[]);let InsertCodeAtCursorRequest=class InsertCodeAtCursorRequest extends er.v{static fromBinary(e,t){return new InsertCodeAtCursorRequest().fromBinary(e,t)}static fromJson(e,t){return new InsertCodeAtCursorRequest().fromJson(e,t)}static fromJsonString(e,t){return new InsertCodeAtCursorRequest().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(InsertCodeAtCursorRequest,e,t)}constructor(e){super(),this.text="",this.editorType=0,en.w.util.initPartial(e,this)}};InsertCodeAtCursorRequest.runtime=en.w,InsertCodeAtCursorRequest.typeName="exa.extension_server_pb.InsertCodeAtCursorRequest",InsertCodeAtCursorRequest.fields=en.w.util.newFieldList(()=>[{no:1,name:"text",kind:"scalar",T:9},{no:2,name:"editor_type",kind:"enum",T:en.w.getEnumType(_)}]);let InsertCodeAtCursorResponse=class InsertCodeAtCursorResponse extends er.v{static fromBinary(e,t){return new InsertCodeAtCursorResponse().fromBinary(e,t)}static fromJson(e,t){return new InsertCodeAtCursorResponse().fromJson(e,t)}static fromJsonString(e,t){return new InsertCodeAtCursorResponse().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(InsertCodeAtCursorResponse,e,t)}constructor(e){super(),en.w.util.initPartial(e,this)}};InsertCodeAtCursorResponse.runtime=en.w,InsertCodeAtCursorResponse.typeName="exa.extension_server_pb.InsertCodeAtCursorResponse",InsertCodeAtCursorResponse.fields=en.w.util.newFieldList(()=>[]);let EventMetadataRecord=class EventMetadataRecord extends er.v{static fromBinary(e,t){return new EventMetadataRecord().fromBinary(e,t)}static fromJson(e,t){return new EventMetadataRecord().fromJson(e,t)}static fromJsonString(e,t){return new EventMetadataRecord().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(EventMetadataRecord,e,t)}constructor(e){super(),this.key="",this.value="",en.w.util.initPartial(e,this)}};EventMetadataRecord.runtime=en.w,EventMetadataRecord.typeName="exa.extension_server_pb.EventMetadataRecord",EventMetadataRecord.fields=en.w.util.newFieldList(()=>[{no:1,name:"key",kind:"scalar",T:9},{no:2,name:"value",kind:"scalar",T:9}]);let LogEventRequest=class LogEventRequest extends er.v{static fromBinary(e,t){return new LogEventRequest().fromBinary(e,t)}static fromJson(e,t){return new LogEventRequest().fromJson(e,t)}static fromJsonString(e,t){return new LogEventRequest().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(LogEventRequest,e,t)}constructor(e){super(),this.event=et.tbr.EVENT_UNSPECIFIED,this.metadata=[],en.w.util.initPartial(e,this)}};LogEventRequest.runtime=en.w,LogEventRequest.typeName="exa.extension_server_pb.LogEventRequest",LogEventRequest.fields=en.w.util.newFieldList(()=>[{no:1,name:"event",kind:"enum",T:en.w.getEnumType(et.tbr)},{no:2,name:"metadata",kind:"message",T:EventMetadataRecord,repeated:!0}]);let LogEventResponse=class LogEventResponse extends er.v{static fromBinary(e,t){return new LogEventResponse().fromBinary(e,t)}static fromJson(e,t){return new LogEventResponse().fromJson(e,t)}static fromJsonString(e,t){return new LogEventResponse().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(LogEventResponse,e,t)}constructor(e){super(),en.w.util.initPartial(e,this)}};LogEventResponse.runtime=en.w,LogEventResponse.typeName="exa.extension_server_pb.LogEventResponse",LogEventResponse.fields=en.w.util.newFieldList(()=>[]);let CheckTerminalShellSupportRequest=class CheckTerminalShellSupportRequest extends er.v{static fromBinary(e,t){return new CheckTerminalShellSupportRequest().fromBinary(e,t)}static fromJson(e,t){return new CheckTerminalShellSupportRequest().fromJson(e,t)}static fromJsonString(e,t){return new CheckTerminalShellSupportRequest().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(CheckTerminalShellSupportRequest,e,t)}constructor(e){super(),en.w.util.initPartial(e,this)}};CheckTerminalShellSupportRequest.runtime=en.w,CheckTerminalShellSupportRequest.typeName="exa.extension_server_pb.CheckTerminalShellSupportRequest",CheckTerminalShellSupportRequest.fields=en.w.util.newFieldList(()=>[]);let CheckTerminalShellSupportResponse=class CheckTerminalShellSupportResponse extends er.v{static fromBinary(e,t){return new CheckTerminalShellSupportResponse().fromBinary(e,t)}static fromJson(e,t){return new CheckTerminalShellSupportResponse().fromJson(e,t)}static fromJsonString(e,t){return new CheckTerminalShellSupportResponse().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(CheckTerminalShellSupportResponse,e,t)}constructor(e){super(),this.hasShellIntegration=!1,this.shellName="",this.shellPath="",en.w.util.initPartial(e,this)}};CheckTerminalShellSupportResponse.runtime=en.w,CheckTerminalShellSupportResponse.typeName="exa.extension_server_pb.CheckTerminalShellSupportResponse",CheckTerminalShellSupportResponse.fields=en.w.util.newFieldList(()=>[{no:1,name:"has_shell_integration",kind:"scalar",T:8},{no:2,name:"shell_name",kind:"scalar",T:9},{no:3,name:"shell_path",kind:"scalar",T:9}]);let ExecuteCommandRequest=class ExecuteCommandRequest extends er.v{static fromBinary(e,t){return new ExecuteCommandRequest().fromBinary(e,t)}static fromJson(e,t){return new ExecuteCommandRequest().fromJson(e,t)}static fromJsonString(e,t){return new ExecuteCommandRequest().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(ExecuteCommandRequest,e,t)}constructor(e){super(),this.commandLine="",this.cwd="",this.terminalId="",en.w.util.initPartial(e,this)}};ExecuteCommandRequest.runtime=en.w,ExecuteCommandRequest.typeName="exa.extension_server_pb.ExecuteCommandRequest",ExecuteCommandRequest.fields=en.w.util.newFieldList(()=>[{no:5,name:"command_line",kind:"scalar",T:9},{no:3,name:"cwd",kind:"scalar",T:9},{no:4,name:"terminal_id",kind:"scalar",T:9}]);let ShowTerminalRequest=class ShowTerminalRequest extends er.v{static fromBinary(e,t){return new ShowTerminalRequest().fromBinary(e,t)}static fromJson(e,t){return new ShowTerminalRequest().fromJson(e,t)}static fromJsonString(e,t){return new ShowTerminalRequest().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(ShowTerminalRequest,e,t)}constructor(e){super(),this.terminalId="",en.w.util.initPartial(e,this)}};ShowTerminalRequest.runtime=en.w,ShowTerminalRequest.typeName="exa.extension_server_pb.ShowTerminalRequest",ShowTerminalRequest.fields=en.w.util.newFieldList(()=>[{no:1,name:"terminal_id",kind:"scalar",T:9}]);let ShowTerminalResponse=class ShowTerminalResponse extends er.v{static fromBinary(e,t){return new ShowTerminalResponse().fromBinary(e,t)}static fromJson(e,t){return new ShowTerminalResponse().fromJson(e,t)}static fromJsonString(e,t){return new ShowTerminalResponse().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(ShowTerminalResponse,e,t)}constructor(e){super(),en.w.util.initPartial(e,this)}};ShowTerminalResponse.runtime=en.w,ShowTerminalResponse.typeName="exa.extension_server_pb.ShowTerminalResponse",ShowTerminalResponse.fields=en.w.util.newFieldList(()=>[]);let OpenVirtualFileRequest=class OpenVirtualFileRequest extends er.v{static fromBinary(e,t){return new OpenVirtualFileRequest().fromBinary(e,t)}static fromJson(e,t){return new OpenVirtualFileRequest().fromJson(e,t)}static fromJsonString(e,t){return new OpenVirtualFileRequest().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(OpenVirtualFileRequest,e,t)}constructor(e){super(),this.text="",this.showMarkdownPreview=!1,en.w.util.initPartial(e,this)}};OpenVirtualFileRequest.runtime=en.w,OpenVirtualFileRequest.typeName="exa.extension_server_pb.OpenVirtualFileRequest",OpenVirtualFileRequest.fields=en.w.util.newFieldList(()=>[{no:1,name:"text",kind:"scalar",T:9},{no:2,name:"show_markdown_preview",kind:"scalar",T:8}]);let OpenVirtualFileResponse=class OpenVirtualFileResponse extends er.v{static fromBinary(e,t){return new OpenVirtualFileResponse().fromBinary(e,t)}static fromJson(e,t){return new OpenVirtualFileResponse().fromJson(e,t)}static fromJsonString(e,t){return new OpenVirtualFileResponse().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(OpenVirtualFileResponse,e,t)}constructor(e){super(),en.w.util.initPartial(e,this)}};OpenVirtualFileResponse.runtime=en.w,OpenVirtualFileResponse.typeName="exa.extension_server_pb.OpenVirtualFileResponse",OpenVirtualFileResponse.fields=en.w.util.newFieldList(()=>[]);let SaveDocumentRequest=class SaveDocumentRequest extends er.v{static fromBinary(e,t){return new SaveDocumentRequest().fromBinary(e,t)}static fromJson(e,t){return new SaveDocumentRequest().fromJson(e,t)}static fromJsonString(e,t){return new SaveDocumentRequest().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(SaveDocumentRequest,e,t)}constructor(e){super(),this.uri="",en.w.util.initPartial(e,this)}};SaveDocumentRequest.runtime=en.w,SaveDocumentRequest.typeName="exa.extension_server_pb.SaveDocumentRequest",SaveDocumentRequest.fields=en.w.util.newFieldList(()=>[{no:1,name:"uri",kind:"scalar",T:9}]);let SaveDocumentResponse=class SaveDocumentResponse extends er.v{static fromBinary(e,t){return new SaveDocumentResponse().fromBinary(e,t)}static fromJson(e,t){return new SaveDocumentResponse().fromJson(e,t)}static fromJsonString(e,t){return new SaveDocumentResponse().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(SaveDocumentResponse,e,t)}constructor(e){super(),en.w.util.initPartial(e,this)}};SaveDocumentResponse.runtime=en.w,SaveDocumentResponse.typeName="exa.extension_server_pb.SaveDocumentResponse",SaveDocumentResponse.fields=en.w.util.newFieldList(()=>[]);let GetLintErrorsRequest=class GetLintErrorsRequest extends er.v{static fromBinary(e,t){return new GetLintErrorsRequest().fromBinary(e,t)}static fromJson(e,t){return new GetLintErrorsRequest().fromJson(e,t)}static fromJsonString(e,t){return new GetLintErrorsRequest().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(GetLintErrorsRequest,e,t)}constructor(e){super(),en.w.util.initPartial(e,this)}};GetLintErrorsRequest.runtime=en.w,GetLintErrorsRequest.typeName="exa.extension_server_pb.GetLintErrorsRequest",GetLintErrorsRequest.fields=en.w.util.newFieldList(()=>[{no:1,name:"await_new_lints_config",kind:"message",T:GetLintErrorsRequest_AwaitNewLintsConfig,opt:!0}]);let GetLintErrorsRequest_AwaitNewLintsConfig=class GetLintErrorsRequest_AwaitNewLintsConfig extends er.v{static fromBinary(e,t){return new GetLintErrorsRequest_AwaitNewLintsConfig().fromBinary(e,t)}static fromJson(e,t){return new GetLintErrorsRequest_AwaitNewLintsConfig().fromJson(e,t)}static fromJsonString(e,t){return new GetLintErrorsRequest_AwaitNewLintsConfig().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(GetLintErrorsRequest_AwaitNewLintsConfig,e,t)}constructor(e){super(),this.acknowledgerId="",this.timeoutMs=0,this.gracePeriodMs=0,this.includeSaved=!1,en.w.util.initPartial(e,this)}};GetLintErrorsRequest_AwaitNewLintsConfig.runtime=en.w,GetLintErrorsRequest_AwaitNewLintsConfig.typeName="exa.extension_server_pb.GetLintErrorsRequest.AwaitNewLintsConfig",GetLintErrorsRequest_AwaitNewLintsConfig.fields=en.w.util.newFieldList(()=>[{no:1,name:"acknowledger_id",kind:"scalar",T:9},{no:2,name:"timeout_ms",kind:"scalar",T:5},{no:3,name:"grace_period_ms",kind:"scalar",T:5},{no:4,name:"include_saved",kind:"scalar",T:8}]);let GetLintErrorsResponse=class GetLintErrorsResponse extends er.v{static fromBinary(e,t){return new GetLintErrorsResponse().fromBinary(e,t)}static fromJson(e,t){return new GetLintErrorsResponse().fromJson(e,t)}static fromJsonString(e,t){return new GetLintErrorsResponse().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(GetLintErrorsResponse,e,t)}constructor(e){super(),this.lintErrors=[],this.persistentLintErrors=[],en.w.util.initPartial(e,this)}};GetLintErrorsResponse.runtime=en.w,GetLintErrorsResponse.typeName="exa.extension_server_pb.GetLintErrorsResponse",GetLintErrorsResponse.fields=en.w.util.newFieldList(()=>[{no:1,name:"lint_errors",kind:"message",T:et.ybJ,repeated:!0},{no:2,name:"persistent_lint_errors",kind:"message",T:et.ybJ,repeated:!0}]);let OpenDiffZonesRequest=class OpenDiffZonesRequest extends er.v{static fromBinary(e,t){return new OpenDiffZonesRequest().fromBinary(e,t)}static fromJson(e,t){return new OpenDiffZonesRequest().fromJson(e,t)}static fromJsonString(e,t){return new OpenDiffZonesRequest().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(OpenDiffZonesRequest,e,t)}constructor(e){super(),this.cascadeId="",this.validationStates=[],this.writeNewState=!1,en.w.util.initPartial(e,this)}};OpenDiffZonesRequest.runtime=en.w,OpenDiffZonesRequest.typeName="exa.extension_server_pb.OpenDiffZonesRequest",OpenDiffZonesRequest.fields=en.w.util.newFieldList(()=>[{no:1,name:"cascade_id",kind:"scalar",T:9},{no:2,name:"validation_states",kind:"message",T:ei.YgU,repeated:!0},{no:3,name:"write_new_state",kind:"scalar",T:8}]);let OpenDiffZonesResponse=class OpenDiffZonesResponse extends er.v{static fromBinary(e,t){return new OpenDiffZonesResponse().fromBinary(e,t)}static fromJson(e,t){return new OpenDiffZonesResponse().fromJson(e,t)}static fromJsonString(e,t){return new OpenDiffZonesResponse().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(OpenDiffZonesResponse,e,t)}constructor(e){super(),en.w.util.initPartial(e,this)}};OpenDiffZonesResponse.runtime=en.w,OpenDiffZonesResponse.typeName="exa.extension_server_pb.OpenDiffZonesResponse",OpenDiffZonesResponse.fields=en.w.util.newFieldList(()=>[]);let OpenExternalUrlRequest=class OpenExternalUrlRequest extends er.v{static fromBinary(e,t){return new OpenExternalUrlRequest().fromBinary(e,t)}static fromJson(e,t){return new OpenExternalUrlRequest().fromJson(e,t)}static fromJsonString(e,t){return new OpenExternalUrlRequest().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(OpenExternalUrlRequest,e,t)}constructor(e){super(),this.url="",this.useIdeBrowser=!1,en.w.util.initPartial(e,this)}};OpenExternalUrlRequest.runtime=en.w,OpenExternalUrlRequest.typeName="exa.extension_server_pb.OpenExternalUrlRequest",OpenExternalUrlRequest.fields=en.w.util.newFieldList(()=>[{no:1,name:"url",kind:"scalar",T:9},{no:2,name:"use_ide_browser",kind:"scalar",T:8}]);let OpenExternalUrlResponse=class OpenExternalUrlResponse extends er.v{static fromBinary(e,t){return new OpenExternalUrlResponse().fromBinary(e,t)}static fromJson(e,t){return new OpenExternalUrlResponse().fromJson(e,t)}static fromJsonString(e,t){return new OpenExternalUrlResponse().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(OpenExternalUrlResponse,e,t)}constructor(e){super(),en.w.util.initPartial(e,this)}};OpenExternalUrlResponse.runtime=en.w,OpenExternalUrlResponse.typeName="exa.extension_server_pb.OpenExternalUrlResponse",OpenExternalUrlResponse.fields=en.w.util.newFieldList(()=>[]);let HandleAsyncPostMessageRequest=class HandleAsyncPostMessageRequest extends er.v{static fromBinary(e,t){return new HandleAsyncPostMessageRequest().fromBinary(e,t)}static fromJson(e,t){return new HandleAsyncPostMessageRequest().fromJson(e,t)}static fromJsonString(e,t){return new HandleAsyncPostMessageRequest().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(HandleAsyncPostMessageRequest,e,t)}constructor(e){super(),this.messageType="",this.messageContent="",en.w.util.initPartial(e,this)}};HandleAsyncPostMessageRequest.runtime=en.w,HandleAsyncPostMessageRequest.typeName="exa.extension_server_pb.HandleAsyncPostMessageRequest",HandleAsyncPostMessageRequest.fields=en.w.util.newFieldList(()=>[{no:1,name:"message_type",kind:"scalar",T:9},{no:2,name:"message_content",kind:"scalar",T:9}]);let HandleAsyncPostMessageResponse=class HandleAsyncPostMessageResponse extends er.v{static fromBinary(e,t){return new HandleAsyncPostMessageResponse().fromBinary(e,t)}static fromJson(e,t){return new HandleAsyncPostMessageResponse().fromJson(e,t)}static fromJsonString(e,t){return new HandleAsyncPostMessageResponse().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(HandleAsyncPostMessageResponse,e,t)}constructor(e){super(),this.responseContent="",en.w.util.initPartial(e,this)}};HandleAsyncPostMessageResponse.runtime=en.w,HandleAsyncPostMessageResponse.typeName="exa.extension_server_pb.HandleAsyncPostMessageResponse",HandleAsyncPostMessageResponse.fields=en.w.util.newFieldList(()=>[{no:1,name:"response_content",kind:"scalar",T:9}]);let Unleash=class Unleash{isEnabled(e){var t,s;return null!==(s=null===(t=this.experimentStatus.find(t=>t.experimentKey===e))||void 0===t?void 0:t.enabled)&&void 0!==s&&s}constructor(e){this.experimentStatus=e}};function createCsrfInterceptor(e){return t=>async s=>(s.header.set("x-codeium-csrf-token",e),await t(s))}let useServerConnection=e=>{var t,s;let{serverAddress:a,bridge:n,fetchMentions:r,getUserAnalyticsSummary:o,openProfile:i,openGenericUrl:l,userId:c,readTerminal:d,readActiveSelection:u,openUniversity:m,lsClient:p,extensionClient:x,handleLogin:h,handleReload:g,handleOpenReadOnlyDiff:f,handleCloseAllDiffZones:y,handleSetDiffZonesState:v,handleClosePanel:C,handleFastApply:w,handleFocusEditor:b,setWebviewMetadata:N,handlePopup:S,userStatusError:j,logEvent:E,checkClipboard:T,openQuickSettings:R,openCascadeMemoriesPanel:_,openMcpConfigFile:D,downloadDiagnostics:A,updateIdePlanInfo:P,triggerAutoCascade:M,disableWebSocket:L=!1}=e,[O,F]=(0,X.useState)(I.DISCONNECTED),B=(0,X.useRef)(),q=useChatParamsContext(),{ready:U,hasDevExtension:G,ideTelemetryEnabled:Q,webServerUrl:J}=q,[W,H]=(0,X.useState)(null),[V,Y]=(0,X.useState)(),[Z,K]=(0,X.useState)(),[z,en]=(0,X.useState)(null),[er,eo]=(0,X.useState)([]),[em,ep]=(0,X.useState)(new et.PGO),[ex,eh]=(0,X.useState)(!1),[eb,eS]=(0,X.useState)(void 0),[ej,eE]=(0,X.useState)(void 0),eI=(0,X.useMemo)(()=>{if(p)return p;let e=null==z?void 0:z.languageServerAddress;if(!e)return null;let t=[];if(q.csrfToken){let e=createCsrfInterceptor(q.csrfToken);t.push(e)}return(0,$.Hb)(es.c,(0,ey.B)({baseUrl:"http://".concat(e),useBinaryFormat:!0,interceptors:t}))},[null==z?void 0:z.languageServerAddress,p,q]);(0,X.useEffect)(()=>{let fetch=async()=>{if(eI&&q.apiKey){if(L){let e=getMetadata(q),t=eI.getUserStatus({metadata:e}),s=eI.getChatExperiments({metadata:e}),a=eI.getUserSettings({}),[n,r,o]=await Promise.all([t,s,a]);Y(n.userStatus),K(n.planInfo),eo(r.experiments),ep(o.userSettings||new et.PGO)}try{let e=await eI.getProfileData({apiKey:q.apiKey});H(e.profilePictureUrl)}catch(e){console.error(e)}}};fetch()},[eI,q,q.apiKey,L]);let eT=(0,X.useMemo)(()=>new Unleash(L?er:(null==z?void 0:z.experiments)||[]),[er,L,null==z?void 0:z.experiments]),ek=(0,X.useMemo)(()=>O===I.READY,[O]),{items:eR,reset:e_,updateItem:eD,clear:eA}=(0,eg.useListState)({getID:e=>{var t;return(null===(t=e.message)||void 0===t?void 0:t.messageId)||""},comparator:(e,t)=>{var s,a,n,r;return(0,ef.dateComparator)((null===(a=e.message)||void 0===a?void 0:null===(s=a.timestamp)||void 0===s?void 0:s.toDate())||new Date,(null===(r=t.message)||void 0===r?void 0:null===(n=r.timestamp)||void 0===n?void 0:n.toDate())||new Date,"asc")}}),eP=(0,X.useRef)(),[eM,eL]=(0,X.useState)(null),eO=(0,X.useRef)(0),[eF,eB]=(0,X.useState)(getCurrentConversationID([])),eq=(0,X.useCallback)((e,t)=>{if(x){x.logEvent({event:e,metadata:t?Object.entries(t).map(e=>{let[t,s]=e;return{key:t,value:s}}):[]});return}E&&E(e,null!=t?t:{})},[E,x]),eU=(0,X.useMemo)(()=>{let e={};return eR.forEach(t=>{var s,a;let n=null===(s=t.message)||void 0===s?void 0:s.conversationId;if(!n||!(null===(a=t.message)||void 0===a?void 0:a.timestamp))return;let r=t.message.timestamp.toDate();if(e[n]){let s=e[n];"status"!==t.message.content.case&&s.numMessages++,r>s.latestMessageAt&&(s.latestMessageAt=r),r<=s.createdAt&&(s.createdAt=r,s.firstMessage=t.message)}else e[n]={conversationID:n,firstMessage:t.message,createdAt:r,latestMessageAt:r,numMessages:1}}),Object.values(e).sort((e,t)=>t.latestMessageAt.getTime()-e.latestMessageAt.getTime())},[eR]),eG=(0,X.useMemo)(()=>c||!eF?eR:eR.filter(e=>{var t;return(null===(t=e.message)||void 0===t?void 0:t.conversationId)===eF}),[eR,eF,c]),eQ=(0,X.useCallback)(()=>{let e;eP.current&&eP.current.close(1e3);let t=performance.now();if(F(I.CONNECTING),console.debug("[WebSocket] begin acquiring connection ".concat((t/1e3).toFixed(2)," seconds after page load")),eL(null),!q.apiKey){eL(eu);return}if(!q.webServerUrl&&!q.hasDevExtension){eL(Error("Missing chat language server URL. Please ensure that you are signed in to the Codeium plugin and close / reopen the chat window. If the problem persists, please restart the IDE."));return}e=n||new WebSocketBridge(a),eP.current=e,eP.current.onOpen=()=>{let e=performance.now();console.debug("[WebSocket] connection established in ".concat(((e-t)/1e3).toFixed(2)," seconds")),eL(null),F(I.CONNECTED);try{var s;null===(s=eP.current)||void 0===s||s.send(new WebServerRequest({payload:{case:"handshakeRequest",value:{metadata:getMetadata(q),userId:c}}}))}catch(e){e instanceof Error&&eL(e)}},eP.current.onMessage=e=>{switch(e.payload.case){case"errorResponse":eL(Error(e.payload.value.error));break;case"handshakeResponse":{en(e.payload.value),F(I.READY);let s=e.payload.value;if(eO.current=0,e.payload.value.initialState){var t;let{initialState:s}=e.payload.value;e_(s.messages),eh(s.isReceivingMessage),s.userSettings&&(ep(s.userSettings),eS(s.draftQuery)),(null===(t=s.userSettings)||void 0===t?void 0:t.openMostRecentChatConversation)?eB(getCurrentConversationID(s.messages)):eB((0,el.getNonce)())}s.userStatus&&Y(s.userStatus),s.planInfo&&K(s.planInfo),eo(s.experiments),B.current=setInterval(()=>{var e;null===(e=eP.current)||void 0===e||e.send(new WebServerRequest({payload:{case:"heartbeat",value:{}}}))},3e4);break}case"stateUpdate":{F(I.READY);let t=e.payload.value.state;if(!t)return;if(e.payload.value.state){let{state:t,isPartialUpdate:s}=e.payload.value;s?(t.messages.forEach(e=>{var t;(null===(t=e.message)||void 0===t?void 0:t.messageId)&&eD(e.message.messageId,e)}),eh(t.isReceivingMessage)):(e_(t.messages),eh(t.isReceivingMessage),eE(t.pinnedSystemFeedback)),t.userSettings&&ep(t.userSettings),t.isReceivingMessage&&eB(getCurrentConversationID(t.messages))}}}},eP.current.onError=e=>{console.error("[WebSocket] error:",e)},eP.current.onClose=e=>{if(F(I.DISCONNECTED),console.debug("[WebSocket] connection closed with code ".concat(e.code)),clearInterval(B.current),1006==e.code){eL(Error("Abnormal connection close by server."));let e=exponentialBackoffDelay(eO.current,{baseDelaySeconds:1,maxDelaySeconds:120});eO.current+=1,console.debug("[WebSocket] retrying connection in ".concat(e," seconds")),setTimeout(()=>{eQ()},1e3*e)}},eP.current.connect()},[n,q,a,e_,eD,c]);(0,X.useEffect)(()=>{if(U&&!L)return eQ(),()=>{var e;console.debug("[WebSocket] closing connection"),null===(e=eP.current)||void 0===e||e.close(1e3)}},[L,U,a,c]);let eJ=(0,X.useCallback)(()=>{eq(et.tbr.CHAT_NEW_CONVERSATION),eB((0,el.getNonce)()),eh(!1)},[eq]),eW=(0,X.useCallback)(()=>{var e;let t=new WebServerRequest({payload:{case:"clearConversation",value:{}}});null===(e=eP.current)||void 0===e||e.send(t),eh(!1),eA(),eJ()},[eA,eJ]),eH=(0,X.useCallback)(e=>{var t;let s=new WebServerRequest({payload:{case:"clearConversation",value:{conversationId:e}}});null===(t=eP.current)||void 0===t||t.send(s),eh(!1),e===eF&&eJ()},[eF,eJ]),eV=(0,X.useMemo)(()=>(!q.ready||!!q.apiKey)&&(!ek||null!=z&&!!z.userStatus&&(z.userStatus.teamId?z.userStatus.teamStatus===et.ngL.APPROVED:!!Q&&!z.userStatus.disableTelemetry)),[q.apiKey,q.ready,null==z?void 0:z.userStatus,Q,ek]),eY=(0,X.useCallback)(()=>{var e;let t=eR[eR.length-1];t&&(null===(e=eP.current)||void 0===e||e.send(new WebServerRequest({payload:{case:"cancelInfightMessage",value:{streamId:t.streamId}}})))},[eR]),eZ=(0,X.useCallback)(()=>{var e;if(0===eR.length)return;let t=eR[eR.length-1];t&&(null===(e=eP.current)||void 0===e||e.send(new WebServerRequest({payload:{case:"retryLastMessage",value:{}}})))},[eR]),eK=(0,X.useCallback)(async(e,t)=>{console.debug("[WebSocket] sending message:",e.toJson()),eY();let s=eF;"generic"!==e.intent.case&&eB(s=(0,el.getNonce)());let a=getRelevantMessageHistory(eG,s),n=new ee.J({messageId:"user-".concat((0,el.getNonce)()),source:et.ogd.USER,conversationId:s,timestamp:ea.E.now(),content:{case:"intent",value:e}}),r=a.map(e=>e.message).filter(ed.notEmpty),o=u?await u():void 0;try{var i,l,c,d,m,p,x,h;let e=new WebServerRequest({payload:{case:"getChatMessageRequest",value:{metadata:getMetadata(q),chatMessages:[...r,n],contextInclusionType:null==t?void 0:t.contextInclusionType,chatModel:null==t?void 0:t.model,activeSelection:null!=o?o:void 0,systemPromptOverride:null==t?void 0:t.systemPrompt,chatModelName:null==t?void 0:null===(i=t.externalModelOptions)||void 0===i?void 0:i.model_name,enterpriseChatModelConfig:{maxOutputTokens:null==t?void 0:null===(l=t.externalModelOptions)||void 0===l?void 0:l.max_output_tokens,maxInputTokens:null==t?void 0:null===(c=t.externalModelOptions)||void 0===c?void 0:c.max_input_tokens}}}});null===(d=eP.current)||void 0===d||d.send(e),eq(et.tbr.CHAT_MESSAGE_SENT,{contextInclusionType:null!==(x=null==t?void 0:null===(m=t.contextInclusionType)||void 0===m?void 0:m.toString())&&void 0!==x?x:"",chatModel:null!==(h=null==t?void 0:null===(p=t.model)||void 0===p?void 0:p.toString())&&void 0!==h?h:""}),(null==t?void 0:t.contextInclusionType)===et.tyb.INCLUDE&&eq(et.tbr.CHAT_WITH_CODEBASE)}catch(e){e instanceof Error&&eL(e)}return n},[eY,q,eF,eG,u,eq]),ez=(0,X.useCallback)((e,t,s)=>{try{var a;let n=new WebServerRequest({payload:{case:"recordChatFeedbackRequest",value:{metadata:getMetadata(q),messageId:e,feedback:t,reason:s,timestamp:ea.E.now()}}});G&&console.debug("[".concat(e,"] sending feedback ").concat((0,ec.enumToString)(t,ee.Cx))),null===(a=eP.current)||void 0===a||a.send(n)}catch(e){e instanceof Error&&eL(e)}},[q,G]),eX=(0,X.useCallback)(e=>{var t;eS(e);let s=new WebServerRequest({payload:{case:"setDraftQuery",value:{draftQuery:e}}});null===(t=eP.current)||void 0===t||t.send(s)},[]),e$=(0,X.useCallback)(async e=>{var t;if(x){await x.openFilePointer(e);return}null===(t=eP.current)||void 0===t||t.send(new WebServerRequest({payload:{case:"openFilePointer",value:e}}))},[x]),e0=(0,X.useCallback)(e=>{var t;let{messageId:s,filePath:a,diffBlock:n,providerSource:r,fileContentHash:o,diffDocPrefix:i,diffDocSuffix:l,uri:c}=e;null===(t=eP.current)||void 0===t||t.send(function(e,t,s){let a=t||eC.S.fromPath(e).toString();return new WebServerRequest({payload:{case:"applyDiff",value:{filePathMigrateMeToUri:e,uri:a,...s}}})}(a,c,{messageId:s,diff:n,providerSource:r,fileContentHash:o,diffDocPrefix:i,diffDocSuffix:l}))},[]),e1=(0,X.useCallback)(e=>{var t;let{messageId:s,fileUri:a,providerSource:n}=e;null===(t=eP.current)||void 0===t||t.send(new WebServerRequest({payload:{case:"hideDiff",value:{uri:a,messageId:s,providerSource:n}}}))},[]),e2=(0,X.useCallback)(async function(e){var t;let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:k.TEXT_EDITOR;if(x){await x.insertCodeAtCursor(new InsertCodeAtCursorRequest({text:e,editorType:s}));return}null===(t=eP.current)||void 0===t||t.send(new WebServerRequest({payload:{case:"insertAtCursor",value:{text:e,editorType:s}}}))},[x]),e5=(0,X.useCallback)(e=>{let t=findUserIntentFromResponse(e,eG);t&&eK(t,{contextInclusionType:et.tyb.EXCLUDE})},[eG,eK]),e3=(0,X.useCallback)(e=>{let t=findUserIntentFromResponse(e,eG);t&&eK(t,{contextInclusionType:et.tyb.INCLUDE})},[eG,eK]),e4=(0,X.useCallback)(async e=>{var t;if(o)return o(e);if(!eI)throw Error("No language server client");let s=await eI.getUserAnalyticsSummary(new ei.OD_({metadata:getMetadata(q),timeZone:null!==(t=(0,ev.getCurrentTimeZone)())&&void 0!==t?t:ew.DefaultTimeZone,startTimestamp:(null==e?void 0:e.start)?ea.E.fromDate(e.start):void 0,endTimestamp:(null==e?void 0:e.end)?ea.E.fromDate(e.end):void 0}));return s.toBinary()},[q,o,eI]),e6=(0,X.useCallback)(e=>{if(L)null==eI||eI.setUserSettings({userSettings:e}),ep(e);else{var t;null===(t=eP.current)||void 0===t||t.send(new WebServerRequest({payload:{case:"updateUserSettings",value:{userSettings:e}}}))}},[L,eP,eI]),e8=(0,X.useCallback)(()=>{var e;null===(e=eP.current)||void 0===e||e.send(new WebServerRequest({payload:{case:"dismissPinnedSystemFeedback",value:{}}}))},[eP]),e9=(0,X.useMemo)(()=>{if(!J)return null;let e=J.replace("ws://","http://").replace("wss://","https://");return(0,$.Hb)(eN,(0,ey.B)({baseUrl:e,useBinaryFormat:!0}))},[J]),e7=useBrainConnect(eI),te=!!(G||(null==z?void 0:null===(t=z.userStatus)||void 0===t?void 0:t.teamsFeatures.includes(et.Y7c.CORTEX))||(null==z?void 0:null===(s=z.userStatus)||void 0===s?void 0:s.userFeatures.includes(et.aYQ.CORTEX))),tt=(0,X.useCallback)(async()=>{if(!p)return[];let e=await p.getWebDocsOptions(new ei.s4s({metadata:getMetadata(q)}));return e.options},[p,q]);return(0,X.useEffect)(()=>{let e=getCodeTheme();N&&e&&N(e)},[N]),{status:O,error:eM,userStatusError:null!=j?j:null,isInitialized:ek,conversationID:eF,submitFeedback:ez,setDraftQuery:eX,cancelInflightChat:eY,retryLastMessage:eZ,isChatEnabled:eV,newConversation:eJ,setConversationID:eB,handshake:z,sendMessage:eK,applyDiff:e0,hideDiff:e1,insertAtCursor:e2,openFilePointer:e$,state:{isReceivingMessage:ex,conversations:eU,messages:eG,userSettings:em,draftQuery:eb,profilePictureUrl:W},clearHistory:eW,deleteConversation:eH,refreshConnection:eQ,getUserAnalyticsSummary:e4,updateUserSettings:e6,lsClient:eI,extensionClient:x,props:{serverAddress:a,bridge:n,fetchMentions:r,getUserAnalyticsSummary:o,openProfile:()=>{if(i){i();return}window.open("https://codeium.com/profile?referrer=extension","_blank")},openGenericUrl:e=>{if(l){l(e);return}window.open(e,"_blank")},openUniversity:m,handleLogin:h,handleReload:g,handleFastApply:w,lsClient:null!=eI?eI:void 0,handleOpenReadOnlyDiff:f,handleCloseAllDiffZones:y,handleSetDiffZonesState:v,handleClosePanel:C,checkClipboard:T,handlePopup:S,openQuickSettings:R,openCascadeMemoriesPanel:_,downloadDiagnostics:A,updateIdePlanInfo:P,openMcpConfigFile:D,triggerAutoCascade:M},rerunWithoutContext:e5,rerunWithContext:e3,webServerConnectClient:e9,readTerminal:d,brainInterface:e7,handleFocusEditor:b,cortexEnabled:te,pinnedSystemFeedback:ej,dismissPinnedSystemFeedback:e8,logEvent:eq,getWebDocsOptions:tt,userStatus:V,planInfo:Z,unleash:eT}},eI={status:I.DISCONNECTED,error:null,userStatusError:null,isInitialized:!1,handshake:null,conversationID:"",newConversation:()=>{},setConversationID:()=>{},isChatEnabled:!0,sendMessage:()=>Promise.resolve(new ee.J),retryLastMessage:()=>{},openFilePointer:async()=>{},applyDiff:()=>{},hideDiff:()=>{},insertAtCursor:async()=>{},state:{isReceivingMessage:!1,conversations:[],messages:[],userSettings:new et.PGO,draftQuery:void 0},refreshConnection:()=>{},cancelInflightChat:()=>{},submitFeedback:()=>{},clearHistory:()=>{},setDraftQuery:()=>{},deleteConversation:()=>{},getUserAnalyticsSummary:()=>Promise.resolve(new Uint8Array),updateUserSettings:()=>{},lsClient:null,extensionClient:void 0,props:{serverAddress:"",openProfile:()=>{throw Error("Not implemented")},openGenericUrl:()=>{throw Error("Not implemented")},handleFastApply:()=>{throw Error("Not implemented")}},rerunWithoutContext:()=>{},rerunWithContext:()=>{},webServerConnectClient:null,readTerminal:void 0,brainInterface:{},handleFocusEditor:()=>{},cortexEnabled:!1,pinnedSystemFeedback:void 0,dismissPinnedSystemFeedback:()=>{},logEvent:()=>{},getWebDocsOptions:()=>Promise.resolve([]),unleash:new Unleash([])},eT=(0,X.createContext)(eI),ServerConnectionManager=e=>{let{children:t,...s}=e,a=useServerConnection(s);return(0,z.jsx)(eT.Provider,{value:a,children:t})},useServerConnectionContext=()=>(0,X.useContext)(eT);var ek=s(10630);let enableLogging=e=>{let getTimestamp=()=>{let e=new Date;return"".concat(e.getFullYear(),"-").concat(e.getMonth()+1,"-").concat(e.getDate()," ").concat(e.getHours(),":").concat(e.getMinutes(),":").concat(e.getSeconds(),".").concat(e.getMilliseconds())},t=console.log;console.log=function(){for(var s=arguments.length,a=Array(s),n=0;n<s;n++)a[n]=arguments[n];e(["[LOG]",getTimestamp(),...a].join(" ")),t(...a)};let s=console.info;console.info=function(){for(var t=arguments.length,a=Array(t),n=0;n<t;n++)a[n]=arguments[n];e(["[INFO]",getTimestamp(),...a].join(" ")),s(...a)};let a=console.warn;console.warn=function(){for(var t=arguments.length,s=Array(t),n=0;n<t;n++)s[n]=arguments[n];e(["[WARN]",getTimestamp(),...s].join(" ")),a(...s)};let n=console.error;console.error=function(){for(var t=arguments.length,s=Array(t),a=0;a<t;a++)s[a]=arguments[a];e(["[ERROR]",getTimestamp(),...s].join(" ")),n(...s)}};var eR=s(91658),e_=s(47855);let useDiagnostics=function(){var e,t;let s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,{status:a,error:n,state:{messages:{length:r}},props:{serverAddress:o,bridge:i},handshake:l,isChatEnabled:c}=useServerConnectionContext(),{ideTelemetryEnabled:d,...u}=useChatParamsContext(),m=(0,X.useCallback)(async()=>{var e,t,m,p,x;let h=null;try{h=window.location.href}catch(e){h=null}let g=null,f=null;try{let e=o.replace("ws://","http://").replace("/connect/chat","/health"),t=await fetch(e);g=t.status}catch(e){e instanceof Error&&(f=e)}let y=null;s&&(y={name:s.name,message:s.message,stack:null===(p=s.stack)||void 0===p?void 0:p.split("\n"),cause:s.cause});let v={url:h,connection:{status:a,error:{name:null==n?void 0:n.name,message:null==n?void 0:n.message,stack:null==n?void 0:null===(e=n.stack)||void 0===e?void 0:e.split("\n")}},error:y,isChatEnabled:c,handshake:{disabledTelemetry:null==l?void 0:null===(t=l.userStatus)||void 0===t?void 0:t.disableTelemetry,ignoreChatTelemetrySetting:null==l?void 0:null===(m=l.userStatus)||void 0===m?void 0:m.ignoreChatTelemetrySetting},params:{ideTelemetryEnabled:d,...u},data:{numMessages:r},bridge:{bridgeType:null!==(x=null==i?void 0:i.bridgeType)&&void 0!==x?x:"null"},health:{checkStatus:g,error:{name:null==f?void 0:f.name,message:null==f?void 0:f.message}}};return v},[null==i?void 0:i.bridgeType,null==n?void 0:n.message,null==n?void 0:n.name,null==n?void 0:n.stack,s,null==l?void 0:null===(e=l.userStatus)||void 0===e?void 0:e.disableTelemetry,null==l?void 0:null===(t=l.userStatus)||void 0===t?void 0:t.ignoreChatTelemetrySetting,d,c,r,u,o,a]),p=(0,X.useCallback)(async()=>{let e=await m();await (0,eR.copyToClipboard)((0,e_.Z)(e,{indentation:2}))},[m]);return{getDiagnostics:m,copyDebugOutput:p}};var eD=s(65051),eA=s(75816),eP=s.n(eA);let eM=[eE.E.Unavailable,eE.E.DeadlineExceeded,eE.E.Unknown],eL=(0,X.createContext)(null),ChatClientServerContextProvider=e=>{let{children:t,client:s}=e,a=X.useMemo(()=>({}),[]),n=(0,X.useCallback)((e,t)=>{let s=(a[e]||(a[e]=new Set),a[e]);s.add(t)},[a]),r=(0,X.useCallback)((e,t)=>{let s=a[e];null==s||s.delete(t)},[a]);return(0,X.useEffect)(()=>{let e=new AbortController;return startStreamImpl(s,a,e.signal),()=>{e.abort()}},[s,a]),(0,z.jsx)(eL.Provider,{value:{registerHandler:n,unregisterHandler:r},children:t})},useRegisterChatClientRequestHandler=(e,t)=>{let s=(0,X.useContext)(eL);if(!s)throw Error("useRegisterChatClientRequestHandler must be used within a ChatClientServerContextProvider");(0,X.useEffect)(()=>(s.registerHandler(e,t),()=>{s.unregisterHandler(e,t)}),[e,t,s])};async function startStreamImpl(e,t,s){for(;;){try{let r=e.startChatClientRequestStream({},{signal:s});for await(let e of r){var a,n;if(void 0===e.request.case)continue;let s=e.request.case;switch(s){case"addCascadeInput":{let s=e.request.value;null===(a=t.addCascadeInput)||void 0===a||a.forEach(e=>{e(s)});break}case"sendActionToChatPanel":{let s=e.request.value;null===(n=t.sendActionToChatPanel)||void 0===n||n.forEach(e=>{e(s)});break}default:console.error("Unknown request case:",s)}}}catch(e){if(!(e instanceof ej.K))throw e;if(e.code===eE.E.Canceled||e.code===eE.E.Unknown&&"[unknown] canceled"===e.message)return;if(!eM.includes(e.code))throw e;console.error("Error starting chat client server stream:",e)}await new Promise(e=>{setTimeout(e,1e3)})}}let eO=(0,X.createContext)({copyDiagnostics:()=>{throw Error("Not implemented")},capturedError:void 0,clearCapturedError:()=>{throw Error("Not implemented")},getLogs:()=>[]}),DebuggingContextProvider=e=>{let{children:t,active:s=!0}=e,{ideName:a}=useChatParamsContext(),{props:{openGenericUrl:n,lsClient:r,downloadDiagnostics:o}}=useServerConnectionContext(),i=(0,X.useRef)([]),[l,c]=(0,X.useState)(void 0),d=useDiagnostics(l),u=(0,X.useCallback)(e=>{if("setApiKey"!==e.actionType)return;let t=new TextDecoder().decode(e.payload[0]),s=new CustomEvent("apiKeyChanged",{detail:{apiKey:t},bubbles:!0,cancelable:!0});window.dispatchEvent(s)},[]);useRegisterChatClientRequestHandler("sendActionToChatPanel",u),(0,X.useEffect)(()=>{s&&enableLogging(e=>{i.current.length>1e3&&i.current.shift(),i.current.push(e)})},[s]);let m=(0,X.useCallback)(async()=>{let e=await d.getDiagnostics(),t=i.current,s={extensionDiagnostics:e,extensionPanelLogs:t};if(r)try{let{languageServerDiagnostics:e}=await r.getDebugDiagnostics(new ei.Al9);e&&(s.languageServerDiagnostics=e)}catch(e){s.webServerError=e,console.log("[DebuggingContext] Error",e)}if(void 0!==o){o(s);return}let l=JSON.stringify(s,null,2);if("vscode"===a||"windsurf"==a)(0,eD.downloadText)(l,"codeium-debug-logs-".concat(eP()().format("YYYY-MM-DD-HH-mm"),".txt"));else{let e=(0,eD.generateFileBlob)(l);n(e)}},[d,a,n,r,o]);(0,X.useEffect)(()=>{if(!s)return;let errorHandler=e=>{if("ResizeObserver loop completed with undelivered notifications."===e.message){console.log("ResizeObserver loop completed with undelivered notifications.");return}c(e.error)},unhandledRejectionHandler=e=>{c(e.reason)};return window.addEventListener("error",errorHandler),window.addEventListener("unhandledrejection",unhandledRejectionHandler),()=>{window.removeEventListener("error",errorHandler),window.removeEventListener("unhandledrejection",unhandledRejectionHandler)}},[s]);let p=(0,X.useCallback)(()=>{c(void 0)},[]);return s?(0,z.jsx)(eO.Provider,{value:{copyDiagnostics:m,capturedError:l,clearCapturedError:p,getLogs:()=>i.current},children:t}):t},useDebuggingContext=()=>(0,X.useContext)(eO);var eF=s(35564),eB=s(43085),eq=s(79776);let ThemeProvider=e=>{let{children:t,...s}=e,{state:{userSettings:{themePreference:a}}}=useServerConnectionContext(),n=a===et.Bvo.AUTO||a===et.Bvo.UNSPECIFIED,getStyleValue=e=>{switch(a){case et.Bvo.LIGHT:return eB.P[e];case et.Bvo.DARK:return eB.g[e];case et.Bvo.AUTO:default:return"var(".concat(eq.T[e],", ").concat(eB.g[e],")")}};return(0,z.jsxs)("div",{...s,children:[!n&&(0,z.jsx)("style",{children:"body {\n        --codeium-chat-background: ".concat(getStyleValue("chatBackground"),";\n        --codeium-editor-background: ").concat(getStyleValue("editorBackground"),";\n        --codeium-editor-color: ").concat(getStyleValue("editorColor"),";\n        --codeium-text-color: ").concat(getStyleValue("textColor"),";\n        --codeium-link-color: ").concat(getStyleValue("linkColor"),";\n        --codeium-link-hover-color: ").concat(getStyleValue("linkHoverColor"),";\n        --codeium-caption-color: ").concat(getStyleValue("captionColor"),";\n        --codeium-message-block-user-background: ").concat(getStyleValue("messageBlockUserBackground"),";\n        --codeium-message-block-user-color: ").concat(getStyleValue("messageBlockUserColor"),";\n        --codeium-message-block-bot-background: ").concat(getStyleValue("messageBlockBotBackground"),";\n        --codeium-message-block-bot-color: ").concat(getStyleValue("messageBlockBotColor"),";\n        --codeium-input-color: ").concat(getStyleValue("inputColor"),";\n        --codeium-input-placeholder: ").concat(getStyleValue("inputPlaceholder"),";\n        --codeium-input-background: ").concat(getStyleValue("inputBackground"),";\n        --codeium-tooltip-background: ").concat(getStyleValue("tooltipBackground"),";\n        --codeium-tooltip-color: ").concat(getStyleValue("tooltipColor"),";\n        --codeium-active-selection-background: ").concat(getStyleValue("activeSelectionBackground"),";\n        --codeium-active-selection-color: ").concat(getStyleValue("activeSelectionColor"),";\n        --codeium-button-background: ").concat(getStyleValue("buttonBackground"),";\n        --codeium-button-color: ").concat(getStyleValue("buttonColor"),";\n        --codeium-button-secondary-background: ").concat(getStyleValue("buttonSecondaryBackground"),";\n        --codeium-button-secondary-color: ").concat(getStyleValue("buttonSecondaryColor"),";\n        }")}),t]})};var eU=s(58647),eG=s(26394),eQ=s(74290);let getDiffLinePrefix=e=>{switch(e){case eo.Br.INSERT:return"+";case eo.Br.DELETE:return"-";case eo.Br.UNCHANGED:default:return" "}},unifiedDiffToString=e=>{let t=e.lines.map(e=>{let{type:t,text:s}=e;return"".concat(getDiffLinePrefix(t)).concat(s)});return t.join("\n")},getAppliedDiff=(e,t)=>{let s=e.lines.filter(e=>{let{type:s}=e;switch(s){case eo.Br.INSERT:return t;case eo.Br.DELETE:return!t;case eo.Br.UNCHANGED:default:return!0}});return s.map(e=>e.text).join("\n")},countDiffLines=e=>{let t=0,s=0,a=0;for(let n of e.lines)switch(n.type){case eo.Br.INSERT:t++;break;case eo.Br.DELETE:s++;break;case eo.Br.UNCHANGED:a++}return{numInsertions:t,numDeletions:s,numUnchanged:a}},countLinesInLineDiff=(e,t)=>{let s=(0,eQ.Mp)(e,t),a=0,n=0,r=0;for(let e of s){var o;let t=e.added?eo.Br.INSERT:e.removed?eo.Br.DELETE:eo.Br.UNCHANGED,s=null!==(o=e.count)&&void 0!==o?o:e.value.split("\n").length;switch(t){case eo.Br.INSERT:a+=s;break;case eo.Br.DELETE:n+=s;break;case eo.Br.UNCHANGED:r+=s}}return{numInsertions:a,numDeletions:n,numUnchanged:r}};var eJ=s(2144),eW=s(61162);let useContextValue=e=>{let{message:t,feedback:s,isIgnoredInHistory:a=!1,scrollToCutOff:n,showContextWarning:r=!1}=e,{submitFeedback:o}=useServerConnectionContext(),i="intent"!==t.content.case,l=i&&"action"===t.content.case,c=(0,X.useCallback)((e,s)=>{l&&o(t.messageId,e,s)},[l,t.messageId,o]);return{isBot:i,messageID:t.messageId,message:t,feedback:s,allowFeedback:l,onFeedbackSubmission:c,debugPayload:t.toJson(),isIgnoredInHistory:a,scrollToCutOff:n,showContextWarning:r,redact:t.redact}},eH={isBot:!1,messageID:"NA",message:new ee.J,feedback:null,onFeedbackSubmission:()=>"",allowFeedback:!1,debugPayload:{},isIgnoredInHistory:!1,showContextWarning:!1,redact:!1},eV=X.createContext(eH),useChatMessageContext=()=>(0,X.useContext)(eV),ChatMessageProvider=e=>{let t=useContextValue(e);return(0,z.jsx)(eV.Provider,{value:t,children:e.children})};var eY=s(6932),eZ=s(19539),eK=s(28770),ez=s(91721);let CodeBlock=e=>{var t;let{className:s,snippet:a,inProgress:n=!1,disableCopyCode:r=!1,inline:o=!1,hideToolbar:i=!1,customToolbar:l,...c}=e,{insertAtCursorEnabled:d,ideName:u}=useChatParamsContext(),{insertAtCursor:m,state:{isReceivingMessage:p}}=useServerConnectionContext(),{onFeedbackSubmission:x}=useChatMessageContext(),h="jetbrains"===u?{minWidth:"40rem",display:"block"}:{},{redact:g}=useChatMessageContext(),f=/language-([^\s]+)/.exec(s||""),y=null==f?void 0:null===(t=f[1])||void 0===t?void 0:t.replace(/_/g," "),[v,C]=(0,X.useMemo)(()=>{if(a.includes("\n"))return[a,k.TEXT_EDITOR];switch(y){case"zsh":case"powershell":case"bash":case"shell":return[(0,eZ.formatForTerminalCommand)(a),k.TERMINAL];default:return[a,k.TEXT_EDITOR]}},[y,a]),w=(0,X.useMemo)(()=>[{title:"Copy",clickMessage:"Copied!",disabled:p,onClick:()=>{(0,eR.copyToClipboard)(a),x(ee.Cx.FEEDBACK_TYPE_COPIED,a)},hide:r},{title:C===k.TERMINAL?"Insert in Terminal":"Insert",clickMessage:"Inserted!",disabled:n||p,onClick:()=>{m(v,C),x(ee.Cx.FEEDBACK_TYPE_INSERT_AT_CURSOR,a)},hide:!d}],[r,n,m,d,v,C,p,x,a]),b=(0,X.useMemo)(()=>w.map(e=>(0,z.jsx)(ez.F,{...e,children:e.title},e.title)),[w]);if(g&&!o)return(0,z.jsx)("div",{className:"redacted-code-block",children:"/* Code Block Redacted */"});if(o)return(0,z.jsx)("code",{...c,"aria-label":"inline-code-".concat(s),className:"bg-ide-message-block-bot-background px-1 py-0.5 text-ide-message-block-bot-color",children:a});let N=y?(0,z.jsx)("div",{className:(0,eG.classNames)(s,"relative box-border overflow-hidden rounded-[0.25em] border border-gray-700"),"aria-label":"highlighted-code-".concat(s),children:(0,z.jsx)("div",{className:"w-full overflow-x-auto",children:(0,z.jsx)(eY.ErrorBoundary,{title:"Error rendering code block",children:(0,z.jsx)(eJ.Z,{style:eW.YC,language:y,PreTag:"div",customStyle:{margin:0,...h},codeTagProps:{style:{fontSize:"0.813rem"}},children:a})})})}):(0,z.jsx)("div",{className:(0,eG.classNames)(s,"relative box-border overflow-hidden rounded-[0.25em] border border-gray-700"),"aria-label":"highlighted-code-".concat(s),children:(0,z.jsx)("div",{className:"overflow-x-auto bg-editor-content-area p-3",children:(0,z.jsx)("code",{...c,"aria-label":"plain-code-".concat(s),className:(0,eG.classNames)(s,"text-sm"),style:{...h,whiteSpace:"pre-wrap"},children:a})})});return l?(0,z.jsxs)("div",{className:"flex flex-col",children:[l,N]}):i?N:(0,z.jsx)(eK.F,{actions:b,title:y,children:N})};var eX=s(9609),e$=s(73040),e0=s(45234);let InlineCodePointer=e=>{let{children:t,pointer:s}=e,{openFilePointer:a}=useServerConnectionContext(),{openFilePointerEnabled:n}=useChatParamsContext(),r=(0,X.useCallback)(()=>{n&&a(s)},[a,n,s]);return(0,z.jsx)("code",{className:(0,eG.classNames)("break-word rounded bg-ide-message-block-bot-background px-1 py-0.5 font-mono text-[0.8571429em] text-ide-message-block-bot-color underline-offset-2",n?"cursor-pointer underline":"cursor-default"),onClick:r,children:t})};var e1=s(74953);let ChatLink=e=>{var t;let{newTab:s=!1,href:a,...n}=e,{props:{openGenericUrl:r}}=useServerConnectionContext(),o={};return s&&(o.target="_blank",o.rel="noopener noreferrer"),(0,z.jsx)("a",{href:a,onClick:e=>{e.preventDefault(),a&&r(a)},className:null!==(t=n.className)&&void 0!==t?t:"",...o,children:n.children})};var e2=s(82856);let e5=(0,X.memo)(e=>{let{children:t,className:s="",codeBlockClassName:a="",inProgress:n=!1,disableCopyCode:r=!1,renderKnowledgeBaseItemLink:o,customCodeBlockToolbar:i,hideToolbar:l=!1}=e,c=(0,X.useMemo)(()=>{let e=(0,e0.convertCustomTagToDiv)((0,e0.getStreamingMarkdown)((0,e0.getStreamingMarkdown)((0,e0.cleanupMarkdown)(t),e0.THINK_TAG),e0.FUNCTION_RESULTS_TAG),[e0.THINK_TAG,e0.FUNCTION_RESULTS_TAG]);return e},[t]),d=(0,X.useCallback)(e=>e.startsWith("cci:")||e.startsWith("repo:")||e.startsWith("hidden:")||e.startsWith("terminal:")||e.startsWith("kb:")?e:(0,eX.A)(e),[]);return(0,z.jsx)(eY.ErrorBoundary,{title:"Error rendering Markdown",children:(0,z.jsx)(e$.D,{skipHtml:!0,rehypePlugins:[e2.Z],remarkRehypeOptions:{handlers:{link:(e,t)=>{let s={href:t.url};null!==t.title&&void 0!==t.title&&(s.title=t.title);let a={type:"element",tagName:"a",properties:s,children:e.all(t)};return e.patch(t,a),e.applyData(t,a)}}},transformLinkUri:d,className:(0,eG.classNames)("prose prose-sm max-w-none break-words","prose-headings:text-base prose-headings:text-ide-editor-color","prose-p:mb-3 prose-p:block prose-p:leading-normal","prose-code:before:content-none prose-code:after:content-none prose-pre:my-2 prose-pre:bg-transparent prose-pre:p-0","marker:text-inherit prose-ol:list-outside prose-ol:list-decimal prose-ol:leading-normal prose-ul:mt-0 prose-ul:list-outside prose-ul:list-disc prose-li:my-0","prose-strong:text-inherit","prose-a:underline prose-a:hover:text-inherit prose-a:hover:opacity-60",s),components:{blockquote:e=>(0,z.jsx)("blockquote",{className:"bg-transparent font-normal text-[color:var(--codeium-text-color)]",...e}),a:e=>{var t,s,a,n,r,i;if(null===(t=e.href)||void 0===t?void 0:t.startsWith("hidden:"))return(0,z.jsx)(z.Fragment,{});if(null===(s=e.href)||void 0===s?void 0:s.startsWith("cci:")){let t=(0,e1.parseCodeContextItemURI)(e.href);if(t)return(0,z.jsx)(InlineCodePointer,{pointer:new OpenFilePointer({fileUri:(0,e1.getCCIMetadataAbsolutePath)(t).toString(),filePathMigrateMeToUri:(0,e1.getCCIMetadataAbsolutePath)(t).toDisplayString(),startCol:t.startCol,startLine:t.startLine,endCol:t.endCol,endLine:t.endLine}),children:e.children})}else if(null===(a=e.href)||void 0===a?void 0:a.startsWith("repo:")){let t=(0,e1.parseRepoItemUri)(e.href);if(t)return(0,z.jsx)("a",{href:"https://github.com/".concat(t.repoName,"/blob/").concat(t.commit),target:"_blank",className:"cursor-pointer",children:(0,z.jsxs)("code",{className:"break-word px-0.5 font-mono text-sm text-inherit underline-offset-2",children:["@repo:",t.repoName]})})}else if(null===(n=e.href)||void 0===n?void 0:n.startsWith("terminal:"))return(0,z.jsx)("code",{className:"break-word px-0.5 font-mono text-sm text-inherit",children:"@terminal"});else if(null===(r=e.href)||void 0===r?void 0:r.startsWith("kb:"))return null!==(i=null==o?void 0:o(e.href))&&void 0!==i?i:(0,z.jsx)(z.Fragment,{});return(0,z.jsx)(ChatLink,{href:e.href||"",...e})},p:e=>(0,z.jsx)("p",{className:(0,eG.classNames)("!mb-0 mt-0",e.className),...e}),code:e=>{let{inline:t,className:s,children:o,...c}=e,d=String(o).replace(/\n$/,"");return d.trim()?(0,z.jsx)(eY.ErrorBoundary,{title:"Error rendering CodeBlock",children:(0,z.jsx)(CodeBlock,{...c,inProgress:n,disableCopyCode:r,inline:t,snippet:d,className:(0,eG.classNames)(s,a),customToolbar:i,hideToolbar:l})}):null},li:e=>{let{children:t,className:s,ordered:a,checked:n,node:r,...o}=e;return(0,z.jsx)("li",{...o,className:(0,eG.classNames)(s,"[&>p]:inline"),children:t})}},children:c})})});e5.displayName="CustomMarkdown";var e3=s(47106),e4=s.n(e3);let wrapMarkdownCode=(e,t)=>{let s=["```"+(t?getMarkdownLanguage(t):""),e,"```"];return s.join("\n")},getMarkdownLanguage=e=>{switch(e){case et.SQ0.CPP:return"cpp";case et.SQ0.C:return"c";case et.SQ0.CSS:return"css";case et.SQ0.DOCKERFILE:return"dockerfile";case et.SQ0.HASKELL:return"haskell";case et.SQ0.HTML:return"html";case et.SQ0.GO:return"go";case et.SQ0.JAVA:return"java";case et.SQ0.JAVASCRIPT:return"javascript";case et.SQ0.JSON:return"json";case et.SQ0.LATEX:return"latex";case et.SQ0.PHP:return"php";case et.SQ0.PYTHON:return"python";case et.SQ0.RUST:return"rust";case et.SQ0.SCSS:return"scss";case et.SQ0.SQL:return"sql";case et.SQ0.SWIFT:return"swift";case et.SQ0.TSX:return"tsx";case et.SQ0.TYPESCRIPT:return"typescript";case et.SQ0.VUE:return"vue";case et.SQ0.YAML:return"yaml"}return""},e6={[et.P1A.UNSPECIFIED]:0,[et.P1A.HEADER_1]:1,[et.P1A.HEADER_2]:2,[et.P1A.HEADER_3]:3,[et.P1A.HEADER_4]:4,[et.P1A.HEADER_5]:5,[et.P1A.HEADER_6]:6},markdownChunkToString=e=>{if(0===e.headers.length)return e.text;if(1===e.headers.length){if(!e.headers[0])return e.text;let t="#".repeat(e6[e.headers[0].type]);return"".concat(t," ").concat(e.headers[0].text,"\n\n").concat(e.text)}let t=e4()(e.headers.map(e=>e6[e.type]))||0,s=[];switch(e.headers.forEach(e=>{e6[e.type]>=t&&s.push(e)}),s.length){case 0:default:return e.text;case 1:if(!s[0])return e.text;let a="#".repeat(e6[s[0].type]);return"".concat(a," ").concat(s[0].text,"\n\n").concat(e.text)}},DiffBlockViz=e=>{let{id:t,diff:s,hideShowDiffToggle:a}=e,[n,r]=(0,X.useState)(!0),[o,i]=(0,X.useState)(!1),getLineStyle=e=>{let t="text-white";switch(e){case eo.Br.INSERT:t="text-green bg-green/10";break;case eo.Br.DELETE:t="text-red bg-red/10"}return t},l=(0,X.useMemo)(()=>{let e=[],t=[];return s.unifiedDiff&&s.unifiedDiff.lines.forEach((s,a)=>{let{type:n,text:r}=s,o=getLineStyle(n);e.push((0,z.jsx)("span",{className:(0,eG.classNames)(o,"block h-5 w-full select-none pr-1 text-sm"),children:getDiffLinePrefix(n)},"".concat(r,"-").concat(a))),t.push((0,z.jsx)("span",{className:(0,eG.classNames)(o,"block h-5 w-max pr-1 text-sm"),children:r},"".concat(r,"-").concat(a)))}),{gutterNodes:e,lineNodes:t}},[s.unifiedDiff]),c=(0,X.useMemo)(()=>{if(!s.unifiedDiff)return(0,z.jsx)(z.Fragment,{});if(n)return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)("div",{className:"w-4 text-right",children:l.gutterNodes}),(0,z.jsx)("div",{className:"w-full overflow-x-auto",children:(0,z.jsx)("pre",{className:"paragraph-space-after no-scrollbar overflow-x-auto text-sm",children:l.lineNodes})})]});let e=getAppliedDiff(s.unifiedDiff,!0),t=wrapMarkdownCode(e,s.toLanguage);return(0,z.jsx)("div",{className:"w-full",children:(0,z.jsx)(e5,{disableCopyCode:!0,children:t})})},[l.gutterNodes,l.lineNodes,s,n]),d="diff-".concat(t);return(0,z.jsxs)("div",{className:"relative flex flex-row border-[1px] border-gray-700 bg-surface p-2",onMouseEnter:()=>{i(!0)},onMouseLeave:()=>{i(!1)},children:[c,!a&&(0,z.jsxs)("div",{className:(0,eG.classNames)("absolute bottom-2 right-2 flex flex-row items-center justify-center gap-1 rounded bg-gray-100 px-2 py-1 transition-opacity",o?"opacity-100":"opacity-0"),children:[(0,z.jsx)("input",{id:d,name:d,type:"checkbox",className:"h-4 w-4 cursor-pointer rounded border-gray-300 text-green-600 focus:ring-green-600",checked:n,onChange:e=>{r(e.target.checked)}}),(0,z.jsx)("label",{htmlFor:d,className:"text-sm text-black",children:"Show diff"})]})]})};var e8=s(50568);let getCodeBlockPointerLabel=(e,t)=>{let{startLine:s,startCol:a,endLine:n,endCol:r}=t,o=[(0,e8.getFileName)(e.toDisplayString())];return 0!=s&&(o.push(":"),0!=a?o.push("".concat((s+1).toFixed(0),":").concat((a+1).toFixed(0))):o.push((s+1).toFixed(0))),0!=s&&0!=n&&n!=s&&(o.push("-"),0!=r?o.push("".concat((n+1).toFixed(0),":").concat((r+1).toFixed(0))):o.push((n+1).toFixed(0))),o.join("")},getFolderPathFromGitRoot=(e,t)=>{if(void 0===e&&void 0!==t)return t;if(void 0!==e&&void 0===t)return e;if(void 0===e||void 0===t)return"";let s=e.split("/").slice(0,-1).join("/");return t.replace(s,"").substring(1)},getFolderName=e=>{let t=e.split(/[\/\\]/);return t[t.length-1]},ActionEdit=e=>{let{edit:t}=e,{messageID:s,message:{inProgress:a},onFeedbackSubmission:n}=useChatMessageContext(),{applyDiff:r}=useServerConnectionContext(),{diffViewEnabled:o}=useChatParamsContext(),{diff:i}=t,l=GetChatMessageActionEditAbsoluteUri(t),c=(0,X.useCallback)(()=>{i&&(r({messageId:s,filePath:"",diffBlock:i,uri:l.toString()}),n(ee.Cx.FEEDBACK_TYPE_APPLY_DIFF,i.unifiedDiff?unifiedDiffToString(i.unifiedDiff):void 0))},[r,i,l,s,n]),d=(0,X.useCallback)(()=>{if(!i||!i.unifiedDiff)return;let e=getAppliedDiff(i.unifiedDiff,!0);(0,eR.copyToClipboard)(e),n(ee.Cx.FEEDBACK_TYPE_COPIED,e)},[i,n]),u=(0,X.useMemo)(()=>{if(!i||!i.unifiedDiff)return(0,z.jsx)(z.Fragment,{});if(l.toString())return(0,z.jsx)(DiffBlockViz,{id:"diff-".concat(s),diff:i});let e=getAppliedDiff(i.unifiedDiff,!0);return(0,z.jsx)(CodeBlock,{disableCopyCode:!0,inline:!1,snippet:e,hideToolbar:!0,className:"language-".concat(getMarkdownLanguage(i.toLanguage))})},[i,l,s]),m=(0,X.useMemo)(()=>[{title:a?"Loading Diff":l.toString()?"Apply Diff":"New File",clickMessage:"Applied!",onClick:c,hide:!o,disabled:a},{title:"Copy Code",clickMessage:"Copied!",onClick:d}],[o,l,c,d,a]),p=(0,X.useMemo)(()=>m.map(e=>(0,z.jsx)(ez.F,{...e,children:e.title},e.title)),[m]);return i&&i.unifiedDiff?(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)("h5",{children:"Proposed Change"}),t.textPre&&(0,z.jsx)("div",{children:(0,z.jsx)(e5,{className:"text-[color:var(--codeium-text-color)] prose-a:text-[color:var(--codeium-link-color)]",children:t.textPre})}),l.toString()?(0,z.jsxs)("p",{className:"my-1",children:[i.startLine==i.endLine?"Inserting at ":"Replacing code at ",(0,z.jsx)(InlineCodePointer,{pointer:new OpenFilePointer({fileUri:l.toString(),filePathMigrateMeToUri:l.toDisplayString(),startLine:i.startLine,endLine:i.startLine!=i.endLine?i.endLine:void 0}),children:getCodeBlockPointerLabel(l,new ee.Pl({startLine:i.startLine,endLine:i.endLine}))})]}):(0,z.jsx)("p",{className:"my-1",children:"Create new file with this code."}),(0,z.jsx)(eK.F,{actions:p,title:"Proposed Change",children:u}),t.textPost&&(0,z.jsx)("div",{className:"",children:(0,z.jsx)(e5,{className:"text-[color:var(--codeium-text-color)] prose-a:text-[color:var(--codeium-link-color)]",children:t.textPost})})]}):(0,z.jsx)("p",{children:"No changes proposed."})};var e9=s(69123),e7=s(50576),te=s(86844);let KnowledgeBaseCitation=e=>{let{knowledgeBaseItem:t,index:s}=e,a=t.knowledgeBaseItem;if(!a)return(0,z.jsx)(z.Fragment,{});let n=a.documentId;return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)("a",{href:a.url,className:"not-prose align-text-center ml-0.5 inline-flex h-4 w-4 cursor-pointer select-none items-center justify-center rounded-full bg-ide-tooltip-background align-middle text-xs font-normal text-ide-tooltip-color opacity-70 transition duration-100 hover:opacity-100",target:"_blank",rel:"noopener noreferrer","data-tooltip-id":"tooltip-".concat(n),children:s}),(0,z.jsx)(e7.u,{className:"max-w-[350px] !bg-ide-editor-background !p-2 !py-1 !text-ide-tooltip-color",border:"1px solid var(--codeium-chat-background-color, rgba(255, 255, 255, 0.1))",id:"tooltip-".concat(n),opacity:1,children:(0,z.jsxs)("div",{className:"flex items-center gap-1",children:[(0,z.jsx)(e9.p,{connectorType:te.Eq[t.documentSourceName],className:"h-3 w-3 flex-none"}),(0,z.jsx)("span",{children:a.title})]})})]})},ActionGeneric=e=>{let{generic:t,knowledgeBaseItems:s=[]}=e;return(0,z.jsx)(e5,{className:"text-[color:var(--codeium-text-color)] prose-a:text-[color:var(--codeium-link-color)]",renderKnowledgeBaseItemLink:e=>{let t=parseInt(e.slice(5),10);if(Number.isNaN(t))return(0,z.jsx)(z.Fragment,{});let a=s[t-1];return a?(0,z.jsx)(KnowledgeBaseCitation,{knowledgeBaseItem:a,index:t}):(0,z.jsx)(z.Fragment,{})},children:t.displayText?t.displayText:t.text})};var tt=s(90979);let ts=null,getJSConfetti=()=>(ts||(ts=new tt.Z),ts),addConfetti=async()=>{await getJSConfetti().addConfetti()};var ta=s(37955),tn=s(19432),tr=s(74029),to=s(17205),ti=s(30699),tl=s(48283),tc=s(56119);let td="h-4 w-4 opacity-60 hover:opacity-100",ActionBarActions=()=>{let[e,t]=(0,X.useState)(!1),{rerunWithoutContext:s,rerunWithContext:a}=useServerConnectionContext(),{message:n,feedback:r,onFeedbackSubmission:o}=useChatMessageContext(),i="action"==n.content.case?n.content.value.contextItems.length:0,l="action"===n.content.case&&"search"!==n.content.value.action.case&&i>0,c=(0,X.useCallback)(e=>{r!==e&&o(e),e===ee.Cx.FEEDBACK_TYPE_ACCEPT&&addConfetti()},[o,r]),d=(0,X.useCallback)(()=>{l?s(n.messageId):a(n.messageId)},[n.messageId,s,a,l]),getMessageText=()=>{if("action"!==n.content.case)return null;let e=n.content.value;if("generic"!==e.action.case)return null;let t=e.action.value;return t.text},copyMessageToClipboard=()=>{let e=getMessageText();e&&(0,ti.copyToClipboard)(e).then(()=>{t(!0),setTimeout(()=>{t(!1)},2e3)}).catch(e=>{console.error("Failed to copy text: ",e)})};return(0,z.jsxs)("div",{className:"flex items-center",children:[l?(0,z.jsxs)("button",{className:"regenerate-message-no-context-button mr-2",onClick:e=>{e.stopPropagation(),d()},children:[(0,z.jsx)(tc.Z,{className:td,stroke:"currentColor",strokeWidth:"1.5"}),(0,z.jsx)(e7.u,{anchorSelect:".regenerate-message-no-context-button",positionStrategy:"fixed",border:"1px solid var(--codeium-tooltip-color, rgb(255, 255, 255))",content:"Regenerate message without context",children:"Regenerate message without context"})]}):(0,z.jsxs)("button",{className:"regenerate-message-with-context-button mr-2",onClick:e=>{e.stopPropagation(),d()},children:[(0,z.jsx)(tl.Z,{className:td,stroke:"currentColor",strokeWidth:"1.5"}),(0,z.jsx)(e7.u,{anchorSelect:".regenerate-message-with-context-button",positionStrategy:"fixed",border:"1px solid var(--codeium-tooltip-color, rgb(255, 255, 255))",children:"Regenerate message with context"})]}),(0,z.jsxs)("button",{className:"copy-message-button mr-2",onClick:e=>{e.stopPropagation(),copyMessageToClipboard()},children:[e?(0,z.jsx)(to.Z,{className:td,stroke:"currentColor",strokeWidth:"1.5"}):(0,z.jsx)(tr.Z,{className:td,stroke:"currentColor",strokeWidth:"1.5"}),(0,z.jsx)(e7.u,{anchorSelect:".copy-message-button",positionStrategy:"fixed",border:"1px solid var(--codeium-tooltip-color, rgb(255, 255, 255))",children:"Copy message"})]}),(0,z.jsxs)("button",{onClick:e=>{e.stopPropagation(),c(ee.Cx.FEEDBACK_TYPE_ACCEPT)},className:"message-feedback-thumbs-up mr-2",children:[(0,z.jsx)(ta.ThumbsUpIcon,{className:(0,eG.classNames)(td,r===ee.Cx.FEEDBACK_TYPE_ACCEPT?"fill-green":"")}),(0,z.jsx)(e7.u,{anchorSelect:".message-feedback-thumbs-up",positionStrategy:"fixed",border:"1px solid var(--codeium-tooltip-color, rgb(255, 255, 255))",children:"Good response"})]}),(0,z.jsxs)("button",{onClick:e=>{e.stopPropagation(),c(ee.Cx.FEEDBACK_TYPE_REJECT)},className:"message-feedback-thumbs-down mr-2",children:[(0,z.jsx)(tn.ThumbsDownIcon,{className:(0,eG.classNames)(td,r===ee.Cx.FEEDBACK_TYPE_REJECT?"fill-red":"")}),(0,z.jsx)(e7.u,{anchorSelect:".message-feedback-thumbs-down",positionStrategy:"fixed",border:"1px solid var(--codeium-tooltip-color, rgb(255, 255, 255))",children:"Bad response"})]})]})},PillButton=e=>{let{children:t,className:s,onClick:a,...n}=e;return(0,z.jsx)("span",{className:(0,eG.classNames)("inline-flex cursor-pointer items-center rounded-md bg-gray-100/10 px-1 py-0.5 font-mono text-xs text-inherit ring-1 ring-inset ring-gray-500/20 transition-colors duration-100 hover:bg-gray-100/40",s),onClick:a,...n,children:(0,z.jsx)("span",{className:"overflow-hidden text-ellipsis whitespace-nowrap",children:t})})},ContextItemPillButton=e=>{let{className:t,contextItem:s}=e,{openFilePointer:a,props:{openGenericUrl:n}}=useServerConnectionContext(),{nodePrefix:r,nodeName:o}=getContextItemLabel(s);return(0,z.jsxs)(PillButton,{className:t,onClick:()=>{if(s.repoInfo&&""===(0,e1.getCCIAbsolutePath)(s).toString()){s.workspacePaths.length>0&&n((0,e1.getRemoteCodeContextItemWebUrl)(s));return}a(new OpenFilePointer({fileUri:(0,e1.getCCIAbsolutePath)(s).toString(),filePathMigrateMeToUri:(0,e1.getCCIAbsolutePath)(s).toDisplayString(),startLine:s.startLine,endLine:s.endLine}))},children:[(0,z.jsxs)("span",{className:"opacity-70",children:[r,o?":":""]}),o]},"".concat((0,e1.getCCIAbsolutePath)(s).toString(),"-").concat(s.nodeName,"-").concat(s.startLine,"-").concat(s.endLine))},KnowledgeBaseItemPillButton=e=>{let{className:t,knowledgeBaseItem:s,index:a}=e,{props:{openGenericUrl:n}}=useServerConnectionContext(),{knowledgeBaseItem:r}=s;if(!r)return null;let o=r.title;return(0,z.jsxs)("span",{className:(0,eG.classNames)("mb-1 inline-flex w-full cursor-pointer flex-row items-center gap-2 rounded-full text-xs text-inherit opacity-70 saturate-0 transition-[filter] transition-[opacity] duration-100 hover:opacity-100 hover:saturate-100",t),onClick:()=>{n(r.url)},children:[a&&(0,z.jsx)("div",{className:"font-medium",children:a}),(0,z.jsx)(e9.p,{connectorType:te.Eq[s.documentSourceName],className:"h-3 w-3 flex-none"}),(0,z.jsx)("div",{className:"overflow-hidden truncate",children:o})]},"".concat(r.url,"-").concat(o))};var tu=s(9663);let ActionBarViewButton=e=>{let{isSelected:t,onClick:s,Icon:a,label:n,tooltipText:r}=e,o=(0,X.useRef)("action-bar-view-".concat((0,el.getNonce)()));return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsxs)("button",{id:o.current,type:"button",className:(0,eG.classNames)("flex flex-row items-center justify-center gap-1 rounded px-2 py-1 text-sm",t?"bg-ide-active-selection-background text-ide-active-selection-color opacity-100":"opacity-60 hover:opacity-100"),onClick:()=>{s()},children:[(0,z.jsx)(a,{className:"h-4 w-4"}),n&&(0,z.jsx)("span",{children:n})]}),r&&(0,z.jsx)(e7.u,{anchorSelect:"#".concat(o.current),positionStrategy:"fixed",border:"1px solid var(--codeium-tooltip-color, rgb(255, 255, 255))",children:r})]})};var tm=s(25156),tp=s(75463);let InteractiveBreakdown=e=>{let{data:t,format:s}=e,[a,n]=(0,X.useState)(null),[r,o]=(0,X.useState)(null),i=(0,X.useRef)((0,el.getNonce)()).current,l=t.reduce((e,t)=>e+t.value,0),c=t.map((e,t)=>({...e,id:"interactive-breakdown-".concat(t,"-").concat(i),paddedValue:Math.max(e.value,.025*l)})),d=c.reduce((e,t)=>e+t.value,0),u=null!=a?a:r;return(0,z.jsxs)("div",{children:[(0,z.jsx)("div",{className:"mb-3 flex h-2 w-full flex-row items-center justify-center overflow-clip rounded-full xs:mb-3",onMouseLeave:()=>{o(null)},children:c.map((e,t)=>{let a="".concat(e.id,"-chart"),r="opacity-40";return null===u?r="opacity-60":u===t&&(r="opacity-100"),(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)("div",{id:a,style:{backgroundColor:e.color,width:"".concat(e.paddedValue/d*100,"%")},className:(0,eG.classNames)("h-full cursor-pointer",r),onMouseOver:()=>{o(t)},onClick:()=>{n(e=>e===t?null:t)}},e.id),(0,z.jsxs)(e7.u,{anchorSelect:"#".concat(a),positionStrategy:"fixed",border:"1px solid var(--codeium-tooltip-color, rgb(255, 255, 255))",children:[e.label," (",s?s(e.value):e.value,")"]})]})})}),(0,z.jsx)("div",{className:"px-2 xs:px-4",onMouseLeave:()=>{o(null)},children:c.map((e,t)=>{let a="".concat(e.id,"-details");return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)("div",{className:(0,eG.classNames)("cursor-pointer",null!==u&&u!==t?"opacity-60":"opacity-100"),onMouseOver:()=>{o(t)},onClick:()=>{n(e=>e===t?null:t)},children:(0,z.jsxs)("span",{className:"flex flex-row items-center justify-between",children:[(0,z.jsxs)("div",{className:"flex flex-row items-center justify-start gap-1",children:[(0,z.jsxs)("p",{className:"text-sm",children:[t+1,". ",e.label]}),e.details&&(0,z.jsx)(tp.InfoIcon,{id:a,fill:"currentColor",className:"ml-1 h-3.5 w-3.5"})]}),(0,z.jsx)("p",{className:"text-sm",children:s?s(e.value):e.value})]})},e.label),(0,z.jsx)(e7.u,{anchorSelect:"#".concat(a),positionStrategy:"fixed",border:"1px solid var(--codeium-tooltip-color, rgb(255, 255, 255))",className:"win-w-[200px] w-max max-w-[90vw]",children:e.details})]})})})]})};var tx=s(79689);let ChatWithCodebaseButton=e=>{let{className:t,...s}=e,a=(0,tx.useIsMac)();return(0,z.jsxs)("button",{className:(0,eG.classNames)("text-ide-chat-color cursor-pointer cursor-pointer whitespace-nowrap rounded py-0.5 text-xs opacity-90 hover:opacity-100 disabled:cursor-not-allowed disabled:opacity-50",t),suppressHydrationWarning:!0,...s,children:[a?"":"Ctrl + "," "," ",(0,z.jsx)("span",{className:"ml-1 hidden overflow-hidden xs:inline",children:"Chat With Codebase"}),(0,z.jsx)("span",{className:"ml-1 inline xs:hidden",children:"Codebase"})]})},th="https://codeium.com/enterprise?referrer=extension_gpt4_quota";var tg=s(54449),tf=s(22419),ty=s(95224);(l=D||(D={})).STATS="Message Stats",l.CONTEXT="Context Items";let tv={"Message Stats":(0,z.jsx)(()=>{var e;let{message:t}=useChatMessageContext(),{hasEnterpriseExtension:s,hasDevExtension:a}=useChatParamsContext(),{handshake:n}=useServerConnectionContext(),r=(null==n?void 0:null===(e=n.userStatus)||void 0===e?void 0:e.teamStatus)===et.ngL.APPROVED;if("action"!==t.content.case)return(0,z.jsx)(z.Fragment,{});let{numTokens:o,generationStats:i,contextItems:l}=t.content.value,formatMilliseconds=e=>{if(!e)return"N/A";let t=Number(e)/1e3;return t<.01?"<0.01s":"".concat(t.toFixed(2),"s")},c=Number((null==i?void 0:i.shouldGetLocalContextForChatLatencyMs)||0),d=Number((null==i?void 0:i.computeChangeEventsLatencyMs)||0),u=(null==i?void 0:i.startTimestamp)&&i.endTimestamp?eP().duration(eP()(i.endTimestamp.toDate()).diff(i.startTimestamp.toDate(),"milliseconds"),"milliseconds"):null;return(0,z.jsxs)("div",{className:"mt-2",children:[(0,z.jsx)(InteractiveBreakdown,{data:[{label:(null==i?void 0:i.shouldGetLocalContextForChat)?"Determine codebase context is relevant":"Determine codebase context not needed",color:"rgba(187, 132, 204, 1)",value:Math.max(c,1),details:(0,z.jsxs)("div",{className:"space-y-2",children:[(0,z.jsxs)("p",{children:["Based on your query, Codeium determined"," ",(null==i?void 0:i.shouldGetLocalContextForChat)?"codebase context is relevant to your query.":(0,z.jsxs)(z.Fragment,{children:["your query did not require codebase context. You can force include context by using the ",(0,z.jsx)(tl.Z,{className:"inline h-4 w-4"})," button."]})]}),(0,z.jsxs)("p",{children:[(0,z.jsx)("b",{children:"Pro tip"}),": You can force include context by using ",(0,z.jsx)(ChatWithCodebaseButton,{})," ","when sending a message."]})]})},{label:"Prepare index",color:"rgba(202, 180, 62, 1)",value:d},{label:"Retrieve context",color:"rgba(106, 159, 203, 1)",value:Number((null==i?void 0:i.refreshContextLatencyMs)||0)-c-d,details:'Codeium assembles context from your recently used files, active directories, pinned context, and more. It also searches over your indexed codebase(s) to find relevant code snippets if it is considered relevant. You can configure this in the "Context" tab.'},{label:l.length>0?"Construct prompt with ".concat(l.length," context items"):"Prompt construction",color:"rgba(232, 151, 95, 1)",value:Number((null==i?void 0:i.contextToChatPromptLatencyMs)||0),details:void 0},{label:"Stream ".concat(o," token response"),color:"rgba(122, 174, 102, 1)",value:Number((null==i?void 0:i.responseStreamLatencyMs)||0),details:"Codeium's models streamed back ".concat(o," tokens for its response.")}].filter(e=>e.value>0),format:formatMilliseconds}),(0,z.jsx)("div",{className:"mt-4 px-2",children:(0,z.jsxs)("div",{className:"grid grid-cols-1 gap-1 xs:grid-cols-2",children:[(null==i?void 0:i.activeDocumentAbsolutePath)&&(0,z.jsxs)("p",{className:"text-sm leading-loose",children:[(0,z.jsx)("span",{className:"block sm:mr-1 sm:inline-block",children:"Active File:"}),(0,z.jsx)(ContextItemPillButton,{contextItem:(0,e1.createCCIFromAbsolutePath)(i.activeDocumentAbsolutePath)})]}),(null==i?void 0:i.lastActiveCodeContextItem)&&(0,z.jsxs)("p",{className:"text-sm leading-loose",children:[(0,z.jsx)("span",{className:"block sm:mr-1 sm:inline-block",children:"Last Edit:"}),(0,z.jsx)(ContextItemPillButton,{contextItem:i.lastActiveCodeContextItem})]}),(0,z.jsxs)("p",{className:"text-sm",children:["Input Tokens: ",Number((null==i?void 0:i.numInputTokens)||0),(0,z.jsx)(tp.InfoIcon,{id:"".concat(t.messageId,"-input-tokens"),fill:"currentColor",className:"ml-1 inline h-4 w-4"}),(0,z.jsxs)(e7.u,{anchorSelect:"#".concat(t.messageId,"-input-tokens"),clickable:!0,positionStrategy:"fixed",className:"win-w-[200px] w-max max-w-[70vw] bg-ide-tooltip-background text-ide-tooltip-color",opacity:"1",border:"1px solid var(--codeium-tooltip-color, rgb(255, 255, 255))",children:["Input tokens are the number of tokens used in the prompt. The more tokens, the more context is provided to the model."," ",!r&&!s&&(0,z.jsxs)("p",{className:"mt-1 text-sm",children:["Upgrade to"," ",(0,z.jsxs)(ChatLink,{className:"cursor-pointer underline",href:th,children:["Teams",(0,z.jsx)(tg.LinkExternalIcon,{className:"ml-1 inline h-3.5 w-3.5"})]})," ","to unlock 4x context."]})]})]}),(0,z.jsxs)("p",{className:"text-sm",children:["Output Tokens: ",o]}),(0,z.jsxs)("p",{className:"text-sm",children:["Codebase Index: ",(null==i?void 0:i.numIndexedFiles.valueOf().toLocaleString())||0," files (",(null==i?void 0:i.numIndexedCodeContextItems.valueOf().toLocaleString())||0," items)"]}),u&&(0,z.jsxs)("p",{className:"text-sm",children:["Request Duration: ",formatMilliseconds(u.asMilliseconds())]}),a&&(null==i?void 0:i.model)!==void 0&&(0,z.jsxs)("p",{className:"text-sm",children:["Model: ",(0,ec.enumToString)(i.model,et.Hnr)]}),(null==i?void 0:i.startTimestamp)&&(0,z.jsxs)("p",{className:"col-span-full text-sm sm:col-span-1",children:["Sent at"," ",eP()(i.startTimestamp.toDate()).format("MMMM Do YYYY, h:mm:ss a")]})]})})]})},{}),"Context Items":(0,z.jsx)(()=>{let{message:e}=useChatMessageContext(),t=(0,X.useMemo)(()=>{if("action"!==e.content.case)return[];let{contextItems:t}=e.content.value;return t.map(e=>(0,z.jsx)(ContextItemPillButton,{contextItem:e},"".concat((0,e1.getCCIAbsolutePath)(e).toString(),"-").concat(e.nodeName,"-").concat(e.startLine,"-").concat(e.endLine)))},[e.content.case,e.content.value]),s=(0,X.useMemo)(()=>{if("action"!==e.content.case)return[];let{knowledgeBaseItems:t}=e.content.value;return t.map(e=>{var t;return(0,z.jsx)(KnowledgeBaseItemPillButton,{knowledgeBaseItem:e},"".concat(e.documentSourceName,"-").concat(null===(t=e.knowledgeBaseItem)||void 0===t?void 0:t.url))})},[e.content.case,e.content.value]);return(0,z.jsxs)("div",{className:"flex flex-col gap-1",children:[t.length>0?(0,z.jsx)("div",{className:"flex flex-row flex-wrap gap-1",children:t}):null,s.length>0?(0,z.jsx)("div",{className:"flex flex-row flex-wrap gap-1",children:s}):null]})},{})},getContextItemLabel=e=>{let t=e.nodeName.length>20?"".concat(e.nodeName.slice(0,20),"..."):e.nodeName,s="";if(e.repoInfo){let t=e.repoInfo.repoName.split("/");s="(".concat(t[t.length-1],")"),e.workspacePaths.length>0&&(s="".concat(s," ").concat((0,e8.getFileName)((0,ty.getWorkspacePathRelativePath)(e.workspacePaths[0]))))}else s=(0,e8.getFileName)((0,e1.getCCIAbsolutePath)(e).toDisplayString());return{nodePrefix:s,nodeName:t}},ActionBar=()=>{let[e,t]=(0,X.useState)(null),{message:s}=useChatMessageContext();if("action"!==s.content.case)return(0,z.jsx)(z.Fragment,{});let a=s.content.value.contextItems.length||0,n=s.content.value.knowledgeBaseItems.length||0,r=a+n,o="search"!==s.content.value.action.case&&r>0;return(0,z.jsxs)("div",{children:[(0,z.jsxs)("div",{className:"flex flex-grow items-center justify-between",children:[(0,z.jsx)(ActionBarActions,{}),(0,z.jsxs)("div",{className:"flex flex-row items-center justify-end gap-1",children:[s.content.value.generationStats&&(0,z.jsx)(ActionBarViewButton,{isSelected:"Message Stats"===e,onClick:()=>{t(e=>"Message Stats"===e?null:"Message Stats")},Icon:tm.ChartBarIcon,tooltipText:"Stats"}),o&&(0,z.jsx)(ActionBarViewButton,{isSelected:"Context Items"===e,onClick:()=>{t(e=>"Context Items"===e?null:"Context Items")},Icon:tu.Z,label:"".concat(r," Sources")})]})]}),null!==e&&(0,z.jsxs)("div",{className:"mt-3",children:[(0,z.jsxs)("div",{className:"mb-1 flex flex-row items-center justify-between",children:[(0,z.jsx)("p",{className:"text-sm",children:e}),(0,z.jsx)("button",{type:"button",onClick:()=>{t(null)},children:(0,z.jsx)(tf.XIcon,{className:"h-4 w-4 fill-current opacity-60 hover:opacity-100"})})]}),tv[e]]})]})};var tC=s(70493),tw=s(12266);let isTeamsUser=e=>null!=e&&!!e.teamId&&e.teamStatus===et.ngL.APPROVED,MessageBlockContainer=e=>{let{children:t}=e,{messageID:s,message:a,isBot:n,debugPayload:r,isIgnoredInHistory:o,scrollToCutOff:i,showContextWarning:l}=useChatMessageContext(),{handshake:c,newConversation:d}=useServerConnectionContext(),{hasDevExtension:u,hasEnterpriseExtension:m}=useChatParamsContext(),p=(0,X.useMemo)(()=>{var e;if(!(null==c?void 0:null===(e=c.userStatus)||void 0===e?void 0:e.name))return"Me";let t=c.userStatus.name.split(" ");try{switch(t.length){case 0:return"Me";case 1:return t[0].charAt(0);default:return"".concat(t[0].charAt(0)).concat(t[t.length-1].charAt(0))}}catch(e){return"Me"}},[c]),x=(0,X.useCallback)(()=>{u&&console.log("[".concat(s,"]"),r)},[s,r,u]),h=(0,X.useMemo)(()=>{let{timestamp:e}=a;if(!e)return;let t=eP()(e.toDate());if(t.isValid())return t.format("h:mm a, MMM D, YYYY")},[a]),g=(0,z.jsx)("div",{className:(0,eG.classNames)("flex h-6 min-h-[1.5rem] w-6 min-w-[1.5rem] grow-0 flex-row items-center justify-center overflow-hidden rounded-full bg-clip-content",n?"bg-ide-message-block-bot-background text-ide-message-block-bot-color":"bg-ide-message-block-user-background text-ide-message-block-user-color"),"aria-label":"ID: ".concat(s),onClick:x,children:n?(0,z.jsx)(tC.CodeiumLogo,{className:"h-full w-full"}):(0,z.jsx)("p",{className:"m-0 flex w-full flex-row items-center justify-center text-center text-xs",children:p})}),f=null;if(l){let e=isTeamsUser(null==c?void 0:c.userStatus);f=e||m?(0,z.jsxs)("p",{children:["Your"," ",(0,z.jsx)("a",{className:"cursor-pointer underline",onClick:()=>null==i?void 0:i(),children:"chat history"})," ","is being truncated because the token limit has been reached."," ",(0,z.jsx)("a",{className:"cursor-pointer underline",onClick:()=>{d()},children:"Start a new conversation"})]}):(0,z.jsxs)("p",{children:["Your"," ",(0,z.jsx)("a",{className:"cursor-pointer underline",onClick:()=>null==i?void 0:i(),children:"chat history"})," ","is being truncated."," ",(0,z.jsx)("a",{className:"cursor-pointer underline",onClick:()=>{d()},children:"Start a new conversation"}),(0,z.jsxs)(z.Fragment,{children:[" ","or"," ",(0,z.jsx)(ChatLink,{className:"cursor-pointer underline",href:"https://codeium.com/pricing",children:"upgrade to Codeium Teams"})]})," ","for longer context."]})}return(0,z.jsx)("div",{className:(0,eG.classNames)("mt-3 flex w-full items-end",n?"flex-row":"flex-row-reverse",o?"opacity-50":"fade-in"),id:s,"data-message-type":a.content.case,"data-message-id":s,children:(0,z.jsxs)("div",{className:"min-w-0 grow px-2 py-4",children:[(0,z.jsxs)("div",{className:"mb-2 flex flex-row items-center justify-between",children:[(0,z.jsxs)("div",{className:"flex flex-row items-center",children:[g,(0,z.jsx)("span",{className:"ml-1 text-sm",children:n?"Codeium":"You"})]}),(0,z.jsx)("span",{className:"text-xs opacity-50",children:h})]}),t,(0,z.jsx)("div",{className:(0,eG.classNames)("mt-2 flex justify-between",n?"flex-row":"flex-row-reverse"),children:(0,z.jsx)("div",{className:"flex flex-row items-center justify-center space-x-1 text-inherit",children:l&&(0,z.jsxs)("div",{className:"inline-block",children:[(0,z.jsx)(tw.ExclamationTriangleIcon,{id:"".concat(s,"-context-warn-tooltip"),className:"h-4 w-4 fill-ide-caption-color"}),(0,z.jsx)(e7.u,{anchorSelect:"#".concat(s,"-context-warn-tooltip"),clickable:!0,positionStrategy:"fixed",className:"max-w-[350px] bg-ide-tooltip-background text-ide-tooltip-color",border:"1px solid var(--codeium-tooltip-color, rgb(255, 255, 255))",children:f})]})})})]})})};var tb=s(39391);let ActionSearch=e=>{let{searchItems:t}=e,{props:{openGenericUrl:s},openFilePointer:a}=useServerConnectionContext();return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)("p",{className:"pb-3",children:"Here are some results I found:"}),(0,z.jsx)("div",{className:"action-search-container space-y-3",children:t.map(e=>{var t;let n=(0,e1.getCCIAbsolutePath)(e);return(0,z.jsx)("div",{className:"search-item border-2 border-gray-800 p-3",children:(0,z.jsxs)("span",{className:"cursor-pointer break-words font-mono text-xs",onClick:()=>{if(e.repoInfo&&""===n.toString()){e.workspacePaths.length>0&&s((0,e1.getRemoteCodeContextItemWebUrl)(e));return}a(new OpenFilePointer({fileUri:n.toString(),filePathMigrateMeToUri:n.toDisplayString(),startLine:e.startLine,endLine:e.endLine}))},children:[(0,z.jsx)("p",{children:n.toDisplayString()}),(0,z.jsx)(tb.CodeSnippet,{className:"text-xs",children:null===(t=e.snippetByType.CONTEXT_SNIPPET_TYPE_RAW_SOURCE)||void 0===t?void 0:t.snippet})]})},"".concat(n.toString(),"-").concat(e.nodeName,"-").concat(e.startLine,"-").concat(e.endLine))})})]})},ActionMessageBlock=()=>{let{message:e}=useChatMessageContext(),t=(0,X.useMemo)(()=>{if("action"!==e.content.case)return(0,z.jsx)(z.Fragment,{});let t=e.content.value,s=t.knowledgeBaseItems;switch(t.action.case){case"generic":return(0,z.jsx)(ActionGeneric,{generic:t.action.value,knowledgeBaseItems:s});case"edit":return(0,z.jsx)(ActionEdit,{edit:t.action.value});case"search":{let{contextItems:t}=e.content.value;return(0,z.jsx)(ActionSearch,{searchItems:t})}default:return(0,z.jsx)("p",{className:"whitespace-pre-wrap",children:JSON.stringify(t.action)})}},[e]);return"action"!==e.content.case?(0,z.jsx)(z.Fragment,{}):(0,z.jsxs)(MessageBlockContainer,{children:[t,(0,z.jsx)("div",{className:"mb-2 mt-4"}),(0,z.jsx)(ActionBar,{})]})};var tN=s(18310);let ErrorMessageBlock=()=>{var e,t;let{state:{messages:s},handshake:a,retryLastMessage:n}=useServerConnectionContext(),{message:r}=useChatMessageContext(),{hasEnterpriseExtension:o}=useChatParamsContext(),i=(null==a?void 0:null===(e=a.userStatus)||void 0===e?void 0:e.teamStatus)===et.ngL.APPROVED;if("error"!==r.content.case)return(0,z.jsx)(z.Fragment,{});let l=r.content.value;if(!i&&l.text.includes("exceeded GPT-4 quota"))return(0,z.jsxs)(MessageBlockContainer,{children:[(0,z.jsxs)("p",{children:["Error: ",l.text,". You can switch back to the Base Model or upgrade to"," ",(0,z.jsxs)(ChatLink,{className:"inline-flex flex-row items-center justify-center text-ide-link-color hover:text-ide-link-hover-color",href:th,children:["Codeium Teams",(0,z.jsx)(tg.LinkExternalIcon,{className:"ml-1 h-3.5 w-3.5"})]}),"."]}),!o&&(0,z.jsxs)("p",{className:"mt-3",children:["If you have any other questions, our team is available on"," ",(0,z.jsx)(ChatLink,{href:"https://codeium.com/support",newTab:!0,className:"text-ide-link-color hover:text-ide-link-hover-color",children:"Support"}),"."]})]});if(l.text.includes("last user message is too long"))return o||i?(0,z.jsx)(MessageBlockContainer,{children:(0,z.jsx)("p",{children:"I'm sorry, but your last message was too long. Try sending a shorter message."})}):(0,z.jsx)(MessageBlockContainer,{children:(0,z.jsxs)("p",{children:["I'm sorry, but your last message was too long. Try sending a shorter message or upgrade to"," ",(0,z.jsxs)(ChatLink,{className:"cursor-pointer underline",href:th,children:["Teams",(0,z.jsx)(tg.LinkExternalIcon,{className:"ml-1 inline h-3.5 w-3.5"})]})," ","to unlock 4x the context length limit."]})});let c=s[s.length-1],d=(null==c?void 0:null===(t=c.message)||void 0===t?void 0:t.messageId)===r.messageId&&void 0!==c.message.request;return(0,z.jsxs)(MessageBlockContainer,{children:[(0,z.jsx)("p",{children:"I'm sorry, but something went wrong. Here's the error message:"}),(0,z.jsx)("div",{className:"my-2",children:(0,z.jsx)("code",{className:"paragraph-space-after w-full",children:l.text})}),(0,z.jsxs)("p",{children:["We're working hard to improve the quality of your experience. Please try again later."," ",!o&&(0,z.jsxs)(z.Fragment,{children:["If the issue persists, our team is available on"," ",(0,z.jsx)(ChatLink,{href:"https://codeium.com/support",newTab:!0,className:"text-ide-link-color hover:text-ide-link-hover-color",children:"Support"}),"."]})]}),d&&(0,z.jsx)("div",{className:"mt-3 flex items-center justify-center",children:(0,z.jsxs)("button",{className:"hover:border-link-hover-col flex items-center justify-center gap-2 rounded border border-gray-500/20 px-2 py-1 hover:bg-gray-500/10",onClick:()=>{n()},children:[(0,z.jsx)(tN.Z,{className:"h-3 w-3 stroke-ide-text-color"}),(0,z.jsx)("span",{className:"text-sm",children:"Retry"})]})})]})};var tS=s(74904),tj=s(81906),tE=s(67761),tI=s(94881),tT=s(4525),tk=s(76016),tR=s(11390),t_=s(72138);let tD=/(https?:\/\/(?:www\.|(?!www))[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s,]{2,}|www\.[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s,]{2,}|https?:\/\/(?:www\.|(?!www))[a-zA-Z0-9]+\.[^\s,]{2,}|www\.[a-zA-Z0-9]+\.[^\s,]{2,})/,tA=[e=>{let t=tD.exec(e);return null===t?null:{index:t.index,length:t[0].length,text:t[0],url:t[0],attributes:{rel:"noopener noreferrer",target:"_blank",href:t[0]}}}],AutoLinkPlugin=()=>{let[e]=(0,tR.g)();return(0,X.useEffect)(()=>{e.update(()=>{let e=(0,t_.Gv)(),t=[],traverseNodes=e=>{if((0,t_.Gg)(e)&&t.push(e),(0,t_.F7)(e)){let t=e.getChildren();t.length>0&&t.forEach(traverseNodes)}};traverseNodes(e),t.forEach(e=>{e.markDirty()})})},[e]),(0,z.jsx)(tk.$,{matchers:tA})};var tP=s(70407),tM=s(61278),tL=s(95152),tO=s(37161),tF=s(33495);let tB={initialized:!1,data:void 0,retrigger:function(){throw Error("Function not implemented.")},isLoading:!1,error:null,lastRefreshTime:new Date,setContextItems:function(){throw Error("Function not implemented.")},contextItems:[],defaultContextItems:[],guideline:"",setGuideline:function(){throw Error("Function not implemented.")},saveGuideline:function(){throw Error("Function not implemented.")},numTokens:0,setNumTokens:function(){throw Error("Function not implemented.")}},tq=(0,X.createContext)(tB),BrainContextProvider=e=>{var t,s,a,n,r,o;let{children:i}=e,l=useChatParamsContext(),[c,d]=(0,X.useState)(!1),[u,m]=(0,X.useState)([]),[p,x]=(0,X.useState)([]),[h,g]=(0,X.useState)(""),[f,y]=(0,X.useState)(!1),{brainInterface:v}=useServerConnectionContext(),[C,w]=(0,X.useState)(new Date),[b,N]=(0,X.useState)(0),[S,j]=(0,X.useState)(0),{ideName:E}=useChatParamsContext(),I="windsurf"===E,{isLoading:T,data:k,retrigger:R,error:_}=(0,tF.useFetcher)({fire:(0,X.useCallback)(async()=>{if(!v.getBrainStatus||I)return null;let e=await v.getBrainStatus(getMetadata(l),!1);return d(!0),e},[v.getBrainStatus,l,I])}),{retrigger:D}=(0,tF.useFetcher)({fire:(0,X.useCallback)(async()=>!v.getBrainStatus||I?null:await v.getBrainStatus(getMetadata(l),!0),[v.getBrainStatus,l,I])});(0,X.useEffect)(()=>{var e,t,s;m(null!==(s=null==k?void 0:null===(t=k.contextStatus)||void 0===t?void 0:null===(e=t.pinnedScope)||void 0===e?void 0:e.items)&&void 0!==s?s:[])},[null==k?void 0:null===(s=k.contextStatus)||void 0===s?void 0:null===(t=s.pinnedScope)||void 0===t?void 0:t.items]),(0,X.useEffect)(()=>{var e,t,s;x(null!==(s=null==k?void 0:null===(t=k.contextStatus)||void 0===t?void 0:null===(e=t.defaultPinnedScope)||void 0===e?void 0:e.items)&&void 0!==s?s:[])},[null==k?void 0:null===(n=k.contextStatus)||void 0===n?void 0:null===(a=n.defaultPinnedScope)||void 0===a?void 0:a.items]),(0,X.useEffect)(()=>{if(!f&&k){var e,t,s;g((null!==(s=null===(t=k.contextStatus)||void 0===t?void 0:null===(e=t.pinnedGuideline)||void 0===e?void 0:e.items)&&void 0!==s?s:[]).map(e=>e.guideline).join(" ")),y(!0)}},[k,null==k?void 0:null===(o=k.contextStatus)||void 0===o?void 0:null===(r=o.pinnedGuideline)||void 0===r?void 0:r.items,f]),(0,X.useEffect)(()=>{if(I)return;R();let e=setInterval(()=>{R(),w(new Date),N(e=>e+1)},1e3*Math.min(1+b,60));return()=>{clearInterval(e)}},[R,b,c,I]);let A=(0,X.useCallback)(e=>{e?D():R(),w(new Date),N(0)},[R,D]),P=(0,X.useCallback)(async(e,t)=>{var s;m(t),await (null===(s=v.setPinnedContextItems)||void 0===s?void 0:s.call(v,e,t))},[v]),M=(0,X.useCallback)(e=>{v.setPinnedGuideline&&v.setPinnedGuideline(getMetadata(l),e)},[v,l]),L=(0,X.useCallback)(e=>{g(e)},[]),O=(0,X.useCallback)(e=>{j(e)},[]);return(0,z.jsx)(tq.Provider,{value:{isLoading:T,data:null!=k?k:void 0,retrigger:A,error:_,initialized:c,lastRefreshTime:C,setContextItems:P,contextItems:u,defaultContextItems:p,guideline:h,setGuideline:L,saveGuideline:M,numTokens:S,setNumTokens:O},children:i})},useBrainContext=()=>(0,X.useContext)(tq),tU=(0,X.forwardRef)((e,t)=>{let{trigger:s,value:a,...n}=e,r=(0,ti.classNames)("rounded-md px-1 py-0.5 text-white font-mono text-[0.8571429em] font-semibold",n.className);return(0,z.jsxs)("code",{...n,ref:t,title:s+a,className:r,children:[s,a]})});tU.displayName="MentionBlock";let tG=(0,X.forwardRef)((e,t)=>{let{trigger:s,value:a,data:n,...r}=e,o=useChatParamsContext(),{ideName:i}=useChatParamsContext(),l="windsurf"===i,{contextItems:c,setContextItems:d,guideline:u}=useBrainContext(),{openFilePointer:m}=useServerConnectionContext(),[p,x]=(0,X.useState)(!1),[h,g]=(0,X.useState)(""),[f]=(0,tR.g)();(0,tO.O)(t,()=>{x(!1),g("")});let y=(0,X.useMemo)(()=>{try{var e;let t=et.igh.fromJsonString(null!==(e=null==n?void 0:n.data.toString())&&void 0!==e?e:"");if("file"===t.scopeItem.case)return(0,ty.getScopeItemAbsoluteUri)(t.scopeItem.value);if("codeContext"===t.scopeItem.case)return(0,ti.getCCIAbsolutePath)(t.scopeItem.value)}catch(e){}return null},[null==n?void 0:n.data]),v=(0,X.useMemo)(()=>{try{var e;return et.igh.fromJsonString(null!==(e=null==n?void 0:n.data.toString())&&void 0!==e?e:"")}catch(e){return null}},[null==n?void 0:n.data]),C=(0,X.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),m(new OpenFilePointer({fileUri:(null==y?void 0:y.toString())||"",filePathMigrateMeToUri:(null==y?void 0:y.toDisplayString())||""})),g(""),x(!1)},[y,m]),w=(0,X.useCallback)(e=>{l?y&&C(e):f.isEditable()&&y?C(e):(y||v&&!l)&&x(!p)},[p,y,v,l,f,C]),b=(0,X.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),v&&(d(getMetadata(o),[...c,v],u),g("Item has been pinned."),setTimeout(()=>{g(""),x(!1)},2e3))},[v,c,u,o,d,g]);return null!==y||v?(0,z.jsxs)("span",{className:"relative cursor-pointer",ref:t,onClick:w,children:[(0,z.jsx)(tU,{trigger:s,value:a,...r}),p?(0,z.jsxs)("div",{className:"absolute -top-1 left-0 z-10 flex -translate-y-full items-stretch gap-1 overflow-hidden whitespace-nowrap rounded bg-gray-800 px-1 text-xs text-white transition-[background]",children:[h?(0,z.jsx)("div",{className:"rounded p-1",children:h}):(0,z.jsxs)(z.Fragment,{children:[y?(0,z.jsx)("div",{className:"rounded p-1 hover:bg-gray-900",onClick:C,children:"Open"}):null,v&&!l?(0,z.jsx)("div",{className:"rounded p-1 hover:bg-gray-900",onClick:b,children:"Pin item"}):null]}),(0,z.jsx)("div",{className:"flex items-center rounded p-1 hover:bg-gray-900",children:(0,z.jsx)(tL.Z,{className:"h-3 w-3"})})]}):null]}):(0,z.jsx)(tU,{trigger:s,value:a,...r})});tG.displayName="ContextScopeItemBlock";let ContextScopeItemNode=class ContextScopeItemNode extends tP.nY{static getType(){return ContextScopeItemNode.type}static clone(e){return new ContextScopeItemNode(e.__trigger,e.__value,e.__data,e.__key)}static importJSON(e){return new ContextScopeItemNode(e.trigger,e.value,e.data)}exportJSON(){let e=this.__data;return{trigger:this.__trigger,value:this.__value,data:e,type:ContextScopeItemNode.type,version:1}}component(){return tG}};ContextScopeItemNode.type="context-scope-item-mention";var tQ=s(66640);let parseDiffMentionsMarkdown=e=>{let t=e.match(/\[@diff:([a-zA-Z0-9+/]+=*)\]\(diff:\/\/([a-zA-Z0-9+/]+=*)\)/);if(!t||t.length<3)return null;let s=t[1],a=t[2],n=tQ.lW.from(s,"base64").toString("utf-8"),r=tQ.lW.from(a,"base64").toString("utf-8");return{repoPath:n,contents:r}},tJ=/\[Snippet identifier=([^\]]*)\]\n([\s\S]*)\n\[\/Snippet]/,parseSnippet=e=>{let t=e.match(tJ),s=null==t?void 0:t[1],a=null==t?void 0:t[2];if(s&&a)return{identifier:s,content:a}},tW=(0,X.forwardRef)((e,t)=>{let{trigger:s,value:a,data:n,...r}=e,[o,i]=(0,X.useState)(!1),[l,c]=(0,X.useState)("");(0,tO.O)(t,()=>{i(!1),c("")});let d=(0,X.useMemo)(()=>(null==n?void 0:n.data)?parseDiffMentionsMarkdown(n.data):null,[null==n?void 0:n.data]),u=(0,X.useMemo)(()=>{if(!(null==n?void 0:n.data))return null;let e=parseSnippet(n.data);return(null==e?void 0:e.content)||null},[null==n?void 0:n.data]),m=(0,X.useCallback)(()=>{i(!o)},[o]),p=(0,X.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),d?((0,eR.copyToClipboard)("Repo: ".concat(d.repoPath,"\n\n").concat(d.contents)),c("Copied diff.")):u&&((0,eR.copyToClipboard)(u),c("Copied snippet.")),setTimeout(()=>{c(""),i(!1)},2e3)},[d,c,u]);return d||u?(0,z.jsxs)("span",{className:"relative cursor-pointer",ref:t,onClick:m,children:[(0,z.jsx)(tU,{trigger:s,value:a,...r}),o?(0,z.jsxs)("div",{className:"absolute -top-1 left-0 z-10 flex -translate-y-full items-stretch gap-1 overflow-hidden whitespace-nowrap rounded bg-gray-800 px-1 text-xs text-white transition-[background]",children:[l?(0,z.jsx)("div",{className:"rounded p-1",children:l}):(0,z.jsx)("div",{className:"rounded p-1 hover:bg-gray-900",onClick:p,children:d?"Copy diff":"Copy snippet"}),(0,z.jsx)("div",{className:"flex items-center rounded p-1 hover:bg-gray-900",children:(0,z.jsx)(tL.Z,{className:"h-3 w-3"})})]}):null]}):(0,z.jsx)(tU,{trigger:s,value:a,...r})});tW.displayName="ContextScopeItemBlock";let MarkdownNode=class MarkdownNode extends tP.nY{static getType(){return MarkdownNode.type}static clone(e){return new MarkdownNode(e.__trigger,e.__value,e.__data,e.__key)}static importJSON(e){return new MarkdownNode(e.trigger,e.value,e.data)}exportJSON(){let e=this.__data;return{trigger:this.__trigger,value:this.__value,data:e,type:MarkdownNode.type,version:1}}component(){return tW}};MarkdownNode.type="markdown-mention";let CustomAutoLinkNode=class CustomAutoLinkNode extends tM.qp{static getType(){return"custom-autolink"}static clone(e){return new CustomAutoLinkNode(e.getURL(),{rel:e.__rel,target:e.__target},e.__key)}createDOM(){let e=document.createElement("a");return e.className="underline hover:text-inherit cursor-pointer",e.href=this.getURL(),e}static importJSON(e){var t;let s=(t=e.url,new CustomAutoLinkNode(t));return s.setFormat(e.format),s.setIndent(e.indent),s.setDirection(e.direction),s}exportJSON(){return{...super.exportJSON(),type:"custom-autolink",version:1,url:this.getURL(),isUnlinked:!1}}};let tH="!bg-ide-message-block-bot-background !text-ide-message-block-bot-color",tV="!bg-ide-active-selection-background !text-ide-active-selection-color",tY={"@":tH,"@Focused":tV,"/":tH,"/Focused":tV};function onError(e){}let createConfig=(e,t)=>({namespace:e,onError,theme:{beautifulMentions:t,paragraph:"read"===e?"":"text-sm"},nodes:[MarkdownNode,ContextScopeItemNode,CustomAutoLinkNode,{replace:tM.qp,with:e=>{let t=e.getURL();return new CustomAutoLinkNode(t)}},{replace:tP.nY,with:e=>{let t=e.getData();return(null==t?void 0:t.dataType)==="proto"?new ContextScopeItemNode(e.getTrigger(),e.getValue(),e.getData()):new MarkdownNode(e.getTrigger(),e.getValue(),e.getData())}}]});var tZ=s(64212),tK=s(64561),tz=s(5646),tX=s(71246),t$=s(35053),t0=s(131),t1=s(16083),t2=s(66745),t5=s(39205),t3=s(70504),t4=s(21327);let t6=["codeContext","file","directory","repository"],t8=["slack","github","jira","googleDrive"],t9=["codeContext","file","directory"];et.EGe.DIRECTORY,et.EGe.FILE,et.EGe.REPOSITORY,et.EGe.CODE_CONTEXT,et.EGe.CCI_WITH_SUBRANGE,et.EGe.REPOSITORY_PATH,et.EGe.SLACK,et.EGe.GITHUB,et.EGe.FILE_LINE_RANGE,et.EGe.TEXT_BLOCK,et.EGe.JIRA,et.EGe.GOOGLE_DRIVE,et.EGe.CONSOLE_LOG,et.EGe.DOM_ELEMENT,et.EGe.RECIPE;let findLongestPath=e=>{if(0!==e.length)return e.reduce((e,t)=>e.length>t.length?e:t,"")},splitPath=e=>{let t=e?e.split(/[\/\\]/):[],s=t.pop()||"";return{fileName:s,directory:(null==e?void 0:e.substring(0,e.length-s.length))||""}},t7={slack:{case:"slack",getIcon:()=>(0,z.jsx)(t5.SlackIcon,{className:"h-3 w-3 stroke-ide-message-block-bot-color",style:{filter:"grayscale(1)"}}),categoryName:"Slack",prefix:"slack:",getKey:e=>{if("slack"===e.scopeItem.case)return e.scopeItem.value.documentId},getDisplayValue:e=>{if("slack"===e.scopeItem.case)return e.scopeItem.value.displayName},getFilePointer:()=>{},getMetadataDisplayValue:e=>{if("slack"===e.scopeItem.case)return e.scopeItem.value.description},protoType:et.EGe.SLACK},github:{case:"github",getIcon:()=>(0,z.jsx)(t2.GithubIcon,{className:"w-3 stroke-ide-message-block-bot-color"}),categoryName:"Github",prefix:"github:",getKey:e=>{if("github"===e.scopeItem.case)return e.scopeItem.value.documentId},getDisplayValue:e=>{if("github"===e.scopeItem.case)return e.scopeItem.value.displayName},getFilePointer:()=>{},getMetadataDisplayValue:e=>{if("github"===e.scopeItem.case)return e.scopeItem.value.description},protoType:et.EGe.GITHUB},directory:{case:"directory",getIcon:()=>(0,z.jsx)(tZ.Z,{className:"w-3 stroke-ide-message-block-bot-color"}),categoryName:"Directories",prefix:"dir:",getKey:e=>{if("directory"===e.scopeItem.case)return findLongestPath((0,ty.getScopeItemWorkspaceRelativePaths)(e.scopeItem.value))},getDisplayValue:e=>{if("directory"===e.scopeItem.case)return findLongestPath((0,ty.getScopeItemWorkspaceRelativePaths)(e.scopeItem.value))},getFilePointer:()=>{},getMetadataDisplayValue:e=>{if("directory"===e.scopeItem.case&&e.scopeItem.value.numFiles)return"(".concat(e.scopeItem.value.numFiles," files)")},protoType:et.EGe.DIRECTORY},file:{case:"file",getIcon:()=>(0,z.jsx)(tK.Z,{className:"w-3 stroke-ide-message-block-bot-color"}),categoryName:"Files",prefix:"file:",getKey:e=>{if("file"===e.scopeItem.case)return findLongestPath((0,ty.getScopeItemWorkspaceRelativePaths)(e.scopeItem.value))},getDisplayValue:e=>{if("file"!==e.scopeItem.case)return;let t=findLongestPath((0,ty.getScopeItemWorkspaceRelativePaths)(e.scopeItem.value)),{fileName:s}=splitPath(t);return s},getFilePointer:e=>{if("file"===e.scopeItem.case)return new OpenFilePointer({fileUri:(0,ty.getScopeItemAbsoluteUri)(e.scopeItem.value).toString(),filePathMigrateMeToUri:(0,ty.getScopeItemAbsoluteUri)(e.scopeItem.value).toDisplayString()})},getMetadataDisplayValue:e=>{if("file"!==e.scopeItem.case)return;let t=findLongestPath((0,ty.getScopeItemWorkspaceRelativePaths)(e.scopeItem.value)),{directory:s}=splitPath(t);return s},protoType:et.EGe.FILE},repository:{case:"repository",getIcon:()=>(0,z.jsx)(tz.Z,{className:"w-3 stroke-ide-message-block-bot-color"}),categoryName:"Repositories",prefix:"repo:",getKey:e=>{var t,s;if("repository"===e.scopeItem.case)return"".concat(null===(t=e.scopeItem.value.repoInfo)||void 0===t?void 0:t.repoName,".").concat(null===(s=e.scopeItem.value.repoInfo)||void 0===s?void 0:s.versionAlias)},getDisplayValue:e=>{var t;if("repository"===e.scopeItem.case)return null===(t=e.scopeItem.value.repoInfo)||void 0===t?void 0:t.repoName.split("/").pop()},getFilePointer:()=>{},getMetadataDisplayValue:e=>{var t,s;if("repository"===e.scopeItem.case)return"".concat(null===(t=e.scopeItem.value.repoInfo)||void 0===t?void 0:t.repoName," (").concat(null===(s=e.scopeItem.value.repoInfo)||void 0===s?void 0:s.versionAlias,")")},protoType:et.EGe.REPOSITORY},codeContext:{case:"codeContext",getIcon:()=>(0,z.jsx)(tX.Z,{className:"w-3 stroke-ide-message-block-bot-color"}),categoryName:"Code Context Items",prefix:"code:",getDisplayValue:e=>{if("codeContext"!==e.scopeItem.case)return;let t=e.scopeItem.value;return t.contextType===et.fIx.NAIVE_LINECHUNK?"".concat((0,e1.getCCIAbsolutePath)(t).toDisplayString(),"#L").concat(t.startLine+1,"-L").concat(t.endLine+1):t.nodeName},getKey:e=>{if("codeContext"!==e.scopeItem.case)return;let t=e.scopeItem.value;return"".concat((0,e1.getCCIAbsolutePath)(t).toString(),":").concat(t.startLine,":").concat(t.endLine)},getFilePointer:e=>{if("codeContext"!==e.scopeItem.case)return;let t=e.scopeItem.value;return new OpenFilePointer({fileUri:(0,e1.getCCIAbsolutePath)(t).toString(),filePathMigrateMeToUri:(0,e1.getCCIAbsolutePath)(t).toDisplayString(),startLine:Number(t.startLine),endLine:Number(t.endLine)})},getMetadataDisplayValue:e=>{if("codeContext"!==e.scopeItem.case)return;let t="";for(let s of e.scopeItem.value.workspacePaths)(0,ty.getWorkspacePathRelativePath)(s).length>t.length&&(t=(0,ty.getWorkspacePathRelativePath)(s));return""===t&&(t=(0,e1.getCCIAbsolutePath)(e.scopeItem.value).toDisplayString()),t},protoType:et.EGe.CODE_CONTEXT},fileLineRange:{case:"fileLineRange",getIcon:()=>(0,z.jsx)(tX.Z,{className:"w-3 fill-ide-message-block-bot-color"}),categoryName:"Line Ranges",prefix:"code:",getKey:e=>{if("fileLineRange"!==e.scopeItem.case)return;let t=e.scopeItem.value;return"".concat(t.absoluteUri,":").concat(t.startLine,":").concat(t.endLine)},getDisplayValue:e=>{if("fileLineRange"!==e.scopeItem.case)return;let t=e.scopeItem.value,{fileName:s}=splitPath(t.absoluteUri),a="".concat(s,"#L").concat(t.startLine+1);return t.startLine!==t.endLine&&(a+="-".concat(t.endLine+1)),a},getFilePointer:e=>{if("fileLineRange"!==e.scopeItem.case)return;let t=e.scopeItem.value;return new OpenFilePointer({fileUri:t.absoluteUri,startLine:t.startLine,endLine:t.endLine})},getMetadataDisplayValue:e=>{if("fileLineRange"===e.scopeItem.case)return t1.Uri.fromUri(e.scopeItem.value.absoluteUri).toDisplayString()},protoType:et.EGe.FILE_LINE_RANGE},textBlock:{case:"textBlock",getIcon:()=>(0,z.jsx)(tX.Z,{className:"w-3 fill-ide-message-block-bot-color"}),categoryName:"Line Ranges",prefix:"code:",getKey:e=>{if("textBlock"===e.scopeItem.case)return JSON.stringify(e.scopeItem.value.identifier)},getDisplayValue:e=>{if("textBlock"!==e.scopeItem.case)return;let t=e.scopeItem.value.identifier;if("fileLineRange"!=t.case)return;let s=t.value,{fileName:a}=splitPath(s.absoluteUri);return"".concat(a,"#L").concat(s.startLine+1,"-L").concat(s.endLine)},getFilePointer:e=>{if("textBlock"!==e.scopeItem.case)return;let t=e.scopeItem.value.identifier;if("fileLineRange"!=t.case)return;let s=t.value;return new OpenFilePointer({fileUri:s.absoluteUri,startLine:s.startLine,endLine:s.endLine})},getMetadataDisplayValue:e=>{if("textBlock"!==e.scopeItem.case)return;let t=e.scopeItem.value.identifier;if("fileLineRange"!=t.case)return;let s=t.value;return t1.Uri.fromUri(s.absoluteUri).toDisplayString()},protoType:et.EGe.TEXT_BLOCK},cciWithSubrange:{case:"cciWithSubrange",getIcon:()=>(0,z.jsx)(tX.Z,{className:"w-3 fill-ide-message-block-bot-color"}),categoryName:"Code Context Item Subranges",prefix:"code:",getKey:e=>{var t;if("cciWithSubrange"!==e.scopeItem.case)return;let{startLine:s,endLine:a}=getLineOffsetsFromCciWithSubrange(e.scopeItem.value);return"".concat(null===(t=e.scopeItem.value.cci)||void 0===t?void 0:t.nodeName,":").concat(s,":").concat(a)},getDisplayValue:e=>{if("cciWithSubrange"!==e.scopeItem.case)return;let t=e.scopeItem.value.cci;return(null==t?void 0:t.contextType)===et.fIx.NAIVE_LINECHUNK?"".concat((0,e1.getCCIAbsolutePath)(t).toDisplayString(),"#L").concat(t.startLine+1,"-L").concat(t.endLine+1):null==t?void 0:t.nodeName},getFilePointer:e=>{if("cciWithSubrange"!==e.scopeItem.case||!e.scopeItem.value.cci)return;let t=e.scopeItem.value.cci,{startLine:s,endLine:a}=getLineOffsetsFromCciWithSubrange(e.scopeItem.value);return new OpenFilePointer({fileUri:(0,e1.getCCIAbsolutePath)(t).toString(),filePathMigrateMeToUri:(0,e1.getCCIAbsolutePath)(t).toDisplayString(),startLine:Number(t.startLine)+s,endLine:Number(t.startLine)+a})},getMetadataDisplayValue:e=>{if("cciWithSubrange"!==e.scopeItem.case||!e.scopeItem.value.cci)return;let t="";for(let s of e.scopeItem.value.cci.workspacePaths)(0,ty.getWorkspacePathRelativePath)(s).length>t.length&&(t=(0,ty.getWorkspacePathRelativePath)(s));return""===t&&(t=(0,e1.getCCIAbsolutePath)(e.scopeItem.value.cci).toDisplayString()),t},protoType:et.EGe.CCI_WITH_SUBRANGE},repositoryPath:{case:"repositoryPath",getIcon:e=>(null==e?void 0:e.scopeItem.case)!=="repositoryPath"?(0,z.jsx)(z.Fragment,{}):(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(tz.Z,{className:"w-3 fill-ide-message-block-bot-color"}),e.scopeItem.value.isDir?(0,z.jsx)(tZ.Z,{className:"w-3 fill-ide-message-block-bot-color"}):(0,z.jsx)(tK.Z,{className:"w-3 fill-ide-message-block-bot-color"})]}),categoryName:"Repositories",prefix:"repo:",getKey:e=>{var t,s;if("repositoryPath"===e.scopeItem.case)return"".concat(null===(t=e.scopeItem.value.repoInfo)||void 0===t?void 0:t.repoName,".").concat(null===(s=e.scopeItem.value.repoInfo)||void 0===s?void 0:s.versionAlias,":").concat(e.scopeItem.value.relativePath)},getDisplayValue:e=>{if("repositoryPath"===e.scopeItem.case)return e.scopeItem.value.relativePath},getFilePointer:()=>{},getMetadataDisplayValue:e=>{var t,s;if("repositoryPath"===e.scopeItem.case)return"".concat(null===(t=e.scopeItem.value.repoInfo)||void 0===t?void 0:t.repoName," (").concat(null===(s=e.scopeItem.value.repoInfo)||void 0===s?void 0:s.versionAlias,")")},protoType:et.EGe.REPOSITORY_PATH},jira:{case:"jira",getIcon:()=>(0,z.jsx)(t3.y,{className:"h-3 w-3 stroke-ide-message-block-bot-color",style:{filter:"grayscale(1)"}}),categoryName:"Jira",prefix:"jira:",getKey:e=>{if("jira"===e.scopeItem.case)return e.scopeItem.value.documentId},getDisplayValue:e=>{if("jira"===e.scopeItem.case)return e.scopeItem.value.displayName},getFilePointer:()=>{},getMetadataDisplayValue:e=>{if("jira"===e.scopeItem.case)return e.scopeItem.value.description},protoType:et.EGe.JIRA},googleDrive:{case:"googleDrive",getIcon:()=>(0,z.jsx)(t4.GoogleDriveIcon,{className:"h-3 w-3 stroke-ide-message-block-bot-color",style:{filter:"grayscale(1)"}}),categoryName:"Google Drive",prefix:"drive:",getKey:e=>{if("googleDrive"===e.scopeItem.case)return e.scopeItem.value.documentId},getDisplayValue:e=>{if("googleDrive"===e.scopeItem.case)return e.scopeItem.value.displayName},getFilePointer:()=>{},getMetadataDisplayValue:e=>{if("googleDrive"===e.scopeItem.case)return e.scopeItem.value.description},protoType:et.EGe.GOOGLE_DRIVE},consoleLog:{case:"consoleLog",getIcon:()=>(0,z.jsx)(t$.Z,{className:"w-3 fill-ide-message-block-bot-color"}),categoryName:"Console Logs",prefix:"console:",getKey:e=>{if("consoleLog"===e.scopeItem.case)return e.scopeItem.value.serverAddress},getDisplayValue:e=>{if("consoleLog"===e.scopeItem.case)return"web-context:console-logs"},getFilePointer:()=>{},getMetadataDisplayValue:()=>{},protoType:et.EGe.CONSOLE_LOG},domElement:{case:"domElement",getIcon:()=>(0,z.jsx)(tX.Z,{className:"w-3 fill-ide-message-block-bot-color"}),categoryName:"DOM Element",prefix:"dom:",getKey:e=>{if("domElement"!==e.scopeItem.case)return;let t=[e.scopeItem.value.tagName];return e.scopeItem.value.id&&t.push(e.scopeItem.value.id),e.scopeItem.value.reactComponentName&&t.push(e.scopeItem.value.reactComponentName),e.scopeItem.value.fileLineRange&&t.push(e.scopeItem.value.fileLineRange.absoluteUri,e.scopeItem.value.fileLineRange.startLine.toString()),t.join(":")},getDisplayValue:e=>{if("domElement"!==e.scopeItem.case)return;let t=["dom-element",e.scopeItem.value.tagName];return e.scopeItem.value.id&&t.push(e.scopeItem.value.id),e.scopeItem.value.reactComponentName&&t.push(e.scopeItem.value.reactComponentName),t.join(":")},getFilePointer:e=>{if("domElement"!==e.scopeItem.case)return;let t=e.scopeItem.value.fileLineRange;if(void 0!==t)return new OpenFilePointer({fileUri:t.absoluteUri,startLine:t.startLine,endLine:t.startLine})},getMetadataDisplayValue:e=>{if("domElement"!==e.scopeItem.case||void 0===e.scopeItem.value.fileLineRange)return;let t=t1.Uri.fromUri(e.scopeItem.value.fileLineRange.absoluteUri).toDisplayString();return"".concat(t,":").concat(e.scopeItem.value.fileLineRange.startLine)},protoType:et.EGe.DOM_ELEMENT},recipe:{case:"recipe",getIcon:()=>(0,z.jsx)(t0.Z,{className:"w-3 fill-ide-message-block-bot-color"}),categoryName:"Recipes",prefix:"recipe:",getKey:e=>{if("recipe"===e.scopeItem.case)return e.scopeItem.value.recipeId},getDisplayValue:e=>{if("recipe"===e.scopeItem.case)return e.scopeItem.value.title},getFilePointer:()=>{},getMetadataDisplayValue:e=>{if("recipe"===e.scopeItem.case)return e.scopeItem.value.description},protoType:et.EGe.RECIPE}},getLineOffsetsFromCciWithSubrange=e=>{var t,s;if(!e.subrange)throw Error("Couldn't find subrange for CciWithSubrange in snippetByType");let a=null===(s=e.cci)||void 0===s?void 0:null===(t=s.snippetByType.CONTEXT_SNIPPET_TYPE_RAW_SOURCE)||void 0===t?void 0:t.snippet;if(void 0===a)throw Error("Couldn't find snippet for CciWithSubrange in snippetByType");let n=a.substring(0,Number(e.subrange.startOffset)).split("\n").length-1,r=a.substring(0,Number(e.subrange.endOffset)).split("\n").length-1;return{startLine:n,endLine:r}},getContextScopeTypeMetadataFromItem=e=>{let t=e.scopeItem.case&&t7[e.scopeItem.case];if(!t)throw Error("Unknown context scope type: ".concat(e.scopeItem.case));return t},breakdownQueryFromNewEditor=(e,t)=>{if("file"===t)return{scopeType:et.EGe.FILE,query:e};if("directory"===t)return{scopeType:et.EGe.DIRECTORY,query:e};if("codeContext"===t)return{scopeType:et.EGe.CODE_CONTEXT,query:e};if("repository"===t){let t=e.indexOf(":");return t>0?{scopeType:et.EGe.REPOSITORY_PATH,query:e.slice(t+1),repoFilter:e.slice(0,t)}:{scopeType:et.EGe.REPOSITORY,query:e}}if("slack"===t)return{scopeType:et.EGe.SLACK,query:e};if("github"===t)return{scopeType:et.EGe.GITHUB,query:e};if("jira"===t)return{scopeType:et.EGe.JIRA,query:e};else if("googleDrive"===t)return{scopeType:et.EGe.GOOGLE_DRIVE,query:e};else return{scopeType:void 0,query:e}},breakdownQuery=(e,t)=>{if(e.startsWith("dir:")&&(!t||t.includes(et.EGe.DIRECTORY)))return{scopeType:et.EGe.DIRECTORY,query:e.slice(4)};if(e.startsWith("file:")&&(!t||t.includes(et.EGe.FILE)))return{scopeType:et.EGe.FILE,query:e.slice(5)};if(e.startsWith("repo:")&&(!t||t.includes(et.EGe.REPOSITORY))){let t=e.indexOf(":",5);return t>0?{scopeType:et.EGe.REPOSITORY_PATH,query:e.slice(t+1),repoFilter:e.slice(5,t)}:{scopeType:et.EGe.REPOSITORY,query:e.slice(5)}}{if(e.startsWith("code:")&&(!t||t.includes(et.EGe.CODE_CONTEXT)))return{scopeType:et.EGe.CODE_CONTEXT,query:e.slice(5)};let s=e.indexOf(":");return s>1?{scopeType:et.EGe.REPOSITORY_PATH,query:e.slice(s+1),repoFilter:e.slice(0,s)}:{scopeType:void 0,query:e}}};(c=A||(A={})).CATEGORY="category",c.ITEM="item",(d=P||(P={})).PROTO="proto",d.STRING="string";var se=s(83053);let MenuItemOptionComponentData=class MenuItemOptionComponentData extends se.n{constructor(e,t,s){super(t),this.trigger=e,this.mentionText=t,this.itemProps=s}};let AbstractTriggerService=class AbstractTriggerService{getTrigger(){return this.trigger}getCategories(){var e;return[...this.baseCategories,...Object.values(null!==(e=this.customCategories)&&void 0!==e?e:{}).map(e=>e.getCategory())]}getCustomCategory(e){var t;return null===(t=this.customCategories)||void 0===t?void 0:t[e]}handleCustomMentionSearch(e){return[]}handleEmptyQuery(){return this.getCategories().map(e=>new MenuItemOptionComponentData(this.getTrigger(),e.data.mentionText,e))}handleMentionNodeDataToMenuItemOptionComponentData(e){return new MenuItemOptionComponentData(this.getTrigger(),e.getDisplayValue(),e.getMenuItemProps())}async handleSearch(e,t,s){var a;let n=this.getCustomCategory(null!=t?t:"");if(n)return n.handleCategorySelect(),n.handleQuery(e);let r=await this.handleAsyncSearch(e,t,s);if(void 0===r)return;let o=r.map(e=>this.createMentionNodeData(e));if(t)return o;let i=await Promise.all(Object.values(null!==(a=this.customCategories)&&void 0!==a?a:{}).map(t=>t.handleQuery(e))),l=i.reduce((e,t)=>e.concat(t),[]);return this.handleCustomMentionSearch(e).concat(l).concat(o)}shouldShowMention(e,t){return!0}getCategory(e){return this.getCategories().find(t=>t.data.category===e)}handleOpen(){var e;for(let t of Object.values(null!==(e=this.customCategories)&&void 0!==e?e:{}))t.handleOpenMenu()}handleClose(){var e;for(let t of Object.values(null!==(e=this.customCategories)&&void 0!==e?e:{}))t.handleCloseMenu()}async transformData(e){var t,s,a;let n=this.getCustomCategory(null!==(a=null===(s=e.__data)||void 0===s?void 0:null===(t=s.category)||void 0===t?void 0:t.toString())&&void 0!==a?a:"");return n?n.transformData(e):null}constructor(e,t,s){if(1!==e.length)throw Error("Trigger must be one character long");this.trigger=e,this.baseCategories=t,this.customCategories=null==s?void 0:s.reduce((e,t)=>(t.categoryName&&(e[t.categoryName]=t),e),{})}};let MarkdownNodeData=class MarkdownNodeData{convertToTextOrScopeItem(){return new et.QVo({chunk:{case:"text",value:this.itemProps.data.data}})}convertToSerializedLexicalNode(){var e;return{data:e=this.itemProps.data,value:e.mentionText||"",trigger:e.trigger,type:MarkdownNode.getType(),version:1}}getDisplayValue(){return this.itemProps.data.mentionText}getMenuItemProps(){return this.itemProps}constructor(e){this.itemProps=e}};let MarkdownTextNodeParser=class MarkdownTextNodeParser{};var st=s(6749);let WebNodeParser=class WebNodeParser extends MarkdownTextNodeParser{getType(){return"web"}findMatches(e){return e.match(WebNodeParser.WEB_REGEX)}createNodeData(){return new MarkdownNodeData({data:{trigger:"@",category:"web",optionType:A.ITEM,data:"[web](use web search tool)",dataType:P.STRING,displayTitle:"Web",displayMetadata:"",mentionText:"web"},renderData:{displayIcon:(0,z.jsx)(st.Z,{className:"w-3 stroke-ide-message-block-bot-color"})}})}createDefaultNodeData(){return this.createNodeData()}};WebNodeParser.WEB_REGEX=/\[web\]\(use\sweb\ssearch\stool\)/g;let AtMentionService=class AtMentionService extends AbstractTriggerService{handleCustomMentionSearch(e){if(!this.config.webSearchEnabled||!this.isWindsurf)return[];let t=[new WebNodeParser().createDefaultNodeData()].filter(e=>null!==e);return t.filter(t=>t.getDisplayValue().toLowerCase().startsWith(e.toLowerCase()))}async handleAsyncSearch(e,t,s){return await this.searchMention(e,t,s)}createMentionNodeData(e){return ContextScopeItemNodeData.fromContextScopeItem(e)}getNodeType(){return ContextScopeItemNode.getType()}constructor(e,t,s=!1,a=!1,n={},r){let o=a?sn:ss,i=null==r?void 0:r.isEnabled(et.rpR.KNOWLEDGE_BASE_PROMPT_FRACTION),l=s&&i?[...o,...sa]:o;super(AtMentionService.trigger,l,t),this.handleEmptyQuery=()=>{let e=[];if(this.config.webSearchEnabled&&this.isWindsurf){let t=new WebNodeParser().createDefaultNodeData();t&&e.push(new MenuItemOptionComponentData(AtMentionService.trigger,t.getDisplayValue(),t.getMenuItemProps()))}return e.push(...super.handleEmptyQuery()),e},this.searchMention=e,this.isWindsurf=a,this.config=n}};AtMentionService.trigger="@";let ss=scopeTypesToMenuItems(t6),sa=scopeTypesToMenuItems(t8),sn=scopeTypesToMenuItems(t9);function scopeTypesToMenuItems(e){return e.map(e=>({data:{trigger:AtMentionService.trigger,optionType:A.CATEGORY,category:t7[e].case,data:t7[e].categoryName,dataType:P.STRING,displayTitle:t7[e].categoryName,displayMetadata:"",mentionText:t7[e].categoryName},renderData:{displayIcon:t7[e].getIcon()}}))}let ContextScopeItemNodeData=class ContextScopeItemNodeData{convertToTextOrScopeItem(){let e=this.itemProps.data;try{return new et.QVo({chunk:{case:"item",value:et.igh.fromJsonString(e.data)}})}catch(t){if(console.error("Error: unable to parse context item",e.mentionText),e.mentionText)return new et.QVo({chunk:{case:"text",value:e.mentionText}});throw t}}convertToSerializedLexicalNode(){return function(e){let t=et.igh.fromJsonString(e.data),s=getContextScopeTypeMetadataFromItem(t).getDisplayValue(t);return{data:e,value:s||"",trigger:e.trigger,type:ContextScopeItemNode.getType(),version:1}}(this.itemProps.data)}getDisplayValue(){return this.itemProps.data.mentionText}static fromContextScopeItem(e){let t=getContextScopeTypeMetadataFromItem(e),s=t.getDisplayValue(e),a=t.getMetadataDisplayValue(e),n=e.scopeItem.case?t7[e.scopeItem.case].getIcon(e):void 0;return new ContextScopeItemNodeData({data:{data:e.toJsonString(),dataType:P.PROTO,trigger:AtMentionService.trigger,optionType:A.ITEM,displayTitle:null!=s?s:"",displayMetadata:null!=a?a:"",mentionText:null!=s?s:""},renderData:{displayIcon:n}})}getMenuItemProps(){return this.itemProps}constructor(e){this.itemProps=e}};let createTextNode=e=>({detail:0,format:0,mode:"normal",text:e,type:"text",version:1,style:""});let TextNodeData_TextNodeData=class TextNodeData_TextNodeData{convertToTextOrScopeItem(){return new et.QVo({chunk:{case:"text",value:this.text}})}convertToSerializedLexicalNode(){return createTextNode(this.text)}getDisplayValue(){return this.text}constructor(e){this.text=e}};let LineBreakNodeData=class LineBreakNodeData extends TextNodeData_TextNodeData{getDisplayValue(){return""}constructor(){super("\n")}};let TabNodeData=class TabNodeData extends TextNodeData_TextNodeData{getDisplayValue(){return"	"}constructor(){super("	")}};let createAutoLinkNode=(e,t)=>({url:e,type:"custom-autolink",version:1,children:[{text:t,type:"text",version:1}],direction:null,format:"",indent:0,isUnlinked:!1});let CustomAutoLinkNodeData=class CustomAutoLinkNodeData{convertToTextOrScopeItem(){return new et.QVo({chunk:{case:"text",value:this.url}})}convertToSerializedLexicalNode(){return createAutoLinkNode(this.url,this.url)}getDisplayValue(){return this.url}constructor(e){this.url=e}};let createNodeDataFromLexicalNode=e=>{if("text"===e.type)return new TextNodeData_TextNodeData(e.text);if("linebreak"===e.type)return new LineBreakNodeData;if("tab"===e.type)return new TabNodeData;if(e.type===CustomAutoLinkNode.getType())return new CustomAutoLinkNodeData(e.url);if(e.type===ContextScopeItemNode.getType())return new ContextScopeItemNodeData({data:e.data});if(e.type===MarkdownNode.getType())return new MarkdownNodeData({data:e.data});throw Error("Unknown node type: ".concat(e.type))},createNodeDataFromContextScopeItem=e=>ContextScopeItemNodeData.fromContextScopeItem(e);let TerminalNodeParser=class TerminalNodeParser extends MarkdownTextNodeParser{getType(){return"@terminal"}findMatches(e){return e.match(TerminalNodeParser.TERMINAL_REGEX)}createNodeData(e){return new MarkdownNodeData({data:{trigger:"@",category:"terminal",optionType:A.ITEM,data:e,dataType:P.STRING,displayTitle:"Terminal",displayMetadata:"",mentionText:"terminal"}})}};TerminalNodeParser.TERMINAL_REGEX=/\[@terminal\]\(terminal:\/\/(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{4})\)/g;let sr=/\[\/([a-zA-Z0-9_]+)\]\(slash_command:\/\/[a-zA-Z0-9_]+\)/g;let SlashCommandMarkdownNodeParser=class SlashCommandMarkdownNodeParser extends MarkdownTextNodeParser{getType(){return"/slash_command"}findMatches(e){return e.match(sr)}createNodeData(e){var t;let s=(null===(t=e.match(sr.source))||void 0===t?void 0:t[1])||"unknown";return new MarkdownNodeData({data:{trigger:"/",category:void 0,optionType:A.ITEM,data:e,dataType:P.STRING,displayTitle:"/".concat(s),displayMetadata:"",mentionText:s}})}};let DiffMatchNodeParser=class DiffMatchNodeParser extends MarkdownTextNodeParser{getType(){return"@diff"}findMatches(e){return e.match(DiffMatchNodeParser.DIFF_REGEX)}createNodeData(e){let t=parseDiffMentionsMarkdown(e);if(!t)return null;let s=getFolderName(t.repoPath);return new MarkdownNodeData({data:{trigger:"@",category:"diff",optionType:A.ITEM,data:e,dataType:P.STRING,displayTitle:"Diff (".concat(s,")"),displayMetadata:"",mentionText:"diff:".concat(s)}})}};DiffMatchNodeParser.DIFF_REGEX=/\[@diff:(.+)\]\(diff:\/\/(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{4})\)/g;let SnippetNodeParser=class SnippetNodeParser extends MarkdownTextNodeParser{getType(){return"@snippet"}findMatches(e){return e.match(SnippetNodeParser.SNIPPET_REGEX)}createNodeData(e){let t=parseSnippet(e);if(!t)return null;let{identifier:s}=t;return new MarkdownNodeData({data:{trigger:"@",category:"snippet",optionType:A.ITEM,data:e,dataType:P.STRING,displayTitle:s,displayMetadata:"",mentionText:s}})}};SnippetNodeParser.SNIPPET_REGEX=/\[Snippet identifier=([^\]]*)\]\n([\s\S]*)\n\[\/Snippet]/g;var so=s(59584);let base64Encode=e=>btoa(e),needsEscaping=e=>/[\\'"$`!&|<>;*?{}()\[\]#~=:\s]/.test(e),escapeString=e=>"'".concat(e.replace(/'/g,"'\\''"),"'"),getEscapedCommand=e=>{if(!e)return"";let t=e.split(" "),s=t.map(e=>needsEscaping(e)?escapeString(e):e);return s.join(" ")},getCommandDisplay=e=>{if(!e)return"";e=getEscapedCommand(e);let t=e.split(" "),s=t[0];if(!s)return e;let a=s.split(/[\/\\]/),n=a[a.length-1]||s,r=t.slice(1).join(" ");return"".concat(n," ").concat(r).trim()};var si=s(3230);function createWebContextNodeData(e,t){return new MarkdownNodeData({data:{trigger:"@",category:"web-context",optionType:A.ITEM,data:"[web-context](".concat(base64Encode((0,si.cleanTextForBase64)(JSON.stringify(t))),")"),dataType:P.STRING,displayTitle:e,displayMetadata:"",mentionText:"web-context:".concat(e)},renderData:{displayIcon:(0,z.jsx)(so.Z,{className:"w-3 stroke-ide-message-block-bot-color"})}})}let WebContextNodeParser_WebContextNodeParser=class WebContextNodeParser_WebContextNodeParser extends MarkdownTextNodeParser{getType(){return"web-context"}findMatches(e){return e.match(WebContextNodeParser_WebContextNodeParser.WEB_REGEX)}createNodeData(e){let t=e.match(/\[web-context\]\(([A-Za-z0-9+/=]+)\)/);if(!t||!t[1]||!/^[A-Za-z0-9+/=]+$/.test(t[1]))return null;let s=atob(t[1]);try{let e=JSON.parse(s);return createWebContextNodeData(e.type,e)}catch(e){return null}}static createNodeFromWebContextString(e,t){return createWebContextNodeData(e,{type:e,context:t})}};WebContextNodeParser_WebContextNodeParser.WEB_REGEX=/\[web-context\]\(([A-Za-z0-9+/=]+)\)/g;let ParsingConfig=class ParsingConfig{getParsers(){return this.parsers}setParsers(e){this.parsers=e}constructor(){this.parsers=[new TerminalNodeParser,new SlashCommandMarkdownNodeParser,new DiffMatchNodeParser,new WebContextNodeParser_WebContextNodeParser,new SnippetNodeParser]}};let convertEditorStateToNodeData=e=>{let t=e.toJSON(),s=[];return t.root.children.forEach((e,a)=>{e.children.forEach(e=>{let t=createNodeDataFromLexicalNode(e);s.push(t)}),a<t.root.children.length-1&&s.push(new LineBreakNodeData)}),s},convertNodeDataToEditorState=e=>{let t={children:[],type:"root",direction:"ltr",indent:0,version:1,format:""},s=createParagraphNode();for(let a of e){if(a instanceof LineBreakNodeData){t.children.push(s),s=createParagraphNode();continue}s.children.push(a.convertToSerializedLexicalNode())}return s.children.length>0&&t.children.push(s),JSON.stringify({root:t})},convertTextOrScopeItemToEditorState=(e,t)=>{let s=convertTextOrScopeItemToNodeData(e,t);return convertNodeDataToEditorState(s)},convertTextOrScopeItemToNodeData=(e,t)=>{let s=[];for(let a of e)switch(a.chunk.case){case"text":let e=function(e,t){var s;let a=e.flatMap(e=>{let s=e.findMatches(t);return s?s.map(t=>({match:t,parser:e})):[]});a.sort((e,s)=>t.indexOf(e.match)-t.indexOf(s.match));let n=[],r=t;for(let{match:e,parser:t}of a){let s=r.indexOf(e);if(-1===s)continue;let a=r.substring(0,s);a&&n.push(new TextNodeData_TextNodeData(a));let o=t.createNodeData(e);o&&n.push(o),r=r.substring(s+e.length)}return r&&n.push((s=r,new TextNodeData_TextNodeData(s))),n}(t.getParsers(),a.chunk.value);for(let t of e)s.push(t);break;case"item":let n=createNodeDataFromContextScopeItem(a.chunk.value);s.push(n)}return s},convertEditorStateToTextOrScopeItem=e=>convertEditorStateToNodeData(e).map(e=>e.convertToTextOrScopeItem()),convertTextOrScopeItemToPreview=(e,t)=>{let s=convertTextOrScopeItemToNodeData(e,t),a="";for(let e of s)a+=e.getDisplayValue()+" ";return a.trim()},createParagraphNode=()=>({children:[],type:"paragraph",direction:"ltr",indent:0,version:1,format:"",textFormat:0,textStyle:"paragraph"}),createEmptyEditorState=()=>JSON.stringify({root:{children:[createParagraphNode()],type:"root",direction:"ltr",indent:0,version:1,format:""}}),clearEditor=async e=>new Promise((t,s)=>{try{e.update(()=>{let e=(0,t_.Gv)();e.clear();let s=(0,t_.BE)();s.setDirection("ltr"),e.append(s);let a=(0,t_.vN)();a.focus.set(s.getKey(),0,"element"),a.anchor.set(s.getKey(),0,"element"),(0,t_.oq)(a),t()})}catch(e){s(e)}}),updateEditor=async(e,t)=>new Promise((s,a)=>{try{e.update(()=>{let a=e.parseEditorState(convertNodeDataToEditorState(t));e.setEditorState(a),s()})}catch(e){a(e)}}),isEditorEmpty=e=>{let t;return!e||(e.getEditorState().read(()=>{let e=(0,t_.Gv)().getTextContent();t=0===e.trim().length}),t)},setSelectionAtStart=e=>{e.update(()=>{let e=(0,t_.Gv)();e.selectStart()})},EditorRefPlugin=e=>{let{value:t,parsingConfig:s}=e,a=(0,X.useRef)(null),[n]=(0,tR.g)();return(0,X.useEffect)(()=>{a.current=n},[n]),(0,X.useEffect)(()=>{a.current&&updateEditor(a.current,convertTextOrScopeItemToNodeData(t,s))},[t,s]),null},TextOrScopeItemView=e=>{let{className:t,value:s,parsingConfig:a=new ParsingConfig}=e,n=(0,X.useMemo)(()=>0===s.length?createEmptyEditorState():convertTextOrScopeItemToEditorState(s,a),[s,a]),r=(0,X.useMemo)(()=>createConfig("read",tY),[]),o=(0,eG.classNames)("w-full z-1",null!=t?t:"");return(0,z.jsxs)(tS.R,{initialConfig:{...r,editorState:n,editable:!1},children:[(0,z.jsx)(EditorRefPlugin,{value:s,parsingConfig:a}),(0,z.jsx)(tj.B,{contentEditable:(0,z.jsx)(tE.f,{className:o}),placeholder:null,ErrorBoundary:tI.Z}),(0,z.jsx)(tT.e,{}),(0,z.jsx)(AutoLinkPlugin,{})]})},IntentMessageBlock=()=>{let{message:e}=useChatMessageContext(),t=(0,X.useMemo)(()=>{if("intent"!==e.content.case)return(0,z.jsx)(z.Fragment,{});let t="explain-tooltip-".concat(e.messageId),s=(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)("span",{id:t,className:"rounded-md bg-ide-tooltip-background px-1 py-0.5 text-ide-tooltip-color",children:"/explain"}),(0,z.jsx)(e7.u,{anchorSelect:"#".concat(t),place:"right",className:"win-w-[200px] z-100 w-max max-w-[70vw] bg-ide-tooltip-background text-ide-tooltip-color",border:"1px solid var(--codeium-tooltip-color, rgb(255, 255, 255))",children:"Use /explain to get explanations about your codebase. Use it to explain a part of your code reference your code using @function_name."})]}),a=e.content.value;switch(a.intent.case){case"search":{let{query:e}=a.intent.value;if(!e)return(0,z.jsx)("p",{children:"Searching..."});return(0,z.jsxs)("p",{children:[(0,z.jsx)("span",{className:"font-semibold",children:"Search: "}),e]})}case"explainFunction":{let{functionInfo:e}=a.intent.value;if(!e)return(0,z.jsx)("p",{children:"Explaining function..."});return(0,z.jsxs)("p",{children:[s," ",(0,z.jsx)(InlineCodePointer,{pointer:new OpenFilePointer({fileUri:GetIntentAbsolutePath(a.intent.value).toString(),filePathMigrateMeToUri:GetIntentAbsolutePath(a.intent.value).toDisplayString(),startCol:e.startCol,startLine:e.startLine,endCol:e.endCol,endLine:e.endLine}),children:e.nodeName})]})}case"functionDocstring":{let{functionInfo:e}=a.intent.value;if(!e)return(0,z.jsx)("p",{children:"Generating docstring..."});return(0,z.jsxs)("p",{children:["Generate docstring for function:"," ",(0,z.jsx)(InlineCodePointer,{pointer:new OpenFilePointer({fileUri:GetIntentAbsolutePath(a.intent.value).toString(),filePathMigrateMeToUri:GetIntentAbsolutePath(a.intent.value).toDisplayString(),startCol:e.startCol,startLine:e.startLine,endCol:e.endCol,endLine:e.endLine}),children:e.nodeName})]})}case"functionRefactor":{let{functionInfo:e,refactorDescription:t}=a.intent.value;if(!e)return(0,z.jsx)("p",{children:"Refactoring function..."});return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsxs)("p",{children:["Refactor function:"," ",(0,z.jsx)(InlineCodePointer,{pointer:new OpenFilePointer({fileUri:GetIntentAbsolutePath(a.intent.value).toString(),filePathMigrateMeToUri:GetIntentAbsolutePath(a.intent.value).toDisplayString(),startCol:e.startCol,startLine:e.startLine,endCol:e.endCol,endLine:e.endLine}),children:e.nodeName})]}),(0,z.jsx)("p",{children:t})]})}case"functionUnitTests":{let{functionInfo:e}=a.intent.value;if(!e)return(0,z.jsx)("p",{children:"Generating unit tests..."});return(0,z.jsxs)("p",{children:["Generate unit tests:"," ",(0,z.jsx)(InlineCodePointer,{pointer:new OpenFilePointer({fileUri:GetIntentAbsolutePath(a.intent.value).toString(),filePathMigrateMeToUri:GetIntentAbsolutePath(a.intent.value).toDisplayString(),startCol:e.startCol,startLine:e.startLine,endCol:e.endCol,endLine:e.endLine}),children:e.nodeName})]})}case"explainClass":{let{classInfo:e}=a.intent.value;if(!e)return(0,z.jsx)("p",{children:"Explaining class..."});return(0,z.jsxs)("p",{children:[s," ",(0,z.jsx)(InlineCodePointer,{pointer:new OpenFilePointer({fileUri:GetIntentAbsolutePath(a.intent.value).toString(),filePathMigrateMeToUri:GetIntentAbsolutePath(a.intent.value).toDisplayString(),startLine:e.startLine,endLine:e.endLine,startCol:e.startCol,endCol:e.endCol}),children:e.nodeName})]})}case"explainCodeBlock":{let{codeBlockInfo:e}=a.intent.value;if(!e)return(0,z.jsx)("p",{children:"Explaining code block..."});return(0,z.jsx)(z.Fragment,{children:(0,z.jsxs)("p",{children:[s," ",(0,z.jsx)(InlineCodePointer,{pointer:new OpenFilePointer({fileUri:GetIntentAbsolutePath(a.intent.value).toString(),filePathMigrateMeToUri:GetIntentAbsolutePath(a.intent.value).toDisplayString(),startCol:e.startCol,startLine:e.startLine,endCol:e.endCol,endLine:e.endLine}),children:getCodeBlockPointerLabel(GetIntentAbsolutePath(a.intent.value),e)})]})})}case"codeBlockRefactor":{let{codeBlockInfo:e,refactorDescription:t}=a.intent.value;if(!e)return(0,z.jsx)("p",{children:"Refactoring code block..."});return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsxs)("p",{children:["Refactor code block:"," ",(0,z.jsx)(InlineCodePointer,{pointer:new OpenFilePointer({fileUri:GetIntentAbsolutePath(a.intent.value).toString(),filePathMigrateMeToUri:GetIntentAbsolutePath(a.intent.value).toDisplayString(),startCol:e.startCol,startLine:e.startLine,endCol:e.endCol,endLine:e.endLine}),children:getCodeBlockPointerLabel(GetIntentAbsolutePath(a.intent.value),e)})]}),(0,z.jsx)("p",{children:t})]})}case"problemExplain":{let{diagnosticMessage:e,problematicCode:t}=a.intent.value;if(!e||!t)return(0,z.jsx)("p",{children:"Explaining problem..."});return(0,z.jsxs)("p",{children:["Explain problem:"," "+e," @",(0,z.jsx)(InlineCodePointer,{pointer:new OpenFilePointer({fileUri:GetIntentAbsolutePath(a.intent.value).toString(),filePathMigrateMeToUri:GetIntentAbsolutePath(a.intent.value).toDisplayString(),startCol:t.startCol,startLine:t.startLine,endCol:t.endCol,endLine:t.endLine}),children:getCodeBlockPointerLabel(GetIntentAbsolutePath(a.intent.value),t)})]})}case"generic":if(a.intent.value.items.length>0)return(0,z.jsx)(TextOrScopeItemView,{value:a.intent.value.items});return(0,z.jsx)(e5,{className:"text-[color:var(--text-ide-text-color)] prose-a:text-[color:var(--text-ide-link-color)]",children:a.intent.value.text});default:return(0,z.jsx)("p",{className:"whitespace-pre-wrap",children:JSON.stringify(a.intent)})}},[e.content.case,e.content.value,e.messageId]);return"intent"!==e.content.case?(0,z.jsx)(z.Fragment,{}):(0,z.jsx)(MessageBlockContainer,{children:t})};var sl=s(56280);(u=M||(M={}))[u.DONE=0]="DONE",u[u.PROCESSING=1]="PROCESSING",u[u.QUEUED=2]="QUEUED";let StatusContextRelevancy=e=>{let{contextRelevancy:t}=e,s=(0,X.useMemo)(()=>t.isLoading&&t.isRelevant?1:t.isLoading&&!t.isRelevant?2:0,[t.isLoading,t.isRelevant]),a=(0,X.useMemo)(()=>!t.isLoading&&t.isRelevant&&t.querySuggestions.length>0?0:!t.isLoading&&t.isRelevant?1:2,[t.isLoading,t.isRelevant,t.querySuggestions.length]),n=(0,X.useMemo)(()=>!t.isLoading&&t.isRelevant&&t.querySuggestions.length>0?1:2,[t.isLoading,t.isRelevant,t.querySuggestions.length]),r=(0,X.useMemo)(()=>[{label:"Retrieving Context",status:s},{label:"Constructing Prompt",status:a},{label:"Start Streaming Tokens",status:n}],[a,s,n]),o=(0,X.useMemo)(()=>{if(!t.isRelevant)return(0,z.jsx)(sl.TypingAnimation,{});let e=(0,z.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3",viewBox:"0 0 13 13",fill:"none",children:[(0,z.jsx)("circle",{cx:"6.5",cy:"6.5",r:"6.5",className:"fill-ide-text-color opacity-50"}),(0,z.jsx)("path",{className:"fill-ide-chat-background",fillRule:"evenodd",clipRule:"evenodd",d:"M10.524 3.67592C10.6364 3.78843 10.6996 3.94102 10.6996 4.10012C10.6996 4.25921 10.6364 4.4118 10.524 4.52432L5.72396 9.32432C5.61144 9.4368 5.45885 9.49999 5.29976 9.49999C5.14066 9.49999 4.98807 9.4368 4.87556 9.32432L2.47556 6.92432C2.36626 6.81115 2.30578 6.65959 2.30715 6.50228C2.30852 6.34496 2.37162 6.19447 2.48286 6.08322C2.59411 5.97198 2.7446 5.90888 2.90192 5.90751C3.05923 5.90614 3.21079 5.96662 3.32396 6.07592L5.29976 8.05172L9.67556 3.67592C9.78807 3.56343 9.94066 3.50024 10.0998 3.50024C10.2589 3.50024 10.4114 3.56343 10.524 3.67592Z"})]});return(0,z.jsx)("div",{className:"flex flex-row items-center justify-center",children:(0,z.jsxs)("div",{className:"rounded-lg p-1",children:[(0,z.jsx)("p",{className:"",children:"Processing request..."}),(0,z.jsx)("ul",{className:"p-2",children:r.map((t,s)=>(0,z.jsxs)("li",{className:"flex items-center space-x-3 ".concat(2===t.status?"opacity-50":"opacity-100"),children:[0===t.status&&e,1===t.status&&(0,z.jsxs)("div",{className:"relative h-3 w-3",children:[(0,z.jsx)("div",{className:"absolute inset-0 rounded-full border-2 border-ide-text-color opacity-50"}),(0,z.jsx)("div",{className:"absolute inset-0 animate-spin rounded-full border-2 border-r-ide-active-selection-background"})]}),2===t.status&&(0,z.jsx)("div",{className:"border-ide-text-color-opacity-25 h-3 w-3 rounded-full border-2"}),(0,z.jsx)("span",{children:t.label})]},s))})]})})},[t.isRelevant,r]);return(0,z.jsx)("div",{className:"h-24 w-fit rounded-md rounded-bl-none px-3 py-2 text-ide-message-block-bot-color",children:o})},StatusMessageBlock=()=>{let{message:e}=useChatMessageContext(),[t,s]=(0,X.useState)(!1),a=(0,X.useMemo)(()=>{if("status"!==e.content.case)return(0,z.jsx)(z.Fragment,{});let a=e.content.value;return(t||"contextRelevancy"!==a.status.case||setTimeout(()=>{s(!0)},200),"contextRelevancy"===a.status.case)?t&&(0,z.jsx)(StatusContextRelevancy,{contextRelevancy:a.status.value}):(0,z.jsx)(MessageBlockContainer,{children:(0,z.jsx)("p",{className:"whitespace-pre-wrap",children:JSON.stringify(a.status)})})},[t,e]);return"status"!==e.content.case?(0,z.jsx)(z.Fragment,{}):a},ChatMessageBlock=e=>{let{chat:t,isIgnoredInHistory:s=!1,scrollToCutOff:a,showContextWarning:n=!1}=e;return t.message?(0,z.jsxs)(ChatMessageProvider,{message:t.message,feedback:t.feedback,isIgnoredInHistory:s,scrollToCutOff:a,showContextWarning:n,children:[(0,z.jsx)(IntentMessageBlock,{}),(0,z.jsx)(ErrorMessageBlock,{}),(0,z.jsx)(ActionMessageBlock,{}),(0,z.jsx)(StatusMessageBlock,{})]}):(0,z.jsx)(z.Fragment,{})};var sc=s(24946),sd=s(2130);let ChecklistItem=e=>{let{title:t,isOk:s,fixDescription:a}=e;return(0,z.jsxs)("li",{className:"flex flex-row gap-x-2 rounded-md bg-ide-message-block-bot-background px-4 py-3 text-ide-message-block-bot-color",children:[(0,z.jsx)("div",{className:"flex h-auto grow-0 items-center justify-center",children:s?(0,z.jsx)(sc.CheckCircleIcon,{className:"h-10 w-10 fill-green"}):(0,z.jsx)(sd.XCircleIcon,{className:"h-10 w-10 fill-red"})}),(0,z.jsxs)("div",{className:"flex flex-col items-start justify-start gap-0",children:[(0,z.jsx)("h6",{children:t}),s?(0,z.jsx)(z.Fragment,{}):a]})]})};var su=s(95912);let ChatDisabledChecklist=()=>{let{handshake:e}=useServerConnectionContext(),{ideTelemetryEnabled:t}=useChatParamsContext(),s=null==e?void 0:e.userStatus,{copyDebugOutput:a}=useDiagnostics();return(0,z.jsxs)("div",{className:"mt-10 flex w-full flex-col items-center justify-center p-3",children:[(0,z.jsx)("h3",{className:"mb-6",children:"Chat Is Disabled"}),(0,z.jsxs)("ul",{role:"list",className:"space-y-3",children:[!(null==s?void 0:s.teamId)&&(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(ChecklistItem,{title:"Completion Logging",isOk:!(null==s?void 0:s.disableTelemetry),fixDescription:(0,z.jsxs)("p",{className:"text-sm text-ide-text-color",children:["Please update your Code Snippet Telemetry settings on"," ",(0,z.jsx)("a",{href:"https://codeium.com/profile",target:"_blank",className:"underline",children:"your profile"})," ","and reload your window."]})}),(0,z.jsx)(ChecklistItem,{title:"IDE Telemetry",isOk:!!t,fixDescription:(0,z.jsx)("p",{className:"text-sm text-ide-text-color",children:"Please check your IDE's telemetry settings and reload your window."})})]}),(null==s?void 0:s.teamId)&&(0,z.jsx)(ChecklistItem,{title:"Team Approval",isOk:s.teamStatus===et.ngL.APPROVED,fixDescription:(0,z.jsx)("p",{className:"text-sm text-ide-text-color",children:"You are not an approved member of your team. Please reach out to your team's administrator for more information."})})]}),(0,z.jsxs)("p",{className:"mt-6 text-sm text-ide-text-color",children:["Unlike Autocomplete, Chat individual tier currently uses APIs from partners. If you want to try Chat with Telemetry turned off, please use our"," ",(0,z.jsx)("a",{href:"https://codeium.com/enterprise",target:"_blank",className:"underline",children:"Teams product"})," ","which has Chat enabled with guarantees of no data sharing. This has no effect on the Autocomplete service! Please see"," ",(0,z.jsx)("a",{href:"https://codeium.com/faq",target:"_blank",className:"underline",children:"our FAQ"})," ","on our website for more information."]}),(0,z.jsxs)("p",{className:"mb-3 mt-3 text-sm",children:["If you have any questions, our team is available on"," ",(0,z.jsx)("a",{href:"https://codeium.com/support",target:"_blank",className:"underline",children:"Support"}),". You can copy the debug output below to assist the team with debugging."]}),(0,z.jsx)(su.Button,{kind:"outlined",size:"small",color:"gray",onClick:e=>{e.preventDefault(),a()},children:"Copy Debug Output"})]})},getChatTokensSoftLimit=e=>isTeamsUser(e)?13e3:3500;var sm=s(64393),sp=s(70399);let sx=[{label:"to accept a completion while editing code",keys:["Tab"]},{label:"to show the next completion while editing code",keys:[sm.KeyboardKeyType.ALT,"]"]},{label:"to show the previous completion while editing code",keys:[sm.KeyboardKeyType.ALT,"["]},{label:"to edit past chat messages while using Codeium chat",keys:["Up/Down"]}],sh={jetbrains:[{label:"to generate inline code while editing code",keys:[sm.KeyboardKeyType.CTRL,"I"]},{label:"to open Codeium chat",keys:[sm.KeyboardKeyType.ALT,"C"]}],vscode:[{label:"to generate inline code while editing code",keys:[sm.KeyboardKeyType.CTRL,"I"]},{label:"to toggle between the editor and Codeium chat",keys:[sm.KeyboardKeyType.CTRL,sm.KeyboardKeyType.SHIFT,"A"]},{label:"to start a new chat",keys:[sm.KeyboardKeyType.ALT,"C"]}]},InitMessage=e=>{let{ideName:t}=e,{props:{openUniversity:s}}=useServerConnectionContext(),a=(0,tx.useIsMac)(),[n,r]=(0,X.useState)(null),{conversationID:o}=useServerConnectionContext();(0,X.useEffect)(()=>{let e=t&&sh[t],s=[...e||[],...sx],a=Math.floor(Math.random()*s.length);r({...s[a],index:a})},[o,t]);let i=(0,X.useMemo)(()=>null==n?void 0:n.keys.map(e=>e===sm.KeyboardKeyType.CTRL?a?"":"Ctrl":e===sm.KeyboardKeyType.ALT?a?"":"Alt":e).join("+"),[a,null==n?void 0:n.keys]);return(0,z.jsxs)("div",{className:"mx-4 flex flex-col space-y-4 rounded p-3 pt-8 text-ide-message-block-bot-color",children:[(0,z.jsx)("p",{children:"Welcome to Codeium, the most intelligent code assistant."}),s&&(0,z.jsxs)("div",{className:"flex flex-col items-start justify-start",children:[(0,z.jsx)("p",{className:"text-base font-semibold",children:"Learn More"}),(0,z.jsx)("p",{className:"mb-1 text-base",children:"Get the most out of Codeium by going through our interactive tutorial."}),(0,z.jsxs)("button",{onClick:()=>{s()},className:"flex cursor-pointer flex-row items-center justify-start space-x-1 rounded bg-ide-message-block-user-background px-2.5 py-1.5 text-sm text-ide-message-block-user-color opacity-90 hover:opacity-100 disabled:pointer-events-none disabled:opacity-60",children:[(0,z.jsx)("span",{children:"Start Codeium University"}),(0,z.jsx)(sp.RightArrowIcon,{className:"h-3.5 w-3.5"})]})]}),n&&(0,z.jsxs)("div",{className:"rounded bg-ide-tooltip-background p-4 text-ide-tooltip-color",children:[(0,z.jsx)("h6",{className:"text-sm font-semibold uppercase opacity-70",children:"Did you know"}),(0,z.jsxs)("div",{className:"mt-1 items-center justify-start",children:[(0,z.jsx)("span",{className:"text-base",children:"Use"}),(0,z.jsx)("span",{className:"bg-editor-content mx-1 rounded bg-ide-active-selection-background px-2 py-1 font-mono text-sm text-ide-active-selection-color",children:i}),(0,z.jsx)("span",{className:"text-base",children:n.label})]}),(0,z.jsxs)("div",{className:"mt-6 flex flex-row justify-between",children:[(0,z.jsxs)("div",{className:"cursor-pointer text-sm font-semibold opacity-70 hover:underline",onClick:()=>{let e=t&&sh[t],s=[...e||[],...sx];if(!n)return;let a=(n.index-1+s.length)%s.length;r({...s[a],index:a})},children:[" ","Previous tip"," "]}),(0,z.jsxs)("div",{className:"cursor-pointer text-sm font-semibold opacity-70 hover:underline",onClick:()=>{let e=t&&sh[t],s=[...e||[],...sx];if(!n)return;let a=(n.index+1)%s.length;r({...s[a],index:a})},children:[" ","Next tip"," "]})]})]})]})},useChatAutoScroll=e=>{let{scrollRef:t,containerRef:s}=e,[a,n]=(0,X.useState)(0),r=(0,X.useCallback)(e=>{if(!t.current||!s.current)return;let a=t.current.clientHeight,r=e.getBoundingClientRect().top-s.current.getBoundingClientRect().top,o=r+a;s.current.style.minHeight="".concat(o,"px"),n(o)},[s,t]),o=(0,X.useCallback)(()=>{s.current&&(s.current.style.removeProperty("min-height"),t.current&&t.current.scrollTo({top:s.current.scrollHeight,behavior:"instant"}))},[s,t]);return(0,X.useEffect)(()=>{s.current&&s.current.style.removeProperty("min-height")},[s]),(0,X.useEffect)(()=>{t.current&&t.current.scrollTo({top:a,behavior:"smooth"})},[a,t]),{triggerScroll:r,resetScroll:o}},UnauthedPanel=e=>{let{handleLogin:t,handleReload:s}=e;return t||s?(0,z.jsx)("div",{className:"mx-4 flex flex-col flex-col space-y-4 p-3",children:(0,z.jsxs)("div",{className:"flex flex-col rounded bg-ide-tooltip-background p-4",children:[(0,z.jsx)("h6",{className:"font-semibold",children:" Log in to start using Codeium "}),s&&(0,z.jsx)("div",{className:"text-sm opacity-80",children:"If you have already logged in to Codeium, please reload."}),(0,z.jsxs)("div",{className:"mt-2 flex flex-row",children:[t&&(0,z.jsx)(su.Button,{color:"primary",onClick:t,size:"small",className:"mr-2",children:"Login"}),s&&(0,z.jsx)(su.Button,{color:"gray",onClick:s,size:"small",children:"Reload"})]})]})}):(0,z.jsx)("div",{className:"flex h-full w-full flex-col items-center justify-center",children:"Click on Codeium in the status bar to get set up"})};var sg=s(869),sf=s(18647);let PendingConnectionView=()=>{let{error:e,status:t,props:{handleReload:s}}=useServerConnectionContext(),{ready:a,hasEnterpriseExtension:n}=useChatParamsContext(),{copyDiagnostics:r}=useDebuggingContext(),[o,i]=(0,X.useState)(!1),[l,c]=(0,X.useState)(!1),d=(0,X.useMemo)(()=>{if(!a)return"Getting ready...";switch(t){case I.DISCONNECTED:return"Initializing...";case I.CONNECTING:case I.CONNECTED:return"Connecting...";case I.READY:return"Ready"}},[t,a]);(0,X.useEffect)(()=>{let e=setTimeout(()=>{i(!0)},1e3),t=setTimeout(()=>{c(!0)},2e3);return()=>{clearTimeout(e),clearTimeout(t)}},[]);let u=null==e?void 0:e.message;return n&&(null==e?void 0:e.message.includes("user is disabled by team"))&&(u="[permission_denied] User is not authorized to access Codeium. Please refer to your company-specific resources for instructions to request a license."),(o||e)&&(0,z.jsx)("div",{className:"mx-4 flex flex-col flex-col space-y-4 p-3",children:l&&e?(0,z.jsx)(sf.Alert,{type:"error",title:"Connection Error",message:(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)("h6",{className:"text-lg font-bold",children:u}),(0,z.jsxs)("p",{className:"text-sm",children:["If this problem persists, click here to"," ",(0,z.jsx)("a",{onClick:r,className:"cursor-pointer underline",children:"download diagnostics"})," ","and send it to us."]})]})}):(0,z.jsxs)("div",{className:"flex flex-col rounded bg-ide-tooltip-background p-4",children:[(0,z.jsx)("h6",{className:"text-ide-editor-color",children:d}),(0,z.jsx)("div",{className:"mt-1 flex flex-row",children:(0,z.jsx)(sg.ActionButton,{label:"Reload",successLabel:"Reloading...",onClick:s,size:"small"})})]})})},ChatView=()=>{let{userStatusError:e,isInitialized:t,conversationID:s,state:{messages:a,isReceivingMessage:n},clearHistory:r,isChatEnabled:o,handshake:i,props:{handleLogin:l,handleReload:c},pinnedSystemFeedback:d}=useServerConnectionContext(),u=(0,X.useRef)(null),m=(0,X.useRef)(null),{ideName:p,ready:x,apiKey:h,hasEnterpriseExtension:g}=useChatParamsContext(),f=x&&!h||"vscode"===p&&(null==e?void 0:e.message)&&e.message.includes("sign in to Codeium"),y=(0,X.useRef)(null),[v,C]=(0,X.useState)(!0),{resetScroll:w,triggerScroll:b}=useChatAutoScroll({scrollRef:u,containerRef:m}),N=(0,X.useRef)([]),S=(0,X.useCallback)(()=>{y.current&&y.current.scrollIntoView({behavior:"smooth"})},[]),j=(0,X.useMemo)(()=>(null==i?void 0:i.userStatus)?getChatTokensSoftLimit(i.userStatus):0,[null==i?void 0:i.userStatus]),E=(0,X.useMemo)(()=>{try{let e=[],t=[...a].reverse(),r=getConversationTruncationIndex(t,j);return t.filter((e,t)=>{var a;return(null===(a=e.message)||void 0===a?void 0:a.conversationId)===s&&("status"!==e.message.content.case||0===t&&n)}).forEach((t,s)=>{var a,n,o;let i=null!==r&&r<=s;i&&r===s&&e.push((0,z.jsxs)("div",{className:"my-2 flex w-full flex-row items-center justify-center gap-x-2 py-4",ref:y,children:[(0,z.jsx)("div",{className:"grow border-b border-white"}),(0,z.jsx)("p",{className:"shrink-0 grow-0",children:"Chats above this truncated"}),(0,z.jsx)("div",{className:"grow border-b border-white"})]},"message-limit-truncation")),e.push((0,z.jsx)("div",{ref:e=>N.current[s]=e,"data-type":null===(a=t.message)||void 0===a?void 0:a.content.case,children:(0,z.jsx)(ChatMessageBlock,{chat:t,isIgnoredInHistory:i,scrollToCutOff:S,showContextWarning:null!==r},(null===(n=t.message)||void 0===n?void 0:n.messageId)||"NA")},(null===(o=t.message)||void 0===o?void 0:o.messageId)||"NA"))}),e.reverse()}catch(e){console.error(e),r()}},[r,s,S,a,n,j]);(0,X.useEffect)(()=>{w()},[s,w]),(0,X.useEffect)(()=>{(null==d?void 0:d.payload.case)==="error"&&w()},[d,w]),(0,X.useEffect)(()=>{E&&(N.current=N.current.slice(0,E.length))},[E]);let[I,T]=(0,X.useState)(!t);(0,X.useEffect)(()=>{t?setTimeout(()=>{T(!1)},200):T(!0)},[t]),(0,X.useEffect)(()=>{if(n&&E){let t=null;for(let s=0;s<2;s++){var e;if(N.current[s]&&(null===(e=N.current[s])||void 0===e?void 0:e.getAttribute("data-type"))==="intent"){t=N.current[s];break}}t&&b(t)}},[n]);let k=(0,X.useCallback)(e=>{if(!u.current||!m.current)return;let t=e.currentTarget.scrollTop>=m.current.scrollHeight-m.current.clientHeight-100;C(t)},[]),R=(0,X.useCallback)(()=>{u.current&&m.current&&u.current.scrollTo({behavior:"smooth",top:m.current.scrollHeight})},[m,u]),_=0===a.length;return(0,z.jsxs)("main",{className:"relative h-full w-full overflow-y-auto overflow-x-hidden pr-[1px]",children:[t&&(0,z.jsx)(eU.ArrowDownIcon,{className:(0,eG.classNames)("absolute bottom-1 right-1 z-10 h-8 w-8 rounded-full border border-gray-700 bg-black stroke-white stroke-2 p-2 text-xs transition-colors transition-opacity duration-200 ease-in-out hover:border-gray-500",v?"pointer-events-none cursor-default opacity-0":"pointer-events-auto cursor-pointer opacity-100",!v&&n?"animate-bounce animate-pulse":""),onClick:R}),(0,z.jsx)("div",{onScroll:k,ref:u,className:(0,eG.classNames)("relative flex h-full flex-col overflow-y-auto overflow-x-hidden",_?"justify-center":""),children:(0,z.jsxs)("div",{ref:m,children:[(0,z.jsx)("div",{className:(0,eG.classNames)("flex flex-col transition-opacity duration-200 ease-in-out",t?"opacity-100":"opacity-0"),children:o?(0,z.jsx)(z.Fragment,{children:_?(0,z.jsx)(InitMessage,{ideName:p}):E}):(0,z.jsx)(ChatDisabledChecklist,{})}),I&&(0,z.jsx)("div",{className:(0,eG.classNames)("flex flex-col transition-opacity duration-200 ease-in-out",t?"opacity-0":"opacity-100"),children:f?(0,z.jsx)(UnauthedPanel,{handleLogin:l,handleReload:c}):e&&"vscode"===p?(0,z.jsx)(sf.Alert,{type:"error",title:"Error Fetching User Status",message:e.message+(g?"":". Please try signing in again by clicking the account icon on the bottom left. If the issue persists, please check your network connection or contact us at codeium.com/support for further assistance.")}):(0,z.jsx)(PendingConnectionView,{})})]})})]})},UserInfo=()=>{let{handshake:e}=useServerConnectionContext();return(null==e?void 0:e.userStatus)&&e.planInfo?(0,z.jsxs)("div",{className:"",children:[(0,z.jsx)("h6",{className:"flex flex-row items-center justify-start gap-x-1 text-sm font-medium",children:"Profile"}),(0,z.jsxs)("div",{className:"mt-2 flex flex-row",children:[(0,z.jsx)("p",{className:"mr-2 text-sm opacity-80",children:"Email:"}),(0,z.jsx)("p",{className:"col-span-2 text-sm",children:e.userStatus.email})]}),(0,z.jsxs)("div",{className:"mt-2 flex flex-row",children:[(0,z.jsx)("p",{className:"mr-2 text-sm opacity-80",children:"Plan:"}),(0,z.jsx)("p",{className:"col-span-2 text-sm",children:e.planInfo.planName})]})]}):null},DebugPanel=()=>{let{copyDiagnostics:e}=useDebuggingContext();return(0,z.jsxs)("div",{children:[(0,z.jsx)("h6",{className:"flex flex-row items-center justify-start gap-x-1 text-sm font-medium",children:"Extension Diagnostics"}),(0,z.jsxs)("div",{className:"flex flex-col items-start gap-2",children:[(0,z.jsx)("p",{className:"mt-2 flex-grow text-sm opacity-80",children:"If you are having difficulty using Codeium, please download the extension diagnostics and reach out to our team."}),(0,z.jsx)("div",{tabIndex:0,onClick:e,className:"cursor-pointer text-sm underline hover:opacity-80",children:"Download"})]})]})};var sy=s(62145);let sv={label:"Default",value:et.hhp.DEFAULT},sC={label:"Slow",value:et.hhp.SLOW},sw={label:"Fast",value:et.hhp.FAST},sb=[sC,sv,sw],AutocompleteSpeedSelector=()=>{let{state:{userSettings:e},updateUserSettings:t,handshake:s}=useServerConnectionContext(),a=(0,X.useMemo)(()=>{var e;return!!(null==s?void 0:null===(e=s.planInfo)||void 0===e?void 0:e.hasAutocompleteFastMode)},[s]),n=(0,X.useMemo)(()=>a?sb:sb.filter(e=>e.value!==et.hhp.FAST),[a]),r=(0,X.useMemo)(()=>a||e.autocompleteSpeed!==et.hhp.FAST?e.autocompleteSpeed===et.hhp.UNSPECIFIED?a?sw:sv:n.find(t=>t.value===e.autocompleteSpeed):sv,[e.autocompleteSpeed,a,n]);return(0,z.jsxs)("div",{className:"my-2 flex flex-row items-center justify-between",children:[(0,z.jsxs)("label",{className:"flex flex-row items-center justify-start gap-x-1 text-base text-sm",children:[(0,z.jsx)("span",{className:"opacity-80",children:" Autocomplete Speed"}),(0,z.jsx)("span",{className:"rounded-full border border-brand-dark px-2 text-sm font-bold text-brand-dark opacity-80",children:"Beta"}),(0,z.jsx)(tp.InfoIcon,{fill:"currentColor",className:"h-3.5 w-3.5","data-tooltip-id":"autocomplete-speed-tooltip"}),(0,z.jsx)(e7.u,{id:"autocomplete-speed-tooltip",positionStrategy:"fixed",className:"max-w-[350px] !bg-ide-editor-background !text-ide-editor-color",opacity:"1",border:"1px solid var(--codeium-tooltip-color, rgb(255, 255, 255))",children:'When set to "Slow", autocompletion suggestions will display slower; when set to "Fast", autocompletion suggestions will display faster.'})]}),(0,z.jsx)("select",{className:"my-1 max-w-[200px] rounded border border-gray-500/40 bg-ide-editor-background bg-right px-2 py-0.5 pr-6 text-[14px] text-xs text-ide-editor-color",placeholder:"Autocomplete Speed",value:null==r?void 0:r.value,onChange:s=>{let a=e.clone();a.autocompleteSpeed=Number(s.target.value),t(a)},children:n.map(e=>(0,z.jsx)("option",{value:e.value,children:e.label},e.value))})]})},sN={label:"Default",value:et.Bf8.DEFAULT},sS=[{label:"Small",value:et.Bf8.SMALL},sN,{label:"Large",value:et.Bf8.LARGE}],UserSettings=()=>{var e;let{state:{userSettings:t},updateUserSettings:s,handshake:a}=useServerConnectionContext(),{ideName:n}=useChatParamsContext(),r="vscode"===n||"jetbrains"===n||"visual_studio"===n||"windsurf"===n,o=[{label:"Auto (".concat(r?"default":"disabled",")"),value:et.Bvo.AUTO,optionDisabled:!r},{label:"Dark",value:et.Bvo.DARK},{label:"Light",value:et.Bvo.LIGHT}],i=t.themePreference===et.Bvo.UNSPECIFIED?r?o[0]:o[1]:o.find(e=>e.value===t.themePreference),l=t.fontSize===et.Bf8.UNSPECIFIED?sN:sS.find(e=>e.value===t.fontSize),c=(null==a?void 0:null===(e=a.planInfo)||void 0===e?void 0:e.allowStickyPremiumModels)===!0,d=t.rememberLastModelSelection===et.kZq.DISABLED;return(0,z.jsxs)("div",{children:[(0,z.jsx)("h6",{className:"mt-4 flex flex-row items-center justify-start gap-x-1 text-sm font-medium",children:"User Settings"}),(0,z.jsxs)("div",{className:"mt-2 flex flex-row items-center justify-between gap-x-2",children:[(0,z.jsx)("label",{className:"text-sm opacity-80",children:"Opens most recent conversation on chat panel open"}),(0,z.jsx)(sy.Toggle,{value:t.openMostRecentChatConversation,onChange:e=>{let a=t.clone();a.openMostRecentChatConversation=e,s(a)},name:"openMostRecentChatConversation"})]}),(0,z.jsxs)("div",{className:"mt-2 flex flex-row items-center justify-between gap-x-2",children:[(0,z.jsxs)("label",{className:"flex flex-row items-center justify-start gap-x-1 text-sm opacity-80",children:["Remember last model selection",(0,z.jsx)(tp.InfoIcon,{fill:"currentColor",className:"h-3.5 w-3.5","data-tooltip-id":"remember-model-selection-tooltip"}),(0,z.jsx)(e7.u,{id:"remember-model-selection-tooltip",positionStrategy:"fixed",className:"max-w-[350px] bg-ide-tooltip-background text-ide-tooltip-color",border:"1px solid var(--codeium-tooltip-color, rgb(255, 255, 255))",children:"When enabled, the last model selection will be remembered across sessions. Upgrade to Pro for access."})]}),(0,z.jsx)(sy.Toggle,{value:c&&!d,onChange:e=>{var n;let r=t.clone();(null==a?void 0:null===(n=a.planInfo)||void 0===n?void 0:n.allowStickyPremiumModels)?(r.rememberLastModelSelection=e?et.kZq.ENABLED:et.kZq.DISABLED,e||(r.lastSelectedModel=et.Hnr.MODEL_CLAUDE_3_5_SONNET_20240620)):r.rememberLastModelSelection=et.kZq.UNSPECIFIED,s(r)},name:"rememberLastModelSelection"})]}),(0,z.jsxs)("div",{className:"my-2 flex flex-row items-center justify-between",children:[(0,z.jsxs)("label",{className:"flex flex-row items-center justify-start gap-x-1 text-base text-sm",children:[(0,z.jsx)("span",{className:"opacity-80",children:"Theme Preference"}),(0,z.jsx)(tp.InfoIcon,{fill:"currentColor",className:"h-3.5 w-3.5","data-tooltip-id":"theme-preference-tooltip"}),(0,z.jsx)(e7.u,{id:"theme-preference-tooltip",positionStrategy:"fixed",className:"max-w-[350px] !bg-ide-editor-background !text-ide-editor-color",opacity:"1",border:"1px solid var(--codeium-tooltip-color, rgb(255, 255, 255))",children:'When set to "Auto", the theme will be auto-detected based on the IDE. This is only available on VS Code, JetBrains IDEs, and Visual Studio with more coming soon.'})]}),(0,z.jsx)("select",{className:"my-1 max-w-[200px] rounded border border-gray-500/40 bg-ide-editor-background bg-right px-2 py-0.5 pr-6 text-[14px] text-xs text-ide-editor-color",placeholder:"Theme Preference",value:null==i?void 0:i.value,onChange:e=>{let a=t.clone();a.themePreference=Number(e.currentTarget.value),s(a)},children:o.map(e=>(0,z.jsx)("option",{value:e.value,disabled:e.optionDisabled,children:e.label},e.value))})]}),(0,z.jsxs)("div",{className:"my-2 flex flex-row items-center justify-between",children:[(0,z.jsxs)("label",{className:"flex flex-row items-center justify-start gap-x-1 text-sm",children:[(0,z.jsx)("span",{className:"opacity-80",children:"Font Size"}),(0,z.jsx)(tp.InfoIcon,{fill:"currentColor",className:"h-3.5 w-3.5","data-tooltip-id":"font-size-tooltip"}),(0,z.jsx)(e7.u,{id:"font-size-tooltip",positionStrategy:"fixed",className:"max-w-[350px] !bg-ide-editor-background !text-ide-editor-color",opacity:"1",border:"1px solid var(--codeium-tooltip-color, rgb(255, 255, 255))",children:"Change the font size of the chat panel."})]}),(0,z.jsx)("select",{className:"my-1 max-w-[200px] rounded border border-gray-500/40 bg-ide-editor-background bg-right px-2 py-0.5 pr-6 text-[14px] text-xs text-ide-editor-color",placeholder:"Font Size",value:null==l?void 0:l.value,onChange:e=>{let a=t.clone();a.fontSize=Number(e.target.value),s(a)},children:sS.map(e=>(0,z.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,z.jsx)(AutocompleteSpeedSelector,{})]})};var sj=s(69794),sE=s(54699);(m=L||(L={}))[m.UNSPECIFIED=0]="UNSPECIFIED",m[m.USER_DATA=1]="USER_DATA",m[m.CHAT_DATA=2]="CHAT_DATA",m[m.COMMAND_DATA=3]="COMMAND_DATA",m[m.CASCADE_DATA=4]="CASCADE_DATA",m[m.PCW_DATA=5]="PCW_DATA",en.w.util.setEnumType(L,"exa.user_analytics_pb.QueryDataSource",[{no:0,name:"QUERY_DATA_SOURCE_UNSPECIFIED"},{no:1,name:"QUERY_DATA_SOURCE_USER_DATA"},{no:2,name:"QUERY_DATA_SOURCE_CHAT_DATA"},{no:3,name:"QUERY_DATA_SOURCE_COMMAND_DATA"},{no:4,name:"QUERY_DATA_SOURCE_CASCADE_DATA"},{no:5,name:"QUERY_DATA_SOURCE_PCW_DATA"}]),(p=O||(O={}))[p.UNSPECIFIED=0]="UNSPECIFIED",p[p.COUNT=1]="COUNT",p[p.SUM=2]="SUM",p[p.AVG=3]="AVG",p[p.MAX=4]="MAX",p[p.MIN=5]="MIN",en.w.util.setEnumType(O,"exa.user_analytics_pb.QueryAggregation",[{no:0,name:"QUERY_AGGREGATION_UNSPECIFIED"},{no:1,name:"QUERY_AGGREGATION_COUNT"},{no:2,name:"QUERY_AGGREGATION_SUM"},{no:3,name:"QUERY_AGGREGATION_AVG"},{no:4,name:"QUERY_AGGREGATION_MAX"},{no:5,name:"QUERY_AGGREGATION_MIN"}]),(x=F||(F={}))[x.UNSPECIFIED=0]="UNSPECIFIED",x[x.EQUAL=1]="EQUAL",x[x.NOT_EQUAL=2]="NOT_EQUAL",x[x.GREATER_THAN=3]="GREATER_THAN",x[x.LESS_THAN=4]="LESS_THAN",x[x.GE=5]="GE",x[x.LE=6]="LE",en.w.util.setEnumType(F,"exa.user_analytics_pb.QueryFilter",[{no:0,name:"QUERY_FILTER_UNSPECIFIED"},{no:1,name:"QUERY_FILTER_EQUAL"},{no:2,name:"QUERY_FILTER_NOT_EQUAL"},{no:3,name:"QUERY_FILTER_GREATER_THAN"},{no:4,name:"QUERY_FILTER_LESS_THAN"},{no:5,name:"QUERY_FILTER_GE"},{no:6,name:"QUERY_FILTER_LE"}]);let QuerySelectionField=class QuerySelectionField extends er.v{static fromBinary(e,t){return new QuerySelectionField().fromBinary(e,t)}static fromJson(e,t){return new QuerySelectionField().fromJson(e,t)}static fromJsonString(e,t){return new QuerySelectionField().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(QuerySelectionField,e,t)}constructor(e){super(),this.aggregationFunction=0,this.field="",this.name="",en.w.util.initPartial(e,this)}};QuerySelectionField.runtime=en.w,QuerySelectionField.typeName="exa.user_analytics_pb.QuerySelectionField",QuerySelectionField.fields=en.w.util.newFieldList(()=>[{no:1,name:"aggregation_function",kind:"enum",T:en.w.getEnumType(O)},{no:2,name:"field",kind:"scalar",T:9},{no:3,name:"name",kind:"scalar",T:9}]);let QueryFilterField=class QueryFilterField extends er.v{static fromBinary(e,t){return new QueryFilterField().fromBinary(e,t)}static fromJson(e,t){return new QueryFilterField().fromJson(e,t)}static fromJsonString(e,t){return new QueryFilterField().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(QueryFilterField,e,t)}constructor(e){super(),this.filter=0,this.name="",this.value="",en.w.util.initPartial(e,this)}};QueryFilterField.runtime=en.w,QueryFilterField.typeName="exa.user_analytics_pb.QueryFilterField",QueryFilterField.fields=en.w.util.newFieldList(()=>[{no:1,name:"filter",kind:"enum",T:en.w.getEnumType(F)},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"value",kind:"scalar",T:9}]);let QueryAggregationField=class QueryAggregationField extends er.v{static fromBinary(e,t){return new QueryAggregationField().fromBinary(e,t)}static fromJson(e,t){return new QueryAggregationField().fromJson(e,t)}static fromJsonString(e,t){return new QueryAggregationField().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(QueryAggregationField,e,t)}constructor(e){super(),this.field="",this.name="",en.w.util.initPartial(e,this)}};QueryAggregationField.runtime=en.w,QueryAggregationField.typeName="exa.user_analytics_pb.QueryAggregationField",QueryAggregationField.fields=en.w.util.newFieldList(()=>[{no:1,name:"field",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9}]);let QueryOrderField=class QueryOrderField extends er.v{static fromBinary(e,t){return new QueryOrderField().fromBinary(e,t)}static fromJson(e,t){return new QueryOrderField().fromJson(e,t)}static fromJsonString(e,t){return new QueryOrderField().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(QueryOrderField,e,t)}constructor(e){super(),this.ascending=!1,this.name="",en.w.util.initPartial(e,this)}};QueryOrderField.runtime=en.w,QueryOrderField.typeName="exa.user_analytics_pb.QueryOrderField",QueryOrderField.fields=en.w.util.newFieldList(()=>[{no:1,name:"ascending",kind:"scalar",T:8},{no:2,name:"name",kind:"scalar",T:9}]);let CustomQueryRequest=class CustomQueryRequest extends er.v{static fromBinary(e,t){return new CustomQueryRequest().fromBinary(e,t)}static fromJson(e,t){return new CustomQueryRequest().fromJson(e,t)}static fromJsonString(e,t){return new CustomQueryRequest().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(CustomQueryRequest,e,t)}constructor(e){super(),this.dataSource=0,this.selections=[],this.filters=[],this.aggregations=[],this.orderings=[],this.useRealApiKey=!1,en.w.util.initPartial(e,this)}};CustomQueryRequest.runtime=en.w,CustomQueryRequest.typeName="exa.user_analytics_pb.CustomQueryRequest",CustomQueryRequest.fields=en.w.util.newFieldList(()=>[{no:1,name:"data_source",kind:"enum",T:en.w.getEnumType(L)},{no:2,name:"selections",kind:"message",T:QuerySelectionField,repeated:!0},{no:3,name:"filters",kind:"message",T:QueryFilterField,repeated:!0},{no:5,name:"aggregations",kind:"message",T:QueryAggregationField,repeated:!0},{no:4,name:"orderings",kind:"message",T:QueryOrderField,repeated:!0},{no:6,name:"use_real_api_key",kind:"scalar",T:8}]);let QueryResponseItem=class QueryResponseItem extends er.v{static fromBinary(e,t){return new QueryResponseItem().fromBinary(e,t)}static fromJson(e,t){return new QueryResponseItem().fromJson(e,t)}static fromJsonString(e,t){return new QueryResponseItem().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(QueryResponseItem,e,t)}constructor(e){super(),this.item={},en.w.util.initPartial(e,this)}};QueryResponseItem.runtime=en.w,QueryResponseItem.typeName="exa.user_analytics_pb.QueryResponseItem",QueryResponseItem.fields=en.w.util.newFieldList(()=>[{no:1,name:"item",kind:"map",K:9,V:{kind:"scalar",T:9}}]);let CustomQueryResponse=class CustomQueryResponse extends er.v{static fromBinary(e,t){return new CustomQueryResponse().fromBinary(e,t)}static fromJson(e,t){return new CustomQueryResponse().fromJson(e,t)}static fromJsonString(e,t){return new CustomQueryResponse().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(CustomQueryResponse,e,t)}constructor(e){super(),this.responseItems=[],en.w.util.initPartial(e,this)}};CustomQueryResponse.runtime=en.w,CustomQueryResponse.typeName="exa.user_analytics_pb.CustomQueryResponse",CustomQueryResponse.fields=en.w.util.newFieldList(()=>[{no:1,name:"response_items",kind:"message",T:QueryResponseItem,repeated:!0}]);let GetAnalyticsRequest=class GetAnalyticsRequest extends er.v{static fromBinary(e,t){return new GetAnalyticsRequest().fromBinary(e,t)}static fromJson(e,t){return new GetAnalyticsRequest().fromJson(e,t)}static fromJsonString(e,t){return new GetAnalyticsRequest().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(GetAnalyticsRequest,e,t)}constructor(e){super(),this.queryRequests=[],this.apiKey="",this.groupId="",en.w.util.initPartial(e,this)}};GetAnalyticsRequest.runtime=en.w,GetAnalyticsRequest.typeName="exa.user_analytics_pb.GetAnalyticsRequest",GetAnalyticsRequest.fields=en.w.util.newFieldList(()=>[{no:2,name:"query_requests",kind:"message",T:QueryRequest,repeated:!0},{no:3,name:"start_timestamp",kind:"message",T:ea.E},{no:4,name:"end_timestamp",kind:"message",T:ea.E},{no:5,name:"api_key",kind:"scalar",T:9},{no:6,name:"group_id",kind:"scalar",T:9}]);let GetAnalyticsResponse=class GetAnalyticsResponse extends er.v{static fromBinary(e,t){return new GetAnalyticsResponse().fromBinary(e,t)}static fromJson(e,t){return new GetAnalyticsResponse().fromJson(e,t)}static fromJsonString(e,t){return new GetAnalyticsResponse().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(GetAnalyticsResponse,e,t)}constructor(e){super(),this.queryResults=[],en.w.util.initPartial(e,this)}};GetAnalyticsResponse.runtime=en.w,GetAnalyticsResponse.typeName="exa.user_analytics_pb.GetAnalyticsResponse",GetAnalyticsResponse.fields=en.w.util.newFieldList(()=>[{no:1,name:"query_results",kind:"message",T:QueryResult,repeated:!0}]);let AnalyticsRequest=class AnalyticsRequest extends er.v{static fromBinary(e,t){return new AnalyticsRequest().fromBinary(e,t)}static fromJson(e,t){return new AnalyticsRequest().fromJson(e,t)}static fromJsonString(e,t){return new AnalyticsRequest().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(AnalyticsRequest,e,t)}constructor(e){super(),this.queryRequests=[],this.serviceKey="",this.groupName="",en.w.util.initPartial(e,this)}};AnalyticsRequest.runtime=en.w,AnalyticsRequest.typeName="exa.user_analytics_pb.AnalyticsRequest",AnalyticsRequest.fields=en.w.util.newFieldList(()=>[{no:1,name:"query_requests",kind:"message",T:CustomQueryRequest,repeated:!0},{no:2,name:"service_key",kind:"scalar",T:9},{no:3,name:"group_name",kind:"scalar",T:9},{no:4,name:"start_timestamp",kind:"message",T:ea.E},{no:5,name:"end_timestamp",kind:"message",T:ea.E}]);let AnalyticsResponse=class AnalyticsResponse extends er.v{static fromBinary(e,t){return new AnalyticsResponse().fromBinary(e,t)}static fromJson(e,t){return new AnalyticsResponse().fromJson(e,t)}static fromJsonString(e,t){return new AnalyticsResponse().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(AnalyticsResponse,e,t)}constructor(e){super(),this.queryResults=[],en.w.util.initPartial(e,this)}};AnalyticsResponse.runtime=en.w,AnalyticsResponse.typeName="exa.user_analytics_pb.AnalyticsResponse",AnalyticsResponse.fields=en.w.util.newFieldList(()=>[{no:1,name:"query_results",kind:"message",T:CustomQueryResponse,repeated:!0}]);let UserPageAnalyticsRequest=class UserPageAnalyticsRequest extends er.v{static fromBinary(e,t){return new UserPageAnalyticsRequest().fromBinary(e,t)}static fromJson(e,t){return new UserPageAnalyticsRequest().fromJson(e,t)}static fromJsonString(e,t){return new UserPageAnalyticsRequest().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(UserPageAnalyticsRequest,e,t)}constructor(e){super(),this.serviceKey="",this.groupName="",en.w.util.initPartial(e,this)}};UserPageAnalyticsRequest.runtime=en.w,UserPageAnalyticsRequest.typeName="exa.user_analytics_pb.UserPageAnalyticsRequest",UserPageAnalyticsRequest.fields=en.w.util.newFieldList(()=>[{no:1,name:"service_key",kind:"scalar",T:9},{no:2,name:"group_name",kind:"scalar",T:9},{no:3,name:"start_timestamp",kind:"message",T:ea.E},{no:4,name:"end_timestamp",kind:"message",T:ea.E}]);let UserPageAnalyticsResponse=class UserPageAnalyticsResponse extends er.v{static fromBinary(e,t){return new UserPageAnalyticsResponse().fromBinary(e,t)}static fromJson(e,t){return new UserPageAnalyticsResponse().fromJson(e,t)}static fromJsonString(e,t){return new UserPageAnalyticsResponse().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(UserPageAnalyticsResponse,e,t)}constructor(e){super(),this.userTableStats=[],en.w.util.initPartial(e,this)}};UserPageAnalyticsResponse.runtime=en.w,UserPageAnalyticsResponse.typeName="exa.user_analytics_pb.UserPageAnalyticsResponse",UserPageAnalyticsResponse.fields=en.w.util.newFieldList(()=>[{no:1,name:"user_table_stats",kind:"message",T:et.jCT,repeated:!0}]);let GetPublicAnalyticsRequest=class GetPublicAnalyticsRequest extends er.v{static fromBinary(e,t){return new GetPublicAnalyticsRequest().fromBinary(e,t)}static fromJson(e,t){return new GetPublicAnalyticsRequest().fromJson(e,t)}static fromJsonString(e,t){return new GetPublicAnalyticsRequest().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(GetPublicAnalyticsRequest,e,t)}constructor(e){super(),this.username="",this.queryRequests=[],en.w.util.initPartial(e,this)}};GetPublicAnalyticsRequest.runtime=en.w,GetPublicAnalyticsRequest.typeName="exa.user_analytics_pb.GetPublicAnalyticsRequest",GetPublicAnalyticsRequest.fields=en.w.util.newFieldList(()=>[{no:1,name:"username",kind:"scalar",T:9},{no:2,name:"query_requests",kind:"message",T:QueryRequest,repeated:!0},{no:3,name:"start_timestamp",kind:"message",T:ea.E},{no:4,name:"end_timestamp",kind:"message",T:ea.E}]);let GetPublicAnalyticsResponse=class GetPublicAnalyticsResponse extends er.v{static fromBinary(e,t){return new GetPublicAnalyticsResponse().fromBinary(e,t)}static fromJson(e,t){return new GetPublicAnalyticsResponse().fromJson(e,t)}static fromJsonString(e,t){return new GetPublicAnalyticsResponse().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(GetPublicAnalyticsResponse,e,t)}constructor(e){super(),this.queryResults=[],en.w.util.initPartial(e,this)}};GetPublicAnalyticsResponse.runtime=en.w,GetPublicAnalyticsResponse.typeName="exa.user_analytics_pb.GetPublicAnalyticsResponse",GetPublicAnalyticsResponse.fields=en.w.util.newFieldList(()=>[{no:1,name:"query_results",kind:"message",T:QueryResult,repeated:!0}]);let QueryRequest=class QueryRequest extends er.v{static fromBinary(e,t){return new QueryRequest().fromBinary(e,t)}static fromJson(e,t){return new QueryRequest().fromJson(e,t)}static fromJsonString(e,t){return new QueryRequest().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(QueryRequest,e,t)}constructor(e){super(),this.requestType={case:void 0},en.w.util.initPartial(e,this)}};QueryRequest.runtime=en.w,QueryRequest.typeName="exa.user_analytics_pb.QueryRequest",QueryRequest.fields=en.w.util.newFieldList(()=>[{no:1,name:"completion_stats",kind:"message",T:QueryRequestCompletionStats,oneof:"request_type"},{no:2,name:"completions_by_day",kind:"message",T:QueryRequestCompletionsByDay,oneof:"request_type"},{no:3,name:"completions_by_language",kind:"message",T:QueryRequestCompletionsByLanguage,oneof:"request_type"},{no:4,name:"all_users_completion_stats",kind:"message",T:QueryRequestAllUsersCompletionStats,oneof:"request_type"},{no:5,name:"all_users_completions_by_day",kind:"message",T:QueryRequestAllUsersCompletionsByDay,oneof:"request_type"},{no:6,name:"all_users_completions_by_language",kind:"message",T:QueryRequestAllUsersCompletionsByLanguage,oneof:"request_type"},{no:7,name:"completions_by_ide",kind:"message",T:QueryRequestCompletionsByIde,oneof:"request_type"},{no:8,name:"all_users_completions_by_ide",kind:"message",T:QueryRequestCompletionsByIde,oneof:"request_type"},{no:9,name:"completions_by_api_key",kind:"message",T:QueryRequestCompletionsByApiKey,oneof:"request_type"},{no:19,name:"completions_by_repository",kind:"message",T:QueryRequestCompletionsByRepository,oneof:"request_type"},{no:10,name:"chats_by_day",kind:"message",T:QueryRequestChatsByDay,oneof:"request_type"},{no:11,name:"all_users_chats_by_day",kind:"message",T:QueryRequestAllChatsByDay,oneof:"request_type"},{no:12,name:"chats_by_model",kind:"message",T:QueryRequestChatStatsByModel,oneof:"request_type"},{no:13,name:"all_users_chats_by_model",kind:"message",T:QueryRequestAllChatStatsByModel,oneof:"request_type"},{no:14,name:"active_user_count",kind:"message",T:QueryRequestActiveUserCount,oneof:"request_type"},{no:15,name:"percent_code_written",kind:"message",T:QueryRequestPercentCodeWritten,oneof:"request_type"},{no:16,name:"chars_per_opportunity",kind:"message",T:QueryRequestCharsPerOpportunity,oneof:"request_type"},{no:17,name:"chat_stats",kind:"message",T:QueryRequestChatStats,oneof:"request_type"},{no:18,name:"active_days_by_api_key",kind:"message",T:QueryRequestActiveDaysByApiKey,oneof:"request_type"},{no:20,name:"command_stats",kind:"message",T:QueryRequestCommandStats,oneof:"request_type"},{no:21,name:"custom_query",kind:"message",T:CustomQueryRequest,oneof:"request_type"},{no:22,name:"user_page_analytics",kind:"message",T:UserPageAnalyticsRequest,oneof:"request_type"}]);let QueryResult=class QueryResult extends er.v{static fromBinary(e,t){return new QueryResult().fromBinary(e,t)}static fromJson(e,t){return new QueryResult().fromJson(e,t)}static fromJsonString(e,t){return new QueryResult().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(QueryResult,e,t)}constructor(e){super(),this.resultType={case:void 0},en.w.util.initPartial(e,this)}};QueryResult.runtime=en.w,QueryResult.typeName="exa.user_analytics_pb.QueryResult",QueryResult.fields=en.w.util.newFieldList(()=>[{no:1,name:"completion_stats",kind:"message",T:QueryResultCompletionStats,oneof:"result_type"},{no:2,name:"completions_by_day",kind:"message",T:QueryResultCompletionsByDay,oneof:"result_type"},{no:3,name:"completions_by_language",kind:"message",T:QueryResultCompletionsByLanguage,oneof:"result_type"},{no:4,name:"completions_by_ide",kind:"message",T:QueryResultCompletionsByIde,oneof:"result_type"},{no:5,name:"completions_by_api_key",kind:"message",T:QueryResultCompletionsByApiKey,oneof:"result_type"},{no:13,name:"completions_by_repository",kind:"message",T:QueryResultCompletionsByRepository,oneof:"result_type"},{no:6,name:"chats_by_day",kind:"message",T:QueryResultChatsByDay,oneof:"result_type"},{no:7,name:"chats_by_model",kind:"message",T:QueryResultChatStatsByModel,oneof:"result_type"},{no:8,name:"active_user_count",kind:"message",T:QueryResultActiveUserCount,oneof:"result_type"},{no:9,name:"percent_code_written",kind:"message",T:QueryResultPercentCodeWritten,oneof:"result_type"},{no:10,name:"chars_per_opportunity",kind:"message",T:QueryResultCharsPerOpportunity,oneof:"result_type"},{no:11,name:"chat_stats",kind:"message",T:QueryResultChatStats,oneof:"result_type"},{no:12,name:"active_days_by_api_key",kind:"message",T:QueryResultActiveDaysByApiKey,oneof:"result_type"},{no:14,name:"error",kind:"message",T:QueryResultError,oneof:"result_type"},{no:15,name:"command_stats",kind:"message",T:QueryResultCommandStats,oneof:"result_type"},{no:16,name:"custom_stats",kind:"message",T:CustomQueryResponse,oneof:"result_type"},{no:17,name:"user_page_analytics",kind:"message",T:UserPageAnalyticsResponse,oneof:"result_type"}]);let QueryRequestCompletionStats=class QueryRequestCompletionStats extends er.v{static fromBinary(e,t){return new QueryRequestCompletionStats().fromBinary(e,t)}static fromJson(e,t){return new QueryRequestCompletionStats().fromJson(e,t)}static fromJsonString(e,t){return new QueryRequestCompletionStats().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(QueryRequestCompletionStats,e,t)}constructor(e){super(),en.w.util.initPartial(e,this)}};QueryRequestCompletionStats.runtime=en.w,QueryRequestCompletionStats.typeName="exa.user_analytics_pb.QueryRequestCompletionStats",QueryRequestCompletionStats.fields=en.w.util.newFieldList(()=>[]);let QueryResultCompletionStats=class QueryResultCompletionStats extends er.v{static fromBinary(e,t){return new QueryResultCompletionStats().fromBinary(e,t)}static fromJson(e,t){return new QueryResultCompletionStats().fromJson(e,t)}static fromJsonString(e,t){return new QueryResultCompletionStats().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(QueryResultCompletionStats,e,t)}constructor(e){super(),en.w.util.initPartial(e,this)}};QueryResultCompletionStats.runtime=en.w,QueryResultCompletionStats.typeName="exa.user_analytics_pb.QueryResultCompletionStats",QueryResultCompletionStats.fields=en.w.util.newFieldList(()=>[{no:1,name:"completion_statistics",kind:"message",T:et.yRI}]);let QueryRequestCompletionsByDay=class QueryRequestCompletionsByDay extends er.v{static fromBinary(e,t){return new QueryRequestCompletionsByDay().fromBinary(e,t)}static fromJson(e,t){return new QueryRequestCompletionsByDay().fromJson(e,t)}static fromJsonString(e,t){return new QueryRequestCompletionsByDay().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(QueryRequestCompletionsByDay,e,t)}constructor(e){super(),this.timeZone="",en.w.util.initPartial(e,this)}};QueryRequestCompletionsByDay.runtime=en.w,QueryRequestCompletionsByDay.typeName="exa.user_analytics_pb.QueryRequestCompletionsByDay",QueryRequestCompletionsByDay.fields=en.w.util.newFieldList(()=>[{no:1,name:"time_zone",kind:"scalar",T:9}]);let QueryResultCompletionsByDay=class QueryResultCompletionsByDay extends er.v{static fromBinary(e,t){return new QueryResultCompletionsByDay().fromBinary(e,t)}static fromJson(e,t){return new QueryResultCompletionsByDay().fromJson(e,t)}static fromJsonString(e,t){return new QueryResultCompletionsByDay().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(QueryResultCompletionsByDay,e,t)}constructor(e){super(),this.completionsByDay=[],en.w.util.initPartial(e,this)}};QueryResultCompletionsByDay.runtime=en.w,QueryResultCompletionsByDay.typeName="exa.user_analytics_pb.QueryResultCompletionsByDay",QueryResultCompletionsByDay.fields=en.w.util.newFieldList(()=>[{no:1,name:"completions_by_day",kind:"message",T:et.kCJ,repeated:!0}]);let QueryRequestCompletionsByLanguage=class QueryRequestCompletionsByLanguage extends er.v{static fromBinary(e,t){return new QueryRequestCompletionsByLanguage().fromBinary(e,t)}static fromJson(e,t){return new QueryRequestCompletionsByLanguage().fromJson(e,t)}static fromJsonString(e,t){return new QueryRequestCompletionsByLanguage().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(QueryRequestCompletionsByLanguage,e,t)}constructor(e){super(),en.w.util.initPartial(e,this)}};QueryRequestCompletionsByLanguage.runtime=en.w,QueryRequestCompletionsByLanguage.typeName="exa.user_analytics_pb.QueryRequestCompletionsByLanguage",QueryRequestCompletionsByLanguage.fields=en.w.util.newFieldList(()=>[]);let QueryResultCompletionsByLanguage=class QueryResultCompletionsByLanguage extends er.v{static fromBinary(e,t){return new QueryResultCompletionsByLanguage().fromBinary(e,t)}static fromJson(e,t){return new QueryResultCompletionsByLanguage().fromJson(e,t)}static fromJsonString(e,t){return new QueryResultCompletionsByLanguage().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(QueryResultCompletionsByLanguage,e,t)}constructor(e){super(),this.completionsByLanguage=[],en.w.util.initPartial(e,this)}};QueryResultCompletionsByLanguage.runtime=en.w,QueryResultCompletionsByLanguage.typeName="exa.user_analytics_pb.QueryResultCompletionsByLanguage",QueryResultCompletionsByLanguage.fields=en.w.util.newFieldList(()=>[{no:1,name:"completions_by_language",kind:"message",T:et.qBR,repeated:!0}]);let QueryRequestCompletionsByIde=class QueryRequestCompletionsByIde extends er.v{static fromBinary(e,t){return new QueryRequestCompletionsByIde().fromBinary(e,t)}static fromJson(e,t){return new QueryRequestCompletionsByIde().fromJson(e,t)}static fromJsonString(e,t){return new QueryRequestCompletionsByIde().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(QueryRequestCompletionsByIde,e,t)}constructor(e){super(),en.w.util.initPartial(e,this)}};QueryRequestCompletionsByIde.runtime=en.w,QueryRequestCompletionsByIde.typeName="exa.user_analytics_pb.QueryRequestCompletionsByIde",QueryRequestCompletionsByIde.fields=en.w.util.newFieldList(()=>[]);let QueryResultCompletionsByIde=class QueryResultCompletionsByIde extends er.v{static fromBinary(e,t){return new QueryResultCompletionsByIde().fromBinary(e,t)}static fromJson(e,t){return new QueryResultCompletionsByIde().fromJson(e,t)}static fromJsonString(e,t){return new QueryResultCompletionsByIde().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(QueryResultCompletionsByIde,e,t)}constructor(e){super(),this.completionsByIde={},en.w.util.initPartial(e,this)}};QueryResultCompletionsByIde.runtime=en.w,QueryResultCompletionsByIde.typeName="exa.user_analytics_pb.QueryResultCompletionsByIde",QueryResultCompletionsByIde.fields=en.w.util.newFieldList(()=>[{no:1,name:"completions_by_ide",kind:"map",K:9,V:{kind:"message",T:et.yRI}}]);let QueryRequestCompletionsByRepository=class QueryRequestCompletionsByRepository extends er.v{static fromBinary(e,t){return new QueryRequestCompletionsByRepository().fromBinary(e,t)}static fromJson(e,t){return new QueryRequestCompletionsByRepository().fromJson(e,t)}static fromJsonString(e,t){return new QueryRequestCompletionsByRepository().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(QueryRequestCompletionsByRepository,e,t)}constructor(e){super(),en.w.util.initPartial(e,this)}};QueryRequestCompletionsByRepository.runtime=en.w,QueryRequestCompletionsByRepository.typeName="exa.user_analytics_pb.QueryRequestCompletionsByRepository",QueryRequestCompletionsByRepository.fields=en.w.util.newFieldList(()=>[]);let QueryResultCompletionsByRepository=class QueryResultCompletionsByRepository extends er.v{static fromBinary(e,t){return new QueryResultCompletionsByRepository().fromBinary(e,t)}static fromJson(e,t){return new QueryResultCompletionsByRepository().fromJson(e,t)}static fromJsonString(e,t){return new QueryResultCompletionsByRepository().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(QueryResultCompletionsByRepository,e,t)}constructor(e){super(),this.completionsByRepository={},en.w.util.initPartial(e,this)}};QueryResultCompletionsByRepository.runtime=en.w,QueryResultCompletionsByRepository.typeName="exa.user_analytics_pb.QueryResultCompletionsByRepository",QueryResultCompletionsByRepository.fields=en.w.util.newFieldList(()=>[{no:1,name:"completions_by_repository",kind:"map",K:9,V:{kind:"message",T:et.yRI}}]);let QueryRequestChatsByDay=class QueryRequestChatsByDay extends er.v{static fromBinary(e,t){return new QueryRequestChatsByDay().fromBinary(e,t)}static fromJson(e,t){return new QueryRequestChatsByDay().fromJson(e,t)}static fromJsonString(e,t){return new QueryRequestChatsByDay().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(QueryRequestChatsByDay,e,t)}constructor(e){super(),this.timeZone="",en.w.util.initPartial(e,this)}};QueryRequestChatsByDay.runtime=en.w,QueryRequestChatsByDay.typeName="exa.user_analytics_pb.QueryRequestChatsByDay",QueryRequestChatsByDay.fields=en.w.util.newFieldList(()=>[{no:1,name:"time_zone",kind:"scalar",T:9}]);let QueryResultChatsByDay=class QueryResultChatsByDay extends er.v{static fromBinary(e,t){return new QueryResultChatsByDay().fromBinary(e,t)}static fromJson(e,t){return new QueryResultChatsByDay().fromJson(e,t)}static fromJsonString(e,t){return new QueryResultChatsByDay().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(QueryResultChatsByDay,e,t)}constructor(e){super(),this.chatsByDay=[],en.w.util.initPartial(e,this)}};QueryResultChatsByDay.runtime=en.w,QueryResultChatsByDay.typeName="exa.user_analytics_pb.QueryResultChatsByDay",QueryResultChatsByDay.fields=en.w.util.newFieldList(()=>[{no:1,name:"chats_by_day",kind:"message",T:et.yUQ,repeated:!0}]);let QueryRequestAllChatsByDay=class QueryRequestAllChatsByDay extends er.v{static fromBinary(e,t){return new QueryRequestAllChatsByDay().fromBinary(e,t)}static fromJson(e,t){return new QueryRequestAllChatsByDay().fromJson(e,t)}static fromJsonString(e,t){return new QueryRequestAllChatsByDay().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(QueryRequestAllChatsByDay,e,t)}constructor(e){super(),this.timeZone="",en.w.util.initPartial(e,this)}};QueryRequestAllChatsByDay.runtime=en.w,QueryRequestAllChatsByDay.typeName="exa.user_analytics_pb.QueryRequestAllChatsByDay",QueryRequestAllChatsByDay.fields=en.w.util.newFieldList(()=>[{no:1,name:"time_zone",kind:"scalar",T:9}]);let QueryRequestActiveUserCount=class QueryRequestActiveUserCount extends er.v{static fromBinary(e,t){return new QueryRequestActiveUserCount().fromBinary(e,t)}static fromJson(e,t){return new QueryRequestActiveUserCount().fromJson(e,t)}static fromJsonString(e,t){return new QueryRequestActiveUserCount().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(QueryRequestActiveUserCount,e,t)}constructor(e){super(),this.timeZone="",en.w.util.initPartial(e,this)}};QueryRequestActiveUserCount.runtime=en.w,QueryRequestActiveUserCount.typeName="exa.user_analytics_pb.QueryRequestActiveUserCount",QueryRequestActiveUserCount.fields=en.w.util.newFieldList(()=>[{no:1,name:"time_zone",kind:"scalar",T:9}]);let QueryRequestChatStatsByModel=class QueryRequestChatStatsByModel extends er.v{static fromBinary(e,t){return new QueryRequestChatStatsByModel().fromBinary(e,t)}static fromJson(e,t){return new QueryRequestChatStatsByModel().fromJson(e,t)}static fromJsonString(e,t){return new QueryRequestChatStatsByModel().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(QueryRequestChatStatsByModel,e,t)}constructor(e){super(),en.w.util.initPartial(e,this)}};QueryRequestChatStatsByModel.runtime=en.w,QueryRequestChatStatsByModel.typeName="exa.user_analytics_pb.QueryRequestChatStatsByModel",QueryRequestChatStatsByModel.fields=en.w.util.newFieldList(()=>[]);let QueryRequestAllChatStatsByModel=class QueryRequestAllChatStatsByModel extends er.v{static fromBinary(e,t){return new QueryRequestAllChatStatsByModel().fromBinary(e,t)}static fromJson(e,t){return new QueryRequestAllChatStatsByModel().fromJson(e,t)}static fromJsonString(e,t){return new QueryRequestAllChatStatsByModel().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(QueryRequestAllChatStatsByModel,e,t)}constructor(e){super(),en.w.util.initPartial(e,this)}};QueryRequestAllChatStatsByModel.runtime=en.w,QueryRequestAllChatStatsByModel.typeName="exa.user_analytics_pb.QueryRequestAllChatStatsByModel",QueryRequestAllChatStatsByModel.fields=en.w.util.newFieldList(()=>[]);let QueryResultChatStatsByModel=class QueryResultChatStatsByModel extends er.v{static fromBinary(e,t){return new QueryResultChatStatsByModel().fromBinary(e,t)}static fromJson(e,t){return new QueryResultChatStatsByModel().fromJson(e,t)}static fromJsonString(e,t){return new QueryResultChatStatsByModel().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(QueryResultChatStatsByModel,e,t)}constructor(e){super(),this.chatsByModel=[],en.w.util.initPartial(e,this)}};QueryResultChatStatsByModel.runtime=en.w,QueryResultChatStatsByModel.typeName="exa.user_analytics_pb.QueryResultChatStatsByModel",QueryResultChatStatsByModel.fields=en.w.util.newFieldList(()=>[{no:1,name:"chats_by_model",kind:"message",T:et.nZ9,repeated:!0}]);let QueryRequestAllUsersCompletionsByDay=class QueryRequestAllUsersCompletionsByDay extends er.v{static fromBinary(e,t){return new QueryRequestAllUsersCompletionsByDay().fromBinary(e,t)}static fromJson(e,t){return new QueryRequestAllUsersCompletionsByDay().fromJson(e,t)}static fromJsonString(e,t){return new QueryRequestAllUsersCompletionsByDay().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(QueryRequestAllUsersCompletionsByDay,e,t)}constructor(e){super(),this.timeZone="",en.w.util.initPartial(e,this)}};QueryRequestAllUsersCompletionsByDay.runtime=en.w,QueryRequestAllUsersCompletionsByDay.typeName="exa.user_analytics_pb.QueryRequestAllUsersCompletionsByDay",QueryRequestAllUsersCompletionsByDay.fields=en.w.util.newFieldList(()=>[{no:1,name:"time_zone",kind:"scalar",T:9}]);let QueryRequestAllUsersCompletionsByLanguage=class QueryRequestAllUsersCompletionsByLanguage extends er.v{static fromBinary(e,t){return new QueryRequestAllUsersCompletionsByLanguage().fromBinary(e,t)}static fromJson(e,t){return new QueryRequestAllUsersCompletionsByLanguage().fromJson(e,t)}static fromJsonString(e,t){return new QueryRequestAllUsersCompletionsByLanguage().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(QueryRequestAllUsersCompletionsByLanguage,e,t)}constructor(e){super(),en.w.util.initPartial(e,this)}};QueryRequestAllUsersCompletionsByLanguage.runtime=en.w,QueryRequestAllUsersCompletionsByLanguage.typeName="exa.user_analytics_pb.QueryRequestAllUsersCompletionsByLanguage",QueryRequestAllUsersCompletionsByLanguage.fields=en.w.util.newFieldList(()=>[]);let QueryRequestAllUsersCompletionStats=class QueryRequestAllUsersCompletionStats extends er.v{static fromBinary(e,t){return new QueryRequestAllUsersCompletionStats().fromBinary(e,t)}static fromJson(e,t){return new QueryRequestAllUsersCompletionStats().fromJson(e,t)}static fromJsonString(e,t){return new QueryRequestAllUsersCompletionStats().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(QueryRequestAllUsersCompletionStats,e,t)}constructor(e){super(),en.w.util.initPartial(e,this)}};QueryRequestAllUsersCompletionStats.runtime=en.w,QueryRequestAllUsersCompletionStats.typeName="exa.user_analytics_pb.QueryRequestAllUsersCompletionStats",QueryRequestAllUsersCompletionStats.fields=en.w.util.newFieldList(()=>[]);let QueryRequestCompletionsByApiKey=class QueryRequestCompletionsByApiKey extends er.v{static fromBinary(e,t){return new QueryRequestCompletionsByApiKey().fromBinary(e,t)}static fromJson(e,t){return new QueryRequestCompletionsByApiKey().fromJson(e,t)}static fromJsonString(e,t){return new QueryRequestCompletionsByApiKey().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(QueryRequestCompletionsByApiKey,e,t)}constructor(e){super(),en.w.util.initPartial(e,this)}};QueryRequestCompletionsByApiKey.runtime=en.w,QueryRequestCompletionsByApiKey.typeName="exa.user_analytics_pb.QueryRequestCompletionsByApiKey",QueryRequestCompletionsByApiKey.fields=en.w.util.newFieldList(()=>[]);let QueryResultCompletionsByApiKey=class QueryResultCompletionsByApiKey extends er.v{static fromBinary(e,t){return new QueryResultCompletionsByApiKey().fromBinary(e,t)}static fromJson(e,t){return new QueryResultCompletionsByApiKey().fromJson(e,t)}static fromJsonString(e,t){return new QueryResultCompletionsByApiKey().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(QueryResultCompletionsByApiKey,e,t)}constructor(e){super(),this.completionsByApiKey={},en.w.util.initPartial(e,this)}};QueryResultCompletionsByApiKey.runtime=en.w,QueryResultCompletionsByApiKey.typeName="exa.user_analytics_pb.QueryResultCompletionsByApiKey",QueryResultCompletionsByApiKey.fields=en.w.util.newFieldList(()=>[{no:1,name:"completions_by_api_key",kind:"map",K:9,V:{kind:"message",T:et.yRI}}]);let QueryResultActiveUserCount=class QueryResultActiveUserCount extends er.v{static fromBinary(e,t){return new QueryResultActiveUserCount().fromBinary(e,t)}static fromJson(e,t){return new QueryResultActiveUserCount().fromJson(e,t)}static fromJsonString(e,t){return new QueryResultActiveUserCount().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(QueryResultActiveUserCount,e,t)}constructor(e){super(),this.activeUserCount=sE.q.zero,en.w.util.initPartial(e,this)}};QueryResultActiveUserCount.runtime=en.w,QueryResultActiveUserCount.typeName="exa.user_analytics_pb.QueryResultActiveUserCount",QueryResultActiveUserCount.fields=en.w.util.newFieldList(()=>[{no:1,name:"active_user_count",kind:"scalar",T:3}]);let QueryRequestPercentCodeWritten=class QueryRequestPercentCodeWritten extends er.v{static fromBinary(e,t){return new QueryRequestPercentCodeWritten().fromBinary(e,t)}static fromJson(e,t){return new QueryRequestPercentCodeWritten().fromJson(e,t)}static fromJsonString(e,t){return new QueryRequestPercentCodeWritten().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(QueryRequestPercentCodeWritten,e,t)}constructor(e){super(),en.w.util.initPartial(e,this)}};QueryRequestPercentCodeWritten.runtime=en.w,QueryRequestPercentCodeWritten.typeName="exa.user_analytics_pb.QueryRequestPercentCodeWritten",QueryRequestPercentCodeWritten.fields=en.w.util.newFieldList(()=>[]);let QueryResultPercentCodeWritten=class QueryResultPercentCodeWritten extends er.v{static fromBinary(e,t){return new QueryResultPercentCodeWritten().fromBinary(e,t)}static fromJson(e,t){return new QueryResultPercentCodeWritten().fromJson(e,t)}static fromJsonString(e,t){return new QueryResultPercentCodeWritten().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(QueryResultPercentCodeWritten,e,t)}constructor(e){super(),this.percentCodeWritten=0,this.codeiumBytesByAutocomplete=sE.q.zero,this.codeiumBytesByCommand=sE.q.zero,this.codeiumBytesBySupercomplete=sE.q.zero,this.userBytes=sE.q.zero,this.codeiumBytes=sE.q.zero,this.totalBytes=sE.q.zero,en.w.util.initPartial(e,this)}};QueryResultPercentCodeWritten.runtime=en.w,QueryResultPercentCodeWritten.typeName="exa.user_analytics_pb.QueryResultPercentCodeWritten",QueryResultPercentCodeWritten.fields=en.w.util.newFieldList(()=>[{no:1,name:"percent_code_written",kind:"scalar",T:1},{no:2,name:"codeium_bytes_by_autocomplete",kind:"scalar",T:3},{no:3,name:"codeium_bytes_by_command",kind:"scalar",T:3},{no:7,name:"codeium_bytes_by_supercomplete",kind:"scalar",T:3},{no:4,name:"user_bytes",kind:"scalar",T:3},{no:5,name:"codeium_bytes",kind:"scalar",T:3},{no:6,name:"total_bytes",kind:"scalar",T:3}]);let QueryRequestCharsPerOpportunity=class QueryRequestCharsPerOpportunity extends er.v{static fromBinary(e,t){return new QueryRequestCharsPerOpportunity().fromBinary(e,t)}static fromJson(e,t){return new QueryRequestCharsPerOpportunity().fromJson(e,t)}static fromJsonString(e,t){return new QueryRequestCharsPerOpportunity().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(QueryRequestCharsPerOpportunity,e,t)}constructor(e){super(),en.w.util.initPartial(e,this)}};QueryRequestCharsPerOpportunity.runtime=en.w,QueryRequestCharsPerOpportunity.typeName="exa.user_analytics_pb.QueryRequestCharsPerOpportunity",QueryRequestCharsPerOpportunity.fields=en.w.util.newFieldList(()=>[]);let QueryResultCharsPerOpportunity=class QueryResultCharsPerOpportunity extends er.v{static fromBinary(e,t){return new QueryResultCharsPerOpportunity().fromBinary(e,t)}static fromJson(e,t){return new QueryResultCharsPerOpportunity().fromJson(e,t)}static fromJsonString(e,t){return new QueryResultCharsPerOpportunity().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(QueryResultCharsPerOpportunity,e,t)}constructor(e){super(),this.charsPerOpportunity=0,this.numBytesAccepted=sE.q.zero,this.numCompletionAttempts=sE.q.zero,en.w.util.initPartial(e,this)}};QueryResultCharsPerOpportunity.runtime=en.w,QueryResultCharsPerOpportunity.typeName="exa.user_analytics_pb.QueryResultCharsPerOpportunity",QueryResultCharsPerOpportunity.fields=en.w.util.newFieldList(()=>[{no:1,name:"chars_per_opportunity",kind:"scalar",T:1},{no:2,name:"num_bytes_accepted",kind:"scalar",T:4},{no:3,name:"num_completion_attempts",kind:"scalar",T:4}]);let QueryRequestChatStats=class QueryRequestChatStats extends er.v{static fromBinary(e,t){return new QueryRequestChatStats().fromBinary(e,t)}static fromJson(e,t){return new QueryRequestChatStats().fromJson(e,t)}static fromJsonString(e,t){return new QueryRequestChatStats().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(QueryRequestChatStats,e,t)}constructor(e){super(),en.w.util.initPartial(e,this)}};QueryRequestChatStats.runtime=en.w,QueryRequestChatStats.typeName="exa.user_analytics_pb.QueryRequestChatStats",QueryRequestChatStats.fields=en.w.util.newFieldList(()=>[]);let QueryResultChatStats=class QueryResultChatStats extends er.v{static fromBinary(e,t){return new QueryResultChatStats().fromBinary(e,t)}static fromJson(e,t){return new QueryResultChatStats().fromJson(e,t)}static fromJsonString(e,t){return new QueryResultChatStats().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(QueryResultChatStats,e,t)}constructor(e){super(),en.w.util.initPartial(e,this)}};QueryResultChatStats.runtime=en.w,QueryResultChatStats.typeName="exa.user_analytics_pb.QueryResultChatStats",QueryResultChatStats.fields=en.w.util.newFieldList(()=>[{no:1,name:"chat_stats",kind:"message",T:et.Dj3}]);let QueryRequestCommandStats=class QueryRequestCommandStats extends er.v{static fromBinary(e,t){return new QueryRequestCommandStats().fromBinary(e,t)}static fromJson(e,t){return new QueryRequestCommandStats().fromJson(e,t)}static fromJsonString(e,t){return new QueryRequestCommandStats().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(QueryRequestCommandStats,e,t)}constructor(e){super(),en.w.util.initPartial(e,this)}};QueryRequestCommandStats.runtime=en.w,QueryRequestCommandStats.typeName="exa.user_analytics_pb.QueryRequestCommandStats",QueryRequestCommandStats.fields=en.w.util.newFieldList(()=>[]);let QueryResultCommandStats=class QueryResultCommandStats extends er.v{static fromBinary(e,t){return new QueryResultCommandStats().fromBinary(e,t)}static fromJson(e,t){return new QueryResultCommandStats().fromJson(e,t)}static fromJsonString(e,t){return new QueryResultCommandStats().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(QueryResultCommandStats,e,t)}constructor(e){super(),en.w.util.initPartial(e,this)}};QueryResultCommandStats.runtime=en.w,QueryResultCommandStats.typeName="exa.user_analytics_pb.QueryResultCommandStats",QueryResultCommandStats.fields=en.w.util.newFieldList(()=>[{no:1,name:"command_stats",kind:"message",T:et.xdI}]);let QueryRequestActiveDaysByApiKey=class QueryRequestActiveDaysByApiKey extends er.v{static fromBinary(e,t){return new QueryRequestActiveDaysByApiKey().fromBinary(e,t)}static fromJson(e,t){return new QueryRequestActiveDaysByApiKey().fromJson(e,t)}static fromJsonString(e,t){return new QueryRequestActiveDaysByApiKey().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(QueryRequestActiveDaysByApiKey,e,t)}constructor(e){super(),en.w.util.initPartial(e,this)}};QueryRequestActiveDaysByApiKey.runtime=en.w,QueryRequestActiveDaysByApiKey.typeName="exa.user_analytics_pb.QueryRequestActiveDaysByApiKey",QueryRequestActiveDaysByApiKey.fields=en.w.util.newFieldList(()=>[]);let QueryResultActiveDaysByApiKey=class QueryResultActiveDaysByApiKey extends er.v{static fromBinary(e,t){return new QueryResultActiveDaysByApiKey().fromBinary(e,t)}static fromJson(e,t){return new QueryResultActiveDaysByApiKey().fromJson(e,t)}static fromJsonString(e,t){return new QueryResultActiveDaysByApiKey().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(QueryResultActiveDaysByApiKey,e,t)}constructor(e){super(),this.activeDaysByApiKey={},en.w.util.initPartial(e,this)}};QueryResultActiveDaysByApiKey.runtime=en.w,QueryResultActiveDaysByApiKey.typeName="exa.user_analytics_pb.QueryResultActiveDaysByApiKey",QueryResultActiveDaysByApiKey.fields=en.w.util.newFieldList(()=>[{no:1,name:"active_days_by_api_key",kind:"map",K:9,V:{kind:"scalar",T:13}}]);let QueryResultError=class QueryResultError extends er.v{static fromBinary(e,t){return new QueryResultError().fromBinary(e,t)}static fromJson(e,t){return new QueryResultError().fromJson(e,t)}static fromJsonString(e,t){return new QueryResultError().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(QueryResultError,e,t)}constructor(e){super(),this.error="",en.w.util.initPartial(e,this)}};QueryResultError.runtime=en.w,QueryResultError.typeName="exa.user_analytics_pb.QueryResultError",QueryResultError.fields=en.w.util.newFieldList(()=>[{no:1,name:"error",kind:"scalar",T:9}]);let GetPreferredTimeZoneRequest=class GetPreferredTimeZoneRequest extends er.v{static fromBinary(e,t){return new GetPreferredTimeZoneRequest().fromBinary(e,t)}static fromJson(e,t){return new GetPreferredTimeZoneRequest().fromJson(e,t)}static fromJsonString(e,t){return new GetPreferredTimeZoneRequest().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(GetPreferredTimeZoneRequest,e,t)}constructor(e){super(),this.apiKey="",en.w.util.initPartial(e,this)}};GetPreferredTimeZoneRequest.runtime=en.w,GetPreferredTimeZoneRequest.typeName="exa.user_analytics_pb.GetPreferredTimeZoneRequest",GetPreferredTimeZoneRequest.fields=en.w.util.newFieldList(()=>[{no:1,name:"api_key",kind:"scalar",T:9}]);let GetPreferredTimeZoneResponse=class GetPreferredTimeZoneResponse extends er.v{static fromBinary(e,t){return new GetPreferredTimeZoneResponse().fromBinary(e,t)}static fromJson(e,t){return new GetPreferredTimeZoneResponse().fromJson(e,t)}static fromJsonString(e,t){return new GetPreferredTimeZoneResponse().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(GetPreferredTimeZoneResponse,e,t)}constructor(e){super(),this.preferredTimeZone="",en.w.util.initPartial(e,this)}};GetPreferredTimeZoneResponse.runtime=en.w,GetPreferredTimeZoneResponse.typeName="exa.user_analytics_pb.GetPreferredTimeZoneResponse",GetPreferredTimeZoneResponse.fields=en.w.util.newFieldList(()=>[{no:1,name:"preferred_time_zone",kind:"scalar",T:9}]);let useUserAnalyticsSummary=e=>{let{getUserAnalyticsSummary:t}=useServerConnectionContext(),[s,a]=(0,X.useState)(!0),[n,r]=(0,X.useState)(null),[o,i]=(0,X.useState)(null),l=null==e?void 0:e.timeRange;return(0,X.useEffect)(()=>{let fetchAnalytics=async()=>{try{a(!0);let s=await t(l);if(e)return;i(ei.BqN.fromBinary(s))}catch(e){r(e)}finally{a(!1)}},e=!1;return fetchAnalytics(),()=>{e=!0}},[t,l]),{analyticsSummary:o,isLoading:s,error:n}};var sI=s(29495);let UserStats=()=>{var e;let{props:{openProfile:t}}=useServerConnectionContext(),{hasEnterpriseExtension:s}=useChatParamsContext(),{analyticsSummary:a,error:n}=useUserAnalyticsSummary(),r=(0,X.useMemo)(()=>(null==a?void 0:a.completionsByDay)?(0,sj.getCompletionsByDayRecord)(new QueryResultCompletionsByDay({completionsByDay:a.completionsByDay})):{},[a]),o=(0,X.useMemo)(()=>(null==a?void 0:a.completionStatistics)?a.completionStatistics.numAcceptances:0,[a]),[i]=(0,X.useMemo)(()=>{let{history:e}=(0,sI.getStreak)(r,{start:eP()().subtract(1,"year").toDate(),end:new Date});if(0==e.length||!e[0])return[0,!1];let t=e[0];return(0,sI.isDateEqual)(t.endTime,new Date)?[(0,sI.getStreakDuration)(t),!1]:(0,sI.isDateEqual)(t.endTime,eP()().subtract(1,"day").toDate())?[(0,sI.getStreakDuration)(t),!0]:[0,!1]},[r]);return n?(0,z.jsx)(z.Fragment,{}):(0,z.jsxs)("div",{children:[(0,z.jsx)("h6",{className:"flex flex-row items-center justify-start gap-x-1 text-sm font-medium",children:"Stats"}),(0,z.jsxs)("div",{className:"mt-2 flex flex-col gap-2 pb-2 opacity-80",children:[(0,z.jsxs)("div",{className:"flex flex-row gap-1",children:[(0,z.jsx)("div",{className:"text-sm",children:"Total Completions:"}),(0,z.jsx)("div",{className:"text-sm",children:o.toLocaleString()})]}),(0,z.jsxs)("div",{className:"flex flex-row gap-1",children:[(0,z.jsx)("div",{className:"text-sm",children:"Streak:"}),(0,z.jsxs)("div",{className:"text-sm",children:[i.toLocaleString()," day",i>1?"s in a row":""]})]}),(0,z.jsxs)("div",{className:"flex flex-row gap-1",children:[(0,z.jsx)("div",{className:"text-sm",children:"Total Languages: "}),(0,z.jsx)("div",{className:"text-sm",children:null!==(e=null==a?void 0:a.completionsByLanguage.length)&&void 0!==e?e:0})]}),!s&&(0,z.jsx)("a",{onClick:t,children:(0,z.jsx)("div",{className:"flex cursor-pointer flex-row gap-1",children:(0,z.jsx)("div",{className:"cursor-pointer text-sm underline",children:"View more stats"})})})]})]})};var sT=s(79910);let getNumPremiumMessagesSent=e=>{let t=0;return e.forEach(e=>{let{modelId:s,chatStats:a}=e;switch(s){case et.Hnr.MODEL_LLAMA_3_1_405B_INSTRUCT:case et.Hnr.MODEL_CHAT_GPT_4:case et.Hnr.MODEL_CHAT_GPT_4_1106_PREVIEW:t+=Number(null==a?void 0:a.chatsSent)||0}}),t},isLimitUnlimited=e=>-1===e,isLimitUnavailable=e=>0===e,getRemainingPromptCredits=(e,t)=>isLimitUnlimited(e.monthlyPromptCredits)?Number.MAX_SAFE_INTEGER:e.monthlyPromptCredits-t.usedPromptCredits,getRemainingToolCredits=(e,t)=>e.monthlyFlowCredits-t.usedFlowCredits,getRemainingFlexCredits=e=>e.availableFlexCredits-e.usedFlexCredits,getRemainingPromptAndFlexCredits=(e,t)=>isLimitUnlimited(e.monthlyPromptCredits)?Number.MAX_SAFE_INTEGER:Math.max(0,getRemainingPromptCredits(e,t)+getRemainingFlexCredits(t)),getRemainingToolAndFlexCredits=(e,t)=>Math.max(0,getRemainingToolCredits(e,t)+getRemainingFlexCredits(t)),isCreditRunningLow=(e,t)=>{if(!isLimitUnlimited(e.monthlyPromptCredits)){let s=e.monthlyPromptCredits-t.usedPromptCredits;if(s<2500&&s>0&&0===t.availableFlexCredits)return!0}let s=e.monthlyFlowCredits-t.usedFlowCredits;if(s<2500&&s>0&&0===t.availableFlexCredits)return!0;let a=t.availableFlexCredits-t.usedFlexCredits;return a<2500&&a>0},PlanInformation=()=>{var e,t,s,a,n,r;let{handshake:o}=useServerConnectionContext(),{hasEnterpriseExtension:i}=useChatParamsContext(),{analyticsSummary:l}=useUserAnalyticsSummary((0,X.useMemo)(()=>({timeRange:{start:eP()().subtract(1,"day").toDate(),end:new Date}}),[])),c=(null==o?void 0:null===(e=o.userStatus)||void 0===e?void 0:e.teamStatus)===et.ngL.APPROVED||(null==o?void 0:null===(t=o.userStatus)||void 0===t?void 0:t.pro),d=null!==(n=null==o?void 0:null===(s=o.planInfo)||void 0===s?void 0:s.planName)&&void 0!==n?n:"Codeium",u=getNumPremiumMessagesSent(null!==(r=null==l?void 0:l.chatsByModel)&&void 0!==r?r:[]),m=(0,X.useMemo)(()=>{var e,t;let s=Number(null!==(t=null==o?void 0:null===(e=o.planInfo)||void 0===e?void 0:e.maxNumPremiumChatMessages)&&void 0!==t?t:0);if(isLimitUnavailable(s))return(0,z.jsx)(tf.XIcon,{className:"h-4 w-4 fill-red"});if(isLimitUnlimited(s))return(0,z.jsx)(sT.CheckIcon,{className:"h-4 w-4 text-green"});let a=u/s>=1?"text-red":u/s>.7?"text-orange":"text-green";return(0,z.jsxs)("span",{className:(0,eG.classNames)("text-sm",a),children:[s.toFixed(0)," / day"]})},[null==o?void 0:null===(a=o.planInfo)||void 0===a?void 0:a.maxNumPremiumChatMessages,u]);return(0,z.jsxs)("div",{children:[(0,z.jsxs)("h6",{id:"codeium-plan-information",className:"text-sm font-medium",children:["Plan: ",d]}),!i&&(0,z.jsxs)("div",{className:"opacity-80",children:[(0,z.jsxs)("div",{className:"flex flex-row items-center justify-between space-x-4",children:[(0,z.jsx)("p",{className:"text-sm",children:"4x context length"}),c?(0,z.jsx)(sT.CheckIcon,{className:"h-4 w-4 text-green"}):(0,z.jsx)(tf.XIcon,{className:"h-4 w-4 fill-red"})]}),(0,z.jsxs)("div",{className:"flex flex-row items-center justify-between space-x-4",children:[(0,z.jsx)("p",{className:"text-sm",children:"Access to GPT-4, Claude Sonnet, and Llama 3.1 405B"}),m]}),!c&&(0,z.jsxs)("p",{className:"mt-1 text-sm",children:["Upgrade to"," ",(0,z.jsxs)(ChatLink,{className:"cursor-pointer underline",href:th,children:["Teams",(0,z.jsx)(tg.LinkExternalIcon,{className:"ml-1 inline h-3.5 w-3.5"})]})]})]}),(0,z.jsxs)("div",{className:"text-sm opacity-80",children:["Learn more about our models"," ",(0,z.jsx)("a",{href:"https://docs.codeium.com/chat/models",className:"underline",children:"here"})]})]})},CrossSellWindsurfMessage=()=>{let{ideName:e,hasEnterpriseExtension:t}=useChatParamsContext(),{unleash:s,logEvent:a}=useServerConnectionContext(),n=s.isEnabled(et.rpR.CROSS_SELL_EXTENSION_DOWNLOAD_WINDSURF);return!n||"vscode"!==e||t?null:(0,z.jsxs)("div",{className:"mt-1 flex flex-row items-center justify-between gap-2 rounded bg-gray-500/15 px-2 py-1 text-ide-tooltip-color",children:[(0,z.jsx)("div",{className:"text-sm",children:"Experience enhanced context-awareness and large codebase editing with Windsurf, our new agentic IDE."}),(0,z.jsx)("a",{target:"_blank",rel:"noreferrer",href:"https://codeium.com/redirect/windsurf/download?ide=".concat(e),className:"text-sm font-medium hover:text-ide-tooltip-color hover:underline",onClick:()=>{a(et.tbr.CROSS_SELL_EXTENSION_DOWNLOAD_WINDSURF_CLICK,{source:"panel",type:"settings"})},children:"Download"})]})},Profile=()=>{let{handleOpenChat:e,handleOpenCascade:t}=useNavigationContext(),{defaultView:s}=useChatParamsContext();return(0,z.jsxs)("div",{className:"flex h-full w-full flex-1 flex-col overflow-y-scroll bg-ide-chat-background py-2 text-ide-editor-color shadow-xl",children:[(0,z.jsx)("div",{className:"mb-4 flex flex-row items-end justify-end px-2",children:(0,z.jsx)(tL.Z,{onClick:s===R.CASCADE?t:e,className:"h-6 w-6 cursor-pointer rounded p-1 hover:bg-gray-500/20"})}),(0,z.jsxs)("div",{className:"flex h-full w-full flex-1 flex-col gap-y-8 px-2",children:[(0,z.jsx)(CrossSellWindsurfMessage,{}),(0,z.jsx)(PlanInformation,{}),(0,z.jsx)(DebugPanel,{}),(0,z.jsx)(UserSettings,{}),(0,z.jsx)(UserInfo,{}),(0,z.jsx)(UserStats,{})]})]})};var sk=s(76345),sR=s(97266),s_=s(97315),sD=s(19631);let getModelLabel=e=>{switch(e){case void 0:case et.Hnr.MODEL_CHAT_3_5_TURBO:return"Base Model ";case et.Hnr.MODEL_CHAT_GPT_4:case et.Hnr.MODEL_CHAT_GPT_4_1106_PREVIEW:case et.Hnr.MODEL_CHAT_GPT_4O_2024_08_06:return"GPT-4o";case et.Hnr.MODEL_CHAT_O1_PREVIEW:return"o1-preview";case et.Hnr.MODEL_CHAT_O1_MINI:return"o1-mini";case et.Hnr.MODEL_LLAMA_3_1_405B_INSTRUCT:return"Codeium Premier \uD83D\uDE80";case et.Hnr.MODEL_CLAUDE_3_7_SONNET_20250219:return"Claude 3.7 Sonnet";case et.Hnr.MODEL_CLAUDE_3_SONNET_20240229:case et.Hnr.MODEL_CLAUDE_3_5_SONNET_20240620:return"Claude 3.5 Sonnet";case et.Hnr.MODEL_OPENAI_COMPATIBLE:return"External OpenAI";case et.Hnr.MODEL_XAI_GROK_2:return"xAI Grok 2";case et.Hnr.MODEL_XAI_GROK_3:return"xAI Grok 3";case et.Hnr.MODEL_UNSPECIFIED:return"Self-Hosted Model"}return"Unknown"};(h=B||(B={})).UNAVAILABLE="Unavailable",h.AVAILABLE="Available",h.RATE_LIMITED="Rate Limited",h.WAITLIST="Waitlist";let sA={[et.Hnr.MODEL_OPENAI_COMPATIBLE]:"OpenAI Compatible",[et.Hnr.MODEL_ANTHROPIC_COMPATIBLE]:"Anthropic",[et.Hnr.MODEL_BEDROCK_COMPATIBLE]:"Amazon Bedrock",[et.Hnr.MODEL_VERTEX_COMPATIBLE]:"Google Vertex",[et.Hnr.MODEL_AZURE_COMPATIBLE]:"Azure OpenAI"},constructModelId=(e,t)=>e.toString()+"_"+t;constructModelId(et.Hnr.MODEL_UNSPECIFIED,"Cascade Base"),constructModelId(et.Hnr.MODEL_CHAT_GPT_4O_2024_08_06,"GPT-4o"),constructModelId(et.Hnr.MODEL_CLAUDE_3_7_SONNET_20250219,"Claude 3.7 Sonnet"),constructModelId(et.Hnr.MODEL_CLAUDE_3_5_SONNET_20241022,"Claude 3.5 Sonnet"),constructModelId(et.Hnr.MODEL_CLAUDE_3_5_HAIKU_20241022,"Claude 3.5 Haiku"),constructModelId(et.Hnr.MODEL_CHAT_O1,"OpenAI o1"),constructModelId(et.Hnr.MODEL_CHAT_O1_MINI,"OpenAI o1-mini"),constructModelId(et.Hnr.MODEL_CHAT_O3_MINI,"OpenAI o3-mini"),constructModelId(et.Hnr.MODEL_DEEPSEEK_V3,"DeepSeek V3"),constructModelId(et.Hnr.MODEL_DEEPSEEK_R1,"DeepSeek R1"),constructModelId(et.Hnr.MODEL_GOOGLE_GEMINI_2_0_FLASH,"Gemini 2.0 Flash"),constructModelId(et.Hnr.MODEL_XAI_GROK_2,"xAI Grok 2"),constructModelId(et.Hnr.MODEL_XAI_GROK_3,"xAI Grok 3");let getModelFromId=(e,t)=>t.find(t=>t.id===e),enterpriseModelOptions=e=>{let t=e.map(e=>({label:e.modelName,value:e.modelId,id:constructModelId(e.modelId,e.modelName),access:{individual:"Available",pro:"Available",team:"Available"},description:sA[e.modelId]||"Custom-added Model",enterpriseModelConfig:{maxCompletionTokens:e.maxCompletionTokens,maxInputTokens:e.maxInputTokens}}));return[...t.filter(e=>e.value!==et.Hnr.MODEL_UNSPECIFIED),...t.filter(e=>e.value===et.Hnr.MODEL_UNSPECIFIED)]},modelOptions=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s={label:getModelLabel(et.Hnr.MODEL_CHAT_O1_MINI),value:et.Hnr.MODEL_CHAT_O1_MINI,id:constructModelId(et.Hnr.MODEL_CHAT_O1_MINI,getModelLabel(et.Hnr.MODEL_CHAT_O1_MINI)),access:{individual:"Unavailable",pro:"Available",team:"Available"},description:"o1-mini"},a={label:getModelLabel(et.Hnr.MODEL_CHAT_O1_PREVIEW),value:et.Hnr.MODEL_CHAT_O1_PREVIEW,id:constructModelId(et.Hnr.MODEL_CHAT_O1_PREVIEW,getModelLabel(et.Hnr.MODEL_CHAT_O1_PREVIEW)),access:{individual:"Unavailable",pro:"Available",team:"Available"},description:"o1-preview"},n={label:getModelLabel(et.Hnr.MODEL_CHAT_GPT_4_1106_PREVIEW),value:et.Hnr.MODEL_CHAT_GPT_4_1106_PREVIEW,id:constructModelId(et.Hnr.MODEL_CHAT_GPT_4_1106_PREVIEW,getModelLabel(et.Hnr.MODEL_CHAT_GPT_4_1106_PREVIEW)),access:{individual:"Waitlist",pro:"Rate Limited",team:"Available"},description:"Slower model by OpenAI that does not inherit Codeium's workflow-specific optimizations. May be subject to rate limiting."},r={label:getModelLabel(et.Hnr.MODEL_LLAMA_3_1_405B_INSTRUCT),id:constructModelId(et.Hnr.MODEL_LLAMA_3_1_405B_INSTRUCT,getModelLabel(et.Hnr.MODEL_LLAMA_3_1_405B_INSTRUCT)),value:et.Hnr.MODEL_LLAMA_3_1_405B_INSTRUCT,access:{individual:"Waitlist",pro:"Rate Limited",team:"Available"},description:"Llama 3.1 405B based model. Meta's largest and highest quality language model. Biggest open source model on the market. May be subject to rate limiting.",isBeta:!0},o={label:getModelLabel(et.Hnr.MODEL_CLAUDE_3_7_SONNET_20250219),value:et.Hnr.MODEL_CLAUDE_3_7_SONNET_20250219,id:constructModelId(et.Hnr.MODEL_CLAUDE_3_7_SONNET_20250219,getModelLabel(et.Hnr.MODEL_CLAUDE_3_7_SONNET_20250219)),access:{individual:"Waitlist",pro:"Rate Limited",team:"Available"},description:"Slower model by Anthropic that does not inherit Codeium's workflow-specific optimizations. May be subject to rate limiting."},i={label:getModelLabel(et.Hnr.MODEL_CLAUDE_3_5_SONNET_20240620),value:et.Hnr.MODEL_CLAUDE_3_5_SONNET_20240620,id:constructModelId(et.Hnr.MODEL_CLAUDE_3_5_SONNET_20240620,getModelLabel(et.Hnr.MODEL_CLAUDE_3_5_SONNET_20240620)),access:{individual:"Waitlist",pro:"Rate Limited",team:"Available"},description:"Slower model by Anthropic that does not inherit Codeium's workflow-specific optimizations. May be subject to rate limiting."},l={label:getModelLabel(et.Hnr.MODEL_CHAT_3_5_TURBO),value:et.Hnr.MODEL_CHAT_3_5_TURBO,id:constructModelId(et.Hnr.MODEL_CHAT_3_5_TURBO,getModelLabel(et.Hnr.MODEL_CHAT_3_5_TURBO)),access:{individual:"Available",pro:"Available",team:"Available"},description:"Family of fast, high-quality models, including a Llama 3.1 70B based model."},c=[];if(t&&t.length>0){let e=[i,o,r,l,n,s,a];c.push(...e.filter(e=>t.includes(e.label)))}else c.push(r),c.push(o),c.push(i),c.push(l),e||(c.push(n),c.push(s),c.push(a));return c},getAccessControl=(e,t)=>{var s;if(null===e)return t.access.individual;let a=e.teamId&&e.teamStatus===et.ngL.APPROVED;if(a)return t.access.team;let n=(null===(s=e.planInfo)||void 0===s?void 0:s.teamsTier)===et.wuw.PRO||e.pro;return n?t.access.pro:t.access.individual};var sP=s(19447),sM=s(35966);let ModelSelect=e=>{var t;let{value:s,onChange:a,modelConfigs:n,className:r,isLoading:o=!1}=e,{userStatus:i}=useServerConnectionContext(),{hasEnterpriseExtension:l}=useChatParamsContext(),c=(null==i?void 0:i.teamStatus)===et.ngL.APPROVED,d=null==i?void 0:null===(t=i.planInfo)||void 0===t?void 0:t.planName,u=(null==i?void 0:i.pro)&&!c;return(0,z.jsx)(s_.R,{value:s,onChange:e=>{a(e)},children:e=>{var t;let{open:a}=e;return(0,z.jsx)(z.Fragment,{children:(0,z.jsxs)("div",{className:"shrink-1 relative text-ellipsis whitespace-nowrap",children:[(0,z.jsxs)(s_.R.Button,{className:"relative m-0 flex w-full cursor-pointer flex-row items-center justify-start gap-x-0.5 rounded p-0.5 text-ide-text-color opacity-70 hover:bg-gray-500/20 hover:opacity-100",children:[(0,z.jsx)(sP.Z,{className:"h-3.5 fill-none stroke-ide-text-color"}),o?(0,z.jsx)("span",{className:"h-2 w-[5rem] animate-pulse rounded-full bg-gray-500/70"}):(0,z.jsx)("p",{className:"flex-grow overflow-hidden text-ellipsis whitespace-nowrap text-xs leading-none",children:null===(t=getModelFromId(s,n))||void 0===t?void 0:t.label})]}),(0,z.jsx)(sD.u,{show:a,as:X.Fragment,leave:"transition ease-in duration-100",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,z.jsx)(s_.R.Options,{className:(0,eG.classNames)("absolute -left-6 -top-1 z-40 w-60 max-w-[90vw] origin-top-right -translate-y-full overflow-hidden rounded-md border border-gray-500/50 bg-ide-chat-background opacity-100 focus:outline-none",r),children:n.map(e=>{let t=getAccessControl(null!=i?i:null,e),s=t===B.UNAVAILABLE||t===B.WAITLIST;return(0,z.jsx)(s_.R.Option,{className:"cursor-default select-none list-none border-ide-tooltip-color text-sm text-ide-tooltip-color",disabled:s,value:e.id,children:t=>{let{selected:a,active:n,disabled:r}=t;return(0,z.jsx)("div",{className:(0,eG.classNames)("flex flex-col p-1",r?"opacity-80":"cursor-pointer opacity-100",n?"bg-gray-500/20":""),children:(0,z.jsxs)("div",{className:"flex justify-between",children:[(0,z.jsxs)("div",{className:"flex flex-row items-center justify-start gap-x-2",children:[s&&(0,z.jsx)(sR.LockClosedIcon,{className:"h-5 w-5"}),(0,z.jsx)("p",{className:(0,eG.classNames)("whitespace-nowrap text-xs",n||a?"opacity-100":"opacity-80"),children:e.label}),l&&(0,z.jsx)("span",{className:" px-2 text-xs font-medium text-gray",children:e.description}),c&&e.access.individual!==B.AVAILABLE&&e.access.team===B.AVAILABLE&&(0,z.jsx)("span",{className:"rounded-full border border-gray-300/50 bg-ide-active-selection-background px-2 text-xs font-medium text-ide-active-selection-color",children:d}),!c&&u&&e.access.individual!==B.AVAILABLE&&e.access.pro===B.RATE_LIMITED&&(0,z.jsxs)("span",{className:"rounded-full border border-brand-dark px-2 text-xs font-bold text-brand-dark",children:[e.isBeta?"Beta ":"","Limit 20 / day"]})]}),a&&(0,z.jsx)(sM.Z,{className:"h-5 w-5 text-ide-tooltip-color","aria-hidden":"true"})]})})}},e.value)})})})]})})}})};var sL=s(73298),sO=s.n(sL);let useContextMention=e=>{let{brainInterface:t}=useServerConnectionContext(),s=useChatParamsContext(),a=!!s.ideName&&s.ideName.includes("windsurf"),n=(0,X.useMemo)(()=>{let t=a?t9:t6;return e&&e.length>0?e:t.map(e=>t7[e].protoType)},[e,a]),r=(0,X.useCallback)(async(e,a,r)=>{var o;let i;e=null!=e?e:"";let{scopeType:l,query:c,repoFilter:d}=breakdownQueryFromNewEditor(e,null!=a?a:"");i=l?[l]:n;let u=await (null===(o=t.getMatchingSearchQueries)||void 0===o?void 0:o.call(t,c,getMetadata(s),i,d,r));if(void 0===u)return;let m=u.filter((e,t,s)=>void 0!==e.scopeItem.case&&t8.includes(e.scopeItem.case)||void 0!==getContextScopeTypeMetadataFromItem(e).getDisplayValue(e)&&t===s.findIndex(t=>getContextScopeTypeMetadataFromItem(t).getDisplayValue(t)===getContextScopeTypeMetadataFromItem(e).getDisplayValue(e)&&getContextScopeTypeMetadataFromItem(t).getMetadataDisplayValue(t)===getContextScopeTypeMetadataFromItem(e).getMetadataDisplayValue(e)));return m},[n,t.getMatchingSearchQueries,s]),o=(0,X.useMemo)(()=>({query:r,isWindsurf:a}),[r,a]);return o};var sF=s(44098);let Menu=e=>{var t;let{loading:s,...a}=e,n=(0,eG.classNames)("z-30 rounded-t border bg-white text-black",null!==(t=a.className)&&void 0!==t?t:"");return(0,z.jsx)("div",{...a,className:n,children:(0,z.jsx)("ul",{children:a.children})})},isSelectionBeginningOfInput=(e,t)=>{if(0!==t.offset)return!1;let s=(0,t_.gI)(t.key),a=s;for(;null==a?void 0:a.getParent();){if(0!==a.getIndexWithinParent())return!1;a=a.getParent()}return!0},isSelectionEndOfInput=(e,t)=>{let s=(0,t_.gI)(t.key);if(!s||t.offset!==s.getTextContentSize())return!1;let a=s;for(;null==a?void 0:a.getParent();){var n;if((null===(n=a.getParent())||void 0===n?void 0:n.getChildrenSize())!==void 0&&a.getIndexWithinParent()!==a.getParent().getChildrenSize()-1)return!1;a=a.getParent()}return!0},HandleKeyPlugin=e=>{let{onEnter:t,onEditorKeyDown:s,onEditorKeyUp:a}=e,[n]=(0,tR.g)();return(0,X.useEffect)(()=>{let e=n.registerCommand(t_.Zb,e=>{let t=(0,t_.dL)(),a=null==t?void 0:t.getStartEndPoints();if(a&&isSelectionEndOfInput(n,a[0])&&isSelectionEndOfInput(n,a[1])){let t=(null==s?void 0:s(e))||!1;return t}return!1},t_.u6),r=n.registerCommand(t_._0,e=>{let t=(0,t_.dL)(),s=null==t?void 0:t.getStartEndPoints();if(s&&isSelectionBeginningOfInput(n,s[0])&&isSelectionBeginningOfInput(n,s[1])&&a){let t=a(e)||!1;return t}return!1},t_.u6),o=n.registerCommand(t_.XN,e=>!!t&&t(e),t_.KB);return()=>{o(),e(),r()}},[n,t,s,a]),null},OnLoadPlugin=e=>{let{onMount:t,editorRef:s}=e,a=(0,tR.g)(),[n,r]=(0,X.useState)(!1);return(0,X.useEffect)(()=>{s&&(s.current=a[0])},[a,s]),(0,X.useEffect)(()=>{n||(null==t||t(a[0]),r(!0))},[a,t,n]),null},sB=(0,X.forwardRef)(function(e,t){var s,a;let{item:n,selected:r}=e,{icon:o,title:i,metadata:l}=(0,X.useMemo)(()=>{var e;return{icon:null===(e=n.renderData)||void 0===e?void 0:e.displayIcon,title:n.data.displayTitle,metadata:n.data.displayMetadata}},[n]),c=(0,eG.classNames)("m-0 flex cursor-pointer flex-row items-center justify-between border-t border-gray-500/25 p-1 text-sm text-black first:border-none whitespace-nowrap",r?(null===(s=e.options)||void 0===s?void 0:s.selectedClassName)?e.options.selectedClassName:"bg-gray-500/10":(null===(a=e.options)||void 0===a?void 0:a.unselectedClassName)?e.options.unselectedClassName:"bg-white");return n.data.optionType===A.CATEGORY?(0,z.jsxs)("li",{...e,"aria-selected":r,role:"option",className:c,ref:t,children:[(0,z.jsx)("div",{className:"!stroke-ide-active-selection-color pr-1",children:o}),(0,z.jsx)("span",{children:i}),(0,z.jsx)("span",{className:(0,eG.classNames)("flex flex-grow flex-row justify-end",r?"opacity-100":"opacity-0"),children:""})]}):(0,z.jsxs)("li",{...e,"aria-selected":r,role:"option",className:c,ref:t,children:[(0,z.jsx)("div",{className:"pr-1",children:o}),(0,z.jsx)("span",{className:"opacity-90",children:i}),(0,z.jsx)("span",{className:"ml-1 flex-shrink overflow-hidden text-ellipsis opacity-40 [direction:rtl]",children:(0,z.jsx)("span",{className:"[unicode-bidi:plaintext]",children:l})}),(0,z.jsx)("span",{className:(0,eG.classNames)("flex flex-grow flex-row justify-end",r?"opacity-100":"opacity-0"),children:""})]})}),MentionPlugin=e=>{let{onEnter:t,services:s}=e,{ideName:a}=useChatParamsContext(),[n]=(0,tR.g)();return(0,X.useEffect)(()=>{let e=n.registerNodeTransform(t_.R2,e=>{e.getType()&&0!==e.getFormat()&&e.setFormat(0)});return()=>{e()}},[n]),(0,X.useEffect)(()=>{let e=null;return isWindsurf(a)||(e=n.registerNodeTransform(MarkdownNode,e=>{(async()=>{for(let t of s){let s=await t.transformData(e);if(s){n.update(()=>{e.setData(s)});break}}})().catch(console.error)})),()=>{null==e||e()}},[n,s,a]),(0,X.useEffect)(()=>n.registerCommand(t_.iG,e=>"Enter"===e.key&&t(e),t_.VN),[n,t]),null},PasteInterceptorPlugin=e=>{let{id:t,onImagePaste:s}=e,[a]=(0,tR.g)(),n=(0,X.useCallback)(e=>{if("codeBlockMention"!==e.actionType)return;if(t){var s;null===(s=document.getElementById(t))||void 0===s||s.focus()}let n=e.payload.map(e=>et.QVo.fromBinary(e));insertTextNodeItems(a,n),a.update(()=>{let e=(0,t_.dL)();e&&e.insertText(" ")})},[t,a]);useRegisterChatClientRequestHandler("sendActionToChatPanel",n);let{props:{checkClipboard:r}}=useServerConnectionContext();return(0,X.useEffect)(()=>{let e=a.registerCommand(t_.A1,e=>{let t=(0,t_.dL)();if((0,t_.OP)(t)&&e instanceof ClipboardEvent){let s=t.anchor.getNode();if(s.getParent() instanceof CustomAutoLinkNode){var n;e.preventDefault();let r=null===(n=e.clipboardData)||void 0===n?void 0:n.getData("text/plain");return r&&a.update(()=>{let e=s.getTextContent(),a=t.anchor.offset,n=e.slice(0,a)+r+e.slice(a);s.setTextContent(n),t.anchor.offset=a+r.length,t.focus.offset=a+r.length}),!0}}let runAsync=async()=>{if(e instanceof ClipboardEvent){var t,n;let o=Array.from((null===(t=e.clipboardData)||void 0===t?void 0:t.items)||[]),i=o.find(e=>e.type.startsWith("image/"));if(i&&s){e.preventDefault(),s(i);return}let l=null===(n=e.clipboardData)||void 0===n?void 0:n.getData("text");if(!l)return;let defaultPaste=()=>{a.update(()=>{let e=(0,t_.dL)(),t=(0,t_.MX)(l);e?e.insertNodes([t]):console.error("[Paste Interceptor] No selection found")})};if(l.split("\n").length<2){defaultPaste();return}e.preventDefault();let c=Math.floor(1e3*Math.random()),d=await (null==r?void 0:r(l)),u=null==d?void 0:d.match(/(.+):([0-9]+)-([0-9]+)/),m=null==u?void 0:u[1],p=parseInt((null==u?void 0:u[2])||"-1"),x=parseInt((null==u?void 0:u[3])||"-1"),h=null==m?void 0:m.split("/").slice(-1)[0];m&&h?a.update(()=>{let e=(0,t_.dL)(),t=(0,tP.kg)("@","".concat(h,":").concat(p,"-").concat(x),{data:"[Snippet fileName="+m+" startLine=".concat(p)+" endLine=".concat(x)+"]\n"+l+"\n[/Snippet]",pasteId:c});e?e.insertNodes([t]):console.error("[Paste Interceptor] No selection found")}):defaultPaste()}};return runAsync(),!0},t_.jw);return()=>{e()}},[r,a,t,s]),null},insertTextNodeItems=(e,t)=>{e.update(()=>{let e=(0,t_.dL)();if(!e){console.error("[Paste Interceptor] No selection found");return}t.forEach(t=>{if("item"===t.chunk.case){let{scopeItem:a}=t.chunk.value;switch(a.case){case"codeContext":{var s;let t=a.value.absoluteUri.split("/").slice(-1)[0],n=a.value.startLine,r=a.value.endLine,o=a.value.absoluteUri,i=(null===(s=a.value.snippetByType[et.PCp.RAW_SOURCE])||void 0===s?void 0:s.snippet)||"",l=(0,tP.kg)("@","".concat(t,":").concat(n,"-").concat(r),{data:"[Snippet fileName="+o+" startLine=".concat(n)+" endLine=".concat(r)+"]\n"+i+"\n[/Snippet]"});e.insertNodes([l]);break}case"textBlock":{let{content:t,identifier:s}=a.value,n="text block";if("fileLineRange"===s.case){let e=(0,e8.getFileName)(s.value.absoluteUri);n="".concat(e,"#L").concat(s.value.startLine+1),s.value.startLine!==s.value.endLine&&(n+="-".concat(s.value.endLine+1))}else"label"===s.case&&(n=s.value);let r=(0,tP.kg)("@",n,{data:"[Snippet identifier=".concat(n,"]\n").concat(t,"\n[/Snippet]")});e.insertNodes([r])}}}else if("text"===t.chunk.case){let s=(0,t_.MX)(t.chunk.value);e.insertNodes([s])}})})};function tryPathFromUri(e){try{let t=t1.Uri.fromUri(e),s=t.toPath();return s}catch(t){return e}}let getBaseName=e=>tryPathFromUri(e).split(/[\/\\]/).pop();function prettyPath(e,t,s){let a=tryPathFromUri(e);if(1===s.length){let e=tryPathFromUri(s[0]),t=(0,t1.relativePathPrefix)(e,a);if(""!==t&&t!==a)return t}let n=(0,t1.relativePathPrefix)(t,a);return n!==a?"~/".concat(n):n}let FileMentionPlugin=e=>{let{inputId:t}=e,[s]=(0,tR.g)(),a=(0,X.useCallback)(e=>{if("fileMention"!==e.actionType)return;if(t){var a;null===(a=document.getElementById(t))||void 0===a||a.focus()}let n=e.payload.map(e=>et.QVo.fromBinary(e));insertFileMention(s,n)},[t,s]);return useRegisterChatClientRequestHandler("sendActionToChatPanel",a),null},insertFileMention=(e,t)=>{e.update(()=>{let e=(0,t_.dL)();if(!e){console.error("[File Mention] No selection found");return}t.forEach(t=>{if("item"===t.chunk.case){let{scopeItem:n}=t.chunk.value;if("file"===n.case){var s,a;let t=n.value.absoluteUri,r=null!==(a=null!==(s=getBaseName(t))&&void 0!==s?s:t.split("/").slice(-1)[0])&&void 0!==a?a:t,o=ContextScopeItemNodeData.fromContextScopeItem(new et.igh({scopeItem:n})).getMenuItemProps().data,i=(0,tP.kg)("@",r,o);e.insertNodes([i])}}})})},ContextMentionEditor=e=>{var t,s;let{onMount:a,editorRef:n,containerRef:r,onEditorChange:o,onEnter:i,onEditorKeyDown:l,onEditorKeyUp:c,className:d,triggerServices:u,menuClassName:m,menuItemOptions:p,placeholderClassName:x,onMenuOpen:h,onInsertMention:g,onImagePaste:f,...y}=e,v=(0,X.useMemo)(()=>u.map(e=>e.trigger),[u]),C=(0,X.useMemo)(()=>u.reduce((e,t)=>(e[t.trigger]=t,e),{}),[u]),w=(0,z.jsx)("p",{className:(0,eG.classNames)("pointer-events-none absolute left-[0.6rem] right-[3rem] top-1/2 z-0 flex -translate-y-1/2 select-none items-center items-center overflow-hidden text-ellipsis whitespace-nowrap text-sm text-ide-input-color opacity-50",x),children:null!==(t=y.placeholder)&&void 0!==t?t:"Ask anything - use '@' to mention code blocks"}),[b,N]=(0,X.useState)(null),[S,j]=(0,X.useState)(!1),[E,I]=(0,X.useState)([]),[T,k]=(0,X.useState)(0),R=(0,X.useMemo)(()=>(0,eG.classNames)("w-full p-2 bg-white rounded-b min-h-[2rem] text-black z-1 focus:outline focus:!outline-ide-active-selection-background h-min",S?"rounded-b":"rounded",d),[S,d]),_=(0,X.useMemo)(()=>{var e;let t=null!==(e=null==b?void 0:b.trigger)&&void 0!==e?e:"";if(!v.length||!t)return[];let s=null==b?void 0:b.query,a=C[t];if(!a)return console.error("No trigger was found for the editor"),[];if(!s&&!(null==b?void 0:b.filter)&&a.getCategories().length)return a.handleEmptyQuery();let n=[];s&&a.getCategories().length&&(n=a.getCategories().filter(e=>e.data.mentionText.toLowerCase().startsWith(s.toLowerCase())).map(e=>new MenuItemOptionComponentData(t,e.data.mentionText,e)));let r=E.map(a.handleMentionNodeDataToMenuItemOptionComponentData.bind(a));return n.concat(r)},[null==b?void 0:b.filter,null==b?void 0:b.query,null==b?void 0:b.trigger,E,C,v.length]),D=(0,X.useState)(Math.floor(1e9*Math.random()))[0],P=(0,X.useCallback)(async(e,t,s)=>{k(e=>e+1);let a=await e.handleSearch(t,s,D);void 0!==a&&I(a),k(e=>e-1)},[D]),M=(0,X.useCallback)(async e=>{var t,s;let a=null!==(t=null==e?void 0:e.substring(0,1))&&void 0!==t?t:"";if(!a){N(null);return}let n=C[a],r=null!==(s=null==e?void 0:e.substring(1))&&void 0!==s?s:"",o=r.split(":");if(o.length>1){let[e,...t]=o,s=t.join(":");N({filter:e,query:s,trigger:a}),await P(n,s,e)}else N({filter:null,query:r,trigger:a}),(r||!n.getCategories().length)&&await P(n,r,void 0)},[C,P]),handleMenuItemSelect=async(e,t,s,a)=>{if(!(null==n?void 0:n.current)||0===a.length)return;let r=a[0],o=C[r],i=e.itemProps.data;if(i.optionType===A.CATEGORY&&i.category){let e=a.substring(1),s=i.category;n.current.update(()=>{var e;let s=null!==(e=null==t?void 0:t.getTextContent().indexOf(a))&&void 0!==e?e:-1;if(-1===s)return;null==t||t.setTextContent(r);let n=i.category+":",o=(0,t_.dL)();null==o||o.insertRawText(n)}),I([]),N({filter:s,query:"",trigger:r}),await P(o,e,s);return}if(!v.length||!r)return;let l=i.mentionText;n.current.update(()=>{let e=(0,tP.kg)(r,l,i);if(t){t.replace(e);let s=t.getNextSibling();null==g||g(i),s instanceof t_.R2?s.setTextContent(" "+s.getTextContent()):e.insertAfter(new t_.R2(" "))}}),s()},L=(0,X.useCallback)((e,t)=>{let s=v.reduce((t,s)=>{var a;let n=(0,tP.$R)(e,[s],"[\\(\\{\\[\\,\\./]",",\\*\\?\\$\\|#{}\\(\\)\\^\\[\\]\\!%'\"~=<>;",!1);return n&&n.leadOffset>(null!==(a=null==t?void 0:t.leadOffset)&&void 0!==a?a:-1)&&(t=n),t},null);if(s){s.matchingString=s.replaceableString;let e=s.matchingString.substring(0,1),t=C[e];if(null==n?void 0:n.current)return t.shouldShowMention(n.current.getEditorState(),s)?s:null}return s},[n,v,C]),O=(0,X.useCallback)((e,t)=>{let{setHighlightedIndex:s,selectOptionAndCleanUp:a}=t,n=t.options,r=n.map((e,n)=>(0,z.jsx)(sB,{item:e.itemProps,ref:t=>{e.setRefElement(t)},onClick:()=>{s(n),a(e)},onMouseDown:e=>{e.preventDefault()},onMouseEnter:()=>{s(n)},selected:n===t.selectedIndex,options:p},"".concat(n,"-").concat(e.mentionText)));return(0,z.jsx)(Menu,{loading:T>0,className:m,children:0===r.length?(0,z.jsx)("div",{className:(0,eG.classNames)("border-gray-500/25 p-1 text-sm text-black",null==p?void 0:p.unselectedClassName),children:"No results"}):r})},[T,m,p]),F=(0,X.useCallback)(e=>{if(S){var t;return null==n||null===(t=n.current)||void 0===t||t.dispatchCommand(t_.dB,e),e.preventDefault(),!0}return!1},[n,S]);return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(tj.B,{contentEditable:(0,z.jsx)(tE.f,{className:R,id:y.id,onKeyDown:y.onKeyDown,onKeyUp:y.onKeyUp}),placeholder:w,ErrorBoundary:tI.Z}),"undefined"!=typeof document&&(0,z.jsx)(se.HQ,{onQueryChange:M,onSelectOption:handleMenuItemSelect,triggerFn:L,options:_,onClose:()=>{var e;let t=C[null!==(e=null==b?void 0:b.trigger)&&void 0!==e?e:""];t&&t.handleClose(),j(!1),N(null)},onOpen:e=>{var t;null==h||h();let s=null===(t=e.match)||void 0===t?void 0:t.matchingString.substring(0,1),a=C[null!=s?s:""];a&&a.handleOpen(),j(!0)},menuRenderFn:O,parent:null!==(s=null==r?void 0:r.current)&&void 0!==s?s:void 0,anchorClassName:"lexical-typeahead-menu"}),(0,z.jsx)(tT.e,{}),(0,z.jsx)(MentionPlugin,{services:u,onEnter:F}),o?(0,z.jsx)(sF.$,{onChange:o}):null,(0,z.jsx)(HandleKeyPlugin,{onEnter:i,onEditorKeyDown:l,onEditorKeyUp:c}),(0,z.jsx)(OnLoadPlugin,{onMount:a,editorRef:n}),(0,z.jsx)(PasteInterceptorPlugin,{id:y.id,onImagePaste:f}),(0,z.jsx)(FileMentionPlugin,{inputId:y.id}),(0,z.jsx)(AutoLinkPlugin,{})]})},sq={lexicalRef:(0,X.createRef)(),focusEditor:()=>{throw Error("Function not implemented.")}},sU=(0,X.createContext)(sq),ConversationContextProvider=e=>{let{children:t}=e,s=(0,X.useRef)(null),a=(0,X.useCallback)(()=>{s.current?s.current.focus():console.warn("Lexical ref does not exist.")},[s]);return(0,z.jsx)(sU.Provider,{value:{focusEditor:a,lexicalRef:s},children:t})},useConversationContext=()=>(0,X.useContext)(sU),EditorContext=e=>{let{editorConfig:t}=e;return(0,z.jsx)(tS.R,{initialConfig:t,children:e.children})},ContextItemPill=e=>{let{contextItem:t,label:s}=e,{openFilePointer:a}=useServerConnectionContext(),n=getContextScopeTypeMetadataFromItem(t),r=(0,X.useMemo)(()=>n.getIcon(t),[t,n]),o=n.getFilePointer(t),handleClick=async()=>{o&&await a(o)},i=(0,X.useMemo)(()=>getContextScopeTypeMetadataFromItem(t).getDisplayValue(t),[t]);return(0,z.jsxs)("div",{onClick:o?handleClick:void 0,className:(0,eG.classNames)("group relative flex items-center justify-between gap-1 rounded-full bg-gray-500/20 px-2 py-0.5 text-xs",o?"cursor-pointer hover:bg-gray-500/30":""),children:[r,(0,z.jsxs)("div",{className:"flex flex-row items-end gap-1",children:[(0,z.jsx)("div",{className:"text-[0.625rem] opacity-100",children:i}),s?(0,z.jsx)("span",{className:"text-[0.5625rem] uppercase opacity-50",children:s}):null]})]})},ContextSummaryBar=e=>{var t;let{}=e,{state:{isReceivingMessage:s}}=useServerConnectionContext(),{data:a}=useBrainContext(),[n]=(0,tR.g)(),[r,o]=(0,X.useState)({}),{handleOpenContext:i}=useNavigationContext(),l=(0,X.useMemo)(()=>{var e,t;let s=(0,ty.maybeGetDocumentAbsoluteUriOrEmptyString)(null==a?void 0:null===(e=a.contextStatus)||void 0===e?void 0:e.activeDocument)||"",n=(0,ty.maybeGetDocumentRelativePathOrEmptyString)(null==a?void 0:null===(t=a.contextStatus)||void 0===t?void 0:t.activeDocument)||"";return s||n?new et.igh({scopeItem:{case:"file",value:new et.eww({absoluteUri:s,workspaceRelativePathsMigrateMeToWorkspaceUris:{current:n}})}}):null},[null==a?void 0:null===(t=a.contextStatus)||void 0===t?void 0:t.activeDocument]);return(0,X.useEffect)(()=>{let e=n.registerMutationListener(ContextScopeItemNode,()=>{n.getEditorState().read(()=>{let e={};(0,t_.K8)(ContextScopeItemNode).forEach(t=>{let s=t.getData();if(s&&s.dataType===P.PROTO&&"string"==typeof s.data){let t=et.igh.fromJsonString(s.data),a=getContextScopeTypeMetadataFromItem(t).getKey(t);if(!a)return;e[a]=t}}),o(e)})});return()=>{e()}},[n]),(0,z.jsx)("div",{className:"relative z-10 mb-[1px] flex flex flex h-min w-full flex-row flex-col items-start items-center justify-between",children:(0,z.jsxs)("div",{className:"flex w-full flex-row items-end justify-between py-1",children:[(0,z.jsxs)("div",{className:"flex flex-wrap gap-1 text-xs",children:[l?(0,z.jsx)(ContextItemPill,{contextItem:l,label:"Current"}):null,Object.values(r).map((e,t)=>(0,z.jsx)(ContextItemPill,{contextItem:e},t))]}),(0,z.jsx)("a",{className:(0,eG.classNames)("z-10 rounded px-1 py-0.5 text-xs opacity-80",s?"cursor-not-allowed":"cursor-pointer hover:bg-gray-500/20 hover:opacity-100"),onClick:s?void 0:i,children:"Advanced"})]})})};var sG=s(66382),sQ=s(33281);let AddContextButton=e=>{let{}=e,{lexicalRef:t}=useConversationContext();return(0,z.jsxs)("div",{className:"flex shrink-0 cursor-pointer flex-row items-center overflow-hidden rounded px-1 py-0.5 opacity-70 hover:bg-gray-500/20 hover:opacity-100",onClick:()=>{var e;null===(e=t.current)||void 0===e||e.update(()=>{(0,sQ.Lh)(["@"],"","@","",{})})},children:[(0,z.jsx)(sG.Z,{className:"h-3.5 min-w-3.5 fill-none stroke-ide-text-color"}),(0,z.jsx)("p",{className:"text-xs leading-none",children:(0,z.jsx)("span",{className:"ml-1 hidden min-[300px]:block",children:"Context"})})]})};var sJ=s(28867);let AbstractCustomCategory=class AbstractCustomCategory{handleOpenMenu(){}handleCloseMenu(){}handleCategorySelect(){}async transformData(e){return null}constructor(e,t){if(1!==e.length)throw Error("Trigger must be a single character");this.trigger=e,this.categoryName=t}};var sW=s(57576);let GitDiffCategory=class GitDiffCategory extends AbstractCustomCategory{getCategory(){return{data:{trigger:this.trigger,category:this.categoryName,optionType:A.CATEGORY,data:"Diff",dataType:P.STRING,displayTitle:"Diff (Beta)",displayMetadata:"",mentionText:this.categoryName},renderData:{displayIcon:this.getDisplayIcon()}}}handleQuery(e){return this.isSelected&&this.workspaceEdits.length?Promise.resolve(this.workspaceEdits.filter(t=>t.repoRoot.includes(null!=e?e:"")).map(e=>{var t;let s=e.edits.map(e=>{var t;return(null===(t=e.diff)||void 0===t?void 0:t.unifiedDiff)?"".concat(e.absoluteUri,"\n").concat(unifiedDiffToString(e.diff.unifiedDiff)):""}),a=s.join("\n\n"),n=null!==(t=getFolderName(e.repoRoot))&&void 0!==t?t:e.repoRoot,r="+".concat(e.numAdditions," -").concat(e.numDeletions);return 0===Number(e.numAdditions+e.numDeletions)&&(r="+".concat(e.numAdditions," -").concat(e.numDeletions," (no changes)")),new MarkdownNodeData({data:{trigger:this.trigger,category:this.categoryName,optionType:A.ITEM,data:"[@diff:".concat((0,sJ.h$)((0,si.cleanTextForBase64)(e.repoRoot)),"](diff://").concat((0,sJ.h$)((0,si.cleanTextForBase64)(a||"no changes")),")"),dataType:P.STRING,displayTitle:n,displayMetadata:r,mentionText:"diff:".concat(n)},renderData:{displayIcon:this.getDisplayIcon()}})})):Promise.resolve([])}async handleOpenMenu(){if(null!==this.lsClient){this.isSelected=!1;try{let e=await this.lsClient.getWorkspaceEditState(new ei.Sew({}));this.workspaceEdits=e.workspaceEdits}catch(e){console.error("Failed to get workspace edit state:",e)}}}handleCloseMenu(){this.workspaceEdits=[],this.isSelected=!1}getNodeType(){return MarkdownNode.getType()}handleCategorySelect(){this.isSelected=!0}getDisplayIcon(){return(0,z.jsx)(sW.Z,{className:"w-3 stroke-ide-message-block-bot-color"})}constructor(e){super(GitDiffCategory.trigger,GitDiffCategory.category),this.workspaceEdits=[],this.isSelected=!1,this.lsClient=e}};GitDiffCategory.category="diff",GitDiffCategory.trigger="@";let sH="[@terminal](terminal://last)",sV="[@terminal](terminal://all)";let TerminalCategory=class TerminalCategory extends AbstractCustomCategory{getCategory(){return{data:{trigger:this.trigger,category:this.categoryName,optionType:A.CATEGORY,data:"Terminal",dataType:P.STRING,displayTitle:"Terminal",displayMetadata:"",mentionText:this.categoryName},renderData:{displayIcon:this.getDisplayIcon()}}}handleQuery(e){let t=[{data:{trigger:this.trigger,category:this.categoryName,optionType:A.ITEM,data:sV,dataType:P.STRING,displayTitle:"Full terminal history",displayMetadata:"",mentionText:"terminal:all"},renderData:{displayIcon:this.getDisplayIcon()}},{data:{trigger:this.trigger,category:this.categoryName,optionType:A.ITEM,data:sH,dataType:P.STRING,displayTitle:"Last terminal command",displayMetadata:"",mentionText:"terminal:last"},renderData:{displayIcon:this.getDisplayIcon()}}].map(e=>new MarkdownNodeData(e));return e?Promise.resolve(t.filter(t=>t.getDisplayValue().toLowerCase().includes(e.toLowerCase()))):Promise.resolve(t)}async transformData(e){var t,s;if(!this.readTerminal)return null;let a=e.getData();if(!a)return null;let n=a.data;if(!n)return null;let r="";switch(n){case sV:r=null!==(t=await this.readTerminal(!1))&&void 0!==t?t:"";break;case sH:r=null!==(s=await this.readTerminal(!0))&&void 0!==s?s:"";break;default:return null}return(setTimeout(()=>{this.focusEditor()},100),r)?{...a,data:"[@terminal](terminal://".concat((0,sJ.h$)((0,si.cleanTextForBase64)(r)),")")}:null}getNodeType(){return MarkdownNode.getType()}getDisplayIcon(){return(0,z.jsx)(t$.Z,{className:"w-3 stroke-ide-message-block-bot-color"})}constructor(e,t,s){super(e,"terminal"),this.readTerminal=t,this.focusEditor=s}};let SlashCommandService=class SlashCommandService extends AbstractTriggerService{async handleAsyncSearch(e){return Promise.resolve(["/explain"].filter(t=>t.toLowerCase().includes(e.toLowerCase())))}shouldShowMention(e,t){return 0===t.leadOffset}createMentionNodeData(e){let t=e.substring(1),s="";"explain"===t&&(s="Explain a code snippet, concept, or part of your codebase.");let a={data:{trigger:this.getTrigger(),optionType:A.ITEM,data:"[/".concat(t,"](slash_command://").concat(t,")"),dataType:P.STRING,displayTitle:"/".concat(t),displayMetadata:s,mentionText:t}};return new MarkdownNodeData(a)}getNodeType(){return MarkdownNode.getType()}constructor(e){super(e,[],[])}};let FastApplyBar=()=>{var e,t;let s=(0,tx.useIsMac)(),{dismissPinnedSystemFeedback:a,props:{handleFastApply:n}}=useServerConnectionContext(),{data:r}=useBrainContext(),{conversationID:o,state:{messages:i}}=useServerConnectionContext(),l=(0,X.useMemo)(()=>s?"Y":"Alt+Y",[s]),c=(0,X.useMemo)(()=>s?"N":"Alt+N",[s]),d=(0,X.useMemo)(()=>{var e;let t=(0,ty.maybeGetDocumentAbsoluteUriOrEmptyString)(null==r?void 0:null===(e=r.contextStatus)||void 0===e?void 0:e.activeDocument)||"",s=t.replace(/^file:\/\//,"")||"";return s},[null==r?void 0:null===(e=r.contextStatus)||void 0===e?void 0:e.activeDocument]),u=(0,X.useMemo)(()=>{var e;let t=[...i].reverse(),s=t.filter(e=>{var t;return(null===(t=e.message)||void 0===t?void 0:t.conversationId)===o}),a=null===(e=s[0])||void 0===e?void 0:e.message;if((null==a?void 0:a.content.case)!=="action"||(null==a?void 0:a.content.value.action.case)!=="generic")return"";let n=a.content.value.action.value,r=n.displayText?n.displayText:n.text,l=(0,e0.cleanupMarkdown)(r),c=function(e){let t;let s=/```(\w*)\n([\s\S]*?)```/g,a=[];for(;null!==(t=s.exec(e));){var n,r;let e=null===(n=t[1])||void 0===n?void 0:n.trim().toLowerCase(),s=null===(r=t[2])||void 0===r?void 0:r.trim();e&&s&&"shell"!==e&&"bash"!==e&&"sh"!==e&&a.push(s)}return a}(l);return c.join("\n")},[i,o]),m=(0,X.useMemo)(()=>{var e,t;let s=(0,ty.maybeGetDocumentAbsoluteUriOrEmptyString)(null==r?void 0:null===(e=r.contextStatus)||void 0===e?void 0:e.activeDocument)||"",a=(0,ty.maybeGetDocumentRelativePathOrEmptyString)(null==r?void 0:null===(t=r.contextStatus)||void 0===t?void 0:t.activeDocument)||"";return s||a?new et.igh({scopeItem:{case:"file",value:new et.eww({absoluteUri:s,workspaceRelativePathsMigrateMeToWorkspaceUris:{current:a}})}}):null},[null==r?void 0:null===(t=r.contextStatus)||void 0===t?void 0:t.activeDocument]),p=(0,X.useCallback)(()=>{n&&n(d,u),a()},[u,a,d,n]),x=(0,X.useCallback)(e=>{e.altKey&&"KeyY"===e.code&&(e.preventDefault(),e.stopPropagation(),p()),e.altKey&&"KeyN"===e.code&&(e.preventDefault(),e.stopPropagation(),a())},[a,p]);return(0,X.useEffect)(()=>(window.addEventListener("keydown",x),()=>{window.removeEventListener("keydown",x)}),[x]),u&&(0,z.jsxs)("div",{className:"-ml-2 flex w-[calc(100%_+_1rem)] w-full flex-row flex-wrap items-center justify-between gap-x-2 gap-y-1 whitespace-nowrap bg-ide-tooltip-background px-2 py-1 pr-2 text-xs text-ide-tooltip-color",children:[(0,z.jsxs)("span",{className:"flex flex-wrap",children:["Apply the code changes to"," ",null!==m&&(0,z.jsx)("span",{className:"mx-1",children:(0,z.jsx)(ContextItemPill,{contextItem:m})}),"?"]}),(0,z.jsxs)("div",{className:"-ml-1 flex flex-row flex-nowrap gap-2",children:[(0,z.jsxs)("div",{onClick:p,className:"transition-background cursor-pointer rounded-full px-1 font-medium hover:bg-gray-500/20",children:["Yes ",l]}),(0,z.jsxs)("div",{onClick:a,className:"transition-background cursor-pointer rounded-full px-1 font-medium hover:bg-gray-500/20",children:[" ","No ",c]})]})]})},PinnedSystemErrorFeedbackBar=e=>{let{pinnedSystemErrorFeedback:t}=e,{message:s,title:a}=t,{dismissPinnedSystemFeedback:n}=useServerConnectionContext();return(0,z.jsxs)("div",{className:"mt-1 flex flex-row justify-between bg-ide-tooltip-background px-2 py-1 text-ide-tooltip-color",children:[(0,z.jsxs)("div",{className:"flex flex-col text-xs",children:[(0,z.jsx)("div",{className:"font-medium",children:a}),(0,z.jsx)("div",{className:"opacity-80",children:s})]}),(0,z.jsx)(tL.Z,{onClick:n,className:"h-6 w-6 cursor-pointer rounded p-1 hover:bg-gray-500/20"})]})},CrossSellWindsurfDismissableMessage=()=>{let{state:{userSettings:e},updateUserSettings:t,unleash:s,logEvent:a}=useServerConnectionContext(),{ideName:n,hasEnterpriseExtension:r}=useChatParamsContext(),o=s.isEnabled(et.rpR.CROSS_SELL_EXTENSION_DOWNLOAD_WINDSURF),i=(0,X.useCallback)(()=>{let s=e.clone();s.userNuxStates.push(new et.BEy({event:et.R8u.USER_NUX_EVENT_DISMISS_WINDSURF_CROSS_SELL})),t(s)},[t,e]);return((0,X.useEffect)(()=>{o&&"vscode"===n&&!r&&a(et.tbr.CROSS_SELL_EXTENSION_DOWNLOAD_WINDSURF_NUDGE_IMPRESSION,{source:"panel",type:"conversation"})},[o,n,r,a]),!o||"vscode"!==n||r)?null:(0,z.jsxs)("div",{className:"mt-1 flex flex-row items-center justify-between gap-2 rounded bg-ide-active-selection-background px-2 py-1 text-ide-active-selection-color",children:[(0,z.jsx)("div",{className:"text-sm",children:"Experience enhanced context-awareness and large codebase editing with Windsurf, our new agentic IDE."}),(0,z.jsx)("a",{href:"https://codeium.com/redirect/windsurf/download?ide=".concat(n),target:"_blank",rel:"noreferrer",className:"text-sm font-medium hover:text-ide-active-selection-color hover:underline",onClick:()=>{a(et.tbr.CROSS_SELL_EXTENSION_DOWNLOAD_WINDSURF_CLICK,{source:"panel",type:"conversation"})},children:"Download"}),(0,z.jsx)(tL.Z,{onClick:i,className:"h-6 w-6 cursor-pointer rounded p-1 hover:bg-gray-500/20"})]})},PinnedSystemFeedback_PinnedSystemFeedback=()=>{let{isInitialized:e,pinnedSystemFeedback:t,state:{userSettings:s}}=useServerConnectionContext(),{hasDevExtension:a}=useChatParamsContext(),n=(0,X.useMemo)(()=>s.userNuxStates.some(e=>e.event===et.R8u.USER_NUX_EVENT_DISMISS_WINDSURF_CROSS_SELL),[s.userNuxStates]);switch(null==t?void 0:t.payload.case){case"fastApply":if(a)return(0,z.jsx)(FastApplyBar,{});break;case"error":return(0,z.jsx)(PinnedSystemErrorFeedbackBar,{pinnedSystemErrorFeedback:t.payload.value});default:if(!n&&e)return(0,z.jsx)(CrossSellWindsurfDismissableMessage,{});return null}},ChatFooter=()=>{var e;let{status:t,isInitialized:s,isChatEnabled:a,setDraftQuery:n,sendMessage:r,cancelInflightChat:o,updateUserSettings:i,state:{isReceivingMessage:l,userSettings:c,messages:d,draftQuery:u},readTerminal:m,handshake:p,handleFocusEditor:x,lsClient:h,dismissPinnedSystemFeedback:g,logEvent:f,unleash:y}=useServerConnectionContext(),{numTokens:v,setNumTokens:C}=useBrainContext(),{focusEditor:w}=useConversationContext(),{ideTelemetryEnabled:b,hasEnterpriseExtension:N,hasDevExtension:S,ideName:j}=useChatParamsContext(),E=!!j&&j.includes("windsurf"),[T,k]=(0,X.useState)(N?{model:et.Hnr.MODEL_UNSPECIFIED,model_name:getModelLabel(et.Hnr.MODEL_UNSPECIFIED)}:{model:et.Hnr.MODEL_CHAT_3_5_TURBO,model_name:getModelLabel(et.Hnr.MODEL_CHAT_3_5_TURBO)}),[R,_]=(0,X.useState)(N?constructModelId(et.Hnr.MODEL_UNSPECIFIED,getModelLabel(et.Hnr.MODEL_UNSPECIFIED)):constructModelId(et.Hnr.MODEL_CHAT_3_5_TURBO,getModelLabel(et.Hnr.MODEL_CHAT_3_5_TURBO))),D=(0,X.useRef)(null),A=(0,tx.useIsMac)(),{query:P}=useContextMention(),{tab:M,changeTab:L}=useNavigationContext(),{lexicalRef:O}=useConversationContext(),F=useChatParamsContext(),B=(0,X.useMemo)(()=>new TerminalCategory(AtMentionService.trigger,m,w),[m,w]),q=(0,X.useMemo)(()=>new GitDiffCategory(h),[h]),U=(0,X.useMemo)(()=>{let e=[];if(m&&e.push(B),N||e.push(q),0!==e.length)return e},[q,N,m,B]),G=(0,X.useMemo)(()=>new AtMentionService(P,U,S,E,void 0,y),[P,U,S,E,y]),[Q,J]=(0,X.useState)(!1),W=!!(null==p?void 0:null===(e=p.userStatus)||void 0===e?void 0:e.teamsFeatures.includes(et.Y7c.OPENAI_DISABLED)),[H,V]=(0,X.useState)(!1),Y=(0,X.useMemo)(()=>new SlashCommandService("/"),[]),Z=(0,X.useMemo)(()=>[G,Y],[G,Y]),K=(0,X.useMemo)(()=>createEmptyEditorState(),[]),$=(0,X.useMemo)(()=>({...createConfig("edit",tY),editorState:K}),[K]),{data:es,isLoading:ea}=(0,tF.useFetcher)({fire:(0,X.useCallback)(async()=>{if(!N)return[];let e=await (null==h?void 0:h.getExternalModel(new ei.yyF({apiKey:F.apiKey||""}))),t=null==e?void 0:e.models;return t},[N,F,h])}),[en,er]=(0,X.useState)([]);(0,X.useEffect)(()=>{if(!N&&h&&F.apiKey){let fetchTeamOrganizationalControls=async()=>{try{var e;let t=new ei.yFv({metadata:getMetadata(F)}),s=await h.getTeamOrganizationalControls(t),a=(null===(e=s.controls)||void 0===e?void 0:e.extensionModelLabels)||[];er(a)}catch(e){console.error("Error fetching team organizational controls:",e)}};fetchTeamOrganizationalControls()}},[h,N,F]);let eo=(0,X.useMemo)(()=>{let e=[];return N?es&&es.length>0&&(e=enterpriseModelOptions(es)):e=modelOptions(W,en),e},[es,N,W,en]),el=(0,X.useMemo)(()=>N?{model:et.Hnr.MODEL_UNSPECIFIED,model_name:getModelLabel(et.Hnr.MODEL_UNSPECIFIED)}:{model:et.Hnr.MODEL_CHAT_3_5_TURBO,model_name:getModelLabel(et.Hnr.MODEL_CHAT_3_5_TURBO)},[N]);(0,X.useEffect)(()=>{let e=getModelFromId(R,eo);void 0==e?k(el):k({model:e.value,model_name:e.label})},[R,eo,el]);let ec=t===I.CONNECTING||ea,[ed,eu]=(0,X.useState)(),em=(0,X.useCallback)(sO().debounce(e=>{let t=JSON.stringify(null==e?void 0:e.getEditorState().toJSON());n(t)},3e3),[]),ep=(0,X.useCallback)(sO().debounce(e=>{let t="";if(null==e||e.getEditorState().read(()=>{let e=(0,t_.Gv)().getTextContent();t=e.trim()}),!t){C(0);return}null==h||h.getMessageTokenCount(new ei.aBG({chatMessage:t,requestedModelId:T.model})).then(e=>{C(e.tokenCount)}).catch(e=>{console.error(e)})},1e3),[T,h]),[ex,eh]=(0,X.useState)(!1);(0,X.useEffect)(()=>{if(s&&!ex){eh(!0);try{var e;let t=(0,t_.Jh)();null===(e=O.current)||void 0===e||e.setEditorState(t.parseEditorState(null!=u?u:"{}"))}catch(e){}}},[s,u,O,ex]),(0,X.useEffect)(()=>{if(s&&!Q&&!ea){var e,t,a;if(N){if(0===eo.length){_(constructModelId(et.Hnr.MODEL_UNSPECIFIED,getModelLabel(et.Hnr.MODEL_UNSPECIFIED)));return}J(!0);let e=eo.map(e=>e.label).includes(c.lastSelectedModelName);e?_(constructModelId(c.lastSelectedModel,c.lastSelectedModelName)):_(constructModelId((null===(t=eo[0])||void 0===t?void 0:t.value)||et.Hnr.MODEL_UNSPECIFIED,(null===(a=eo[0])||void 0===a?void 0:a.label)||getModelLabel(et.Hnr.MODEL_UNSPECIFIED)));return}J(!0);let s=eo.map(e=>e.value).includes(c.lastSelectedModel);if(null==p?void 0:null===(e=p.planInfo)||void 0===e?void 0:e.allowStickyPremiumModels){let e=c.clone();c.rememberLastModelSelection!==et.kZq.DISABLED&&s?_(constructModelId(c.lastSelectedModel,getModelLabel(c.lastSelectedModel))):(e.lastSelectedModel=et.Hnr.MODEL_CLAUDE_3_5_SONNET_20240620,_(constructModelId(et.Hnr.MODEL_CLAUDE_3_5_SONNET_20240620,getModelLabel(et.Hnr.MODEL_CLAUDE_3_5_SONNET_20240620))),i(e))}else{let e=c.clone();e.lastSelectedModel=et.Hnr.MODEL_CHAT_3_5_TURBO,_(constructModelId(et.Hnr.MODEL_CHAT_3_5_TURBO,getModelLabel(et.Hnr.MODEL_CHAT_3_5_TURBO))),i(e)}}},[Q,N,c,W,s,i,p,u,O,eo,ea]),(0,X.useEffect)(()=>{let e=0;(null==p?void 0:p.userStatus)&&(e=getChatTokensSoftLimit(p.userStatus)),v>e?V(!0):V(!1)},[v,p]);let eg=(0,X.useCallback)(e=>{var t,s,a;if(g(),!b||l||isEditorEmpty(O.current))return;let o=null===(t=O.current)||void 0===t?void 0:t.getEditorState();if(!(null==o?void 0:o.toJSON()))return null;let i=getModelFromId(R,eo),c=convertEditorStateToTextOrScopeItem(o);r(new ee.LD({intent:{case:"generic",value:new ee.uk({items:c})}}),{contextInclusionType:null!=e?e:et.tyb.UNSPECIFIED,model:T.model,...N&&{externalModelOptions:{model_name:T.model_name,max_input_tokens:null==i?void 0:null===(s=i.enterpriseModelConfig)||void 0===s?void 0:s.maxInputTokens,max_output_tokens:null==i?void 0:null===(a=i.enterpriseModelConfig)||void 0===a?void 0:a.maxCompletionTokens}}}),O.current&&clearEditor(O.current),n("")},[g,b,l,n,O,r,T,R,eo,N]),ef=(0,X.useCallback)(async(e,t)=>{if(e&&"intent"===e.content.case){let s=e.content.value;if("generic"===s.intent.case){let e=convertTextOrScopeItemToNodeData(s.intent.value.items,new ParsingConfig);O.current&&(eu({index:t,query:e}),await updateEditor(O.current,e),setSelectionAtStart(O.current));return}}},[O]),ey=(0,X.useCallback)(async()=>{if(!isEditorEmpty(O.current)&&void 0===ed)return;let e=void 0!==ed?ed.index-1:d.length-1;for(let s=e;s>=0;s--){var t;let e=d[s];if((null==e?void 0:null===(t=e.message)||void 0===t?void 0:t.source)===et.ogd.USER){await ef(e.message,s);return}}eu(void 0)},[ed,ef,d,O]),ev=(0,X.useCallback)(async()=>{if(!isEditorEmpty(O.current)&&void 0===ed)return;let e=void 0!==ed?ed.index+1:0;for(let s=e;s<d.length;s++){var t;let e=d[s];if((null==e?void 0:null===(t=e.message)||void 0===t?void 0:t.source)===et.ogd.USER){await ef(e.message,s);return}}eu(void 0)},[ed,d,ef,O]),eC=(0,X.useCallback)(e=>{var t;return(null===(t=e.nativeEvent)||void 0===t||!t.isComposing)&&!e.shiftKey&&(s?(isEditorEmpty(O.current)||H?e.preventDefault():((A?e.metaKey:e.ctrlKey)?eg(et.tyb.INCLUDE):eg(),e.preventDefault(),eu(void 0)),!0):(e.preventDefault(),!1))},[O,eg,A,s,H]),ew=(0,eG.classNames)("absolute top-1/2 -left-1 -translate-x-full -translate-y-1/2","rounded bg-ide-chat-background px-1 py-0.5 text-xs text-ide-chat-color whitespace-nowrap","group-hover:opacity-100 opacity-0 transition-opacity duration-200 flex items-center hover:!opacity-0 hover:cursor-default");(0,X.useEffect)(()=>{let onToggleFocus=()=>{O.current&&(M!==et.q80.CHAT&&L(et.q80.CHAT),O.current.getRootElement()===document.activeElement?setTimeout(()=>{null==x||x()},0):setTimeout(()=>{var e;null===(e=O.current)||void 0===e||e.focus()},0))},onMessage=e=>{"toggleFocus"===e.data.type&&onToggleFocus()};return window.addEventListener("message",onMessage),()=>{window.removeEventListener("message",onMessage)}},[O,M,L]);let eb=(0,z.jsx)("div",{children:(0,z.jsxs)("div",{className:"mb-0.5 mt-0 flex w-full flex-row items-center justify-between gap-1",children:[(0,z.jsx)(AddContextButton,{}),(!N||eo.length>0)&&(0,z.jsx)(ModelSelect,{isLoading:!Q,modelConfigs:eo,value:R,onChange:e=>{_(e);let t=c.clone(),s=getModelFromId(e,eo);void 0!=s&&(t.lastSelectedModel=s.value,t.lastSelectedModelName=s.label,f(et.tbr.CHAT_CHANGE_MODEL,{model:s.label}),i(t))}}),(0,z.jsx)("div",{className:"flex-grow"}),(0,z.jsx)("div",{className:"flex flex-row items-center justify-end",children:(0,z.jsx)(ChatWithCodebaseButton,{onClick:()=>eg(et.tyb.INCLUDE),disabled:l||!a||isEditorEmpty(O.current)||H})})]})}),eN=(0,z.jsxs)("div",{className:"relative",children:[(0,z.jsx)(eY.ErrorBoundary,{title:"Chat Input",children:(0,z.jsx)("div",{ref:D,children:(0,z.jsx)(ContextMentionEditor,{id:"chat-input",containerRef:D,editorRef:O,onEnter:eC,onEditorChange:()=>{em(O.current),ep(O.current)},onEditorKeyUp:()=>(ey(),!1),onEditorKeyDown:()=>(ev(),!1),onMenuOpen:()=>{f(et.tbr.CHAT_MENTION_MENU_OPEN)},onInsertMention:e=>{f(et.tbr.CHAT_MENTION_INSERT,e)},className:"mb-1 !bg-ide-input-background pr-8 text-sm !text-ide-input-color",triggerServices:Z,menuClassName:"absolute left-0 right-0 top-0 -translate-y-full z-100 !bg-ide-input-background !text-ide-input-color max-h-[14.5rem] overflow-auto",menuItemOptions:{selectedClassName:"bg-ide-active-selection-background text-ide-active-selection-color [&_svg]:stroke-ide-active-selection-color",unselectedClassName:"!bg-ide-editor-background text-ide-editor-color [&_svg]:stroke-ide-editor-color"},placeholderClassName:"!text-ide-input-color"})})}),ec||!a?null:(0,z.jsx)("button",{className:(0,eG.classNames)("text-ide-chat-color group absolute right-2 top-[50%] flex h-[24px] w-[24px] -translate-y-[50%] cursor-pointer items-center justify-center text-sm",H?"disabled:cursor-not-allowed disabled:opacity-100":""),type:"submit",disabled:!a||H,onClick:e=>{e.preventDefault(),l?o():eg()},children:l?(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)("div",{className:ew,children:"Cancel response"}),(0,z.jsx)(sk.Z,{className:"h-5 w-5 fill-red-500 stroke-red-500"}),(0,z.jsx)("div",{className:"absolute left-0 top-0 h-full w-full rounded bg-ide-chat-background opacity-50 group-hover:opacity-100"})]}):H?(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)("div",{className:ew,children:"Shorten message to send"}),(0,z.jsx)("span",{className:"z-10 opacity-70",children:""}),(0,z.jsx)("div",{className:"absolute left-0 top-0 h-full w-full rounded bg-ide-chat-background opacity-40 group-hover:opacity-100"})]}):(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)("div",{className:ew,children:"Send"}),(0,z.jsx)("span",{className:"z-10 opacity-70",children:""}),(0,z.jsx)("div",{className:"absolute left-0 top-0 h-full w-full rounded bg-ide-chat-background opacity-50 group-hover:opacity-100"})]})})]});return(0,z.jsx)("footer",{className:"w-full grow-0 bg-ide-chat-background px-2 pb-1 pt-[1px] shadow-[0_-1px_2px_0_rgba(0,0,0,0.05)]",children:(0,z.jsx)(EditorContext,{editorConfig:$,children:(0,z.jsxs)("form",{onSubmit:()=>eg(),children:[(0,z.jsx)(PinnedSystemFeedback_PinnedSystemFeedback,{}),(0,z.jsx)(ContextSummaryBar,{}),eN,eb]})})})};var sY=s(40685),sZ=s(94186),sK=s(99263),sz=s(58758),sX=s(90902),s$=s(95437);let functionInfoToMarkdown=e=>e.rawSource?"`".concat(e.nodeName,"`:\n\n").concat(wrapMarkdownCode(e.rawSource,e.language)):"`".concat(e.nodeName,"`"),codeBlockInfoToMarkdown=(e,t,s)=>"`".concat(getCodeBlockPointerLabel(e,s),"`:\n\n").concat(wrapMarkdownCode(s.rawSource,t)),messageToMarkdown=(e,t)=>{let s=[],a=e.timestamp?eP()(e.timestamp.toDate()):void 0,n=a?" _at ".concat(a.format("h:mm a, MMM D, YYYY"),"_"):"";switch(e.content.case){case"action":{let{action:t,contextItems:a}=e.content.value;switch(s.push("**Codeium**".concat(n)),t.case){case"generic":s.push(t.value.text);break;case"edit":s.push("Edit ".concat(GetChatMessageActionEditAbsoluteUri(t.value).toDisplayString()));break;default:s.push("unknown message type")}let r=a.map(e=>{let{nodePrefix:t,nodeName:s}=getContextItemLabel(e);return"- ".concat(t," `").concat(s,"`")}),o="_Context Items Read (".concat(a.length,"):_\n\n").concat(r.join("\n"),"\n");a.length>0&&s.push(o);break}case"intent":{var r,o;let a=e.content.value.intent;switch(s.push("**".concat((null==t?void 0:null===(r=t.user)||void 0===r?void 0:r.name)||"User","**").concat(n)),a.case){case"explainFunction":a.value.functionInfo?s.push("Explain ".concat(functionInfoToMarkdown(a.value.functionInfo))):s.push("Explain function in `".concat(GetIntentAbsolutePath(a.value).toDisplayString(),"`"));break;case"explainCodeBlock":a.value.codeBlockInfo?s.push("Explain ".concat(codeBlockInfoToMarkdown(GetIntentAbsolutePath(a.value),a.value.language,a.value.codeBlockInfo))):s.push("Explain `".concat(GetIntentAbsolutePath(a.value).toDisplayString(),"`"));break;case"codeBlockRefactor":a.value.codeBlockInfo?s.push("Refactor ".concat(codeBlockInfoToMarkdown(GetIntentAbsolutePath(a.value),a.value.language,a.value.codeBlockInfo))):s.push("Refactor `".concat(GetIntentAbsolutePath(a.value).toDisplayString(),"`"));break;case"functionDocstring":a.value.functionInfo?s.push("Generate docstring for ".concat(functionInfoToMarkdown(a.value.functionInfo))):s.push("Generate docstring for function in `".concat(GetIntentAbsolutePath(a.value).toDisplayString(),"`"));break;case"functionUnitTests":a.value.functionInfo?s.push("Generate unit tests for ".concat(functionInfoToMarkdown(a.value.functionInfo))):s.push("Generate unit tests for function in `".concat(GetIntentAbsolutePath(a.value).toDisplayString(),"`"));break;case"functionRefactor":a.value.functionInfo?s.push("Refactor ".concat(functionInfoToMarkdown(a.value.functionInfo),"\n\nInstructions: ").concat(a.value.refactorDescription)):s.push("Refactor function in `".concat(GetIntentAbsolutePath(a.value).toDisplayString(),"`"));break;case"generateCode":s.push("Generate: ".concat(a.value.instruction));break;case"problemExplain":s.push("Explain problem: `".concat(a.value.diagnosticMessage,"`"));break;case"explainClass":s.push("Explain class: `".concat(null===(o=a.value.classInfo)||void 0===o?void 0:o.nodeName,"`"));break;case"search":s.push("Searching: ".concat(a.value.query));break;case"generic":s.push(a.value.items.filter(e=>"text"===e.chunk.case).map(e=>e.chunk.value).join(""));break;default:s.push("unknown message type")}}}return s.join("\n\n")},conversationToMarkdown=(e,t)=>{let s=[];return e.forEach(e=>{switch(e.source){case et.ogd.USER:s.push(messageToMarkdown(e,t));break;case et.ogd.SYSTEM:"status"!==e.content.case&&s.push(messageToMarkdown(e,t))}}),"# Codeium Chat Conversation\n\nNote: _This is purely the output of the chat conversation and does not contain any raw data, codebase snippets, etc. used to generate the output._\n\n".concat(s.join("\n\n---\n\n"))};var s0=s(75306),s1=s(15124),s2=s(11409),s5=s(21679);let ChatHeaderMenu=()=>{let{deleteConversation:e,conversationID:t,props:{openGenericUrl:s,openProfile:a},state:{messages:n}}=useServerConnectionContext(),{handleOpenCascade:r,handleOpenDebug:o}=useNavigationContext(),{hasDevExtension:i,ideName:l}=useChatParamsContext(),c="vscode"===l||"jetbrains"===l||"windsurf"===l;return(0,z.jsx)("div",{className:"relative ml-3",children:(0,z.jsxs)(sz.v,{as:X.Fragment,children:[(0,z.jsxs)(sz.v.Button,{className:"group relative flex items-center justify-center","data-tooltip-id":"overflow-header-menu",children:[(0,z.jsx)(sK.EllipsesVerticalIcon,{className:"h-4 w-4 fill-ide-text-color"}),(0,z.jsx)("div",{className:"absolute -bottom-1 -left-1 -right-1 -top-1 rounded bg-gray-500 opacity-0 group-hover:opacity-20"}),(0,z.jsx)(e7.u,{id:"overflow-header-menu",place:"bottom-start",className:"z-[200] max-w-[350px] !bg-ide-editor-background !text-sm !text-ide-editor-color",opacity:"1",border:"1px solid rgba(128,128,128,0.5)",children:"Current chat options"})]}),(0,z.jsx)(sD.u,{as:X.Fragment,children:(0,z.jsx)(sz.v.Items,{className:(0,eG.classNames)("absolute right-0 top-full z-20 mt-2 origin-top-right rounded-md border border-gray-500/25 text-right shadow-lg ring-1 ring-opacity-5 focus:outline-none","bg-ide-editor-background text-sm text-ide-editor-color ring-ide-editor-background"),children:(0,z.jsxs)("div",{className:"flex flex-col items-start justify-center space-y-1 py-1",children:[(0,z.jsx)(sz.v.Item,{as:X.Fragment,disabled:0===n.length,children:e=>{let{active:a,close:r,disabled:o}=e;return(0,z.jsxs)("a",{className:(0,eG.classNames)("flex w-full flex-row items-center justify-start gap-1 px-2 py-1",a?"bg-ide-tooltip-background":"bg-none",o?"cursor-default opacity-50":"cursor-pointer opacity-100"),onClick:()=>{let e=conversationToMarkdown(n.map(e=>e.message).filter(ed.notEmpty));if(c){if("vscode"===l||"windsurf"===l)(0,eD.downloadText)(e,"Codeium Chat - ".concat(t,".md"));else{let t=(0,eD.generateFileBlob)(e);s(t)}}else(0,eR.copyToClipboard)(e);r()},children:[c?(0,z.jsx)(sX.Z,{className:"h-3.5 w-3.5"}):(0,z.jsx)(s2.Z,{className:"h-3.5 w-3.5"}),(0,z.jsx)("span",{className:"whitespace-nowrap",children:c?"Export Conversation":"Copy Conversation"})]})}}),(0,z.jsx)(sz.v.Item,{as:X.Fragment,disabled:0===n.length,children:s=>{let{active:a,close:n,disabled:r}=s;return(0,z.jsxs)("a",{className:(0,eG.classNames)("flex w-full flex-row items-center justify-start gap-1 px-2 py-1",a?"bg-ide-tooltip-background":"bg-none",r?"cursor-default opacity-50":"cursor-pointer opacity-100"),onClick:()=>{e(t),n()},children:[(0,z.jsx)(s$.TrashIcon,{className:"h-3.5 w-3.5"}),(0,z.jsx)("span",{className:"whitespace-nowrap",children:"Delete Chat"})]})}}),a&&(0,z.jsx)(sz.v.Item,{as:X.Fragment,children:e=>{let{active:t,disabled:s}=e;return(0,z.jsxs)("a",{className:(0,eG.classNames)("flex w-full cursor-pointer flex-row items-center justify-start gap-1 px-2 py-1",t?"bg-ide-tooltip-background":"bg-none",s?"cursor-default opacity-50":"cursor-pointer opacity-100"),onClick:a,children:[(0,z.jsx)(s0.Z,{className:"h-3.5 w-3.5"}),(0,z.jsx)("span",{className:"whitespace-nowrap",children:"Open Profile"})]})}}),i||"windsurf"===l?(0,z.jsx)(sz.v.Item,{as:X.Fragment,children:e=>{let{active:t,disabled:s}=e;return(0,z.jsxs)("a",{className:(0,eG.classNames)("flex w-full cursor-pointer flex-row items-center justify-start gap-1 px-2 py-1",t?"bg-ide-tooltip-background":"bg-none",s?"cursor-default opacity-50":"cursor-pointer opacity-100"),onClick:r,children:[(0,z.jsx)(s1.Z,{className:"h-3.5 w-3.5"}),(0,z.jsx)("span",{className:"whitespace-nowrap",children:"Cascade 2.0"})]})}}):null,i&&(0,z.jsx)(sz.v.Item,{as:X.Fragment,children:e=>{let{active:t,disabled:s}=e;return(0,z.jsxs)("a",{className:(0,eG.classNames)("flex w-full cursor-pointer flex-row items-center justify-start gap-1 px-2 py-1",t?"bg-ide-tooltip-background":"bg-none",s?"cursor-default opacity-50":"cursor-pointer opacity-100"),onClick:o,children:[(0,z.jsx)(s5.Z,{className:"h-3.5 w-3.5"}),(0,z.jsx)("span",{className:"whitespace-nowrap",children:"Debug"})]})}})]})})})]})})};var s3=s(7819),s4=s(53244);let ConversationSettings=e=>{let{onShowConversationHistory:t}=e,{newConversation:s,state:{messages:a,isReceivingMessage:n},props:{handlePopup:r},isInitialized:o}=useServerConnectionContext(),{focusEditor:i}=useConversationContext(),{handleOpenSettings:l}=useNavigationContext(),c=n||0===a.length,handleNewConversation=()=>{s(),i()};return(0,z.jsxs)("div",{className:"z-[60] flex min-h-[2.5rem] w-full flex-row items-center justify-between bg-ide-chat-background pr-4 shadow",children:[(0,z.jsx)("div",{className:"pl-[20px] text-sm opacity-80",children:"Codeium Chat"}),(0,z.jsxs)("div",{className:"flex flex-row items-center justify-center",children:[(0,z.jsx)(sZ.X,{disabled:c,onClick:()=>{handleNewConversation()},className:"flex w-4 items-center justify-center","data-tooltip-id":"new-conversation-tooltip",children:(0,z.jsxs)("span",{className:(0,eG.classNames)("opacity-80",c?"":"group-hover:opacity-100"),children:[(0,z.jsx)(sG.Z,{className:"h-4 w-4 fill-ide-text-color hover:fill-ide-link-color"})," "]})}),(0,z.jsx)(e7.u,{id:"new-conversation-tooltip",place:"bottom-start",className:"z-[200] max-w-[350px] !bg-ide-editor-background !text-sm !text-ide-editor-color",opacity:"1",border:"1px solid rgba(128,128,128,0.5)",children:"Start a new conversation"}),(0,z.jsxs)(sZ.X,{disabled:!o,onClick:()=>{t()},className:"ml-3 flex w-4 items-center justify-center","data-tooltip-id":"history-tooltip",children:[(0,z.jsxs)("span",{className:(0,eG.classNames)("opacity-80",c?"":"group-hover:opacity-100"),children:[(0,z.jsx)(sY.HistoryIcon,{className:"h-4 w-4 fill-ide-text-color hover:fill-ide-link-color"})," "]}),(0,z.jsx)(e7.u,{id:"history-tooltip",place:"bottom-start",className:"z-[200] max-w-[350px] !bg-ide-editor-background !text-sm !text-ide-editor-color",opacity:"1",border:"1px solid rgba(128,128,128,0.5)",children:"Past Chat Conversations"})]}),r&&(0,z.jsxs)(sZ.X,{disabled:!o,onClick:()=>{r()},className:"ml-3 flex w-4 items-center justify-center","data-tooltip-id":"new-window-tooltip",children:[(0,z.jsxs)("div",{className:"flex flex-row items-center justify-center gap-x-0.5 opacity-80 group-hover:opacity-100",children:[(0,z.jsx)(s4.Z,{className:"h-4 w-4 stroke-ide-text-color p-[1px] hover:stroke-ide-link-color"})," "]}),(0,z.jsx)(e7.u,{id:"new-window-tooltip",place:"bottom-start",className:"z-[200] max-w-[350px] !bg-ide-editor-background !text-sm !text-ide-editor-color",opacity:"1",border:"1px solid rgba(128,128,128,0.5)",children:"Open in New Window"})]}),(0,z.jsxs)(sZ.X,{disabled:!o,onClick:()=>{l()},className:"ml-3 flex w-4 items-center justify-center","data-tooltip-id":"settings-tooltip",children:[(0,z.jsxs)("div",{className:"flex flex-row items-center justify-center gap-x-0.5 opacity-80 group-hover:opacity-100",children:[(0,z.jsx)(s3.Z,{className:"h-4 w-4 stroke-ide-text-color hover:stroke-ide-link-color"})," "]}),(0,z.jsx)(e7.u,{id:"settings-tooltip",place:"bottom-start",className:"z-[200] max-w-[350px] !bg-ide-editor-background !text-sm !text-ide-editor-color",opacity:"1",border:"1px solid rgba(128,128,128,0.5)",children:"Settings"})]}),(0,z.jsx)(ChatHeaderMenu,{})]})]})},removeMarkdownLinks=e=>{let t=e,s=(0,e0.getLinksFromMarkdown)(e);for(let e of s)t=t.replace(e.originalText,e.text);return t},prettyPrintMessage=e=>{switch(e.content.case){case"action":{let t=e.content.value.action;switch(t.case){case"generic":return t.value.text;case"edit":return"Edit ".concat(GetChatMessageActionEditAbsoluteUri(t.value).toDisplayString())}break}case"intent":{var t,s,a,n,r;let o=e.content.value.intent;switch(o.case){case"explainFunction":return"Explain ".concat(null===(t=o.value.functionInfo)||void 0===t?void 0:t.nodeName);case"explainCodeBlock":if(!o.value.codeBlockInfo)return"Explain ".concat(GetIntentAbsolutePath(o.value).toDisplayString());return"Explain ".concat(getCodeBlockPointerLabel(GetIntentAbsolutePath(o.value),o.value.codeBlockInfo));case"codeBlockRefactor":if(!o.value.codeBlockInfo)return"Refactor ".concat(GetIntentAbsolutePath(o.value).toDisplayString());return"Refactor ".concat(getCodeBlockPointerLabel(GetIntentAbsolutePath(o.value),o.value.codeBlockInfo));case"functionDocstring":return"Docstring for ".concat(null===(s=o.value.functionInfo)||void 0===s?void 0:s.nodeName);case"functionUnitTests":return"Unit tests for ".concat(null===(a=o.value.functionInfo)||void 0===a?void 0:a.nodeName);case"functionRefactor":return"Refactor ".concat(null===(n=o.value.functionInfo)||void 0===n?void 0:n.nodeName,": ").concat(o.value.refactorDescription);case"generateCode":return"Generate: ".concat(o.value.instruction);case"problemExplain":return"Explain problem: ".concat(o.value.diagnosticMessage);case"explainClass":return"Explain class: ".concat(null===(r=o.value.classInfo)||void 0===r?void 0:r.nodeName);case"search":return"Searching: ".concat(o.value.query);case"generic":if(o.value.items.length>0)return convertTextOrScopeItemToPreview(o.value.items,new ParsingConfig);return removeMarkdownLinks(o.value.text)}}}return JSON.stringify(e)},ConversationItem=e=>{let{selected:t=!1,conversation:s,onClick:a,onDelete:n}=e,r=(0,X.useCallback)(e=>{e.stopPropagation(),e.preventDefault(),n()},[n]),o=(0,X.useMemo)(()=>prettyPrintMessage(s.firstMessage),[s.firstMessage]);return(0,z.jsxs)("div",{className:(0,eG.classNames)(t?"bg-gray-500/20":"","group -mx-2 flex cursor-pointer flex-row items-center justify-between rounded-sm px-2 py-1 hover:bg-gray-500/10"),onClick:()=>null==a?void 0:a(),children:[(0,z.jsxs)("div",{className:"flex max-w-[calc(100%-20px)] grow flex-row gap-x-3",children:[(0,z.jsx)("span",{className:"overflow-hidden text-ellipsis whitespace-nowrap text-xs",children:o}),(0,z.jsx)("span",{className:(0,eG.classNames)("whitespace-nowrap text-xs","text-ide-text-color opacity-50"),children:eP()(s.latestMessageAt).fromNow()})]}),(0,z.jsx)(tL.Z,{className:"invisible h-4 w-4 shrink-0 grow-0 cursor-pointer group-hover:visible",onClick:r})]})};var s6=s(3034),s8=s(58220);let EmptyConversationHistory=e=>{let{newConversation:t,onClose:s}=e;return(0,z.jsxs)("div",{className:"flex flex-grow flex-col items-center justify-center",children:[(0,z.jsx)("h3",{children:"No past conversations"}),(0,z.jsx)("div",{children:"Start your first conversation"}),(0,z.jsx)(su.Button,{className:"mt-4",onClick:()=>{t(),s()},children:"New Chat"})]})},ConversationHistory=e=>{let{onClose:t}=e,[s,a]=(0,X.useState)(!1),{conversationID:n,setConversationID:r,newConversation:o,deleteConversation:i,cancelInflightChat:l,clearHistory:c,state:{conversations:d,isReceivingMessage:u},dismissPinnedSystemFeedback:m}=useServerConnectionContext(),p=(0,X.useCallback)(()=>{l(),c(),a(!1)},[l,c]),x=(0,X.useMemo)(()=>(0,z.jsx)(z.Fragment,{children:(0,z.jsxs)("div",{className:"flex flex-grow flex-col overflow-y-auto px-4 py-2",children:[(0,z.jsxs)("div",{className:"mb-1 flex flex-row items-center",children:[(0,z.jsx)("h6",{className:"grow text-sm font-medium",children:"Conversations"}),(0,z.jsxs)("div",{className:"flex flex-row",children:[(0,z.jsx)(e7.u,{id:"new-conversation-tooltip",positionStrategy:"fixed",className:"max-w-[350px] bg-ide-tooltip-background text-ide-tooltip-color",border:"1px solid var(--codeium-text-color, rgb(255, 255, 255))",children:(0,z.jsx)("p",{children:"Start a new conversation"})}),(0,z.jsx)(e7.u,{id:"delete-all-conversations-tooltip",positionStrategy:"fixed",className:"max-w-[350px]",border:"1px solid var(--codeium-text-color, rgb(255, 255, 255))",children:(0,z.jsx)("p",{children:"Delete All Conversations"})}),(0,z.jsxs)("div",{className:"flex flex-row",children:[(0,z.jsx)("div",{className:"cursor-pointer rounded p-1 hover:bg-gray-500/20","data-tooltip-id":"delete-all-conversations-tooltip",onClick:()=>{a(!0)},children:(0,z.jsx)(s$.TrashIcon,{className:"h-4 w-4"})}),(0,z.jsx)("div",{className:"cursor-pointer rounded p-1 hover:bg-gray-500/20","data-tooltip-id":"new-conversation-tooltip",onClick:()=>{o(),t()},children:(0,z.jsx)(s8.Z,{className:"h-4 w-4"})})]}),s&&(0,z.jsx)(s6.DangerModal,{isOpen:s,title:"Delete all conversations",description:"Are you sure you want to delete all conversations? This action cannot be undone.",confirmText:"Delete",onConfirm:()=>{p()},onCancel:()=>{a(!1)}})]})]}),(0,z.jsx)("div",{className:"space-y-1",children:d.map(e=>(0,z.jsx)(ConversationItem,{selected:n===e.conversationID,conversation:e,onClick:()=>{r(e.conversationID),m(),t()},onDelete:()=>{u&&n===e.conversationID&&l(),i(e.conversationID)}},e.conversationID))})]})}),[l,s,n,d,i,p,u,o,t,r,m]);return(0,z.jsxs)("div",{className:"flex w-full flex-grow flex-col overflow-auto",children:[(0,z.jsx)("div",{className:"flex flex-row items-center justify-end border-b-[1px] border-gray-500/20 px-4 py-2",children:(0,z.jsx)(sZ.X,{onClick:()=>{t()},children:(0,z.jsx)(tL.Z,{className:"h-4 w-4 hover:stroke-ide-text-color"})})}),0===d.length?(0,z.jsx)(EmptyConversationHistory,{newConversation:o,onClose:t}):x]})};var s9=s(62108),s7=s(18858);let IndexStatusRow=e=>{var t;let{id:s,indexStatus:a,ignoredWorkSpaces:n}=e,r=(0,X.useMemo)(()=>{for(let e in null==a?void 0:a.indexProgress){let t=a.indexProgress[e];if(1!==t.progress)return e}},[a]),o=(0,X.useMemo)(()=>{var e;return n.includes(null!==(e=null==a?void 0:a.workspaceFolder)&&void 0!==e?e:"")?s7.BadgeStatus.Red:r?s7.BadgeStatus.Yellow:s7.BadgeStatus.Green},[a,n,r]),i=(0,X.useMemo)(()=>o===s7.BadgeStatus.Red?(0,z.jsx)(s9.Badge,{status:o,label:(0,z.jsx)("span",{className:"text-red",children:"Not Indexed"})}):r?(0,z.jsx)(s9.Badge,{status:o,label:(0,z.jsxs)("div",{className:"flex flex-col",children:[(0,z.jsx)("span",{children:"Indexing"}),(0,z.jsxs)("span",{className:"text-blue",children:["(",r.replace(/\b\w/g,e=>e.toUpperCase()),")"]})]})}):(null==a?void 0:a.partialIndexMetadata)?a.remoteRepo?(0,z.jsx)(s9.Badge,{status:o,label:(0,z.jsxs)("div",{className:"flex flex-col",children:[(0,z.jsx)("span",{children:"Ready"}),(0,z.jsx)("span",{className:"text-blue",children:"(Hybrid)"})]})}):(0,z.jsx)(s9.Badge,{status:o,label:(0,z.jsxs)("div",{className:"flex flex-col",children:[(0,z.jsx)("span",{children:"Ready"}),(0,z.jsx)("span",{className:"text-yellow-400",children:"(Partial)"})]})}):(0,z.jsx)(s9.Badge,{status:o,label:(0,z.jsx)("span",{children:"Ready"})}),[a,o,r]),l=(0,X.useMemo)(()=>{var e,t;return r?(0,z.jsx)("div",{className:"relative mt-6 h-2 rounded-full bg-gray-200",style:{width:"100px"},children:(0,z.jsx)("div",{className:"absolute left-0 top-0 h-full rounded-full bg-[#1075CD] transition-all duration-[1500ms] ease-in-out",style:{width:"".concat(100*((null==a?void 0:null===(e=a.indexProgress[r])||void 0===e?void 0:e.progress)||0),"%")}})}):o===s7.BadgeStatus.Green&&(null==a?void 0:a.partialIndexMetadata)?(0,z.jsx)("div",{className:"flex flex-col",children:(0,z.jsx)("div",{className:"flex flex-row items-center opacity-70",children:(0,z.jsxs)("span",{className:"whitespace-nowrap text-sm",children:["Indexed ",a.partialIndexMetadata.numIndexedFiles," files since"," "+(null===(t=a.partialIndexMetadata.cutoffTimestamp)||void 0===t?void 0:t.toDate().toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}))]})})}):null},[a,o,r]);return(0,z.jsxs)("div",{className:"mb-2 flex flex-row items-center justify-between gap-4 rounded py-2",children:[(0,z.jsxs)("div",{className:"flex flex-col overflow-hidden",children:[(0,z.jsxs)("div",{className:"flex w-full flex-row items-center overflow-hidden",children:[(0,z.jsx)("span",{className:"text-sm font-semibold",children:getFolderPathFromGitRoot(null==a?void 0:a.gitRoot,null==a?void 0:a.workspaceFolder)}),(null==a?void 0:a.repoName)&&(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)("span",{className:"mx-1 opacity-70",children:""}),(0,z.jsx)("span",{className:"overflow-hidden text-ellipsis whitespace-nowrap text-sm opacity-70",children:a.repoName})]}),o===s7.BadgeStatus.Green&&(null==a?void 0:a.remoteRepo)&&(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)("span",{className:"ml-1 flex h-6 w-6 flex-row items-center justify-center gap-x-0.5 text-ide-text-color","data-tooltip-id":"remote-index-tooltip-".concat(s),children:(0,z.jsx)(tp.InfoIcon,{fill:"currentColor",className:"h-3.5 w-3.5"})}),(0,z.jsx)(e7.u,{id:"remote-index-tooltip-".concat(s),positionStrategy:"absolute",place:"bottom",className:"z-20 max-w-[350px] bg-ide-tooltip-background text-sm text-ide-tooltip-color",border:"1px solid var(--codeium-tooltip-color, rgb(255, 255, 255))",noArrow:!0,children:(t=a.remoteRepo).baseGitUrl?(0,z.jsxs)(z.Fragment,{children:[(0,z.jsxs)("p",{className:"text-sm",children:["Remote Index: ",t.baseGitUrl]}),t.commit&&(0,z.jsxs)("p",{className:"text-sm",children:["Version: ",t.versionAlias]})]}):(0,z.jsx)(z.Fragment,{})})]})]}),(0,z.jsx)("div",{className:"flex flex-col",children:l})]}),(0,z.jsx)("div",{className:"justify-right flex flex-row gap-6",children:(0,z.jsx)("div",{children:i})})]})};var ae=s(8990),at=s(87380);let MultiselectCombobox=e=>{let{placeholder:t,render:s,value:a,onChange:n,activeItem:r,data:o,onSelect:i,errorMessage:l,forwardedRef:c,loading:d=!1,onClose:u}=e,m="list-none bg-ide-chat-background";return(0,z.jsxs)("div",{className:"relative max-h-[300px] overflow-hidden overflow-y-auto rounded border-[1px] border-gray-200/40",children:[(0,z.jsx)("div",{className:"absolute bottom-0 left-0 right-0 top-0 bg-gray-200 opacity-20"}),(0,z.jsxs)(ae.h,{value:a,children:[(0,z.jsxs)("div",{className:"text-ide-chat-color relative bg-white/10",children:[(0,z.jsx)(at.Z,{className:"absolute left-2 top-1/2 h-4 w-4 -translate-y-1/2"}),(0,z.jsx)(ae.h.Input,{ref:c,onChange:e=>{n(e.target.value)},className:"text-ide-chat-color h-8 w-full border-none bg-transparent px-2 pl-8 text-sm shadow-none focus:outline-none focus:ring-0",placeholder:t,autoComplete:"off",onClick:e=>{e.stopPropagation()},onKeyDown:e=>{("Enter"===e.key||"Tab"===e.key)&&(i(r,e),e.preventDefault()),"Escape"===e.key&&u&&u()}}),(0,z.jsx)("div",{className:"absolute right-2 top-1/2 h-[20x] w-[20px] -translate-y-1/2",children:(0,z.jsx)("div",{className:(0,eG.classNames)(d?"opacity-100":"opacity-0","loader")})})]}),(0,z.jsx)("div",{className:"h-[1px] w-full bg-gray-200/40"}),o?o.length>0?(0,z.jsx)(ae.h.Options,{className:(0,eG.classNames)(m,"max-h-[300px] overflow-y-auto"),static:!0,children:o.map(s)},a):a&&(0,z.jsx)("div",{className:(0,eG.classNames)(m,"p-2 text-sm"),children:"No results found"}):(0,z.jsx)("div",{className:(0,eG.classNames)(m,"p-2 text-sm"),children:null!=l?l:"No results found"})]})]})};var as=s(72073);let ContextItemPill_ContextItemPill=e=>{let{contextScopeItem:t,className:s="",onDelete:a,onClick:n,remote:r=!1,inline:o=!1,readOnly:i=!1}=e,{openFilePointer:l}=useServerConnectionContext(),c=getContextScopeTypeMetadataFromItem(t),d=c.getIcon(t),u=c.getDisplayValue(t),m="context-item-".concat(c.getKey(t)),p=c.getMetadataDisplayValue(t),x=c.getFilePointer(t);return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(e7.u,{id:m,positionStrategy:"fixed",className:"bg-ide-chat-background text-ide-tooltip-color",opacity:"100",border:"1px solid rgb(120, 120, 120)",children:(0,z.jsxs)("div",{className:"flex flex-row gap-2 text-sm",children:[(0,z.jsx)("div",{className:"flex w-[1.2rem] shrink-0 justify-center whitespace-nowrap",children:d}),(0,z.jsxs)("span",{className:"text-sm",children:[r?"Remote":"Local"," context:"]}),(0,z.jsx)("span",{children:u})," ",(0,z.jsx)("span",{className:"opacity-50",children:p})]})}),(0,z.jsxs)("div",{"data-tooltip-id":m,className:(0,eG.classNames)("flex flex-row items-center rounded-full bg-ide-message-block-bot-background",o?"mx-[1px] h-[1.2rem] px-1":"h-[1.5rem] px-2",s),children:[(0,z.jsxs)("div",{className:"grow-1 flex cursor-pointer flex-row items-center gap-x-1 overflow-clip",onClick:()=>{n?n(t):x&&l(x)},children:[(0,z.jsx)("div",{className:"flex w-[1.2rem] shrink-0 justify-center",children:d}),r&&(0,z.jsx)("div",{className:"flex w-[1.2rem] shrink-0 justify-center",children:(0,z.jsx)(so.Z,{className:"inline h-4 w-4"})}),(0,z.jsx)("span",{className:"grow-1 font-normal-2 flex shrink-0 truncate whitespace-nowrap text-sm leading-[1rem]",children:(0,e8.getFileName)(u||"")})]}),!i&&(0,z.jsx)("div",{className:"shrink-0",children:a&&(0,z.jsx)(tf.XIcon,{"aria-label":"delete pill",className:"ml-1 inline-block w-5 cursor-pointer rounded-full fill-ide-text-color hover:bg-ide-text-color hover:fill-ide-chat-background",onClick:()=>{a(t)}})})]})]})},ContextItemList=e=>{let{selectedItems:t,handleDelete:s,onClick:a,readOnly:n=!1}=e,{localRepos:r,remoteRepos:o}=(0,X.useMemo)(()=>{let e=t.filter(e=>!["repository","repositoryPath"].includes(getContextScopeTypeMetadataFromItem(e).case)).map(e=>(0,z.jsx)(ContextItemPill_ContextItemPill,{contextScopeItem:e,onDelete:s,onClick:a,remote:!1,readOnly:n},getContextScopeTypeMetadataFromItem(e).getKey(e))),r=t.filter(e=>["repository","repositoryPath"].includes(getContextScopeTypeMetadataFromItem(e).case)).map(e=>(0,z.jsx)(ContextItemPill_ContextItemPill,{contextScopeItem:e,onDelete:s,onClick:a,remote:!0,readOnly:n},getContextScopeTypeMetadataFromItem(e).getKey(e)));return{localRepos:e,remoteRepos:r}},[t,s,a,n]);return(0,z.jsxs)(z.Fragment,{children:[r,o]})},ContextItemCategoryOption=e=>{let{categoryType:t}=e,s=t7[t],a=null==s?void 0:s.getIcon(),n=null==s?void 0:s.categoryName;return(0,z.jsxs)("div",{className:"flex w-full flex-row items-center justify-between gap-x-2 py-1",children:[(0,z.jsxs)("div",{className:"grow-1 flex flex-row items-center gap-x-2 overflow-clip p-1",children:[(0,z.jsx)("div",{className:"flex w-[1.2rem] shrink-0 justify-center",children:a}),(0,z.jsx)("div",{className:"flex max-w-[calc(100%-1.2rem)] shrink-0 grow-0 flex-row items-center gap-x-2",children:(0,z.jsx)("span",{className:"text-sm font-normal",children:n})})]}),(0,z.jsx)("div",{className:"shrink-0",children:(0,z.jsx)(sp.RightArrowIcon,{className:"fill-ide-chat-color mr-2 w-4"})})]})},ContextItemOption=e=>{let{contextScopeItem:t,onDelete:s}=e,a=getContextScopeTypeMetadataFromItem(t),n=a.getIcon(t),r=a.getDisplayValue(t),o=a.getMetadataDisplayValue(t);return(0,z.jsxs)("div",{className:"flex w-full flex-row items-center justify-between gap-x-2 py-1",children:[(0,z.jsxs)("div",{className:"grow-1 flex flex-row items-center gap-x-2 overflow-clip p-1",children:[(0,z.jsx)("div",{className:"flex w-[1.2rem] shrink-0 justify-center",children:n}),(0,z.jsxs)("div",{className:"flex max-w-[calc(100%-1.2rem)] shrink-0 grow-0 flex-row items-center gap-x-2",children:[(0,z.jsx)("span",{className:"grow-1 flex shrink-0 truncate whitespace-nowrap text-xs font-medium",children:r}),(0,z.jsx)("span",{className:"grow-0 truncate text-xs font-normal opacity-50",children:o})]})]}),(0,z.jsx)("div",{className:"shrink-0",children:s&&(0,z.jsx)(tf.XIcon,{"aria-label":"delete pill",className:"ml-1 inline-block w-5 cursor-pointer rounded-full stroke-ide-text-color p-[3px] hover:bg-ide-text-color",onClick:()=>{s(t)}})})]})},Content=e=>{let{item:t,active:s,setActiveItem:a}=e;return(0,X.useEffect)(()=>{s&&a(t)}),(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)("div",{className:(0,eG.classNames)("absolute bottom-1 left-1 right-1 top-1 rounded bg-ide-tooltip-background opacity-0 group-hover:opacity-50",s?"!opacity-50":"")}),(0,z.jsx)("div",{className:"relative px-1 py-0.5",children:"category"===t.case?(0,z.jsx)(ContextItemCategoryOption,{categoryType:t.value}):(0,z.jsx)(ContextItemOption,{contextScopeItem:t.value})})]})},ContextItemComboboxOption=e=>{let{item:t,handleSelectItem:s,setActiveItem:a}=e;return(0,z.jsx)(ae.h.Option,{value:t.value,className:"group relative cursor-pointer",onClick:s.bind(void 0,t),children:e=>{let{active:s}=e;return(0,z.jsx)(Content,{item:t,active:s,setActiveItem:a})}},"category"===t.case?t.value:getContextScopeTypeMetadataFromItem(t.value).getKey(t.value))},ContextItemMultiselectCombobox=e=>{let{selectedItems:t,onUpdate:s,forcedScopeTypes:a,placeholder:n="Enter Scope",className:r="",readOnly:o=!1,...i}=e,[l,c]=(0,X.useState)(""),[d,u]=(0,X.useState)(),[m,p]=(0,X.useState)(!1),x=(0,X.useRef)(null),h=useChatParamsContext(),{brainInterface:g}=useServerConnectionContext(),f=(0,X.useRef)(null),[y,v]=(0,X.useState)(null);(0,tO.O)(f,()=>{p(!1)});let C=(0,X.useMemo)(()=>async e=>{let a=t.filter(t=>t!==e);await s(a)},[s,t]),onToggleContextSelector=e=>{p(e=>!e),m||setTimeout(()=>{var e;null===(e=x.current)||void 0===e||e.focus()},0),e.preventDefault(),e.stopPropagation()},w=(0,X.useCallback)(async(e,a)=>{var n,r,o,i;if((null==e?void 0:e.case)==="category")c(null!==(o=null===(n=t7[e.value])||void 0===n?void 0:n.prefix)&&void 0!==o?o:""),null===(r=x.current)||void 0===r||r.focus(),a.preventDefault(),a.stopPropagation();else if((null==e?void 0:e.case)==="item"){let n=getContextScopeTypeMetadataFromItem(e.value);if("repository"!==n.case||y){u(void 0),c(""),v(null);let a=Object.values([...t,e.value].reduce((e,t)=>{let s=getContextScopeTypeMetadataFromItem(t).getKey(t);return!s||s in e||(e[s]=t),e},{}));await s(a)}else c("".concat(n.prefix).concat(null!==(i=n.getDisplayValue(e.value))&&void 0!==i?i:"",":")),v(e.value),a.preventDefault(),a.stopPropagation()}},[s,y,t]),{isLoading:b,error:N,data:S}=(0,tF.useFetcher)({fire:(0,X.useCallback)(async()=>{var e;let t;if(!a&&""===l)return t6.map(e=>({case:"category",value:e}));let{scopeType:s,query:n,repoFilter:r}=breakdownQuery(l,a);t=s?[s]:a;let o=await (null===(e=g.getMatchingSearchQueries)||void 0===e?void 0:e.call(g,n,getMetadata(h),t,r));if(!o)return[];let i=o.filter((e,t,s)=>t===s.findIndex(t=>getContextScopeTypeMetadataFromItem(t).getDisplayValue(t)===getContextScopeTypeMetadataFromItem(e).getDisplayValue(e)&&getContextScopeTypeMetadataFromItem(t).getMetadataDisplayValue(t)===getContextScopeTypeMetadataFromItem(e).getMetadataDisplayValue(e))),c=y&&!i.find(e=>e.equals(y))?[y,...i]:i;return c.map(e=>({case:"item",value:e}))},[g,a,h,y,l])});return(0,z.jsx)(z.Fragment,{children:(0,z.jsxs)("div",{className:"relative z-[100]",children:[(0,z.jsx)("div",{className:"flex flex-row flex-wrap gap-2",children:(0,z.jsx)(ContextItemList,{handleDelete:C,selectedItems:t,readOnly:o})}),!o&&(0,z.jsxs)("div",{ref:f,className:"relative mt-2",onClick:e=>{m&&onToggleContextSelector(e)},children:[(0,z.jsx)("button",{onClick:onToggleContextSelector,className:(0,eG.classNames)("flex flex-row items-center justify-center whitespace-nowrap rounded-full px-2 py-1 text-sm font-medium leading-[1rem] leading-[1rem]",r||"bg-ide-message-block-bot-background text-ide-message-block-bot-color"),...i,children:m?(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(as.Z,{className:"mr-1 inline h-4 w-4"}),(0,z.jsx)("div",{children:"Close"})]}):"+ Add context"}),(0,z.jsx)("div",{className:(0,eG.classNames)("absolute -bottom-2 left-0 z-[200] w-[90vw] translate-y-full rounded","bg-ide-chat-background",m?"":"hidden"),children:(0,z.jsx)(MultiselectCombobox,{forwardedRef:x,errorMessage:null==N?void 0:N.message,loading:b,value:l,activeItem:d,onChange:e=>{c(e)},onSelect:(e,t)=>w(e,t),placeholder:n,data:S,onClose:()=>{p(!1)},render:e=>(0,z.jsx)(ContextItemComboboxOption,{setActiveItem:u,handleSelectItem:w,item:e})})})]})]})})},PinnedContext=()=>{let e=useChatParamsContext(),{defaultContextItems:t,contextItems:s,setContextItems:a,initialized:n,guideline:r}=useBrainContext(),onUpdate=t=>(a(getMetadata(e),t,r),Promise.resolve()),o=(0,X.useMemo)(()=>0===s.length?{numFiles:0,numBytes:0}:(0,ty.getScopeItemStats)(s),[s]),pinnedContextElement=(e,t)=>{let s=t?"about-default-pinned-context":"about-pinned-context";return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsxs)("div",{className:"relative z-[60] flex w-full items-center",children:[(0,z.jsx)("h6",{className:"text-sm font-medium",children:t?"Default Pinned Contexts":"Pinned Contexts"}),(0,z.jsx)("span",{className:"ml-1 hidden h-6 w-6 flex-row items-center justify-center gap-x-0.5 text-ide-text-color xs:flex","data-tooltip-id":s,children:(0,z.jsx)(tp.InfoIcon,{fill:"currentColor",className:"h-3.5 w-3.5"})}),(0,z.jsx)(e7.u,{id:s,positionStrategy:"absolute",place:"top",className:"z-[200] max-w-[350px] !bg-ide-editor-background !text-sm !text-ide-editor-color",opacity:"1",border:"1px solid var(--codeium-tooltip-color, rgb(255, 255, 255))",noArrow:!0,children:t?"The list of default pinned contexts can be configured based on the current active document. It is configured by the file ~/.codeium/codeium_settings.yaml.":"Pinned contexts are additional contexts in the form of repositories, directories, files, or code snippets."})]}),o.numFiles>2e3&&(0,z.jsxs)("div",{className:"mb-4 text-red-500",children:["You have pinned ",o.numFiles," files which is more than the recommended maximum of ",2e3," files. This may dilute the effect of pinning context."]}),n?(0,z.jsx)(ContextItemMultiselectCombobox,{selectedItems:e,onUpdate:onUpdate,readOnly:t}):(0,z.jsx)("div",{className:"flex flex-row items-center text-sm",children:"Loading..."})]})};return(0,z.jsxs)("div",{children:[pinnedContextElement(s,!1),t.length>0&&pinnedContextElement(t,!0)]})},useMaxGuidelineLength=()=>{var e,t;let{handshake:s}=useServerConnectionContext(),a=Number(null!==(t=null==s?void 0:null===(e=s.planInfo)||void 0===e?void 0:e.maxCustomChatInstructionCharacters)&&void 0!==t?t:200);return a},GuidelineInput=()=>{let{setGuideline:e,guideline:t}=useBrainContext(),s=useMaxGuidelineLength();return(0,z.jsx)("textarea",{className:"w-full flex-grow rounded p-2 text-sm leading-5 text-gray-800",placeholder:"Enter your custom chat instructions here. Max ".concat(s," characters. E.g. Respond back in Python."),onChange:t=>{-1!=s&&t.target.value.length>s||e(t.target.value)},value:t,rows:3})},EditGuidelineView=()=>{let{saveGuideline:e,guideline:t}=useBrainContext(),[s,a]=(0,X.useState)(!1),{hasEnterpriseExtension:n}=useChatParamsContext(),r=useMaxGuidelineLength(),o=(0,z.jsxs)("div",{className:"flex flex-row items-start gap-2",children:[(0,z.jsx)(GuidelineInput,{}),(0,z.jsx)(su.Button,{color:"primary",size:"small",onClick:()=>{e(t),a(!1)},className:"mt-2",children:"Save"})]}),i=(0,z.jsxs)("div",{className:"flex flex-row items-center gap-2",children:[(0,z.jsx)("div",{className:"flex-grow overflow-hidden text-ellipsis break-words rounded py-2 pr-2 text-sm",children:t||(0,z.jsx)("span",{className:"opacity-50",children:"No custom chat instruction set"})}),(0,z.jsx)("div",{className:"flex-shrink-0 cursor-pointer rounded px-1 py-0.5 text-sm hover:bg-gray-500/20",onClick:()=>{a(!0)},children:"Edit"})]});return(0,z.jsxs)("div",{children:[(0,z.jsxs)("div",{className:"flex w-full items-center",children:[(0,z.jsx)("h6",{className:"text-sm font-medium",children:"Custom Chat Instructions"}),(0,z.jsx)("span",{className:"ml-1 hidden h-6 w-6 flex-row items-center justify-center gap-x-0.5 text-ide-text-color xs:flex","data-tooltip-id":"about-custom-context",children:(0,z.jsx)(tp.InfoIcon,{fill:"currentColor",className:"h-3.5 w-3.5"})}),n?(0,z.jsx)("span",{className:"ml-1 text-xs text-ide-text-color",children:"BETA"}):null,(0,z.jsx)(e7.u,{id:"about-custom-context",positionStrategy:"absolute",place:"bottom-start",className:"z-[200] max-w-[350px] !bg-ide-editor-background !text-sm !text-ide-editor-color",opacity:"1",border:"1px solid var(--codeium-tooltip-color, rgb(255, 255, 255))",noArrow:!0,children:"Custom chat instructions provide a starting instruction to the model for chat responses."}),(0,z.jsxs)("span",{className:"pl-2 text-sm text-gray-500",children:[t.length,"/",-1===Number(r)?"":r.toString()]})]}),s?o:i]})},BrainStatus=()=>{var e;let{data:t,numTokens:s}=useBrainContext(),{hasDevExtension:a}=useChatParamsContext(),n=(0,X.useMemo)(()=>{var e;return(null==t?void 0:null===(e=t.indexStatus)||void 0===e?void 0:e.localIndexes)?t.indexStatus.localIndexes.sort((e,t)=>e.workspaceFolder.localeCompare(t.workspaceFolder)):[]},[null==t?void 0:null===(e=t.indexStatus)||void 0===e?void 0:e.localIndexes]),r=(0,X.useRef)((0,el.getNonce)()).current;return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(EditGuidelineView,{}),(0,z.jsx)(PinnedContext,{}),n.length>0&&(0,z.jsxs)("div",{children:[(0,z.jsxs)("div",{className:"flex w-full items-center",children:[(0,z.jsx)("h6",{className:"text-sm font-medium",children:"Local Indexes"}),(0,z.jsx)("span",{className:"ml-1 hidden h-6 w-6 flex-row items-center justify-center gap-x-0.5 text-ide-text-color xs:flex","data-tooltip-id":"local-indexes",children:(0,z.jsx)(tp.InfoIcon,{fill:"currentColor",className:"h-3.5 w-3.5"})}),(0,z.jsx)(e7.u,{id:"local-indexes",positionStrategy:"absolute",place:"bottom",className:"z-[200] max-w-[350px] !bg-ide-editor-background !text-sm !text-ide-editor-color",opacity:"1",border:"1px solid var(--codeium-tooltip-color, rgb(255, 255, 255))",noArrow:!0,children:"Local indexes are the projects that have local indexes set up to improve Codeium's context awareness"})]}),n.map((e,s)=>{var a;return(0,z.jsx)(IndexStatusRow,{id:"brain-status-".concat(s,"-").concat(r),indexStatus:e,ignoredWorkSpaces:(null==t?void 0:null===(a=t.indexStatus)||void 0===a?void 0:a.ignoredLocalWorkspaces)||[]},e.workspaceFolder)})]}),a&&(0,z.jsxs)("span",{className:(0,eG.classNames)("z-10 mr-8 rounded px-1 py-0.5 text-xs opacity-80"),children:["Current Message Token Count: ",s]})]})};var aa=s(94918);let BrainView=()=>{let{initialized:e,retrigger:t,lastRefreshTime:s,error:a}=useBrainContext(),[n,r]=(0,X.useState)(new Date),{handleOpenChat:o}=useNavigationContext();(0,X.useEffect)(()=>{let e=setInterval(()=>{r(new Date)},1e3);return()=>{clearInterval(e)}},[]);let i=s?Math.max(0,Math.floor((n.getTime()-s.getTime())/1e3)):0;return(0,z.jsxs)("div",{className:"h-full w-full flex-1",children:[(0,z.jsxs)("div",{className:"z-20 flex h-10 w-full flex-row items-center justify-between border-b-[1px] border-gray-700 bg-ide-chat-background px-4 py-2 text-xs",children:[(0,z.jsxs)(sZ.X,{disabled:i<=3,onClick:()=>{t(!0)},children:[(0,z.jsx)("span",{className:(0,eG.classNames)("font-medium text-ide-text-color opacity-80","group-hover:opacity-100"),children:(0,z.jsx)(aa.ArrowPathIcon,{"aria-label":"refresh",className:"mx-1 my-1 mr-2 inline-block h-4 w-4 fill-ide-text-color"})}),(0,z.jsx)(e7.u,{id:"refresh-context-tooltip",place:"bottom-start",className:"z-[200] max-w-[350px] !bg-ide-editor-background !text-sm !text-ide-editor-color",opacity:"1",border:"1px solid rgba(128,128,128,0.5)",children:i<=3?"Last refreshed a few seconds ago":"Last refreshed ".concat(i," seconds ago")})]}),(0,z.jsx)(tL.Z,{onClick:o,className:"h-6 w-6 cursor-pointer rounded p-1 hover:bg-gray-500/20"})]}),(0,z.jsx)("div",{className:"p-4",children:e?(0,z.jsxs)(z.Fragment,{children:[a&&(0,z.jsxs)("p",{className:"my-2 text-sm text-red",children:["Error: ",a.message]}),(0,z.jsxs)("div",{className:"flex flex-col gap-y-8",children:[(0,z.jsx)(CrossSellWindsurfMessage,{}),(0,z.jsx)(BrainStatus,{})]})]}):(0,z.jsx)("div",{className:"mt-6 flex w-full flex-row justify-center",children:"Loading..."})})]})};var an=s(50586),ar=s.n(an);(g=q||(q={})).ALL="all",g.RESOLVED="resolved",g.UNRESOLVED="unresolved",(f=U||(U={}))[f.GOOD=1]="GOOD",f[f.EMPTY=0]="EMPTY",f[f.BAD=-1]="BAD";var ao=s(30612);let useCortex=()=>{var e,t;let{brainInterface:s}=useServerConnectionContext(),{tab:a}=useNavigationContext(),n=useChatParamsContext(),{applyDiff:r,hideDiff:o,openFilePointer:i}=useServerConnectionContext(),[l,c]=(0,X.useState)(""),[d,u]=(0,X.useState)(""),[m,p]=(0,X.useState)(void 0),[x,h]=(0,X.useState)({}),[g,f]=(0,X.useState)({}),[y,v]=(0,X.useState)(q.UNRESOLVED),[C,w]=(0,X.useState)(""),[b,N]=(0,X.useState)(-1),[S,j]=(0,X.useState)([]),[E,I]=(0,X.useState)(!1),[T,k]=(0,X.useState)([]),[R,_]=(0,X.useState)([]),D=(0,X.useCallback)(async()=>{var e;return a===et.q80.CORTEX&&d?await (null===(e=s.getCortexPlan)||void 0===e?void 0:e.call(s,d)):null},[s,d,a]),{data:A}=(0,ao.usePoller)(D,1e3,6e5,[D]),P=(0,X.useCallback)(async()=>{var e;if(a!==et.q80.CORTEX)return null;k(await (null===(e=s.getCortexSummaries)||void 0===e?void 0:e.call(s))||[])},[s,a]);(0,X.useEffect)(()=>{P()},[P]);let M=null==A?void 0:null===(t=A.workflowState)||void 0===t?void 0:null===(e=t.planState)||void 0===e?void 0:e.steps[0],L=null==M?void 0:M.step.value;(0,X.useEffect)(()=>{b>=0&&(null==L?void 0:L.actionStates[b])&&m&&p(L.actionStates[b])},[null==L?void 0:L.actionStates,null==L?void 0:L.actionStates[b],b,m]);let O=(0,X.useCallback)(async e=>{var t;if(!e){_([]);return}let a=await (null===(t=s.getSuggestedContextScopeItems)||void 0===t?void 0:t.call(s,getMetadata(n),[ei.BeN.COMMIT_HISTORY],e,100,10));a&&_(a)},[s,n]),F=(0,X.useCallback)((e,t)=>{h(s=>{let a={...s};return t?a[e]=!0:delete a[e],a})},[h]),B=(0,X.useCallback)(e=>{var t;let s=null==L?void 0:L.actionStates[e],a=null==s?void 0:null===(t=s.result)||void 0===t?void 0:t.result.value;o({messageId:(null==a?void 0:a.completionId)||"",fileUri:(null==a?void 0:a.absoluteUri)||"",providerSource:et.IGB.COMMAND_PLAN}),e===b&&(p(void 0),N(-1))},[null==L?void 0:L.actionStates,b,o]),U=(0,X.useCallback)(e=>{var t;B(e),(null==L?void 0:L.planId)!==void 0&&(null===(t=s.prepareAction)||void 0===t||t.call(s,getMetadata(n),L.planId,e))},[s,L,n,B]),G=(0,X.useCallback)(e=>{g[e]?f(t=>{let s={...t};return delete s[e],s}):f({...g,[e]:!0})},[g]),Q=(0,X.useCallback)(async e=>{let t=null==L?void 0:L.actionStates[e],s=null==t?void 0:t.result;if((null==s?void 0:s.result.case)!=="edit")return;let a=s.result.value;if(a.diff&&(null==t?void 0:t.status)){if(-1!==b&&b!==e&&(B(b),await new Promise(e=>{setTimeout(e,100)})),N(e),p(t),t.status===eS.M4w.PREPARED){let e=new eo.Nm(a.diff);e.endLine-=1,r({messageId:a.completionId,filePath:a.absolutePathMigrateMeToUri,diffBlock:e,providerSource:et.IGB.COMMAND_PLAN,fileContentHash:a.fileContentHash,diffDocPrefix:a.contextPrefix,diffDocSuffix:a.contextSuffix,uri:a.absoluteUri})}else[eS.M4w.APPLIED,eS.M4w.REJECTED].includes(t.status)&&await i(new OpenFilePointer({fileUri:a.absoluteUri,startLine:a.diff.startLine,endLine:a.diff.endLine}))}},[r,L,b,B,i]),J=(0,X.useCallback)(()=>{-1!==b&&B(b),u(""),w(""),c(""),h({}),f({}),p(void 0),N(-1),j([]),v(q.UNRESOLVED),I(!1),_([])},[b,B]),W=(0,X.useCallback)(async()=>{var e;if(!(null==L?void 0:L.planId))return null;-1!==b&&B(b),await (null===(e=s.commitCodingPlan)||void 0===e?void 0:e.call(s,getMetadata(n),L.planId)),I(!0),await P()},[s,null==L?void 0:L.planId,n,P,b,B]),H=(0,X.useCallback)(async()=>{var e;if(!(null==L?void 0:L.planId))return null;-1!==b&&B(b),await (null===(e=s.commitCodingPlan)||void 0===e?void 0:e.call(s,getMetadata(n),L.planId)),addConfetti(),I(!0),await P()},[s,null==L?void 0:L.planId,n,P,b,B]),V=(0,X.useCallback)(async()=>{var e;if(!(null==L?void 0:L.planId)||!C)return null;-1!==b&&B(b),await (null===(e=s.replanCodingPlan)||void 0===e?void 0:e.call(s,L.planId,C)),w("")},[s,null==L?void 0:L.planId,C,b,B]),Y=(0,X.useCallback)(async(e,t)=>{var a;await (null===(a=s.recordCortexFeedback)||void 0===a?void 0:a.call(s,getMetadata(n),d,e,t))},[s,d,n]),Z=(0,X.useMemo)(()=>{if(null==A?void 0:A.done)return!1;if(!L||!L.planFullyGenerated)return!0;for(let e of L.actionStates)if(e.status===eS.M4w.PREPARING)return!0;return!1},[L,null==A?void 0:A.done]),K=(0,X.useMemo)(()=>{let e=-1,t=-1,s=-1;for(let[a,n]of(null==L?void 0:L.actionStates.entries())||[]){let r=n.status===eS.M4w.PREPARED&&!g[a];r&&(-1===e&&(e=a),-1===s&&a>b&&(s=a),a<b&&(t=a))}return -1!==s?{next:s,prev:t}:{next:e,prev:t}},[null==L?void 0:L.actionStates,b,g]),z=(0,X.useCallback)(()=>{d&&-1!==K.next&&Q(K.next)},[d,K,Q]),$=(0,X.useCallback)(()=>{d&&-1!==K.prev&&Q(K.prev)},[d,K,Q]);return{state:{cortexId:d,planFeedback:C,filterView:y,resolvedSteps:g,expandedSteps:x,pinnedStep:m,codingPlan:L,currentFocusStep:b,cortexState:null!=A?A:void 0,instruction:l,selectedItems:S,loading:Z,cortexSummaries:T,showEndScreen:E,adjacentSteps:K,suggestedItems:R},handlers:{setCortexId:u,setFeedback:w,setFilterView:v,toggleResolved:G,handleHideDiff:B,handleRetry:U,handleShowDiff:Q,finishPlan:H,abandonPlan:W,replanWithFeedback:V,setStepExpandedState:F,setPinnedStep:p,setInstruction:c,setSelectedItems:j,setCurrentFocusStep:N,resetPlan:J,recordFeedback:Y,setShowEndScreen:I,updateCortexSummaries:P,focusNextStep:z,focusPrevStep:$,updateSuggestedItems:O}}},ai={state:{cortexId:"",pinnedStep:void 0,planFeedback:"",filterView:q.ALL,resolvedSteps:{},expandedSteps:{},codingPlan:void 0,currentFocusStep:0,cortexState:void 0,instruction:"",selectedItems:[],loading:!0,cortexSummaries:void 0,showEndScreen:!1,adjacentSteps:{prev:-1,next:-1},suggestedItems:[]},handlers:{setFeedback:()=>{},setFilterView:()=>{},toggleResolved:()=>{},handleHideDiff:()=>{},handleRetry:()=>{},handleShowDiff:()=>{},finishPlan:()=>{},abandonPlan:()=>{},replanWithFeedback:()=>{},setStepExpandedState:()=>{},setCurrentFocusStep:()=>{},setCortexId:()=>{},setPinnedStep:()=>{},setInstruction:()=>{},setSelectedItems:()=>{},resetPlan:()=>{},recordFeedback:()=>{},setShowEndScreen:()=>{},updateCortexSummaries:()=>{},focusNextStep:()=>{},focusPrevStep:()=>{},updateSuggestedItems:()=>{}}},al=(0,X.createContext)(ai),CortexContextProvider=e=>{let{children:t}=e,s=useCortex();return(0,z.jsx)(al.Provider,{value:s,children:t})},useCortexContext=()=>(0,X.useContext)(al),useInitPanel=()=>{let{changeTab:e}=useNavigationContext(),{isInitialized:t,state:{isReceivingMessage:s,conversations:a},newConversation:n,cancelInflightChat:r}=useServerConnectionContext(),o=s||t&&0===a.length;(0,X.useEffect)(()=>{let handleKeyDown=t=>{let s="KeyC"===t.code&&t.altKey;s&&!o&&(t.preventDefault(),e(et.q80.CHAT),n())};return document.addEventListener("keydown",handleKeyDown),()=>{document.removeEventListener("keydown",handleKeyDown)}},[e,o,n,r,t])},ac="Beta: May be subject to rate limits or slow generation.",ad={label:"Cascade Base",value:et.Hnr.MODEL_UNSPECIFIED,supportsImages:!1,supportsLegacy:!0,creditMultiplier:0},au={label:"Claude 3.5 Sonnet",value:et.Hnr.MODEL_CLAUDE_3_5_SONNET_20241022,supportsImages:!0,supportsLegacy:!0,creditMultiplier:1,isPremium:!0},am={label:"GPT-4o",value:et.Hnr.MODEL_CHAT_GPT_4O_2024_08_06,supportsImages:!0,supportsLegacy:!0,creditMultiplier:1,isPremium:!0},ap={label:"o3-mini (medium reasoning)",value:et.Hnr.MODEL_CHAT_O3_MINI,betaWarningMessage:ac,isBeta:!0,supportsImages:!1,supportsLegacy:!1,creditMultiplier:1,isPremium:!0},ax={label:"o3-mini (low reasoning)",value:et.Hnr.MODEL_CHAT_O3_MINI_LOW,betaWarningMessage:ac,isBeta:!0,supportsImages:!1,supportsLegacy:!1,creditMultiplier:1,isPremium:!0},ah={label:"o3-mini (high reasoning)",value:et.Hnr.MODEL_CHAT_O3_MINI_HIGH,betaWarningMessage:ac,isBeta:!0,supportsImages:!1,creditMultiplier:1,supportsLegacy:!1,isPremium:!0},ag={label:"DeepSeek R1",value:et.Hnr.MODEL_DEEPSEEK_R1,supportsImages:!1,supportsLegacy:!1,creditMultiplier:.5,isPremium:!0},af={label:"DeepSeek R1 (Distilled 70B)",value:et.Hnr.MODEL_DEEPSEEK_R1_SLOW,betaWarningMessage:ac,isBeta:!0,supportsLegacy:!1,creditMultiplier:0,isPremium:!0},ay={label:"DeepSeek R1 (Fast, Distilled 70B)",value:et.Hnr.MODEL_DEEPSEEK_R1_FAST,betaWarningMessage:ac,isBeta:!0,supportsLegacy:!1,creditMultiplier:0,isPremium:!0},av={label:"DeepSeek V3",value:et.Hnr.MODEL_DEEPSEEK_V3,supportsImages:!1,supportsLegacy:!1,creditMultiplier:.25,isPremium:!0},aC={label:"Gemini 2.0 Flash",value:et.Hnr.MODEL_GOOGLE_GEMINI_2_0_FLASH,betaWarningMessage:ac,isBeta:!0,supportsImages:!1,supportsLegacy:!1,creditMultiplier:0,isPremium:!0},aw={label:"xAI Grok-2",value:et.Hnr.MODEL_XAI_GROK_2,isBeta:!1,supportsLegacy:!1,creditMultiplier:1,isPremium:!0},ab={label:"xAI Grok-3",value:et.Hnr.MODEL_XAI_GROK_3,isBeta:!1,supportsLegacy:!1,creditMultiplier:1,isPremium:!0},aN={label:"OpenAI o1",value:et.Hnr.MODEL_CHAT_O1,supportsImages:!0,supportsLegacy:!1,creditMultiplier:0,isPremium:!0},aS={label:"OpenAI o1-mini",value:et.Hnr.MODEL_CHAT_O1_MINI,supportsLegacy:!1,creditMultiplier:0,isPremium:!0},aj=[au,am,ad],aE=[...aj,ag,af,ay,av,ap,ax,ah,aC,aw,ab],aI=[aN,aS],aT={"Cascade Base":ad,"Claude 3.5 Sonnet":au,"GPT-4o":am,"o3-mini (medium reasoning)":ap,"o3-mini (low reasoning)":ax,"o3-mini (high reasoning)":ah,"DeepSeek R1":ag,"DeepSeek R1 (Distilled 70B)":af,"DeepSeek R1 (Fast, Distilled 70B)":ay,"DeepSeek V3":av,"Gemini 2.0 Flash":aC,"xAI Grok-2":aw,"xAI Grok-3":ab,"OpenAI o1":aN,"OpenAI o1-mini":aS},labelToModelConfig=(e,t)=>{let s=e.find(e=>e.label===t);return s||aT[t]},combineModelLists=function(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];let a=new Map;return t.forEach(e=>{e.forEach(e=>{a.has(e.label)||a.set(e.label,e)})}),Array.from(a.values())},getCreditMultiplier=e=>{var t;return null===(t=combineModelLists(aj,aE,aI).find(t=>t.value===e.choice.value))||void 0===t?void 0:t.creditMultiplier},ak=4/3,getFileDataUrl=e=>new Promise((t,s)=>{let a=new FileReader;a.onloadend=()=>{t(a.result)},a.onerror=s,a.readAsDataURL(e)}),compressWithCanvas=(e,t,s,a)=>new Promise((n,r)=>{let o=new Image,i=document.createElement("canvas"),l=i.getContext("2d");o.onload=()=>{let e=o.width,r=o.height;e>r&&e>a?(r=r*a/e,e=a):r>a&&(e=e*a/r,r=a),i.width=e,i.height=r,null==l||l.drawImage(o,0,0,e,r);let c=t,d=i.toDataURL(t);d.length>s*ak&&(d=((e,t)=>{let s="image/jpeg",a=.01,n=1,r=1,o="";for(;n-a>.02;)r=(a+n)/2,(d=e.toDataURL(s,r)).length<=t*ak?(o=d,a=r):n=r;return o||e.toDataURL(s,a)})(i,s),c="image/jpeg"),n({dataUrl:d,mimeType:c})},o.onerror=r,o.src=e}),maybeCompressImage=async(e,t,s)=>{let a=await getFileDataUrl(e),n=await compressWithCanvas(a,e.type,t,s);if(n.dataUrl.length>t*ak){let s=(t/1e6).toFixed(1);throw Error("Failed to compress image ".concat(e.name," to fit within ").concat(s,"MB"))}return n};var aR=s(93564),a_=s(23372);function applyMessageDiff(e,t){if(0===t.fieldDiffs.length)return Object.freeze(e);let s={...e},a=e.getType().fields;for(let n of t.fieldDiffs){let t=a.find(n.fieldNumber);if(!t){console.warn("field ".concat(n.fieldNumber," not found in message of type ").concat(e.getType().name));continue}switch(n.diff.case){case"updateSingular":applyDiffToField(t,s,n.diff.value,applySingularValueDiff);break;case"updateRepeated":applyDiffToField(t,s,n.diff.value,applyRepeatedDiff);break;case"updateMap":applyDiffToField(t,s,n.diff.value,applyMapDiff);break;case"clear":t.oneof?s[t.oneof.localName]={case:void 0}:s[t.localName]=function(e){if(e.repeated)return Object.freeze([]);if(!e.opt)switch(e.kind){case"scalar":case"enum":return Object.freeze(getConstructorForEmptyScalar(e)());case"map":return Object.freeze({})}}(t)}}let n=new e.constructor;for(let[e,t]of Object.entries(s))n[e]=t;return Object.freeze(n)}function applyDiffToField(e,t,s,a){if(e.oneof){let n=t[e.oneof.localName],r=n.value;if(void 0===r){if(void 0!==n.case)throw Error("oneof field to update is not undefined");let t=getConstructorForEmptyScalar(e);r=t()}t[e.oneof.localName]=Object.freeze({case:e.localName,value:a(e,r,s)});return}let n=t[e.localName];if(void 0===n){let t=getConstructorForEmptyScalar(e);n=t()}t[e.localName]=a(e,n,s)}function applySingularValueDiff(e,t,s){switch(e.kind){case"scalar":case"enum":return singularValueToScalarValue(e,s);case"message":if(!(t instanceof er.v))throw Error("expected an instance of Message");if("messageValue"!=s.value.case)throw Error('expected singular value to be of type "messageValue"');return applyMessageDiff(t,s.value.value);default:throw Error("cannot apply singular value diff to field ".concat(e.name))}}let aD={[a_.w.DOUBLE]:"doubleValue",[a_.w.FLOAT]:"floatValue",[a_.w.INT32]:"int32Value",[a_.w.INT64]:"int64Value",[a_.w.UINT32]:"uint32Value",[a_.w.UINT64]:"uint64Value",[a_.w.SINT32]:"sint32Value",[a_.w.SINT64]:"sint64Value",[a_.w.FIXED32]:"fixed32Value",[a_.w.FIXED64]:"fixed64Value",[a_.w.SFIXED32]:"sfixed32Value",[a_.w.SFIXED64]:"sfixed64Value",[a_.w.BOOL]:"boolValue",[a_.w.STRING]:"stringValue",[a_.w.BYTES]:"bytesValue"};function singularValueToScalarValue(e,t){let s=t.value;switch(e.kind){case"scalar":if(s.case!==aD[e.T])throw Error("invalid SingularValue with case ".concat(s.case," for scalar type ").concat(e.T));return Object.freeze(s.value);case"enum":if("enumValue"!==s.case)throw Error("invalid SingularValue with case ".concat(s.case," for enum type"));return Object.freeze(s.value)}}function getConstructorForEmptyScalar(e){switch(e.kind){case"scalar":return aA[e.T];case"enum":return()=>0;case"message":return()=>new e.T;case"map":throw Error("maps are not supported in repeated fields")}}function applyRepeatedDiff(e,t,s){let a=t.slice(0,s.newLength),n=getConstructorForEmptyScalar(e);for(;a.length<s.newLength;)a.push(n());if(s.updateValues.length!=s.updateIndices.length)throw Error("updateIndices.length(".concat(s.updateIndices.length,") != updateValues.length(").concat(s.updateValues.length,")"));for(let t=0;t<s.updateIndices.length;t++){let n=s.updateIndices[t];if(n<0||n>=s.newLength)throw Error("update index ".concat(n," out of range"));a[n]=applySingularValueDiff(e,a[n],s.updateValues[t])}let r=Object.freeze(a.map(e=>Object.freeze(e)));return r}let aA={[a_.w.DOUBLE]:()=>0,[a_.w.FLOAT]:()=>0,[a_.w.INT32]:()=>0,[a_.w.INT64]:()=>BigInt(0),[a_.w.UINT32]:()=>0,[a_.w.UINT64]:()=>BigInt(0),[a_.w.SINT32]:()=>0,[a_.w.SINT64]:()=>BigInt(0),[a_.w.FIXED32]:()=>0,[a_.w.FIXED64]:()=>BigInt(0),[a_.w.SFIXED32]:()=>0,[a_.w.SFIXED64]:()=>BigInt(0),[a_.w.BOOL]:()=>!1,[a_.w.STRING]:()=>"",[a_.w.BYTES]:()=>new Uint8Array};function applyMapDiff(e,t,s){if("map"!==e.kind)throw Error("got map diff for field of kind ".concat(e.kind));let a={...t};for(let n of s.mapKeyDiffs){if(!n.mapKey)throw Error("got map key diff without mapKey");let s=n.mapKey.value.value,r=n.diff;switch(r.case){case"updateSingular":switch(e.V.kind){case"scalar":case"enum":a[s]=singularValueToScalarValue(e.V,r.value);break;case"message":let o=r.value.value;if("messageValue"!==o.case)throw Error("got diff of case ".concat(o.case," for field of kind ").concat(e.kind));let i=t[s];void 0===i&&(i=new e.V.T),a[s]=applyMessageDiff(i,o.value)}break;case"clear":delete a[s]}}return Object.freeze(a)}(y=G||(G={}))[y.DISCONNECTED_INIT=0]="DISCONNECTED_INIT",y[y.CONNECTING=1]="CONNECTING",y[y.CONNECTED=2]="CONNECTED",y[y.RETRY_WAIT=3]="RETRY_WAIT",y[y.DISCONNECTED_ERROR=4]="DISCONNECTED_ERROR";let aP=[eE.E.Unavailable,eE.E.DeadlineExceeded,eE.E.Unknown];function useReactiveState(e,t,s,a){let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1e3,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,[o,i]=(0,X.useState)({state:new e,version:BigInt(0),connectionState:0});return(0,X.useEffect)(()=>{if(!t||!s){i({state:new e,version:BigInt(0),connectionState:0});return}let o=new AbortController,l=connectImpl(e,t,s,n,r,i,o.signal);return a&&l.catch(a),()=>{o.abort("canceled")}},[t,s,e,a,n,r]),o}async function connectImpl(e,t,s,a,n,r,o){let i=arguments.length>7&&void 0!==arguments[7]&&arguments[7];if(n<0)throw Error("maxConnectionAttempts must be >= 0");0===n&&(n=1/0);for(let l=0;l<n;l++){try{r(e=>({...e,connectionState:1}));let a=!0,n=new aR.sG({id:s,protocolVersion:1});for await(let s of t(n,{signal:o})){let t=s.diff;if(!t)throw Error("missing diff in StreamReactiveUpdatesResponse");let n=a;r(a=>{let r=n?new e:a.state;return{state:applyMessageDiff(r,t),version:s.version,connectionState:2}}),l=0,a=!1}}catch(e){if(!(e instanceof ej.K))throw e;if(e.code===eE.E.Canceled||e.code===eE.E.Unknown&&"[unknown] canceled"===e.message)return;if(!aP.includes(e.code))throw e;i||console.error("got retryable useReactiveState RPC error on attempt [".concat(l+1," / ").concat(n,"]: "),e)}finally{r(e=>({...e,connectionState:4}))}if(l+1<n)r(e=>({...e,connectionState:3})),await new Promise(e=>{setTimeout(e,a)});else throw Error("useReactiveState RPC failed after ".concat(n," attempts"))}}var aM=s(18098),aL=s(62351),aO=s(87806),aF=s(49040),aB=s(75892);let ThinkingStep=e=>{let{loading:t,children:s,className:a,defaultExpanded:n=!0}=e,[r,o]=(0,X.useState)(!1),[i,l]=(0,X.useState)(n),c=(0,X.useRef)(null);return(0,X.useEffect)(()=>{t||r||l(!1)},[t,r]),(0,z.jsxs)("div",{className:(0,eG.classNames)("my-2 flex flex-col rounded bg-gray-500/15 px-2 py-1",a),children:[(0,z.jsx)("div",{className:"flex w-full cursor-pointer items-center items-center gap-1 whitespace-nowrap stroke-ide-editor-color text-left text-base text-ide-editor-color","aria-expanded":i,onClick:()=>{o(!0),l(!i)},children:(0,z.jsxs)("div",{className:"flex items-center gap-1",children:[(0,z.jsx)(aB.Z,{className:(0,eG.classNames)("h-3 w-3 transition-transform",i?"rotate-90":"")}),(0,z.jsx)("span",{className:"text-sm font-medium",children:t?"Thinking...":"Thought Process"})]})}),(0,z.jsx)("div",{ref:c,className:(0,eG.classNames)("transition-[max-height] duration-300 ease-in-out",i?"max-h-[300px] overflow-auto":"max-h-0 overflow-hidden"),children:s})]})};(v=Q||(Q={})).FUNCTION_RESULTS="function_results",v.THINKING="thinking",v.DONE_THINKING="done_thinking";let MarkdownNodes=e=>{let{markdown:t,className:s,renderKnowledgeBaseItemLink:a}=e,{state:{isRunning:n}}=useCascadeContext(),r=(0,X.useMemo)(()=>(0,e0.convertCustomTagToDiv)((0,e0.getStreamingMarkdown)((0,e0.getStreamingMarkdown)(t,e0.FUNCTION_RESULTS_TAG),e0.THINK_TAG),[e0.THINK_TAG,e0.FUNCTION_RESULTS_TAG]),[t]),o=(0,X.useMemo)(()=>(function(e){let t=(0,aL.l)().use(aO.Z).use(aF.Z),s=t.parse(e);return s})(r),[r]),i=(0,X.useMemo)(()=>r.split("\n"),[r]),l=(0,X.useMemo)(()=>o.children.map((e,t)=>{if(!e.position)return null;let s=e.position.start.line-1,a=e.position.end.line-1,n=i.slice(s,a+1).join("\n");return n.startsWith('<div class="'.concat(e0.FUNCTION_RESULTS_TAG,'">'))?{type:"function_results",raw:n}:n.startsWith('<div class="'.concat(e0.THINK_TAG,'">'))?{type:t===o.children.length-1?"thinking":"done_thinking",raw:(0,e0.convertMarkupToMarkdown)(n)}:{type:e.type,raw:n}}),[o.children,i]),c=(0,X.useMemo)(()=>l.map((e,t)=>e&&"function_results"!==e.type?"thinking"===e.type||"done_thinking"===e.type?(0,z.jsx)(ThinkingStep,{defaultExpanded:n,loading:"thinking"===e.type,children:(0,z.jsx)(e5,{className:s,children:e.raw})},t):(0,z.jsx)(e5,{className:s,renderKnowledgeBaseItemLink:a,children:e.raw},t):null),[l,s,a,n]);return(0,z.jsx)("div",{className:"flex w-full flex-col gap-1",children:c})},CascadePlannerMessage=e=>{let{thinking:t,message:s,knowledgeBaseItems:a=[],thinkingRedacted:n}=e,{state:{isRunning:r}}=useCascadeContext(),o=(0,X.useCallback)(e=>{let t=e.slice(5);if(Number.isNaN(t))return(0,z.jsx)(z.Fragment,{});let s=a.findIndex(e=>{var s;return(null===(s=e.knowledgeBaseItem)||void 0===s?void 0:s.documentId)===t});if(s<0)return(0,z.jsx)(z.Fragment,{});let n=a[s];return n?(0,z.jsx)(KnowledgeBaseCitation,{knowledgeBaseItem:n,index:s+1}):(0,z.jsx)(z.Fragment,{})},[a]),i="text-[color:var(--codeium-text-color)] prose-a:text-[color:var(--codeium-link-color)]";return(0,z.jsx)("div",{className:"flex w-full flex-row items-end",children:(0,z.jsxs)("div",{className:"min-w-0 grow",children:[(t||n)&&(0,z.jsx)(ThinkingStep,{defaultExpanded:r,loading:""===s,children:(0,z.jsx)(e5,{className:i,children:n?"Some of Claude's internal reasoning has been automatically encrypted for safety reasons. This doesn't affect the quality of responses.":t})}),(0,z.jsx)(MarkdownNodes,{markdown:s,className:i,renderKnowledgeBaseItemLink:o}),a.length>0?(0,z.jsx)("div",{className:"mt-2 flex flex-col flex-wrap gap-1",children:a.map((e,t)=>{var s;return(0,z.jsx)(KnowledgeBaseItemPillButton,{knowledgeBaseItem:e,index:t+1},"".concat(null===(s=e.knowledgeBaseItem)||void 0===s?void 0:s.documentId))})}):null]})})};var aq=s(5246),aU=s(23526),aG=s(23840);let CompactTooltip=e=>{let{id:t,children:s,className:a="",...n}=e;return(0,z.jsx)(e7.u,{opacity:1,id:t,positionStrategy:"fixed",className:(0,eG.classNames)("z-[100] !bg-ide-editor-background !px-2 !py-0 !text-ide-tooltip-color",a),border:"1px solid rgba(128, 128, 128, 0.1)",...n,children:s})},CascadeUserMessage=e=>{let{items:t,revert:s,images:a,timestamp:n}=e,{handshake:r,state:{profilePictureUrl:o},logEvent:i}=useServerConnectionContext(),{editor:{parsingConfig:l}}=useCascadeContext(),[c,d]=(0,X.useState)(!1),[u,m]=(0,X.useState)(!1),[p,x]=(0,X.useState)(null),h=(0,X.useMemo)(()=>Math.random().toString(36),[]),g=(0,X.useMemo)(()=>{var e;if(!(null==r?void 0:null===(e=r.userStatus)||void 0===e?void 0:e.name))return"Me";let t=r.userStatus.name.split(" ");try{switch(t.length){case 0:return"Me";case 1:return t[0].charAt(0);default:return"".concat(t[0].charAt(0)).concat(t[t.length-1].charAt(0))}}catch(e){return"Me"}},[r]),f=(0,X.useMemo)(()=>{if(!n)return;let e=new Date(1e3*Number(n.seconds)+n.nanos/1e6);return e.toLocaleString()},[n]),y=(0,z.jsxs)(z.Fragment,{children:[f&&(0,z.jsx)(CompactTooltip,{place:"top-start",positionStrategy:"fixed",id:"".concat(h,"-timestamp"),children:f}),(0,z.jsx)("div",{className:"mt-2 flex h-5 min-h-[1.25rem] w-5 min-w-[1.25rem] grow-0 flex-row items-center justify-center overflow-hidden rounded-full bg-ide-message-block-user-background bg-clip-content text-ide-message-block-user-color","data-tooltip-id":f?"".concat(h,"-timestamp"):void 0,children:o&&!u?(0,z.jsx)("img",{src:o,onError:()=>{m(!0)},alt:g,className:"h-full w-full object-cover"}):(0,z.jsx)("p",{className:"m-0 flex w-full flex-row items-center justify-center text-center text-[0.5rem] font-bold",children:g})})]}),v=(0,z.jsxs)("div",{className:"flex items-center",children:[(0,z.jsx)("div",{className:"cursor-pointer p-1 opacity-70 hover:opacity-100",onClick:()=>{c?(s(),d(!1),i(et.tbr.CASCADE_CLICK_EVENT,{type:"revert-step"})):d(!0)},"data-tooltip-id":"".concat(h,"-").concat(c?"confirm":"revert"),children:c?(0,z.jsx)(aq.Z,{className:"h-4 w-4 text-green-500"}):(0,z.jsx)(aU.Z,{className:"h-4 w-4"})}),c&&(0,z.jsx)("div",{className:"ml-1 cursor-pointer p-1 opacity-70 hover:opacity-100",onClick:()=>{d(!1)},"data-tooltip-id":"".concat(h,"-cancel"),children:(0,z.jsx)(aG.Z,{className:"h-4 w-4 text-red-500"})}),!c&&(0,z.jsx)(CompactTooltip,{place:"left",id:"".concat(h,"-revert"),children:"Revert to this step"}),c&&(0,z.jsx)(CompactTooltip,{place:"top",id:"".concat(h,"-confirm"),children:"Confirm revert"}),c&&(0,z.jsx)(CompactTooltip,{place:"top",id:"".concat(h,"-cancel"),children:"Cancel revert"})]});return(0,z.jsxs)("div",{className:"group mt-1 flex w-full flex-row items-start gap-2",children:[y,(0,z.jsx)("div",{className:"flex flex-grow flex-col items-stretch",children:(0,z.jsxs)("div",{className:"relative flex-grow rounded bg-ide-editor-background p-2",children:[(0,z.jsx)("div",{className:"absolute inset-0 z-0 rounded bg-ide-editor-color opacity-[0.04]"}),(0,z.jsx)("div",{className:"relative",children:t.length>0&&(0,z.jsx)(TextOrScopeItemView,{value:t,parsingConfig:l})}),a&&a.length>0&&(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)("div",{className:"relative mt-2 flex flex-wrap gap-2",children:a.map((e,t)=>(0,z.jsx)("div",{className:"relative cursor-pointer overflow-hidden rounded border border-gray-500/25 transition-[opacity] hover:opacity-50",onClick:()=>{x(e)},children:(0,z.jsx)("img",{src:"data:".concat(e.mimeType,";base64,").concat(e.base64Data),alt:"User uploaded image ".concat(t+1),className:"h-full max-h-16 w-full object-contain"})},t))}),p&&(0,z.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",onClick:()=>{x(null)},children:(0,z.jsxs)("div",{className:"relative max-h-[90vh] max-w-[90vw]",children:[(0,z.jsx)("img",{src:"data:".concat(p.mimeType,";base64,").concat(p.base64Data),alt:"Enlarged image",className:"max-h-[90vh] max-w-[90vw] object-contain"}),(0,z.jsx)("button",{className:"group absolute -right-4 -top-4 rounded-full bg-ide-editor-background p-2 text-ide-tooltip-color",onClick:e=>{e.stopPropagation(),x(null)},children:(0,z.jsx)(aG.Z,{className:"duration-50 h-4 w-4 opacity-50 transition-[opacity] group-hover:opacity-100"})})]})})]}),(0,z.jsx)("div",{className:(0,eG.classNames)("absolute bottom-0 right-3 flex translate-y-1/2 flex-row gap-1 rounded border-[1px] border-gray-500/25 bg-ide-editor-background",c?"":"opacity-0 group-hover:opacity-100"),children:v})]})})]})},RelatedFilesStep=e=>{let{absoluteUri:t,totalResults:s}=e,{openFilePointer:a}=useServerConnectionContext(),n=(0,X.useId)(),r=getBaseName(t);return(0,z.jsxs)("div",{className:"flex w-full items-center",children:[(0,z.jsxs)("div",{"data-tooltip-id":n,className:"flex flex-row items-center gap-1 overflow-hidden whitespace-nowrap",children:[(0,z.jsx)("p",{children:"Searched for files related to"}),(0,z.jsx)(PillButton,{onClick:()=>{a(new OpenFilePointer({fileUri:t}))},children:(0,z.jsx)("span",{className:"opacity-70",children:r})}),(0,z.jsxs)(CompactTooltip,{id:n,children:["Searched for files related to ",r]})]}),(0,z.jsx)("div",{className:"ml-auto flex-none",children:(0,z.jsxs)("span",{className:"pl-1",children:[s," result",1===s?"":"s"]})})]})},SearchKnowledgeBaseStep=e=>{let{step:t,status:s}=e;return(0,z.jsxs)("div",{children:[(0,z.jsxs)("div",{className:"flex flex-row items-center gap-2",children:[(0,z.jsxs)("p",{children:[isLoadingStatus(s)?"Searching":"Searched"," knowledge base"]}),(0,z.jsx)("div",{className:"flex flex-row items-center gap-1",children:t.connectorTypes.map(e=>(0,z.jsx)(e9.p,{connectorType:e,className:"h-3 w-3"},"knowledge-base-".concat(e)))})]}),(0,z.jsxs)("div",{className:"mb-1 mt-0.5 flex flex-wrap gap-1",children:[t.queries.filter(e=>""!==e).map(e=>(0,z.jsx)("div",{className:"inline-flex max-w-full items-center rounded-full bg-gray-500/15 px-1.5 py-0.5 text-xs",children:(0,z.jsx)("span",{className:"max-w-full truncate",children:e})},e)),[...function(e){if(!e)return[];let t="timeRange",s=[],timestampToString=e=>e.toDate().toLocaleString("default",{weekday:"short",year:"numeric",month:"short",day:"numeric"}).replace(",","");return e.start&&s.push({filterType:t,displayString:"after: ".concat(timestampToString(e.start))}),e.end&&s.push({filterType:t,displayString:"before: ".concat(timestampToString(e.end))}),s}(t.timeRange),...function(e){let t=[];return e.forEach(e=>{t.push({filterType:"aggregateId",displayString:e})}),t}(t.aggregateIds)].map((e,t)=>{let{filterType:s,displayString:a}=e;return(0,z.jsx)("div",{className:"inline-flex max-w-full items-center rounded-full bg-gray-500/15 px-1 py-0.5 text-xs",children:(0,z.jsx)("span",{className:"truncate",children:a})},"knowledge-base-".concat(s,"-").concat(t))})]})]})},LookupKnowledgeBaseStep=e=>{let{step:t,status:s}=e,a=[...function(e){let t=[];return e.forEach(e=>{t.push({filterType:"url",displayString:e})}),t}(t.urls),...function(e){let t=[];return e.forEach(e=>{t.push({filterType:"documentId",displayString:e})}),t}(t.documentIds)];return(0,z.jsxs)("div",{children:[(0,z.jsx)("div",{className:"flex flex-row items-center gap-2",children:(0,z.jsxs)("p",{children:[isLoadingStatus(s)?"Looking up":"Looked up"," knowledge base"]})}),a.length>0&&(0,z.jsx)("div",{className:"mb-1 mt-0.5 flex flex-wrap gap-1",children:a.map((e,t)=>(0,z.jsx)("div",{className:"inline-flex max-w-full items-center rounded-full bg-gray-500/15 px-1.5 py-0.5 text-xs",children:(0,z.jsx)("span",{className:"max-w-full truncate",children:e.displayString})},"filter-".concat(t)))})]})},FinishStep=e=>{let t,{step:s}=e,{openFilePointer:a}=useServerConnectionContext(),n=(0,X.useId)();if(void 0!==s.output.raw_json)try{let e=JSON.parse(s.output.raw_json);t=e.FilesToEdit}catch(e){console.error("Error parsing JSON:",e)}if(!t)return"";try{return(0,z.jsxs)("div",{children:[(0,z.jsx)("p",{children:"Files to edit:"}),t.map((e,t)=>{let s=e.AbsolutePath;return(0,z.jsxs)("div",{"data-tooltip-id":"".concat(n,"-").concat(t),children:[(0,z.jsx)("div",{className:"flex flex-row",children:(0,z.jsx)("a",{href:s,onClick:()=>{a(new OpenFilePointer({fileUri:s}))},className:"direction-[rtl] flex-grow overflow-hidden text-ellipsis whitespace-nowrap text-left font-mono underline",children:getBaseName(s)})}),(0,z.jsx)(CompactTooltip,{id:"".concat(n,"-").concat(t),children:getBaseName(s)})]},s)})]})}catch(e){return console.error(e),null}},GitCommitStep=e=>{let{hash:t,message:s}=e;return(0,z.jsxs)("div",{children:[(0,z.jsx)("p",{children:"Inspected commit"}),(0,z.jsxs)("div",{className:"flex flex-row",children:[(0,z.jsx)("span",{className:"font-mono opacity-70",children:t.substring(0,7)}),(0,z.jsx)("span",{className:"opacity-50",children:s})]})]})},PlanInputStep=e=>{var t,s;let{step:a}=e;return(0,z.jsxs)("div",{children:[(0,z.jsxs)("span",{children:["Goal: ",(null===(t=a.planInput)||void 0===t?void 0:t.goal)||""]}),(0,z.jsx)("ul",{className:"list-disc",children:null===(s=a.planInput)||void 0===s?void 0:s.nextSteps.map(e=>(0,z.jsx)("li",{children:e},e))})]})},SuggestedResponsesStep=e=>{let{step:t,sendMessage:s}=e;return(0,z.jsxs)("div",{className:"relative rounded p-2",children:[(0,z.jsx)("div",{className:"absolute inset-0 z-[-1] rounded bg-ide-editor-color opacity-[0.04]"}),(0,z.jsx)("div",{className:"text-xs opacity-50",children:"Suggested Actions"}),(0,z.jsx)("div",{className:"flex flex-row flex-wrap gap-x-1",children:t.suggestions.map(e=>(0,z.jsx)("button",{className:"hover:bg-ide-button-secondary-hover-background active:bg-ide-button-secondary-hover-background hover:text-ide-button-secondary-hover-color bg-ide-button-secondary-background text-ide-button-secondary-color mt-1 shrink cursor-pointer overflow-hidden text-ellipsis whitespace-nowrap rounded-sm px-1 py-0.5 text-xs",onClick:()=>{s&&s([new et.QVo({chunk:{case:"text",value:e}})])},children:e},e))})]})},ManagerFeedbackStep=e=>{let{step:t,status:s}=e,a=t.status===eS.sNS.APPROVED;return s!==eS.V_N.DONE?(0,z.jsx)("div",{children:"Getting manager feedback..."}):(0,z.jsxs)("div",{children:[(0,z.jsxs)("p",{children:["Manager Feedback:"," ",(0,z.jsx)("span",{className:"font-bold ".concat(a?"text-green-500":"text-yellow-500"),children:a?"APPROVED":"DENIED"})]}),t.feedback&&(0,z.jsx)("div",{className:"flex flex-row",children:(0,z.jsx)("span",{className:"opacity-80",children:t.feedback})})]})},AutoCascadeBroadcastStep=e=>{let{step:t}=e;return(0,z.jsxs)("div",{children:[(0,z.jsx)("div",{className:"mb-2 font-bold",children:"Broadcast to User"}),(0,z.jsx)(e5,{children:t.message})]})},getHeaderForTrajectory=e=>{let t=eS.fjq[e.trajectoryType],s="".concat(t," (").concat(e.steps.length," Steps)");if(e.steps.length>0){var a,n;let t=null===(n=e.steps[e.steps.length-1])||void 0===n?void 0:null===(a=n.metadata)||void 0===a?void 0:a.createdAt;t&&(s+=" - ".concat(eP()(t.toDate()).fromNow()))}return s},getHeaderFromTrajectoryScope=(e,t,s)=>{let a=e.workspaceUri,n=e.branchName;return(0,z.jsxs)("span",{children:[a&&(0,z.jsxs)("span",{className:"text-gray-400",children:[prettyPath(a,t,s)," "]}),n&&(0,z.jsxs)("span",{className:"text-accent-500",children:["(",n,")"]})]})},isLoadingStatus=e=>[eS.V_N.GENERATING,eS.V_N.WAITING,eS.V_N.PENDING,eS.V_N.RUNNING].includes(e),isCancelableStatus=e=>[eS.V_N.RUNNING,eS.V_N.WAITING].includes(e),isCodeActionHeuristicFailure=e=>e.status===eS.V_N.DONE&&"codeAction"===e.step.case&&e.step.value.heuristicFailure!==eS.zkg.UNSPECIFIED,getContentForStep=(e,t,s,a)=>{if(!s)switch(e.step.case){case"checkpoint":case"memory":case"retrieveMemory":case"finish":case"managerFeedback":return null}switch(e.step.case){case"userInput":var n;return(0,z.jsx)(CascadeUserMessage,{items:e.step.value.items,revert:t,timestamp:null===(n=e.metadata)||void 0===n?void 0:n.createdAt});case"errorMessage":case"mquery":case"codeAction":case"proposeCode":case"listDirectory":case"viewFile":case"grepSearch":case"find":case"runCommand":case"commandStatus":case"readUrlContent":case"viewContentChunk":case"searchWeb":case"mcpTool":case"createRecipe":case"customTool":case"proxyWebServer":case"deployWebApp":case"readDeploymentConfig":return(0,z.jsx)(z.Fragment,{});case"planInput":return(0,z.jsx)(PlanInputStep,{step:e.step.value});case"gitCommit":{let t=e.step.value;return(0,z.jsx)(GitCommitStep,{hash:t.commitHash,message:t.commitMessage})}case"suggestedResponses":if(!a)return null;return(0,z.jsx)(SuggestedResponsesStep,{step:e.step.value,sendMessage:a});case"checkpoint":{let t=e.step.value;return(0,z.jsxs)("div",{children:[(0,z.jsxs)("p",{children:["Checkpoint ",t.checkpointIndex]}),(0,z.jsx)("p",{children:t.userIntent.split("\n")[0]})]})}case"plannerResponse":return(0,z.jsx)(CascadePlannerMessage,{message:e.step.value.response,thinking:e.step.value.thinking,knowledgeBaseItems:e.step.value.knowledgeBaseItems,revert:t,thinkingRedacted:e.step.value.thinkingRedacted});case"viewCodeItem":let r=e.step.value.cci;if(!r)return null;return(0,z.jsx)(z.Fragment,{});case"listClusters":return(0,z.jsx)("p",{children:"Reviewed codebase structure"});case"clusterQuery":let o=e.step.value.outputClusters;if(0===o.length)return null;let i=o.map(e=>(0,z.jsx)("p",{children:e.name},e.name));return(0,z.jsxs)("div",{children:[(0,z.jsx)("div",{children:"Clusters"}),(0,z.jsx)("div",{children:i})]});case"relatedFiles":let l=e.step.value;return(0,z.jsx)(RelatedFilesStep,{absoluteUri:l.absoluteUri,totalResults:l.relatedFileAbsoluteUris.length});case"searchKnowledgeBase":return(0,z.jsx)(SearchKnowledgeBaseStep,{step:e.step.value,status:e.status});case"autoCascadeBroadcast":return(0,z.jsx)(AutoCascadeBroadcastStep,{step:e.step.value});case"lookupKnowledgeBase":return(0,z.jsx)(LookupKnowledgeBaseStep,{step:e.step.value,status:e.status});case"finish":return(0,z.jsx)(FinishStep,{step:e.step.value});case"memory":{let t=e.step.value,s=eS.o2G[t.action];return(0,z.jsxs)("div",{children:[(0,z.jsxs)("p",{children:["Memory id: ",t.memoryId]}),(0,z.jsxs)("p",{children:["Action: ",s]})]})}case"retrieveMemory":{let t=e.step.value;return(0,z.jsx)("div",{children:(0,z.jsxs)("p",{children:["Cascade memories retrieved: ",t.retrievedMemories.length]})})}case"managerFeedback":return(0,z.jsx)(ManagerFeedbackStep,{step:e.step.value,status:e.status});default:return null}},getPathFromCodeAction=e=>{var t,s,a;switch(null===(t=e.actionSpec)||void 0===t?void 0:t.spec.case){case"command":let n=e.actionSpec.spec.value.target;switch(n.case){case"file":case"lineRange":return n.value.absoluteUri}break;case"createFile":return null===(s=e.actionSpec.spec.value.path)||void 0===s?void 0:s.absoluteUri;case"deleteFile":return null===(a=e.actionSpec.spec.value.path)||void 0===a?void 0:a.absoluteUri}},hashUint8Array=e=>{let t=0;for(let s=0;s<e.length;s++)t=(t<<5)-t+(e[s]||0)|0;return t};let DocsNodeParser=class DocsNodeParser extends MarkdownTextNodeParser{getType(){return"docs"}findMatches(e){return e.match(DocsNodeParser.DOCS_REGEX)}createNodeData(e){let t=e.match(DocsNodeParser.DOCS_REGEX);if(!t||t.length<3)return null;let s=t[1],a=t[2];return s&&a?DocsNodeParser.createDocsNode(s,a):null}static createDocsNode(e,t){return new MarkdownNodeData({data:{trigger:"@",category:"docs",optionType:A.ITEM,data:"[@docs:".concat(e,"](").concat(t,")"),dataType:P.STRING,displayTitle:e,displayMetadata:"",mentionText:"docs:".concat(e)},renderData:{displayIcon:(0,z.jsx)(tu.Z,{className:"w-3 stroke-ide-message-block-bot-color"})}})}};DocsNodeParser.DOCS_REGEX=/\[@docs:([a-zA-Z0-9_-]+)\]\(([^)]+)\)/;let modelOrAliasToModel=e=>{switch(e.choice.case){case"alias":if(e.choice.value===et.yr0.CASCADE_BASE)return et.Hnr.MODEL_UNSPECIFIED;break;case"model":return e.choice.value}return null},configToOption=e=>{if(!e.modelOrAlias)return null;let t=modelOrAliasToModel(e.modelOrAlias);return null===t?null:{label:e.label,value:t,creditMultiplier:e.creditMultiplier,disabled:e.disabled,supportsImages:e.supportsImages,supportsLegacy:e.supportsLegacy,isPremium:e.isPremium,betaWarningMessage:e.betaWarningMessage,isBeta:e.isBeta}},getAvailableModelConfigs=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(0===e.length)return t?combineModelLists(aE,aI):aj;let s=e.map(configToOption).filter(e=>null!==e);return t?combineModelLists(s,aE,aI):s};(C=J||(J={})).WRITE_CASCADE_BASE_ON_FREE_PLAN="WRITE_CASCADE_BASE_ON_FREE_PLAN",C.WRITE_CHAT_INSUFFICIENT_USER_PROMPT_CREDITS="WRITE_CHAT_INSUFFICIENT_USER_PROMPT_CREDITS",C.WRITE_CHAT_INSUFFICIENT_FLOW_ACTION_CREDITS="WRITE_CHAT_INSUFFICIENT_FLOW_ACTION_CREDITS",C.WRITE_CHAT_UPGRADE_FOR_CREDITS="WRITE_CHAT_UPGRADE_FOR_CREDITS",C.LEGACY_NOT_ENOUGH_CREDITS="LEGACY_NOT_ENOUGH_CREDITS",C.LEGACY_NOT_SUPPORTED="LEGACY_NOT_SUPPORTED";let getCascadeSendMessageError=function(e,t,s,a){var n,r,o,i;let l=!(arguments.length>4)||void 0===arguments[4]||arguments[4];if(a===et.FLT.NO_TOOL)return(null!==(n=s.creditMultiplier)&&void 0!==n?n:0)>0&&e<(null!==(r=s.creditMultiplier)&&void 0!==r?r:1)*100?{message:"Not enough credits. Purchase more credits or select a different model.",code:"LEGACY_NOT_ENOUGH_CREDITS"}:s.supportsLegacy?{code:void 0}:{message:"This model does not support legacy mode. Use Write or Chat mode to use this model.",code:"LEGACY_NOT_SUPPORTED"};if(!l&&s.value===et.Hnr.MODEL_UNSPECIFIED&&a===et.FLT.DEFAULT)return{message:"Cascade Base does not support Write mode on the Free plan. Switch to Chat mode to use Cascade Base or upgrade to a paid plan.",code:"WRITE_CASCADE_BASE_ON_FREE_PLAN"};let c=e>=0&&e<(null!==(o=s.creditMultiplier)&&void 0!==o?o:1)*100,d=t>=0&&t<(null!==(i=s.creditMultiplier)&&void 0!==i?i:1)*100;return c||d?l?c?{message:"Not enough Premium User Prompt credits. Purchase more or switch to Cascade Base model.",code:"WRITE_CHAT_INSUFFICIENT_USER_PROMPT_CREDITS"}:{message:"Not enough Premium Flow Action credits. Purchase more or switch to Cascade Base model.",code:"WRITE_CHAT_INSUFFICIENT_FLOW_ACTION_CREDITS"}:{message:"Not enough credits. Upgrade to a paid plan or switch to Cascade Base model.",code:"WRITE_CHAT_UPGRADE_FOR_CREDITS"}:{code:void 0}},$initializeSelection=()=>{let e=(0,t_.BE)(),t=(0,t_.MX)("");e.append(t);let s=(0,t_.Gv)();s.append(e);let a=(0,t_.vN)();a.anchor.set(t.getKey(),0,"text"),a.focus.set(t.getKey(),0,"text"),(0,t_.oq)(a)},insertContextScopeItem=(e,t)=>{e.update(()=>{let e=(0,t_.dL)();if((!e||!(0,t_.OP)(e))&&($initializeSelection(),!(e=(0,t_.dL)())||!(0,t_.OP)(e)))return;let s=ContextScopeItemNodeData.fromContextScopeItem(t),a=s.getMenuItemProps(),n=(0,tP.kg)(a.data.trigger,a.data.mentionText,a.data);e.insertNodes([n]);let r=(0,t_.dL)();if(r&&(0,t_.OP)(r)){let e=(0,t_.MX)(" ");r.insertNodes([e]),r.anchor.set(e.getKey(),1,"text"),r.focus.set(e.getKey(),1,"text")}})},insert_insertText=(e,t)=>{e.focus(),e.update(()=>{let e=(0,t_.dL)();if(e&&(0,t_.OP)(e)){let s=e.anchor.offset;e.insertText(t),e.anchor.offset=s+t.length,e.focus.offset=s+t.length}})},aQ={layout:{lexicalRef:(0,X.createRef)(),focusEditor:()=>{},resetScroll:()=>{},triggerScroll:()=>{},scrollRef:(0,X.createRef)(),containerRef:(0,X.createRef)(),cascadeTooltipRef:(0,X.createRef)()},editor:{parsingConfig:new ParsingConfig},debug:{setDebugMode:()=>{},debugMode:!1},validate:{setValidateView:()=>{},validateView:!1},events:{setCascadeConversationState:()=>{},clearCascadeId:()=>{},handleModelChange:()=>{},startCascade:()=>{},sendMessage:async()=>{},cancelInvocation:()=>{},cancelStepIndices:()=>{},resolveOutstandingSteps:()=>{},revertToStep:()=>{},sendUserInteraction:()=>{},toggleConversationalPlannerMode:()=>et.FLT.DEFAULT,onModifierChange:()=>{},deleteConversation:()=>{},deleteAsyncConversation:()=>{},getAllCascadeTrajectories:async()=>{},setInterruptConfirmation:()=>{},getUserImplicitTrajectories:async()=>{},refreshBackgroundResearch:async()=>{},setHasDismissedEditHistory:()=>{},startCascadeFromBaseTrajectory:()=>Promise.resolve(""),fetchCodeValidationStates:async()=>{},hideIdSwitchModal:()=>{},setSelectedImages:()=>{},addSelectedImages:()=>{},clearSelectedImages:()=>{},setErrorMessage:()=>{},clearErrorMessage:()=>{},handleImage:async()=>{},handleImages:async()=>{},validateWindsurfJSAppProjectName:async()=>Promise.resolve(void 0),saveWindsurfJSAppProjectName:async()=>Promise.resolve(void 0)},state:{cascadeConversationState:void 0,cascadeState:void 0,cascadePanelState:void 0,connectionState:void 0,hasChanged:"",remainingPromptAndFlexCredits:0,remainingToolAndFlexCredits:0,remainingPromptCredits:0,remainingToolCredits:0,conversationalPlannerMode:et.FLT.UNSPECIFIED,activeConfig:new eS.P1u,isRunning:!1,isPremiumUser:void 0,canBuyMoreCredits:void 0,canUseWriteMode:!1,currentModelConfig:ad,hasSetInitialModel:!1,isModifierPressed:!1,interruptConfirmation:!1,hasDismissedEditHistory:!1,trajectories:void 0,visibleModelConfigs:aj,implicitTrajectoryResponse:void 0,refreshingTrajectories:new Set,userLoaded:!1,userSettings:new et.PGO,validationStates:[],showIdSwitchModal:!1,hasDevExtension:!1,selectedImages:[],errorMessage:"",webSearchEnabled:!1,recipesEnabled:!1,isLoadingModels:!1}},aJ=(0,X.createContext)(aQ),CascadeContextProvider=e=>{var t;let{children:s}=e,{lsClient:a,userStatus:n,updateUserSettings:r,unleash:o,state:{userSettings:i},props:{handleCloseAllDiffZones:l,handleSetDiffZonesState:c}}=useServerConnectionContext(),{cascadeInitId:d,apiKey:u}=useChatParamsContext(),m=(0,X.useRef)(null),p=useChatParamsContext(),x=navigator.userAgent.includes("Mac OS X"),h=!!p.hasDevExtension,[g,f]=(0,X.useState)(void 0),[y,v]=(0,X.useState)(void 0),[C,w]=(0,X.useState)(!1),[b,N]=(0,X.useState)(!1),[S,j]=(0,X.useState)(et.FLT.UNSPECIFIED),[E,I]=(0,X.useState)([]),[T,k]=(0,X.useState)(""),[R,_]=(0,X.useState)(),[D,A]=(0,X.useState)(!1),[P,M]=(0,X.useState)([]),[L,O]=(0,X.useState)(!1);(0,X.useEffect)(()=>{let fetchAllowedModels=async()=>{let e=[];O(!0);let t=setTimeout(()=>{O(!1)},1e4);try{let s=await (null==a?void 0:a.getCascadeModelConfigs(new ei.Aqu({metadata:getMetadata(p),filter:!0})));(e=(null==s?void 0:s.clientModelConfigs)||[]).length>0&&(clearTimeout(t),O(!1))}catch(e){console.error("Failed to fetch allowed models:",e)}M(getAvailableModelConfigs(e,h))};fetchAllowedModels()},[null==n?void 0:n.teamId,a,u,h,p]);let F=(0,X.useMemo)(()=>null==a?void 0:a.streamCascadePanelReactiveUpdates.bind(a),[a]),B=(0,X.useMemo)(()=>null==a?void 0:a.streamCascadeReactiveUpdates.bind(a),[a]),q=useReactiveState(eS.qNP,F,u),U=useReactiveState(eS._VW,B,null==R?void 0:R.cascadeId),G=U.state,Q=q.state,J=U.connectionState,W=G.status,H=W===eS.xDu.RUNNING,V=Q.userSettings||i,Y=Q.planStatus,Z=(0,X.useCallback)(e=>{_(e);let t=V.clone();t.lastSelectedCascadeId=null==e?void 0:e.cascadeId,r(t)},[V,r,_]),K=null===(t=G.trajectory)||void 0===t?void 0:t.steps,{hasChanged:$}=(0,X.useMemo)(()=>({hasChanged:null==K?void 0:K.map(e=>hashUint8Array(e.toBinary())).join(",")}),[K]),ee=(0,X.useCallback)(async()=>{try{await (null==a?void 0:a.resolveOutstandingSteps(new ei.uHb({cascadeId:null==R?void 0:R.cascadeId})))}catch(e){console.error(e)}},[a,R]),[es,ea]=(0,X.useState)([]),en=(0,X.useCallback)(async()=>{try{let e=await (null==a?void 0:a.getCodeValidationStates(new ei.hOF({cascadeId:null==R?void 0:R.cascadeId})));if(!e)return;let t=e.states;ea(t)}catch(e){console.error(e);return}},[a,R]);(0,X.useEffect)(()=>{d&&Z({type:"sync",cascadeId:d})},[d,Z]);let er=(0,X.useCallback)(e=>{if(R&&es.length>0&&!e){A(!0);return}ee(),l&&R?l(R.cascadeId,!0):console.warn("No handleCloseAllDiffZones found"),Z(void 0)},[R,l,ee,A,es,Z]);(0,X.useEffect)(()=>{var e,t,s,a,r,o,i,l;if(!n)return;v(null===(t=n.planStatus)||void 0===t?void 0:null===(e=t.planInfo)||void 0===e?void 0:e.canBuyMoreCredits);let c=n.teamStatus===et.ngL.APPROVED||(null===(a=n.planStatus)||void 0===a?void 0:null===(s=a.planInfo)||void 0===s?void 0:s.teamsTier)===et.wuw.TRIAL||(null===(o=n.planStatus)||void 0===o?void 0:null===(r=o.planInfo)||void 0===r?void 0:r.teamsTier)===et.wuw.PRO||(null===(l=n.planStatus)||void 0===l?void 0:null===(i=l.planInfo)||void 0===i?void 0:i.teamsTier)===et.wuw.PRO_ULTIMATE;f(c),w(c)},[n]);let eo=(0,X.useCallback)(()=>{A(!1)},[A]),el=(0,X.useMemo)(()=>{for(let e of P)if(e.value===V.lastSelectedCascadeModel)return e;return g?au:ad},[g,V.lastSelectedCascadeModel,P]),[ec,ed]=(0,X.useState)(el);(0,X.useEffect)(()=>{L||ed(el)},[L,el]);let[eu,em]=(0,X.useState)(!1),[ep,ex]=(0,X.useState)(!1),[eh,eg]=(0,X.useState)(null),[ef,ey]=(0,X.useState)(void 0),[ev,eC]=(0,X.useState)(new Set),[ew,eb]=(0,X.useState)(!1);(0,X.useEffect)(()=>{R&&eb(!0)},[R]);let[eN,ej]=(0,X.useState)(!1),[eE,eI]=(0,X.useState)(void 0),[eT,ek]=(0,X.useState)(!1),[eR,e_]=(0,X.useState)(!1),eD=(0,X.useMemo)(()=>void 0===Y||void 0===Y.planInfo?Number.MAX_SAFE_INTEGER:getRemainingPromptAndFlexCredits(Y.planInfo,Y),[Y]),eA=(0,X.useMemo)(()=>void 0===Y||void 0===Y.planInfo?Number.MAX_SAFE_INTEGER:getRemainingToolAndFlexCredits(Y.planInfo,Y),[Y]),eP=(0,X.useMemo)(()=>void 0===Y||void 0===Y.planInfo?Number.MAX_SAFE_INTEGER:getRemainingPromptCredits(Y.planInfo,Y),[Y]),eM=(0,X.useMemo)(()=>void 0===Y||void 0===Y.planInfo?Number.MAX_SAFE_INTEGER:getRemainingToolCredits(Y.planInfo,Y),[Y]),eL=(0,X.useMemo)(()=>{let e=V.cascadePlannerMode?V.cascadePlannerMode:et.FLT.UNSPECIFIED;return e===et.FLT.UNSPECIFIED?S!==et.FLT.UNSPECIFIED?S:et.FLT.DEFAULT:e},[V,S]);(0,X.useEffect)(()=>{eL!==et.FLT.NO_TOOL&&j(eL)},[eL]);let eO=(0,X.useCallback)(e=>{if(H)return e;let t=V.clone(),s=[et.FLT.NO_TOOL,et.FLT.UNSPECIFIED,et.FLT.READ_ONLY].includes(e)?et.FLT.DEFAULT:et.FLT.READ_ONLY;return t.cascadePlannerMode=s,r(t),s},[H,V,r]),eF=(0,X.useMemo)(()=>V.cascadeAutoExecutionPolicy,[V]),eB=(0,X.useMemo)(()=>V.cascadeAllowedCommands,[V]),eq=(0,X.useMemo)(()=>V.cascadeDeniedCommands,[V]),eU=(0,X.useMemo)(()=>{let e=new et.$PV;return ec.value===et.Hnr.MODEL_UNSPECIFIED?e.choice={case:"alias",value:et.yr0.CASCADE_BASE}:e.choice={case:"model",value:ec.value},new eS.P1u({plannerConfig:new eS.yT1({requestedModel:e,plannerTypeConfig:{case:"conversational",value:new eS.Hl({plannerMode:eL})},toolConfig:new eS.mxk({runCommand:new eS.mX2({autoCommandConfig:new eS.nlj({autoExecutionPolicy:eF,userAllowlist:eB,userDenylist:eq})})})})})},[ec,eL,eF,eB,eq]),eG=(0,X.useCallback)(e=>{let t=labelToModelConfig(P,e);if(!t){console.error("[Model Select] Invalid model label: ".concat(e));return}ed(t);let s=V.clone();s.lastSelectedCascadeModel=t.value;let a=t.value===et.Hnr.MODEL_UNSPECIFIED;w(!a||!0===g),r(s)},[V,r,g,P]),eQ=(0,X.useCallback)(async e=>{if(!a)throw Error("Language server client is not initialized");try{let t=await a.startCascade(new ei.DW6({metadata:getMetadata(p),baseTrajectoryIdentifier:e}));return t.cascadeId}catch(e){throw console.error("Failed to start cascade:",e),e}},[a,p]),eJ=(0,X.useCallback)(async e=>{try{let t;e&&(t=new eS.RaJ({identifier:{case:"lastActiveDoc",value:!0}}));let s=await (null==a?void 0:a.startCascade(new ei.DW6({metadata:getMetadata(p),baseTrajectoryIdentifier:t,source:eS.D19.CASCADE_CLIENT})));if(!s)return;return Z({type:"sync",cascadeId:s.cascadeId}),s.cascadeId}catch(e){console.error(e)}},[a,Z,p]),eW=(0,X.useCallback)(async(e,t)=>{var s;ep&&ex(!1);let n=getCascadeSendMessageError(eD,eA,ec,eL,g);if(n.code&&n.message){k(n.message);return}let r=[];if(e)r=e;else{if(!m.current||H)return;let e=m.current.getEditorState();r=convertEditorStateToTextOrScopeItem(e),clearEditor(m.current)}if(0!==r.length||(null==t?void 0:null===(s=t.images)||void 0===s?void 0:s.length))try{if((null==R?void 0:R.type)==="async")await (null==a?void 0:a.sendUserAutoCascadeMessage(new ei.Ad6({metadata:getMetadata(p),items:r,images:ec.supportsImages&&(null==t?void 0:t.images)||[],sessionKey:R.asyncSessionKey})));else{let e=null==R?void 0:R.cascadeId;if(!e){let s=await eJ((null==t?void 0:t.startFromImplicit)||!1);e=s||""}await (null==a?void 0:a.sendUserCascadeMessage(new ei.RGt({metadata:getMetadata(p),cascadeId:e,items:r,images:ec.supportsImages&&(null==t?void 0:t.images)||[],cascadeConfig:eU})))}}catch(e){console.error(e)}},[a,eJ,R,p,eU,H,ep,k,eL,g,eD,eA,ec]),eH=(0,X.useCallback)(()=>{null==a||a.cancelCascadeInvocation(new ei.TrS({cascadeId:null==R?void 0:R.cascadeId})).catch(e=>{console.error(e)})},[a,R]),eV=(0,X.useCallback)(e=>{null==a||a.cancelCascadeSteps(new ei.Jzu({cascadeId:null==R?void 0:R.cascadeId,stepIndices:e})).catch(e=>{console.error(e)})},[a,R]),eY=(0,X.useCallback)(e=>{null==a||a.revertToCascadeStep(new ei.eCc({metadata:getMetadata(p),cascadeId:null==R?void 0:R.cascadeId,stepIndex:e})).then(()=>a.getCodeValidationStates(new ei.hOF({cascadeId:null==R?void 0:R.cascadeId}))).then(e=>{let t=e.states;void 0!==R&&void 0!==c&&c(R.cascadeId,t)}).catch(e=>{console.error(e)})},[a,R,p,c]),eZ=(0,X.useCallback)(e=>{null==a||a.handleCascadeUserInteraction(new ei.Z3({cascadeId:null==R?void 0:R.cascadeId,interaction:e})).catch(e=>{console.error(e)})},[a,R]),eK=(0,X.useCallback)(async()=>{try{let e=await (null==a?void 0:a.getAllCascadeTrajectories(new ei.A8m({})));if(!e)return;ey(e)}catch(e){console.error(e)}},[a]),ez=(0,X.useCallback)(async()=>{try{let e=await (null==a?void 0:a.getUserTrajectoryDebug(new ei.dTT({includeAllTrajectories:!1})));if(!e)return;eI(e)}catch(e){console.error(e)}},[a,eI]),eX=(0,X.useRef)(null),e$=(0,X.useRef)(null),{resetScroll:e0,triggerScroll:e1}=useChatAutoScroll({scrollRef:eX,containerRef:e$}),e2=(0,X.useRef)(null),e5=(0,X.useCallback)(async e=>{try{eC(t=>new Set(t).add(e)),await (null==a?void 0:a.forceBackgroundResearchRefresh({metadata:getMetadata(p),mainlineTrajectoryId:e,blocking:!0,fullRefresh:!1})),await ez()}catch(e){console.error(e)}finally{eC(t=>{let s=new Set(t);return s.delete(e),s})}},[a,p,ez,eC]);(0,X.useEffect)(()=>{if(void 0!==g&&!b){em(!0);let e=ad;if(V.lastSelectedCascadeModel){let t=P.find(e=>e.value===V.lastSelectedCascadeModel);t&&g&&(e=t)}ed(e),N(!0)}},[eu,g,b,V,P,el]),(0,X.useEffect)(()=>{E.length>0&&!0!=ec.supportsImages?k("This model does not support images. You can remove them or switch to a model that does."):k("")},[ec,E]);let e3=(0,X.useCallback)(()=>{m.current?m.current.focus():console.warn("Lexical ref does not exist.")},[m]),e4=(0,X.useCallback)((e,t)=>{if(!t){eh&&(clearTimeout(eh),eg(null)),ex(!1);return}if(H||!m.current)return;let s=function(e){if(!document)return!1;let t=e.getEditorState(),s=e.getRootElement();if(!s)return!1;let a=s.contains(document.activeElement),n=t.read(()=>e.getEditorState()._selection);return a&&null!==n}(m.current),a=x?e.metaKey:e.ctrlKey;if(!a||!s)return;let n=setTimeout(()=>{e.preventDefault(),ex(!0)},400);eh&&clearTimeout(eh),eg(n)},[H,m,x,eh]),e6=(0,X.useCallback)(async e=>{a&&(console.log("Deleting conversation ".concat(e)),await a.deleteCascadeTrajectory(new ei._cj({cascadeId:e})),eK())},[a,eK]),e8=(0,X.useCallback)(async e=>{a&&(console.log("Deleting async conversation ".concat(e)),await a.deleteAutoCascadeSession(new ei.d95({metadata:getMetadata(p),sessionKey:e})))},[a,p]),e9=(0,X.useCallback)(e=>{I(t=>[...t,...e])},[]),e7=(0,X.useCallback)(()=>{k("")},[]),te=(0,X.useCallback)(()=>{I([])},[]),tt=(0,X.useCallback)(async e=>{if(!["image/png","image/jpeg","image/gif"].includes(e.type.toLowerCase())){k("Unsupported image format for ".concat(e.name,". Only PNG, JPG, and GIF are allowed."));return}try{let{dataUrl:t,mimeType:s}=await maybeCompressImage(e,1048576,1024),a=t.split(",")[1];e9([new et.RT3({base64Data:a,mimeType:s})])}catch(t){k("Error processing image ".concat(e.name,": ").concat(t instanceof Error?t.message:String(t)))}},[e9,k]),ts=(0,X.useCallback)(async e=>{if(0===e.length)return;e7();let t=5-E.length;if(t<=0){k("Cannot add more images. Maximum of ".concat(5," images allowed."));return}let s=Array.from(e).slice(0,t);if(e.length>t){let s=e.length-t;k("Only uploading first ".concat(t," image").concat(t>1?"s":""," due to ").concat(5," image limit. ").concat(s," image").concat(s>1?"s were":" was"," skipped."))}await Promise.allSettled(s.map(tt))},[E.length,e7,tt,k]),ta=(0,X.useCallback)(async e=>{if(a)try{let t=new ei.xS1({metadata:getMetadata(p),projectName:e}),s=await a.validateWindsurfJSAppProjectName(t);return s}catch(e){return console.error("Error validating Windsurf JS app project name:",e),new ei.Qb8}},[a,p]),tn=(0,X.useCallback)(async(e,t)=>{if(!a)return;let s=new ei.jQJ({metadata:getMetadata(p),workspaceUri:e,projectName:t}),n=await a.saveWindsurfJSAppProjectName(s);return n},[a,p]),tr=(0,X.useMemo)(()=>{var e,t;return!!(o.isEnabled(et.rpR.CASCADE_WEB_SEARCH_ENABLED)&&(null==n?void 0:null===(t=n.planStatus)||void 0===t?void 0:null===(e=t.planInfo)||void 0===e?void 0:e.cascadeWebSearchEnabled)&&!V.cascadeWebSearchDisabled)},[o,n,V.cascadeWebSearchDisabled]),to=(0,X.useMemo)(()=>!!o.isEnabled(et.rpR.CASCADE_RECIPES_AT_MENTION_VISIBILITY)||h,[o,h]),ti=(0,X.useMemo)(()=>{let e=new ParsingConfig;return tr&&e.setParsers([...e.getParsers(),new WebNodeParser,new DocsNodeParser]),e},[tr]);useRegisterChatClientRequestHandler("addCascadeInput",e=>{if(e.images.length>0&&e9(e.images),m.current&&e.items.length>0)for(let t of e.items)switch(t.chunk.case){case"text":insert_insertText(m.current,t.chunk.value);break;case"item":insertContextScopeItem(m.current,t.chunk.value)}setTimeout(()=>{e3()},100)});let tl=(0,X.useMemo)(()=>({layout:{lexicalRef:m,focusEditor:e3,resetScroll:e0,triggerScroll:e1,scrollRef:eX,containerRef:e$,cascadeTooltipRef:e2},editor:{parsingConfig:ti},debug:{setDebugMode:ek,debugMode:eT},validate:{setValidateView:e_,validateView:eR},events:{setCascadeConversationState:Z,clearCascadeId:er,handleModelChange:eG,startCascade:eJ,sendMessage:eW,cancelInvocation:eH,cancelStepIndices:eV,resolveOutstandingSteps:ee,revertToStep:eY,sendUserInteraction:eZ,toggleConversationalPlannerMode:eO,onModifierChange:e4,deleteConversation:e6,deleteAsyncConversation:e8,getAllCascadeTrajectories:eK,setInterruptConfirmation:ej,getUserImplicitTrajectories:ez,refreshBackgroundResearch:e5,startCascadeFromBaseTrajectory:eQ,setHasDismissedEditHistory:eb,fetchCodeValidationStates:en,hideIdSwitchModal:eo,setSelectedImages:I,addSelectedImages:e9,clearSelectedImages:te,setErrorMessage:k,clearErrorMessage:e7,handleImage:tt,handleImages:ts,validateWindsurfJSAppProjectName:ta,saveWindsurfJSAppProjectName:tn},state:{cascadeConversationState:R,cascadeState:G,cascadePanelState:Q,connectionState:J,hasChanged:null!=$?$:"",remainingPromptAndFlexCredits:eD,remainingToolAndFlexCredits:eA,remainingPromptCredits:eP,remainingToolCredits:eM,conversationalPlannerMode:eL,activeConfig:eU,isPremiumUser:g,canBuyMoreCredits:y,canUseWriteMode:C,userLoaded:b,userSettings:V,currentModelConfig:ec,hasSetInitialModel:eu,isRunning:H,isModifierPressed:ep,interruptConfirmation:eN,hasDismissedEditHistory:ew,trajectories:ef,visibleModelConfigs:P,implicitTrajectoryResponse:eE,refreshingTrajectories:ev,validationStates:es,showIdSwitchModal:D,hasDevExtension:h,selectedImages:E,errorMessage:T,webSearchEnabled:tr,recipesEnabled:to,isLoadingModels:L}}),[e3,e0,e1,ti,eT,eR,Z,er,eG,eJ,eW,eH,eV,ee,eY,eZ,eO,e4,e6,e8,eK,ez,e5,eQ,en,eo,e9,te,e7,tt,ts,R,G,Q,J,$,eD,eA,eP,eM,eL,eU,g,y,C,b,V,ec,eu,H,ep,eN,ew,ef,P,eE,ev,es,D,h,E,T,tr,to,L,e2,ta,tn]);return(0,z.jsx)(aJ.Provider,{value:tl,children:s})},useCascadeContext=()=>(0,X.useContext)(aJ);var aW=s(54315);let animateGradualRevealText=(e,t,s)=>e.substring(0,Math.max(1,Math.ceil(s*e.length/t)))+(s>t?".".repeat(Math.floor((s-t)/500)%4):""),getLoadingCopy=(e,t)=>{if(t){let s=t.status;if(s===eS.V_N.WAITING&&("runCommand"===t.step.case||"deployWebApp"===t.step.case))return animateGradualRevealText("Waiting on response",1e3,e);if(s===eS.V_N.RUNNING&&"runCommand"===t.step.case)return animateGradualRevealText("Running",1e3,e)}return e<7e3?animateGradualRevealText("Generating",1e3,e):e<25e3?"Generating"+animateGradualRevealText(". Just a few more seconds",1e3,e-7e3):"Generating"+animateGradualRevealText(". This request is taking longer than expected",2e3,e-25e3)},CascadeLoading=e=>{let{isLoading:t,lastStep:s,lastUpdate:a}=e,n=Date.now();return(0,z.jsx)("div",{className:(0,eG.classNames)("relative flex flex-col items-stretch gap-2 rounded opacity-0 transition-[opacity] delay-[500ms] duration-[1000ms]",t?"opacity-100":"!hidden"),children:(0,z.jsx)("div",{className:"flex-grow text-left opacity-50",children:getLoadingCopy(n-a-500,s)})})};var aH=s(18396);let aV=(0,X.memo)(e=>{var t,s;let{step:a}=e,n=JSON.parse(JSON.stringify(a)),r=null===(s=a.metadata)||void 0===s?void 0:null===(t=s.toolCall)||void 0===t?void 0:t.argumentsJson;r&&(n.metadata.toolCall.argumentsJson=JSON.parse(r));let o=(0,z.jsxs)("div",{className:"flex w-full flex-row items-center justify-start",children:[(0,z.jsx)(aH.Z,{className:"mr-2 h-4 w-4"}),(0,z.jsx)("pre",{className:"m-1",children:"".concat(eS.prY[a.type]," (").concat(eS.V_N[a.status],")")})]});return(0,z.jsx)("div",{className:"mt-2 rounded bg-ide-active-selection-background px-2",children:(0,z.jsx)(aM.Accordion,{title:o,defaultIsOpen:!1,children:(0,z.jsx)("pre",{className:"whitespace-pre-wrap pb-2 text-sm",children:JSON.stringify(n,null,"	")})})})});aV.displayName="CascadeStepDebugView";let aY=(0,X.memo)(e=>{let{step:t,stepIndex:s,revertToStepFn:a,sendMessage:n,debugMode:r}=e,{hasDevExtension:o}=useChatParamsContext(),i=getContentForStep(t,()=>{a&&a(s)},r,n);return(0,z.jsxs)("div",{className:"w-full",children:[i,t.subtrajectory&&(0,z.jsx)("div",{className:"my-2",children:(0,z.jsx)(CortexTrajectory,{trajectory:t.subtrajectory,debugMode:r,isSubtrajectory:!0})}),r&&o&&(0,z.jsx)(aV,{step:t})]})});aY.displayName="CascadeStep";let aZ={state:{lastDateWarnedRunningOutOfCredits:null,lastDateWarningOutOfCredit:null,activeNux:void 0,nuxIndex:0,nuxCount:0,seenNux:[],userSectionRefs:new Map},events:{dismissWarningRunningOutOfCredits:()=>{},dismissWarningOutOfCredit:()=>{},showNux:()=>{},dismissNux:()=>{},insertText:()=>{},setUserSectionRef:()=>{},clearUserSectionRefs:()=>{}}},aK=(0,X.createContext)(aZ),CascadeUIStateContextProvider=e=>{let{children:t}=e,{layout:{lexicalRef:s}}=useCascadeContext(),{updateUserSettings:a}=useServerConnectionContext(),{state:{remainingPromptAndFlexCredits:n,remainingToolAndFlexCredits:r,userSettings:o}}=useCascadeContext(),[i,l]=(0,X.useState)(null),[c,d]=(0,X.useState)(null),[u,m]=(0,X.useState)(0),[p,x]=(0,X.useState)([]),[h,g]=(0,X.useState)([]),[f,y]=(0,X.useState)(new Map);(0,X.useEffect)(()=>{i&&eP()().diff(i,"minutes")>15&&l(null),c&&eP()().diff(c,"minutes")>15&&d(null)},[n,r,i,c]);let v=(0,X.useCallback)(()=>{l(new Date)},[l]),C=(0,X.useCallback)(()=>{d(new Date)},[d]),w=(0,X.useCallback)(e=>{p.includes(e)||h.includes(e)||x(t=>{let s=Array.from(new Set([...t,e]));return s})},[p,h]),b=(0,X.useCallback)(()=>{let e=p.at(u);if(e){g(t=>{let s=Array.from(new Set([...t,e]));return s});let t=o.cascadeNuxStates.find(t=>t.event===e);if(!t){let t=[...o.cascadeNuxStates,new et.hUr({event:e})],s=new et.PGO({...o,cascadeNuxStates:t});a(s)}m(u+1)}u+1>=p.length&&(x([]),m(0))},[p,u,o,a]),N=(0,X.useCallback)(e=>{let t=s.current;t&&insert_insertText(t,e)},[s]),S=(0,X.useCallback)((e,t)=>{y(s=>{let a=new Map(s);return a.set(e,t),a})},[]),j=(0,X.useCallback)(()=>{y(new Map)},[]),E=(0,X.useMemo)(()=>({state:{lastDateWarnedRunningOutOfCredits:i,lastDateWarningOutOfCredit:c,activeNux:p.at(u),nuxIndex:u,nuxCount:p.length,seenNux:h,userSectionRefs:f},events:{dismissWarningRunningOutOfCredits:v,dismissWarningOutOfCredit:C,showNux:w,dismissNux:b,insertText:N,setUserSectionRef:S,clearUserSectionRefs:j}}),[i,c,u,p,h,v,C,w,b,N,S,j,f]);return(0,z.jsx)(aK.Provider,{value:E,children:t})},useCascadeUIStateContext=()=>(0,X.useContext)(aK);var az=s(12080);let aX=(0,X.createContext)({homeDir:"",workspaceUris:[]}),WorkspaceInfoProvider=e=>{let{children:t}=e,{lsClient:s}=useServerConnectionContext(),[a,n]=(0,X.useState)(""),[r,o]=(0,X.useState)([]);(0,X.useEffect)(()=>{s&&s.getWorkspaceInfos(new ei.myl({})).then(e=>{n(e.homeDirPath),o(e.workspaceInfos.map(e=>e.workspaceUri))}).catch(e=>{console.error("Failed to get workspace infos:",e)})},[s]);let i=(0,X.useMemo)(()=>({homeDir:a,workspaceUris:r}),[a,r]);return(0,z.jsx)(aX.Provider,{value:i,children:t})},useWorkspaceInfoContext=()=>(0,X.useContext)(aX),CascadeUserSection=e=>{let{userStep:t,codeActionSteps:s,runCommandSteps:a,startingStepIndex:n,createdAt:r}=e,{hasDevExtension:o}=useChatParamsContext(),{events:{setUserSectionRef:i}}=useCascadeUIStateContext(),l=(0,X.useRef)(null),[c,d]=(0,X.useState)(!1);(0,X.useEffect)(()=>{l.current&&i(n+s.length+a.length,l)},[n,i,s,a]);let{events:{revertToStep:u,cancelInvocation:m,setSelectedImages:p},debug:{debugMode:x},state:{isRunning:h},editor:{parsingConfig:g}}=useCascadeContext(),{openFilePointer:f}=useServerConnectionContext(),{layout:{lexicalRef:y}}=useCascadeContext(),{homeDir:v,workspaceUris:C}=useWorkspaceInfoContext(),w=t.step.value,b=(0,X.useMemo)(()=>{try{var e,s;let a=JSON.parse(JSON.stringify(t)),n=null===(s=t.metadata)||void 0===s?void 0:null===(e=s.toolCall)||void 0===e?void 0:e.argumentsJson;n&&a.metadata&&a.metadata.toolCall&&(a.metadata.toolCall.argumentsJson=n);let r=(0,z.jsxs)("div",{className:"flex w-full flex-row items-center justify-start",children:[(0,z.jsx)(aH.Z,{className:"mr-2 h-4 w-4"}),(0,z.jsx)("pre",{className:"m-1",children:"".concat(eS.prY[t.type]," (").concat(eS.V_N[t.status],")")})]});return(0,z.jsx)(aM.Accordion,{title:r,defaultIsOpen:!1,children:(0,z.jsx)("pre",{className:"whitespace-pre-wrap pb-2 text-sm",children:JSON.stringify(a,null,"	")})})}catch(e){return(0,z.jsx)(z.Fragment,{})}},[t]),N=(0,X.useMemo)(()=>{let e=s.reduce((e,t)=>{var s,a;let n=t.step.value,r=getPathFromCodeAction(n),o=null===(a=n.actionResult)||void 0===a?void 0:null===(s=a.result.value)||void 0===s?void 0:s.diff,{numInsertions:i,numDeletions:l}=(null==o?void 0:o.unifiedDiff)?countDiffLines(o.unifiedDiff):{numInsertions:0,numDeletions:0};if(!r)return e;let c=e[r];return c&&"number"==typeof c.numDeletions&&"number"==typeof c.numInsertions?e[r]={path:r,numInsertions:c.numInsertions+i,numDeletions:c.numDeletions+l}:e[r]={path:r,numInsertions:i,numDeletions:l},Object.fromEntries(Object.entries(e).filter(e=>{let[,t]=e;return t.numInsertions>0||t.numDeletions>0}))},{});return Object.values(e).map((e,t)=>{var s;let a=e.path,r=a.split("/").pop()||"",o=null!==(s=a.slice(0,-r.length-1).replace(/\/$/,"").split("//").pop())&&void 0!==s?s:"",{numInsertions:i,numDeletions:l}=e;return(0,z.jsxs)("div",{onClick:()=>{f(new OpenFilePointer({fileUri:a}))},className:"group flex cursor-pointer items-center justify-between gap-2 gap-x-1 overflow-hidden text-xs transition-[background-color]",children:[(0,z.jsxs)("span",{"data-tooltip-id":"changed-code-".concat(a,"-").concat(t,"-").concat(n),className:"flex min-w-0 flex-shrink flex-row gap-2 transition-[opacity]",children:[(0,z.jsx)("span",{className:"flex-none overflow-hidden text-ellipsis whitespace-nowrap opacity-90 group-hover:opacity-100",children:decodeURIComponent(r)}),(0,z.jsx)("span",{className:"overflow-hidden text-ellipsis whitespace-nowrap opacity-60 group-hover:opacity-90",children:prettyPath(decodeURIComponent(o||""),v,C)})]}),(0,z.jsxs)("div",{"data-tooltip-id":"changed-code-changes-".concat(a,"-").concat(t,"-").concat(n),className:"flex flex-none gap-1 whitespace-nowrap",children:[(0,z.jsxs)("span",{className:"text-xs text-green-500",children:["+",i]}),(0,z.jsxs)("span",{className:"text-xs text-red-500",children:["-",l]})]}),(0,z.jsx)(CompactTooltip,{id:"changed-code-".concat(a,"-").concat(t,"-").concat(n),children:(0,z.jsx)("div",{children:prettyPath(decodeURIComponent(a),v,C)})}),(0,z.jsxs)(CompactTooltip,{id:"changed-code-changes-".concat(a,"-").concat(t,"-").concat(n),children:[(0,z.jsxs)("div",{children:[i," insertion",1===i?"":"s"," (+)"]}),(0,z.jsxs)("div",{children:[l," deletion",1===l?"":"s"," (-)"]})]})]},"".concat(a,"-").concat(t))})},[s,f,n,v,C]),S=(0,X.useMemo)(()=>{let e=navigator.userAgent.toLowerCase().includes("windows"),t=e?" > ":" $ ";return a.map((e,s)=>{let a=e.step.value,r=a.commandLine;""===r&&(r=[a.command,...a.args].join(" "));let o="".concat(t).concat(r);return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)("div",{className:"overflow-hidden text-ellipsis whitespace-nowrap font-mono text-[.6rem] opacity-60","data-tooltip-id":"run-command-".concat(s,"-").concat(n),children:o},s),(0,z.jsx)(CompactTooltip,{place:"top-start",id:"run-command-".concat(s,"-").concat(n),children:o})]})})},[a,n]);return w.items.length||w.images.length?(0,z.jsxs)("div",{ref:l,className:"flex w-full flex-col",children:[N.length>0||S.length>0?(0,z.jsxs)(z.Fragment,{children:[(0,z.jsxs)("div",{className:"flex cursor-pointer items-center gap-1 text-sm opacity-50 transition-[opacity] hover:opacity-100",onClick:()=>{d(!c)},children:[(0,z.jsx)(az.Z,{className:(0,ti.classNames)("h-4 w-4 flex-none transition-[transform]",c?"-rotate-90":"")}),"Recent history"]}),(0,z.jsxs)("div",{className:(0,ti.classNames)("overflow-y-auto rounded bg-gray-500/15 px-2 transition-[max-height,padding,margin]",c?"mb-2 mt-1 max-h-[6rem] py-1":"max-h-0"),children:[N.length>0&&(0,z.jsxs)("div",{children:[(0,z.jsx)("span",{className:"text-xs opacity-50",children:"Your modified files: "}),(0,z.jsx)("div",{className:"flex flex-col",children:N})]}),S.length>0&&(0,z.jsxs)("div",{children:[(0,z.jsx)("span",{className:"text-xs opacity-50",children:"Your recent terminal commands: "}),(0,z.jsx)("div",{className:"flex flex-col",children:S})]})]})]}):null,(0,z.jsx)(CascadeUserMessage,{items:w.items,images:w.images,revert:()=>{if(h&&m(),y.current){let e=y.current;e.update(()=>{if("userInput"===t.step.case){let s=t.step.value.items,a=e.parseEditorState(convertTextOrScopeItemToEditorState(s,g));e.setEditorState(a)}}),e.update(()=>{let e=(0,t_.Gv)(),t=e.getLastChild();if(t instanceof t_.R2){let e=(0,t_.vN)(),s=t.getTextContentSize();e.anchor.set(t.getKey(),s,"text"),e.focus.set(t.getKey(),s,"text"),(0,t_.oq)(e)}else if(t instanceof t_.HX){let e=t.getChildren(),s=e.length,a=(0,t_.vN)();a.anchor.set(t.getKey(),s,"element"),a.focus.set(t.getKey(),s,"element"),(0,t_.oq)(a)}})}w.images.length>0&&p(w.images),u(n+s.length-1)},timestamp:r}),x&&o&&(0,z.jsx)("div",{className:"rounded bg-ide-active-selection-background px-2",children:b})]}):(0,z.jsx)(z.Fragment,{})},CascadeBinaryInteraction=e=>{let{headerText:t,trajectoryId:s,stepIndex:a}=e,{events:{cancelInvocation:n,sendUserInteraction:r}}=useCascadeContext(),handleUserInteraction=e=>{r(new eS.JEm({trajectoryId:s,stepIndex:a,interaction:{case:"binaryConfirmation",value:new eS.dUW({confirm:e})}})),e||n()};return(0,z.jsxs)("div",{className:"flex w-full items-center justify-between",children:[(0,z.jsx)("p",{children:t}),(0,z.jsxs)("div",{className:"flex flex-row gap-x-1",children:[(0,z.jsx)("button",{onClick:()=>{handleUserInteraction(!0)},className:"hover:bg-ide-button-hover-background cursor-pointer rounded bg-ide-button-background px-1 py-[1px] text-ide-button-color transition-[background]",children:"Accept"}),(0,z.jsx)("button",{onClick:()=>{handleUserInteraction(!1)},className:"hover:bg-ide-button-secondary-hover-background bg-ide-button-secondary-background text-ide-button-secondary-color cursor-pointer rounded px-1 py-[1px] transition-[background]",children:"Reject"})]})]})};var a$=s(2946),a0=s(85666),a1=s(37875),a2=s(97205),a5=s(73079),a3=s(7606),a4=s(688),a6=s(66689),a8=s(8186),a9=s(8568),a7=s(75174),ne=s(45447);let getStatusIcon=e=>{switch(e){case eS.prY.SUGGESTED_RESPONSES:case eS.prY.PROPOSE_CODE:case eS.prY.CHECKPOINT:case eS.prY.USER_INPUT:case eS.prY.PLAN_INPUT:case eS.prY.PLANNER_RESPONSE:return null;case eS.prY.ERROR_MESSAGE:return a$.Z;case eS.prY.MQUERY:case eS.prY.GREP_SEARCH:case eS.prY.FIND:return a0.Z;case eS.prY.CODE_ACTION:case eS.prY.VIEW_FILE:case eS.prY.VIEW_CODE_ITEM:case eS.prY.RELATED_FILES:case eS.prY.SEARCH_KNOWLEDGE_BASE:case eS.prY.FINISH:return a1.Z;case eS.prY.LIST_DIRECTORY:return a2.Z;case eS.prY.GIT_COMMIT:return a5.Z;case eS.prY.RUN_COMMAND:case eS.prY.COMMAND_STATUS:return a3.Z;case eS.prY.MEMORY:case eS.prY.RETRIEVE_MEMORY:return a4.Z;case eS.prY.READ_URL_CONTENT:case eS.prY.VIEW_CONTENT_CHUNK:case eS.prY.SEARCH_WEB:return a6.Z;case eS.prY.MCP_TOOL:return a8.Z;case eS.prY.LIST_CLUSTERS:return a9.Z;case eS.prY.PROXY_WEB_SERVER:return a7.Z;case eS.prY.READ_DEPLOYMENT_CONFIG:case eS.prY.DEPLOY_WEB_APP:return ne.Z;case eS.prY.CLUSTER_QUERY:case eS.prY.AUTO_CASCADE_BROADCAST:case eS.prY.LOOKUP_KNOWLEDGE_BASE:case eS.prY.CREATE_RECIPE:case eS.prY.CUSTOM_TOOL:default:return null}},ToolStatus=e=>{var t,s;let{step:a}=e,n=[eS.prY.SUGGESTED_RESPONSES].includes(a.type),r=(0,X.useId)(),o=getStatusIcon(a.type),i=(0,X.useMemo)(()=>{var e,t,s,n;let r=(null===(t=a.metadata)||void 0===t?void 0:null===(e=t.createdAt)||void 0===e?void 0:e.seconds)?1e3*Number(a.metadata.createdAt.seconds):void 0;return r&&r>new Date(2025,1,4).getTime()&&(null===(s=a.metadata)||void 0===s?void 0:s.flowCreditsUsed)!==void 0?a.metadata.flowCreditsUsed/100:(null===(n=a.metadata)||void 0===n?void 0:n.requestedModel)?getCreditMultiplier(a.metadata.requestedModel):void 0},[a]),{creditCost:l,status:c}=(0,X.useMemo)(()=>{if(isLoadingStatus(a.status))return{status:"Loading",creditCost:0};switch(a.status){case eS.V_N.INVALID:return{status:"Invalid",creditCost:0};case eS.V_N.CLEARED:return{status:"Cleared",creditCost:0};case eS.V_N.CANCELED:return{status:"Canceled",creditCost:0};case eS.V_N.ERROR:var e,t;if(a.type===eS.prY.MCP_TOOL&&!(null===(e=a.error)||void 0===e?void 0:e.isBenign))return{status:"Error",creditCost:i};return{status:(null===(t=a.error)||void 0===t?void 0:t.isBenign)?"Error (benign)":"Error",creditCost:0};case eS.V_N.DONE:return{status:"Done",creditCost:i};default:return{status:"Unknown",creditCost:0}}},[null===(t=a.error)||void 0===t?void 0:t.isBenign,a.status,i,a.type]);if(n)return null;let d=s7.BadgeStatus.Gray;return isLoadingStatus(a.status)?d=s7.BadgeStatus.Yellow:a.status===eS.V_N.ERROR?(d=s7.BadgeStatus.Red,(null===(s=a.error)||void 0===s?void 0:s.isBenign)&&(d=s7.BadgeStatus.Gray)):a.status===eS.V_N.DONE&&(d=s7.BadgeStatus.Green),(0,z.jsxs)("div",{"data-tooltip-id":r,className:"relative flex h-5 w-5 flex-none items-center justify-center rounded shadow-gray-500 transition-[shadow] group-hover:shadow",children:[(0,z.jsx)("div",{className:"absolute inset-0 rounded bg-ide-button-background opacity-0 transition-[opacity] group-hover:opacity-20"}),o?(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(o,{className:"h-3.5 w-3.5 flex-none"}),(0,z.jsx)(s9.Badge,{status:d,label:"",className:"absolute -bottom-[0.125rem] -left-[0.125rem] rounded-full"})]}):(0,z.jsx)(s9.Badge,{status:d,label:"",className:"rounded-full"}),(0,z.jsx)(CompactTooltip,{id:r,place:"top-start",positionStrategy:"fixed",children:(0,z.jsxs)("div",{className:"flex max-w-[8rem] flex-col gap-1 p-2",children:[(0,z.jsxs)("div",{children:["Status: ",(0,z.jsx)("span",{children:c})]}),void 0===i&&(0,z.jsx)("div",{children:"Credit cost will only show for tool calls created after version 1.3.0"}),void 0!==i?(0,z.jsxs)("div",{children:[l," credit",1!==i?"s":""," used"]}):null]})})]})},ToolCancel=e=>{let{onCancel:t}=e;return(0,z.jsxs)("div",{className:"ml-1 h-full",role:"button",children:[(0,z.jsx)(tL.Z,{"data-tooltip-id":"tool-cancel-step",onClick:()=>{t()},className:"z-[100] h-4 w-4"}),(0,z.jsx)(CompactTooltip,{id:"tool-cancel-step",children:"Cancel step"})]})},DiffLineCount=e=>{let{diff:t}=e,s=(0,X.useId)(),a=(0,X.useMemo)(()=>t.unifiedDiff?countDiffLines(t.unifiedDiff):{numInsertions:0,numDeletions:0,numUnchanged:0},[t.unifiedDiff]),{numInsertions:n,numDeletions:r,numUnchanged:o}=a,i=(0,X.useMemo)(()=>(0,z.jsxs)("div",{children:[(0,z.jsxs)("span",{"data-tooltip-id":s,className:"text-md mx-1 flex flex-row gap-1 whitespace-nowrap font-medium",children:[(0,z.jsxs)("span",{className:"text-green-500",children:["+",n]}),(0,z.jsxs)("span",{className:"text-red-500",children:["-",r]}),(0,z.jsxs)("span",{className:"text-gray-500",children:["\xa0",o]})]}),(0,z.jsxs)(CompactTooltip,{id:s,children:[(0,z.jsxs)("div",{children:[n," insertion",1===n?"":"s"," (+)"]}),(0,z.jsxs)("div",{children:[r," deletion",1===r?"":"s"," (-)"]}),(0,z.jsxs)("div",{children:[o," unchanged"]})]})]}),[s,n,r,o]);return i},FileUriPill=e=>{let{uri:t}=e,s=(0,X.useId)(),{openFilePointer:a}=useServerConnectionContext();return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)("div",{"data-tooltip-id":s,className:"overflow-hidden",children:(0,z.jsx)(PillButton,{onClick:()=>{a(new OpenFilePointer({fileUri:t}))},children:(0,z.jsx)("span",{className:"opacity-70",children:getBaseName(t)})})}),(0,z.jsx)(CompactTooltip,{className:"max-w-[90%] overflow-hidden whitespace-normal break-words",id:s,children:decodeURIComponent(t)})]})},CodeActionTitle=e=>{let{uri:t,diff:s,actionName:a}=e;return(0,z.jsxs)("div",{className:"flex min-w-0 flex-row items-center gap-1 overflow-hidden",children:[a,(0,z.jsx)(FileUriPill,{uri:t}),s&&(0,z.jsx)(DiffLineCount,{diff:s})]})};(w=W||(W={}))[w.LOADING=0]="LOADING",w[w.CANCELABLE=1]="CANCELABLE",w[w.READY=2]="READY",w[w.CANCELED=3]="CANCELED";let CodeActionCta=e=>{let{status:t,handlePressedOpenDiff:s,onCancel:a}=e,n=(0,X.useMemo)(()=>isCancelableStatus(t)?1:isLoadingStatus(t)?0:t===eS.V_N.CANCELED?3:2,[t]);switch(n){case 0:return(0,z.jsx)("div",{className:"loader mx-2 h-4 w-4 flex-none"});case 1:return(0,z.jsx)(ToolCancel,{onCancel:a});case 2:return(0,z.jsx)("button",{onClick:s,className:"bg-ide-button-secondary-background hover:bg-ide-button-secondary-background-hovered active:bg-ide-button-secondary-hover-background text-ide-button-secondary-color hover:text-ide-button-secondary-hover-color cursor-pointer whitespace-nowrap rounded px-2 py-[0.15rem] text-xs font-medium transition-[background]",title:"Open diff",children:"Open diff"});case 3:return null}},VerticallyCollapsibleItem=e=>{let{shouldShow:t,children:s}=e;return(0,z.jsx)("div",{className:"grid transition-[grid-template-rows] duration-150 ease-in-out",style:{gridTemplateRows:t?"1fr":"0fr"},children:(0,z.jsx)("div",{className:"min-h-0 overflow-hidden",children:(0,z.jsx)("div",{className:"h-fit",children:s})})})};var nt=s(18706),ns=s(80076);let AutoFixLintsDropdown=e=>{let{autoFixDisabled:t,setDisableAutoFixLints:s}=e;return(0,z.jsx)(s_.R,{value:t,onChange:s,children:e=>{let{open:s}=e;return(0,z.jsxs)("div",{className:"relative",children:[(0,z.jsxs)(s_.R.Button,{className:"group flex cursor-pointer items-center gap-0.5 rounded",children:[(0,z.jsx)("span",{className:"select-none text-sm opacity-70 group-hover:opacity-100",children:t?"Auto-fix off":"Auto-fix on"}),(0,z.jsx)(az.Z,{className:"h-4 w-4 opacity-50"})]}),(0,z.jsx)(sD.u,{show:s,as:X.Fragment,leave:"transition ease-in duration-100",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,z.jsxs)(s_.R.Options,{className:"absolute right-0 z-40 mt-1 origin-top-right overflow-hidden rounded-md border border-gray-500/50 bg-ide-chat-background",children:[(0,z.jsxs)("div",{className:"flex items-center gap-0.5 px-1 py-0.5",children:[(0,z.jsx)("span",{className:"whitespace-nowrap text-sm font-semibold opacity-70",children:"Configure"}),(0,z.jsx)(AutoFixLintTooltip,{})]}),(0,z.jsx)(s_.R.Option,{value:!1,className:e=>{let{selected:t,active:s}=e;return(0,eG.classNames)("cursor-pointer whitespace-nowrap px-2 py-1 text-sm",t?"bg-gray-500/20":s?"bg-gray-500/10":"")},children:"On"}),(0,z.jsx)(s_.R.Option,{value:!0,className:e=>{let{selected:t,active:s}=e;return(0,eG.classNames)("cursor-pointer whitespace-nowrap px-2 py-1 text-sm",t?"bg-gray-500/20":s?"bg-gray-500/10":"")},children:"Off"})]})})]})}})},AutoFixLintTooltip=()=>(0,z.jsxs)("div",{children:[(0,z.jsx)(ns.Z,{className:"ml-0.5 h-3.5 w-3.5 opacity-30 hover:opacity-100","data-tooltip-id":"auto-fix-lint-info-tooltip"}),(0,z.jsx)(CompactTooltip,{id:"auto-fix-lint-info-tooltip",place:"top",children:(0,z.jsxs)("div",{className:"max-w-[80vw] space-y-2 p-1 sm:max-w-[400px]",children:["When auto-fix is on, Cascade detects lint errors created by its edits and may fix them without explicit user input."," ",(0,z.jsx)("span",{className:"font-bold",children:"This may increase its tool call usage. "}),"You can toggle this setting here or in Windsurf's settings."]})})]}),CodeActionSupplementaryView=e=>{let{step:t}=e,[s,a]=(0,X.useState)(!1),{updateUserSettings:n}=useServerConnectionContext(),{state:{userSettings:r}}=useCascadeContext(),o=(0,X.useMemo)(()=>t.lintErrors.map((e,t)=>{var s,a;let n=getBaseName(e.uri),r=null===(a=e.range)||void 0===a?void 0:null===(s=a.startPosition)||void 0===s?void 0:s.row;return(0,z.jsxs)("div",{className:"text-sm",children:[(0,z.jsx)("span",{className:"opacity-80",children:n}),void 0!==r&&(0,z.jsxs)("span",{className:"opacity-80",children:[" (ln ",Number(r)+1,")"]}),(0,z.jsx)("span",{className:"opacity-80",children:": "}),(0,z.jsx)("span",{className:"opacity-50",children:e.message})]},"lint-".concat(t))}),[t.lintErrors]),i=t.lintErrors.length,l=r.disableCascadeAutoFixLints,c=(0,X.useCallback)(e=>{let t=r.clone();t.disableCascadeAutoFixLints=e,n(t)},[r,n]);return(0,z.jsxs)("div",{className:"flex flex-col py-1",children:[(0,z.jsxs)("div",{className:"flex items-center justify-between px-2",children:[(0,z.jsxs)("div",{className:"flex cursor-pointer items-center text-sm",onClick:()=>{a(!s)},children:[(0,z.jsx)(az.Z,{className:(0,eG.classNames)("ml-[-0.2rem] mr-1 h-4 w-4 opacity-50 transition-transform duration-100",s?"rotate-180":"")}),(0,z.jsx)(nt.Z,{className:"mr-1 inline h-3.5 w-3.5 text-[color:var(--codeium-notificationsWarningIcon-foreground)]"}),(0,z.jsxs)("span",{className:"select-none opacity-80",children:[i," new lint error",1!==i?"s":""]})]}),(0,z.jsx)(AutoFixLintsDropdown,{autoFixDisabled:l,setDisableAutoFixLints:c})]}),(0,z.jsx)("div",{className:(0,eG.classNames)("max-h-[12rem] overflow-y-auto px-2 transition-[margin-top] duration-150",s?"mt-1":""),children:(0,z.jsx)(VerticallyCollapsibleItem,{shouldShow:s,children:o})})]})},useCodeActionToolStepContribution=(e,t)=>{var s,a,n;let r;let{lsClient:o,openFilePointer:i,props:{handleOpenReadOnlyDiff:l},unleash:c}=useServerConnectionContext(),{state:{cascadeConversationState:d}}=useCascadeContext(),u=null==d?void 0:d.cascadeId;if("codeAction"!==e.step.case||isCodeActionHeuristicFailure(e))return null;let{step:{value:m}}=e,p=null===(a=m.actionResult)||void 0===a?void 0:null===(s=a.result.value)||void 0===s?void 0:s.diff,x=getPathFromCodeAction(m),h=null===(n=m.actionSpec)||void 0===n?void 0:n.spec.case;if(void 0===x||void 0===h)return null;let g=isLoadingStatus(e.status),f=e.status===eS.V_N.CANCELED;switch(h){case"command":r=g?"Editing":f?"Canceled edit to":"Edited";break;case"createFile":r=g?"Creating":f?"Canceled creation of":"Created";break;case"deleteFile":r=g?"Deleting":f?"Canceled deletion of":"Deleted"}let handlePressedOpenDiff=()=>{(async()=>{let e;try{let t=await (null==o?void 0:o.getCodeValidationStates(new ei.hOF({cascadeId:u})));e=null==t?void 0:t.states.find(e=>e.uri===x)}catch(e){console.error(e)}!e&&p&&l&&p.unifiedDiff?l(x,getAppliedDiff(p.unifiedDiff,!1),getAppliedDiff(p.unifiedDiff,!0)):i(new OpenFilePointerRequest({fileUri:x,isCascadeDiff:!0}))})()},y=c.isEnabled(et.rpR.CASCADE_AUTO_FIX_LINTS);return{cta:()=>(0,z.jsx)(CodeActionCta,{status:e.status,handlePressedOpenDiff:handlePressedOpenDiff,onCancel:t.onCancelStep}),icon:()=>(0,z.jsx)(ToolStatus,{step:e}),title:()=>(0,z.jsx)(CodeActionTitle,{uri:x,diff:p,actionName:r}),supplementaryView:y&&m.lintErrors.length>0?()=>(0,z.jsx)(CodeActionSupplementaryView,{step:m}):null}},useHandleOpenDiffZones=e=>{let{lsClient:t,extensionClient:s}=useServerConnectionContext();(0,X.useEffect)(()=>{if(!t||!s)return;let openDiffZones=async()=>{try{let a=await t.getCodeValidationStates(new ei.hOF({cascadeId:e})),n=a.states;await s.openDiffZones(new OpenDiffZonesRequest({cascadeId:e,validationStates:n,writeNewState:!1}))}catch(e){console.error(e)}};openDiffZones()},[t,e,s])},CortexSubtrajectoryWorkflow=e=>{let{trajectory:t,debugMode:s=!1}=e;return useHandleOpenDiffZones(t.cascadeId),(0,z.jsxs)(z.Fragment,{children:[s&&(0,z.jsxs)("div",{className:"ml-2 mt-2 text-sm opacity-50",children:["ID:"," ",(0,z.jsx)("a",{className:"text-blue-500 underline hover:text-blue-700",href:"https://exafunction.retool.com/app/trajectory?_releaseVersion=latest#detailOnly=true&trajectoryId=".concat(t.trajectoryId,"&genMetadataIter=").concat(t.generatorMetadata.length||1),target:"_blank",rel:"noopener noreferrer",children:t.trajectoryId})]}),(0,z.jsx)("div",{className:"flex flex-col gap-y-4 px-4",children:(0,z.jsx)(CollapsedCascadeSteps,{trajectoryId:t.trajectoryId,startingStepIndex:0,steps:t.steps,debugMode:s})})]})},useWorkflowStepContribution=e=>{if("customTool"!==e.step.case)return null;let{value:t}=e.step;return{icon:()=>(0,z.jsx)(tl.Z,{className:"h-4 w-4"}),title:()=>(0,z.jsxs)("div",{children:["Workflow Step: ",t.recipeName]}),cta:null,supplementaryView:e.subtrajectory?(t,s,a)=>e.subtrajectory?(0,z.jsx)(CortexSubtrajectoryWorkflow,{trajectory:e.subtrajectory,debugMode:a}):null:null}},displayStringPart=(e,t)=>(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)("span",{className:"text-sm opacity-50",children:e}),t&&(0,z.jsx)("span",{className:"direction-[rtl] overflow-hidden text-ellipsis break-all px-0.5 text-left text-sm opacity-70",children:t})]}),CommandDisplay=e=>{let{command:t}=e,s=getCommandDisplay(t);return(0,z.jsx)("div",{children:(0,z.jsx)("span",{className:"cursor-pointer break-words opacity-50 hover:opacity-70",onClick:()=>{t&&navigator.clipboard.writeText(getEscapedCommand(t))},title:"Click to copy full command",children:s})})},useGrepSearchStepContribution=e=>{let{homeDir:t,workspaceUris:s}=useWorkspaceInfoContext(),a=(0,X.useId)();if("grepSearch"!==e.step.case)return null;let n=e.step.value.searchDirectory,r=e.step.value,o=e.step.value.commandRun,i=prettyPath(n,t,s),l=[displayStringPart("Searched in",i)];return r.query&&l.push(displayStringPart("with query",r.query)),r.includes.length>0&&l.push(displayStringPart("including patterns",r.includes.join(", "))),{icon:()=>(0,z.jsx)(ToolStatus,{step:e}),title:()=>(0,z.jsx)("div",{children:"Searched codebase"}),cta:()=>(0,z.jsxs)("span",{className:"pl-1 text-sm",children:[r.totalResults," result",1===r.totalResults?"":"s"]}),supplementaryView:(e,t,s)=>(0,z.jsxs)("div",{className:"flex flex-col px-2 py-1",children:[(0,z.jsx)("div",{className:"text-xs",children:l}),(0,z.jsx)(CompactTooltip,{id:a,children:i}),s&&(0,z.jsx)(CommandDisplay,{command:o})]})}},useFindStepContribution=e=>{let{homeDir:t,workspaceUris:s}=useWorkspaceInfoContext(),a=(0,X.useId)();if("find"!==e.step.case)return null;let n=e.step.value.searchDirectory,r=e.step.value,o=e.step.value.commandRun,i="";switch(r.type){case eS.mIg.FILE:i="files";break;case eS.mIg.DIRECTORY:i="directories"}let l=[(0,z.jsx)("span",{className:"pr-0.5 text-sm opacity-50",children:"Searched"},"searched-text")];return i&&l.push(displayStringPart("for",i)),l.push(displayStringPart("in",prettyPath(n,t,s))),r.maxDepth>0&&l.push(displayStringPart("with depth",r.maxDepth.toString())),r.pattern&&l.push(displayStringPart("with pattern",r.pattern)),r.extensions.length>0&&l.push(displayStringPart("with extensions",r.extensions.join(", "))),r.excludes.length>0&&l.push(displayStringPart("excluding patterns",r.excludes.join(", "))),{icon:()=>(0,z.jsx)(ToolStatus,{step:e}),title:()=>(0,z.jsx)("div",{children:"Searched filesystem"}),cta:()=>(0,z.jsxs)("span",{className:"text-sm",children:[r.totalResults," result",1===r.totalResults?"":"s"]}),supplementaryView:(e,r,c)=>(0,z.jsxs)("div",{className:"flex flex-col px-2 py-1",children:[(0,z.jsx)("div",{className:"text-xs",children:l}),(0,z.jsxs)(CompactTooltip,{id:a,children:["Searched for ",i," in ",prettyPath(n,t,s)]}),c&&(0,z.jsx)(CommandDisplay,{command:o})]})}},CommandTitle=e=>{let{step:t}=e,s="terminal command",a=t.step.value;return a.blocking||(s="background terminal command"),(0,z.jsx)("span",{children:t.status===eS.V_N.WAITING?"Suggested ".concat(s):isLoadingStatus(t.status)?"Running ".concat(s):t.status===eS.V_N.DONE?"Ran ".concat(s):a.userRejected?"Rejected ".concat(s):t.status===eS.V_N.CANCELED?"Canceled ".concat(s):t.status===eS.V_N.ERROR?"Errored ".concat(s):"Terminal command"})};var na=s(74034),nn=s(75536);let useRunCommandOutput=e=>{let t=(0,X.useMemo)(()=>{let t=[],s={Stdout:e.stdoutOutput,Stderr:e.stderrOutput,Output:e.combinedOutput};for(let[e,a]of Object.entries(s)){if(void 0===a||!a.truncated)continue;let s=e;a.numLinesAbove>0&&(s+=" (".concat(a.numLinesAbove," lines above hidden)")),s=s.replace(/ /g,"_"),t.push("~~~".concat(s,"\n").concat(a.truncated,"\n~~~"))}let a={Stdout:e.stdoutBuffer?{buffer:e.stdoutBuffer,linesAbove:e.stdoutLinesAbove}:void 0,Stderr:e.stderrBuffer?{buffer:e.stderrBuffer,linesAbove:e.stderrLinesAbove}:void 0};for(let[e,s]of Object.entries(a)){if(void 0===s||!s.buffer)continue;let a=e;s.linesAbove>0&&(a+=" (".concat(s.linesAbove," lines above hidden)")),a=a.replace(/ /g,"_"),t.push("~~~".concat(a,"\n").concat(s.buffer,"\n~~~"))}return t},[e]);return t},nr=[eS.$3h.USER_ALLOW,eS.$3h.SYSTEM_ALLOW,eS.$3h.MODEL_ALLOW,eS.$3h.DEFAULT_ALLOW],AutoRunView=e=>{var t,s;let a,{runCommandStep:n}=e,{extensionClient:r,userStatus:o}=useServerConnectionContext(),i=(0,X.useMemo)(()=>{let e=nr.includes(n.autoRunDecision)?"allowed":"denied";switch(n.autoRunDecision){case eS.$3h.USER_DENY:case eS.$3h.USER_ALLOW:case eS.$3h.SYSTEM_DENY:case eS.$3h.SYSTEM_ALLOW:let[t,s]=eS.$3h[n.autoRunDecision].toLowerCase().split("_");return"Auto-run ".concat(e," by ").concat(t," ").concat(s," list");case eS.$3h.MODEL_DENY:case eS.$3h.MODEL_ALLOW:return"Auto-run ".concat(e," by model decision");case eS.$3h.DEFAULT_DENY:case eS.$3h.DEFAULT_ALLOW:return"Auto-run ".concat(e," by default");case eS.$3h.UNSPECIFIED:default:return"Auto-run denied"}},[n.autoRunDecision]);(s=a||(a={})).DENY_LIST="cascadeDeniedCommands",s.ALLOW_LIST="cascadeAllowedCommands",s.EXEC_POLICY="cascadeAutoExecutionPolicy";let settingsLink=e=>(0,z.jsx)("a",{className:"cursor-pointer text-ide-link-color underline hover:text-ide-link-hover-color",onClick:()=>{null==r||r.openSetting({settingId:e})},children:(()=>{switch(e){case"cascadeDeniedCommands":return"user deny list";case"cascadeAllowedCommands":return"user allow list";case"cascadeAutoExecutionPolicy":return"auto execution policy"}})()});return(0,z.jsxs)("div",{className:"flex flex-col items-start opacity-50",children:[(0,z.jsx)("div",{className:"mb-1",children:i}),(null==o?void 0:null===(t=o.teamConfig)||void 0===t?void 0:t.allowAutoRunCommands)&&(()=>{switch(n.autoRunDecision){case eS.$3h.USER_DENY:return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)("div",{children:"Want to run this automatically in the future?"}),(0,z.jsxs)("div",{children:["Remove it from your ",settingsLink("cascadeDeniedCommands")," and add it to your"," ",settingsLink("cascadeAllowedCommands")]})]});case eS.$3h.USER_ALLOW:return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)("div",{children:"Want to prevent this from running automatically in the future?"}),(0,z.jsxs)("div",{children:["Remove it from your ",settingsLink("cascadeAllowedCommands")," and add it to your"," ",settingsLink("cascadeDeniedCommands")]})]});case eS.$3h.SYSTEM_DENY:case eS.$3h.MODEL_DENY:case eS.$3h.DEFAULT_DENY:return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)("div",{children:"Want to run this automatically in the future?"}),(0,z.jsxs)("div",{children:["Add it to your ",settingsLink("cascadeAllowedCommands")," or change your command"," ",settingsLink("cascadeAutoExecutionPolicy")]})]});case eS.$3h.SYSTEM_ALLOW:case eS.$3h.MODEL_ALLOW:case eS.$3h.DEFAULT_ALLOW:return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)("div",{children:"Want to prevent this from running automatically in the future?"}),(0,z.jsxs)("div",{children:["Add it to your ",settingsLink("cascadeDeniedCommands")," or change your command"," ",settingsLink("cascadeAutoExecutionPolicy")]})]});case eS.$3h.UNSPECIFIED:default:return}})()]})};var no=s(56198);let RunCommandSupplementaryView=e=>{let{step:t,trajectoryId:s,stepIndex:a}=e,n=t.step.value,r=t.error,{homeDir:o,workspaceUris:i}=useWorkspaceInfoContext(),{extensionClient:l}=useServerConnectionContext(),c=(0,X.useId)(),d=(0,X.useId)(),u=(0,X.useId)(),m=(0,X.useId)(),p=useRunCommandOutput(n),[x,h]=(0,X.useState)(!1),[g,f]=(0,X.useState)(void 0),y=t.status,v=navigator.userAgent.toLowerCase().includes("windows"),C=n.cwd?prettyPath(n.cwd,o,i):"",w=y===eS.V_N.DONE&&void 0!==n.exitCode?"Exit Code ".concat(n.exitCode):"",b=n.commandLine;""===b&&(b=[n.command].concat(n.args).map(e=>(0,sJ.QK)(e)?(0,sJ.Av)(e):e).join(" "));let handleGoToTerminal=async()=>{try{await (null==l?void 0:l.showTerminal({terminalId:n.terminalId}))}catch(e){e instanceof ej.K?f(e.rawMessage):e instanceof Error?f(e.message):f("An unknown error occurred")}},N=null;return t.status===eS.V_N.WAITING&&(N=(0,z.jsx)(CascadeBinaryInteraction,{headerText:"Run command?",trajectoryId:s,stepIndex:a})),(0,z.jsxs)("div",{className:"pb-1 pt-2",children:[(0,z.jsxs)("div",{className:"flex flex-row justify-between px-2 pb-1",children:[n.cwd&&(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)("div",{"data-tooltip-id":c,className:"min-w-0 overflow-hidden text-ellipsis whitespace-nowrap font-mono text-sm opacity-50",children:C}),(0,z.jsxs)(CompactTooltip,{id:c,place:"top-start",children:["Working directory: ",C]})]}),n.terminalId&&(0,z.jsxs)(z.Fragment,{children:[(0,z.jsxs)("button",{type:"button","data-tooltip-id":u,className:(0,eG.classNames)("flex items-center gap-1 whitespace-nowrap text-sm opacity-50 transition-[opacity]",g?"disabled cursor-default text-red":"cursor-pointer hover:opacity-100"),onClick:()=>{handleGoToTerminal()},children:["Go to terminal",(0,z.jsx)(no.TerminalIcon,{className:"h-4 w-4"})]}),(0,z.jsx)(CompactTooltip,{id:u,place:"top-start",children:g||"Clicking this will open the associated terminal session in Windsurf."})]})]}),(0,z.jsxs)("div",{className:"mx-2 mb-1 mb-2 mt-1 flex grow items-center justify-between rounded border border-gray-500/25 bg-ide-tooltip-background p-1 text-xs",children:[(0,z.jsxs)("pre",{className:"whitespace-pre-wrap break-all font-mono text-sm",children:[(0,z.jsxs)("span",{className:"opacity-50",children:[v?">":"$"," "]}),b]}),(0,z.jsx)("button",{type:"button","data-tooltip-id":d,className:"flex h-5 w-5 cursor-pointer items-center justify-center rounded bg-gray-800 p-1 text-white opacity-50 hover:opacity-100",onClick:()=>{navigator.clipboard.writeText(b)},children:(0,z.jsx)(na.Z,{className:"h-4 w-4"})}),(0,z.jsx)(CompactTooltip,{id:d,place:"top-start",children:"Copy command"})]}),r&&!n.userRejected&&(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)("span",{className:"mb-1",children:"Error Details"}),(0,z.jsx)("div",{className:"mb-1 flex w-full items-center justify-between rounded border border-gray-500/25 bg-ide-tooltip-background p-2",children:(0,z.jsx)("pre",{className:"whitespace-pre-wrap break-all font-mono text-sm",children:r.userErrorMessage||r.shortError})})]}),p.length>0&&(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)("div",{className:"h-[1px] w-full bg-gray-500/10"}),(0,z.jsx)(e5,{className:"mx-2 mt-2 text-[color:var(--codeium-text-color)] prose-a:text-[color:var(--codeium-link-color)]",codeBlockClassName:"max-h-[500px] overflow-y-auto",children:p.join("\n\n")})]}),y!==eS.V_N.WAITING&&(0,z.jsxs)("div",{className:"mb-1 flex flex-col gap-y-1 px-2 font-sans text-xs",children:[(0,z.jsxs)("div",{className:"flex w-full items-center justify-between",children:[w&&(0,z.jsx)("div",{className:"min-w-0 overflow-hidden text-ellipsis whitespace-nowrap opacity-50",children:w}),(0,z.jsxs)("button",{type:"button","data-tooltip-id":m,className:(0,eG.classNames)("ml-auto flex cursor-pointer items-center gap-x-1 opacity-50 hover:opacity-100"),onClick:()=>{h(e=>!e)},children:[(0,z.jsx)("span",{children:ni.includes(n.autoRunDecision)?"Auto-run":"Not auto-run"}),(0,z.jsx)(nn.Z,{className:(0,eG.classNames)("h-3 w-3 transform transition-transform",x?"rotate-180":"")})]})]}),x&&(0,z.jsx)("div",{className:"rounded-sm bg-gray-500/10 px-2 py-1",children:(0,z.jsx)(AutoRunView,{runCommandStep:n})})]}),N&&(0,z.jsx)("div",{className:"px-2 pb-2 pt-1",children:N})]})},ni=[eS.$3h.USER_ALLOW,eS.$3h.SYSTEM_ALLOW,eS.$3h.MODEL_ALLOW,eS.$3h.DEFAULT_ALLOW],useCommandToolStepContribution=e=>{let{events:{cancelStepIndices:t}}=useCascadeContext();return"runCommand"!==e.step.case?null:{icon:()=>(0,z.jsx)(ToolStatus,{step:e}),title:()=>(0,z.jsx)(CommandTitle,{step:e}),cta:s=>void 0!==s&&isCancelableStatus(e.status)?(0,z.jsx)(ToolCancel,{onCancel:()=>{t([s])}}):null,supplementaryView:(t,s)=>(0,z.jsx)(RunCommandSupplementaryView,{step:e,trajectoryId:t,stepIndex:s})}},useCommandStatusToolStepContribution=e=>{if("commandStatus"!==e.step.case)return null;let t=e.status===eS.V_N.RUNNING?e.step.value.waitDurationSeconds>0?"Waiting for command completion (up to ".concat(e.step.value.waitDurationSeconds," seconds)"):"Checking command status":"Checked command status";return{icon:()=>(0,z.jsx)(ToolStatus,{step:e}),title:()=>(0,z.jsx)("div",{className:"flex flex-row items-center gap-1",children:(0,z.jsx)("span",{className:"flex-shrink-0",children:t})}),cta:null,supplementaryView:null}},useMQueryStepContribution=e=>{var t;let{homeDir:s,workspaceUris:a}=useWorkspaceInfoContext(),n="mquery"===e.step.case,r=e.step.value,o=(0,X.useMemo)(()=>{if(!n)return[];let e=r.input;return e?e.targetDirectories.map(e=>prettyPath(e,s,a)):[]},[r,s,a,n]);if(!n)return null;let i=isLoadingStatus(e.status)?"Semantic searching":"Semantic searched",l=[displayStringPart(i,o.join(", ")||"")];return(null===(t=r.input)||void 0===t?void 0:t.goal)&&l.push(displayStringPart("with query",r.input.goal)),{icon:()=>(0,z.jsx)(ToolStatus,{step:e}),title:()=>(0,z.jsxs)("div",{children:[i," codebase"]}),cta:()=>(0,z.jsxs)("div",{className:"text-sm",children:[r.numItemsScored," result",1===r.numItemsScored?"":"s"]}),supplementaryView:()=>(0,z.jsx)("div",{className:"px-2 py-1 text-xs",children:l})}};var nl=s(44192);let WindsurfTeamSignature=e=>(0,z.jsx)("svg",{viewBox:"0, 0, 400,90.25398700531599",...e,children:(0,z.jsx)("path",{d:"M195.865 8.051 C 190.319 9.036,185.049 15.571,182.165 25.037 C 181.632 26.787,181.068 28.300,180.911 28.400 C 180.754 28.500,176.184 28.583,170.754 28.585 C 159.133 28.589,158.771 28.657,158.771 30.833 C 158.771 32.916,158.903 32.942,169.994 33.077 L 179.681 33.196 179.665 33.904 C 179.656 34.294,179.318 36.208,178.913 38.157 C 178.509 40.106,177.845 43.934,177.438 46.663 C 174.788 64.422,169.787 79.041,166.042 79.981 C 165.354 80.154,162.326 78.189,160.248 76.222 C 159.187 75.217,159.114 75.276,159.461 76.859 C 159.581 77.404,159.806 78.488,159.962 79.268 C 161.309 86.009,168.020 86.826,172.189 80.755 C 176.216 74.892,179.924 62.485,182.166 47.372 C 183.072 41.270,184.594 33.851,185.029 33.420 C 185.297 33.154,186.531 33.141,192.321 33.345 C 202.185 33.691,203.945 33.612,204.768 32.788 C 205.918 31.637,205.509 29.930,203.940 29.338 C 203.416 29.140,191.509 28.580,187.832 28.581 C 186.113 28.581,186.088 28.508,186.906 25.858 C 191.074 12.365,199.215 8.661,207.112 16.665 C 208.946 18.524,210.770 19.610,212.058 19.610 C 212.496 19.610,212.536 17.389,212.123 16.011 C 211.451 13.768,206.904 9.697,203.746 8.511 C 202.141 7.908,198.021 7.668,195.865 8.051 M15.475 10.982 C 15.346 11.024,14.654 11.236,13.940 11.453 C 11.540 12.183,9.923 13.737,9.923 15.313 C 9.923 16.632,11.412 17.127,13.500 16.501 C 14.909 16.079,14.859 16.260,11.492 23.745 C 3.201 42.172,2.987 52.206,10.884 52.214 C 13.798 52.217,20.820 48.073,22.259 45.501 C 22.654 44.797,22.863 45.128,23.032 46.722 C 24.248 58.196,37.264 52.872,44.413 37.976 C 49.635 27.096,51.401 16.427,48.448 13.599 C 46.183 11.428,43.263 13.574,44.686 16.364 C 46.396 19.716,42.331 33.428,37.454 40.757 C 34.686 44.918,29.231 48.978,28.171 47.667 C 27.361 46.665,27.739 38.838,28.756 35.585 C 30.377 30.397,26.131 29.207,23.833 34.205 C 20.394 41.685,12.269 49.329,10.082 47.142 C 8.585 45.645,11.502 35.545,17.114 22.800 C 20.034 16.166,20.306 14.952,19.315 12.986 C 18.601 11.571,16.710 10.584,15.475 10.982 M223.883 13.308 C 223.169 14.022,223.089 14.987,223.675 15.836 C 224.302 16.746,224.651 16.943,227.053 17.744 C 229.925 18.701,229.970 18.740,229.792 20.072 C 229.601 21.502,227.477 29.899,226.742 32.132 C 226.159 33.906,221.378 47.349,220.777 48.907 C 220.601 49.362,220.452 50.000,220.444 50.325 C 220.425 51.130,220.258 51.327,218.960 52.081 C 217.737 52.791,217.644 53.014,218.224 53.842 C 219.610 55.821,225.051 55.659,233.249 53.395 C 251.010 48.489,256.337 33.704,244.329 22.645 C 242.395 20.864,234.529 15.613,232.605 14.818 C 227.745 12.811,224.876 12.315,223.883 13.308 M108.092 13.335 C 105.558 14.446,100.707 24.142,98.056 33.394 L 96.962 37.212 95.524 37.240 C 92.237 37.304,90.327 38.197,87.888 40.808 C 81.220 47.948,86.624 55.533,94.410 49.962 C 95.434 49.229,95.598 49.177,95.806 49.518 C 98.656 54.172,107.957 51.650,110.866 45.434 C 111.696 43.661,111.469 43.701,113.309 45.014 C 115.994 46.929,116.190 47.702,114.138 48.273 C 110.697 49.230,111.074 52.413,114.655 52.641 C 120.683 53.025,122.614 47.102,117.934 42.583 C 117.225 41.899,116.687 41.305,116.739 41.263 C 119.386 39.136,122.365 38.130,122.383 39.356 C 122.390 39.901,123.489 40.638,124.292 40.637 C 126.615 40.635,128.321 37.315,127.020 35.329 C 124.309 31.191,111.668 36.081,111.073 41.499 L 110.927 42.822 109.155 43.452 C 108.181 43.799,106.320 44.667,105.021 45.382 C 101.399 47.373,100.393 47.684,100.095 46.907 C 99.740 45.982,100.688 42.039,102.284 37.803 C 103.189 35.399,104.469 31.996,105.127 30.242 C 106.761 25.889,109.020 20.604,110.256 18.241 C 112.013 14.886,110.805 12.147,108.092 13.335 M318.488 15.148 C 316.994 15.264,312.789 15.438,309.144 15.535 C 301.239 15.746,300.341 16.068,301.150 18.403 C 301.657 19.865,308.125 20.363,316.398 19.578 C 318.071 19.419,319.313 19.396,319.439 19.522 C 319.825 19.908,318.461 26.931,316.391 35.204 C 315.985 36.828,315.232 39.858,314.718 41.937 C 314.204 44.017,313.456 46.781,313.056 48.080 C 311.612 52.775,311.629 55.849,313.104 56.612 C 315.031 57.608,316.598 55.896,316.598 52.796 C 316.598 50.818,316.906 49.379,318.138 45.600 C 318.582 44.235,319.166 42.109,319.435 40.874 C 319.704 39.640,320.443 36.556,321.079 34.022 C 322.291 29.188,322.926 26.174,323.644 21.855 L 324.076 19.256 327.782 19.191 C 330.367 19.145,332.147 19.239,333.671 19.502 C 337.600 20.179,337.907 20.186,338.630 19.616 C 339.750 18.732,339.466 16.891,338.099 16.185 C 336.007 15.103,325.940 14.571,318.488 15.148 M237.633 23.197 C 252.134 32.913,247.831 45.638,228.589 49.937 C 225.685 50.586,225.549 50.572,225.905 49.667 C 228.384 43.358,232.361 31.086,233.676 25.686 C 234.236 23.384,234.786 21.500,234.898 21.500 C 235.010 21.500,236.241 22.264,237.633 23.197 M54.976 26.548 C 52.331 27.386,51.436 28.952,52.691 30.548 C 54.493 32.838,59.776 31.089,59.776 28.202 C 59.776 26.135,58.102 25.558,54.976 26.548 M50.867 35.680 C 49.163 36.366,43.946 46.506,43.946 49.131 C 43.946 53.729,51.765 53.264,56.780 48.368 C 58.026 47.151,59.780 43.713,58.866 44.278 C 58.755 44.346,57.825 44.456,56.799 44.522 C 55.138 44.629,54.635 44.787,52.242 45.955 C 50.762 46.677,49.504 47.220,49.446 47.162 C 49.310 47.026,52.029 41.901,53.207 40.070 C 55.019 37.254,53.594 34.582,50.867 35.680 M65.150 36.250 C 61.536 37.540,60.180 41.859,63.212 42.427 C 63.661 42.512,64.028 42.712,64.028 42.872 C 64.028 43.361,63.182 45.657,62.519 46.965 C 60.431 51.086,63.811 53.972,66.559 50.415 C 68.138 48.371,70.733 45.363,70.916 45.363 C 71.175 45.363,71.180 45.329,70.735 46.634 C 69.183 51.190,72.053 53.598,76.971 51.865 C 79.482 50.980,81.895 49.683,82.523 48.878 C 82.812 48.509,83.295 47.886,83.597 47.494 L 84.147 46.781 83.597 46.783 C 83.295 46.784,82.347 46.605,81.489 46.386 C 80.014 46.007,79.844 46.009,78.300 46.408 C 75.351 47.171,75.594 47.197,75.880 46.156 C 76.018 45.655,76.452 44.448,76.844 43.473 C 78.973 38.176,76.356 35.736,71.637 38.619 C 69.747 39.774,69.474 39.757,69.466 38.484 C 69.456 36.700,67.183 35.524,65.150 36.250 M170.645 36.411 C 168.910 36.732,166.010 38.421,164.317 40.097 C 162.559 41.838,162.384 41.850,162.779 40.201 C 163.599 36.786,159.541 36.125,158.208 39.457 C 157.999 39.979,157.732 41.269,157.614 42.325 C 157.372 44.493,157.380 44.483,155.232 45.008 C 154.385 45.215,151.565 46.075,148.966 46.918 C 144.416 48.394,143.333 48.641,143.095 48.256 C 142.818 47.807,143.326 46.692,144.433 45.321 C 147.238 41.850,147.890 39.803,146.624 38.437 C 144.802 36.471,142.087 37.880,140.107 41.819 C 139.033 43.955,138.276 44.674,135.694 46.018 C 132.840 47.503,132.768 47.331,134.122 42.249 C 135.002 38.942,134.645 37.724,132.699 37.408 C 130.473 37.047,128.317 42.537,128.565 47.937 C 128.744 51.836,132.121 53.215,136.274 51.086 C 137.777 50.315,138.452 50.147,138.452 50.543 C 138.452 50.663,138.741 51.104,139.094 51.524 C 142.328 55.368,151.394 52.443,156.726 45.836 L 157.393 45.009 157.245 46.678 C 157.164 47.596,156.943 48.863,156.753 49.492 C 155.413 53.945,159.405 55.746,161.375 51.577 C 163.356 47.385,167.511 42.988,171.166 41.218 C 175.028 39.347,175.393 38.999,174.817 37.735 C 174.310 36.620,172.544 36.060,170.645 36.411 M257.478 38.025 C 249.655 41.083,245.621 53.606,251.914 55.301 C 257.015 56.674,263.265 53.601,265.918 48.416 L 267.252 45.806 266.349 46.399 C 265.852 46.726,264.542 47.323,263.438 47.727 C 262.333 48.131,260.685 48.867,259.776 49.363 C 257.464 50.622,255.429 51.318,254.323 51.228 L 253.396 51.152 253.396 49.852 L 253.396 48.553 255.759 48.297 C 262.403 47.576,267.038 43.799,265.818 40.100 C 265.060 37.802,260.774 36.736,257.478 38.025 M274.132 38.631 C 271.001 39.316,268.956 40.896,269.540 42.178 C 269.966 43.113,270.793 43.299,272.736 42.897 C 274.944 42.440,274.916 42.390,274.543 46.123 C 273.854 53.008,274.144 54.823,276.084 55.762 C 278.722 57.039,281.185 55.063,286.102 47.726 C 287.364 45.842,288.736 43.805,289.150 43.201 C 290.760 40.848,290.157 38.748,287.872 38.748 C 286.893 38.748,286.234 39.374,284.691 41.772 C 281.489 46.749,279.753 49.294,279.260 49.740 L 278.743 50.207 278.946 47.608 C 279.575 39.565,278.555 37.662,274.132 38.631 M368.351 40.326 C 366.950 40.837,364.324 43.373,364.324 44.215 C 364.324 45.327,365.781 46.051,366.435 45.263 C 366.861 44.750,368.104 44.366,368.104 44.748 C 368.104 45.437,367.077 47.958,365.858 50.262 C 363.952 53.862,364.214 55.761,366.617 55.758 C 368.055 55.756,368.729 54.984,372.489 49.028 C 374.522 45.809,374.704 46.181,373.405 50.893 C 372.458 54.327,372.460 54.938,373.419 55.897 C 375.046 57.525,376.277 56.634,380.715 50.620 C 382.868 47.702,382.974 47.708,382.398 50.718 C 381.770 53.998,381.887 55.186,382.941 56.240 C 385.427 58.725,388.986 57.462,391.906 53.058 C 393.799 50.202,393.829 50.088,392.514 50.759 C 392.010 51.017,390.992 51.339,390.252 51.476 C 389.513 51.612,388.367 51.957,387.707 52.240 C 387.009 52.541,386.424 52.668,386.307 52.545 C 386.104 52.330,386.512 48.957,386.976 47.017 C 388.348 41.283,384.934 40.118,380.225 44.714 L 378.232 46.659 378.425 45.361 C 379.152 40.470,376.903 38.748,373.247 41.397 C 372.895 41.652,372.745 41.582,372.181 40.907 C 371.377 39.943,369.980 39.731,368.351 40.326 M331.476 40.506 C 320.227 44.652,318.370 56.857,329.002 56.772 C 333.315 56.738,336.130 55.214,337.457 52.197 L 338.036 50.879 336.118 50.981 C 334.887 51.046,333.565 51.303,332.428 51.700 C 330.654 52.318,327.515 52.579,327.081 52.145 C 326.499 51.563,327.455 51.156,330.087 50.865 C 336.431 50.163,339.254 48.111,339.341 44.137 C 339.416 40.765,335.579 38.994,331.476 40.506 M349.793 40.647 C 344.723 42.609,340.724 50.015,342.649 53.877 C 343.997 56.582,348.308 56.756,351.800 54.247 C 353.194 53.246,353.509 53.203,353.915 53.962 C 355.681 57.263,360.299 56.180,361.863 52.098 C 362.112 51.449,362.343 50.863,362.376 50.795 C 362.409 50.728,361.452 50.674,360.249 50.676 L 358.063 50.679 357.992 49.319 C 357.930 48.139,358.053 47.670,358.919 45.775 C 360.589 42.122,360.066 40.416,357.374 40.736 C 356.592 40.829,355.768 40.754,355.013 40.522 C 353.434 40.037,351.235 40.089,349.793 40.647 M260.503 42.272 C 260.072 42.747,256.150 44.533,255.958 44.341 C 255.520 43.904,259.038 41.819,260.213 41.819 C 260.887 41.819,260.897 41.836,260.503 42.272 M94.579 42.781 C 92.947 45.558,89.048 48.278,89.802 46.114 C 90.369 44.488,93.127 42.092,94.461 42.066 C 95.005 42.056,95.005 42.057,94.579 42.781 M334.318 44.989 C 334.318 45.561,330.948 46.545,330.649 46.061 C 330.462 45.759,332.826 44.660,333.668 44.657 C 334.072 44.655,334.318 44.781,334.318 44.989 M353.822 45.146 C 354.457 46.174,348.611 51.482,347.770 50.641 C 347.410 50.280,348.280 48.153,349.296 46.914 C 350.579 45.348,353.292 44.289,353.822 45.146 ",stroke:"none",fill:"inherit",fillRule:"evenodd"})}),NoCreditMessagingInfoTooltip=e=>{let{isStepError:t}=e,s=(0,X.useId)();return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(nl.Z,{"data-tooltip-id":s,className:"mt-0.5 h-4 w-4 flex-none opacity-50 hover:opacity-100"}),(0,z.jsx)(CompactTooltip,{id:s,clickable:!0,children:(0,z.jsxs)("div",{className:"max-w-[80vw] space-y-2 p-2 sm:max-w-[400px]",children:[(0,z.jsxs)("p",{children:[t?(0,z.jsx)("b",{className:"font-bold",children:"Tool errors do not consume Flow Action credits."}):"Error messages like this do not consume Flow Action credits."," ","AI LLMs aren't perfect. There are a number of reasons why an error can occur:"]}),(0,z.jsxs)("ul",{className:"list-outside list-disc pl-4",children:[(0,z.jsx)("li",{children:"LLMs can generate incorrect responses that we cannot handle."}),(0,z.jsx)("li",{children:"Sometimes errors are part of a model's research and planning process. Just like a human, it takes a mistake or two to learn your computer environment, what files exist, what tools are available, and so on."}),(0,z.jsxs)("li",{children:["Model inference can fail due to rate limits and availability issues outside of our control. Check our"," ",(0,z.jsx)("a",{href:"https://status.codeium.com",className:"cursor-pointer underline",children:"status page"})," ","for more information."]})]}),(0,z.jsx)("p",{children:"We want Windsurf to be as fast, reliable, and helpful to you as possible. We are working night and day to improve your experience."}),(0,z.jsx)("p",{children:"Sincerely,"}),(0,z.jsx)(WindsurfTeamSignature,{className:"h-8 fill-ide-text-color"})]})})]})},ErrorTitle=e=>{let{step:t}=e,s="Cascade error";if("codeAction"===t.step.case){let e=getPathFromCodeAction(t.step.value);s=e?(0,z.jsxs)("div",{className:"flex flex-row items-center gap-1",children:["Error while editing",(0,z.jsx)(FileUriPill,{uri:e})]}):"Error editing file"}else if("viewFile"===t.step.case){let e=t.step.value.absolutePathUri;s=e?(0,z.jsxs)("div",{className:"flex flex-row items-center gap-1",children:["Error while viewing",(0,z.jsx)(FileUriPill,{uri:e})]}):"Error viewing file"}else"grepSearch"===t.step.case?s="Error while searching":"find"===t.step.case?s="Error while searching filesystem":"runCommand"===t.step.case?s="Error while running command":"mquery"===t.step.case?s="Error while semantic searching":"proposeCode"===t.step.case?s="Error while proposing code":"listDirectory"===t.step.case?s="Error while analyzing directory":"searchWeb"===t.step.case?s="Error while searching the web":"mcpTool"===t.step.case&&(s="Error while running MCP tool");return(0,z.jsx)("div",{children:s})},useErrorStepContribution=e=>{var t,s,a;let n=(0,X.useId)(),r=e.error&&e.type!==eS.prY.RUN_COMMAND||"errorMessage"===e.step.case&&e.step.value.error&&!e.step.value.error.isBenign,o="errorMessage"===e.step.case&&e.step.value.error&&e.step.value.error.isBenign,[i,l]=(0,X.useState)(!1);if(!r&&!o)return null;let c=e.type!==eS.prY.MCP_TOOL,d=e.type===eS.prY.MCP_TOOL,u="No credits consumed by this error.";r&&c?u="No credits consumed on this tool call.":r&&d&&(u="Failed MCP tool calls consume credits.");let toggleOpen=()=>{l(!i)},m=(null===(t=e.error)||void 0===t?void 0:t.userErrorMessage)||"errorMessage"===e.step.case&&(null===(s=e.step.value.error)||void 0===s?void 0:s.userErrorMessage)||"Cascade has encountered an internal error in this step.",p=o?void 0:null===(a=e.error)||void 0===a?void 0:a.errorId;return{title:()=>(0,z.jsx)(ErrorTitle,{step:e}),cta:c?()=>(0,z.jsx)("div",{className:"ml-1",children:(0,z.jsx)(NoCreditMessagingInfoTooltip,{isStepError:r})}):null,icon:()=>(0,z.jsx)(ToolStatus,{step:e}),omitNonStandardCreditReasons:!0,supplementaryView:(t,s,a)=>{var r;return(0,z.jsxs)("div",{className:"flex flex-col px-2 py-1",children:[(0,z.jsxs)("div",{className:"flex items-center justify-between",children:[(0,z.jsx)("span",{className:"shrink overflow-hidden text-ellipsis whitespace-nowrap text-sm opacity-60",children:u}),(0,z.jsxs)("div",{className:"flex cursor-pointer items-center gap-1 text-xs opacity-60",onClick:toggleOpen,children:[(0,z.jsx)("div",{"data-tooltip-id":n,children:p||"Details"}),p&&(0,z.jsx)(CompactTooltip,{id:n,children:"An error ID that helps the team investigate the error, if needed."}),(0,z.jsx)(nn.Z,{className:(0,eG.classNames)("h-3 w-3 transition-transform",i?"rotate-180":"")})]})]}),(0,z.jsx)("div",{className:(0,eG.classNames)("overflow-hidden transition-all duration-150 ease-in-out",i?"mt-0.5 max-h-96 opacity-100":"max-h-0 p-0 opacity-0"),children:(0,z.jsxs)("div",{className:"rounded bg-gray-500/25 px-2 py-1",children:[(0,z.jsx)("span",{className:"mr-2 text-sm opacity-60",children:m}),a&&(0,z.jsx)("pre",{className:"whitespace-pre-wrap text-sm",children:null===(r=e.error)||void 0===r?void 0:r.fullError})]})})]})}}},useNux=()=>{let{state:{userSettings:e}}=useServerConnectionContext(),{events:{showNux:t}}=useCascadeUIStateContext();return{handleShowNux:s=>{for(let a of s){let s=void 0!==e.cascadeNuxStates.find(e=>e.event===a);s||t(a)}}}},SearchWebStepTitle=e=>{let{step:t,status:s}=e,a=(0,X.useId)(),{unleash:n}=useServerConnectionContext(),{handleShowNux:r}=useNux();(0,X.useEffect)(()=>{let e=n.isEnabled(et.rpR.CASCADE_WEB_SEARCH_NUX);e&&r([et.NQJ.CASCADE_NUX_EVENT_WEB_SEARCH])},[r,n]);let o=(0,X.useMemo)(()=>{if(!t.domain)return(0,z.jsx)("span",{className:"opacity-70",children:"web "});let e=t.domain.startsWith("http")?t.domain:"https://".concat(t.domain);return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)("a",{"data-tooltip-id":a,href:e,target:"_blank",rel:"noreferrer",className:"underline",children:t.domain})," ",(0,z.jsx)(CompactTooltip,{id:a,children:(0,z.jsxs)("div",{className:"max-w-[80vw] space-y-2 whitespace-normal p-2 sm:max-w-[400px]",children:["Web search prioritized results from ",t.domain,". The LLM decided that this would yield the best results. If this is not desired, you can simply tell Cascade to search without a domain filter."]})})]})},[t.domain,a]);return(0,z.jsx)("div",{children:(0,z.jsx)("div",{className:"flex w-full items-start gap-2",children:(0,z.jsxs)("p",{className:"grow",children:[(0,z.jsxs)("span",{className:"opacity-70",children:[isLoadingStatus(s)?"Searching":"Searched"," "]}),o,(0,z.jsx)("span",{className:"opacity-70",children:"for "}),(0,z.jsxs)("span",{children:['"',t.query,'"']})]})})})};var nc=s(99205);let SearchWebStepSupplementaryView=e=>{let{step:t}=e,s=(0,X.useId)();return(0,z.jsx)("div",{className:"px-2 py-1",children:t.webDocuments.length>0&&(0,z.jsx)("ul",{className:"w-full list-inside list-none",children:t.webDocuments.map((e,t)=>(0,z.jsxs)(X.Fragment,{children:[(0,z.jsxs)("li",{className:"flex w-full flex-row items-center justify-start gap-2",children:[(0,z.jsx)("a",{href:e.url,target:"_blank",rel:"noopener noreferrer","data-tooltip-id":"".concat(s,"-").concat(t),children:(0,z.jsx)(nc.Z,{className:"inline-block h-3 w-3 cursor-pointer"})}),(0,z.jsx)("p",{className:"inline-block max-w-[calc(100%-38px)] overflow-x-clip text-ellipsis text-nowrap opacity-70",children:e.title})]}),(0,z.jsxs)(CompactTooltip,{id:"".concat(s,"-").concat(t),className:"max-w-[80vw] space-y-1 whitespace-normal sm:max-w-[400px]",children:[(0,z.jsx)("p",{className:"mb-1",children:(0,z.jsx)("b",{children:e.title})}),(0,z.jsx)("p",{className:"break-all",children:e.url}),(0,z.jsx)("p",{className:"opacity-80",children:e.summary})]})]},e.url))})})};var nd=s(723);let SearchWebStepCTA=e=>{let{step:t}=e,s=(0,X.useId)(),{hasDevExtension:a}=useChatParamsContext();return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(nl.Z,{"data-tooltip-id":s,className:"mt-0.5 h-4 w-4 flex-none opacity-50 hover:opacity-100"}),(0,z.jsx)(CompactTooltip,{id:s,clickable:!0,children:(0,z.jsxs)("div",{className:"max-w-[80vw] space-y-2 p-2 sm:max-w-[400px]",children:[(0,z.jsxs)("p",{children:["Web search may use many tool calls to find the answer it is looking for which can consume many Flow Action credits depending on how many results are read. The search itself is only 1 credit regardless of the number of results found. Reading each URL can consume additional credits. To turn off web search tools, go to your Windsurf Settings in the bottom status bar. Learn more at"," ",(0,z.jsx)("a",{href:"https://docs.codeium.com",className:"underline",children:"docs.codeium.com"})]}),a&&t.webSearchUrl&&(0,z.jsxs)("p",{children:["[Dev Mode] View full search results",(0,z.jsx)("a",{href:t.webSearchUrl,target:"_blank",rel:"noopener noreferrer",title:"view full search results",children:(0,z.jsx)(nd.Z,{className:"ml-1 inline-block h-3 w-3 cursor-pointer"})})]})]})})]})},useSearchWebStepContribution=e=>{if("searchWeb"!==e.step.case)return null;let{value:t}=e.step;return{icon:()=>(0,z.jsx)(ToolStatus,{step:e}),title:()=>(0,z.jsx)(SearchWebStepTitle,{step:t,status:e.status}),cta:()=>(0,z.jsx)(SearchWebStepCTA,{step:t}),supplementaryView:()=>(0,z.jsx)(SearchWebStepSupplementaryView,{step:t})}},useViewCodeItemToolStepContribution=e=>{if("viewCodeItem"!==e.step.case)return null;let{value:t}=e.step;return{icon:()=>(0,z.jsx)(ToolStatus,{step:e}),title:()=>(0,z.jsxs)("div",{className:"flex flex-row items-center gap-1 overflow-hidden whitespace-nowrap",children:[(0,z.jsx)("p",{children:"Analyzed code item"}),t.cci&&(0,z.jsx)(ContextItemPillButton,{contextItem:t.cci})]}),cta:null,supplementaryView:null}};var nu=s(49289);let useViewContentChunkToolStepContribution=e=>{var t;let{extensionClient:s,logEvent:a}=useServerConnectionContext(),n=(0,X.useId)(),r=null===(t=e.step.value.croppedWebDocument)||void 0===t?void 0:t.chunks.at(0),o=(0,X.useMemo)(()=>{if("viewContentChunk"!==e.step.case)return[];if((null==r?void 0:r.chunkType.case)==="markdownChunk"){var t;let e=null===(t=r.chunkType.value.headers.at(-1))||void 0===t?void 0:t.type;return r.chunkType.value.headers.filter(t=>t.type===e&&""!==t.text.trim()).map(e=>e.text)}return[]},[r,e.step.case]),i=(0,X.useCallback)(()=>{let t;if(s&&"viewContentChunk"===e.step.case){switch(null==r?void 0:r.chunkType.case){case"markdownChunk":t=markdownChunkToString(r.chunkType.value);break;case"text":t=r.chunkType.value;break;default:return}s.openVirtualFile({text:t,showMarkdownPreview:!0}),a(et.tbr.CASCADE_WEB_TOOLS_OPEN_CHUNK_MARKDOWN,{num_leaves:String(o.length)})}},[r,s,a,o.length,e.step.case]);if("viewContentChunk"!==e.step.case)return null;let l=e.step.value,c=o.length>1?"".concat(o.length," chunks"):o[0];return{icon:()=>(0,z.jsx)(ToolStatus,{step:e}),title:()=>{var t,s;return(0,z.jsxs)("div",{className:"flex items-center gap-1",children:[(0,z.jsx)("div",{children:isLoadingStatus(e.status)?"Analyzing content":"Analyzed content"}),(0,z.jsx)("div",{"data-tooltip-id":n,className:"overflow-hidden",children:(0,z.jsx)(PillButton,{onClick:i,children:(0,z.jsxs)("span",{className:"flex flex-row items-center justify-center gap-x-1",children:[(0,z.jsx)(nu.Z,{className:"h-3 w-3"}),(0,z.jsx)("span",{className:"opacity-70",children:c||(null===(t=l.croppedWebDocument)||void 0===t?void 0:t.title)||"Chunk ".concat(l.position)})]})})}),(0,z.jsxs)(CompactTooltip,{id:n,className:"max-w-[80vw] space-y-2 whitespace-normal p-2 sm:max-w-[400px]",clickable:!0,children:[(null===(s=l.croppedWebDocument)||void 0===s?void 0:s.title)&&(0,z.jsxs)("p",{children:["Page title: ",l.croppedWebDocument.title]}),(0,z.jsxs)("p",{children:["A chunk is a section of the page. Long pages are chunked so that only the sections that are relevant to your query are read and to save on credit usage. Each analysis like this uses 1 credit. Learn more at"," ",(0,z.jsx)("a",{href:"https://docs.codeium.com",className:"underline",children:"docs.codeium.com"})]}),o.length>1?(0,z.jsxs)(z.Fragment,{children:[(0,z.jsxs)("p",{children:["In this case, ",o.length," chunks were collapsed into one to reduce credit usage (this costs one tool instead of ",o.length,"). Chunks included in this read:"]}),(0,z.jsx)("ul",{className:"list-inside list-disc pl-4",children:o.map(e=>(0,z.jsx)("li",{children:e},e))})]}):(0,z.jsxs)("p",{children:["Section header: ",c||"Chunk ".concat(l.position)]})]})]})},cta:null,supplementaryView:null}},useCreateWorkflowToolStepContribution=e=>{if("createRecipe"!==e.step.case)return null;let t=e.step.value;return{icon:()=>(0,z.jsx)(ToolStatus,{step:e}),title:()=>{var e,s;return(0,z.jsx)("div",{children:(0,z.jsxs)("span",{children:["Created workflow: ",null===(s=t.recipe)||void 0===s?void 0:null===(e=s.toolDefinition)||void 0===e?void 0:e.name," (beta)"]})})},cta:null,supplementaryView:()=>{var e,s;return(0,z.jsx)("div",{className:"px-2 py-1 opacity-50",children:null===(s=t.recipe)||void 0===s?void 0:null===(e=s.toolDefinition)||void 0===e?void 0:e.description})}}};var nm=s(54998);let useReadUrlContentStepContribution=e=>{var t;let{extensionClient:s,logEvent:a}=useServerConnectionContext(),n=(0,X.useId)();if("readUrlContent"!==e.step.case)return null;let r=e.step.value,o=new URL(r.resolvedUrl||r.url),i=(null===(t=r.webDocument)||void 0===t?void 0:t.chunks.length)||0,handleOpenPageMarkdown=()=>{var e;if(!s||!(null===(e=r.webDocument)||void 0===e?void 0:e.chunks))return;let t=r.webDocument.chunks.map(e=>{switch(e.chunkType.case){case"markdownChunk":return markdownChunkToString(e.chunkType.value);case"text":return e.chunkType.value}});s.openVirtualFile({text:t.join("\n\n"),showMarkdownPreview:!0}),a(et.tbr.CASCADE_WEB_TOOLS_OPEN_READ_URL_MARKDOWN,{num_chunks:String(i)})};return{icon:()=>(0,z.jsx)(ToolStatus,{step:e}),title:()=>{var t,s;return(0,z.jsxs)("div",{className:"flex flex-row items-center justify-start gap-1",children:[(0,z.jsx)("p",{children:isLoadingStatus(e.status)?"Reading page":i>1?"Created outline":"Read page"}),(0,z.jsx)("div",{"data-tooltip-id":n,className:"overflow-hidden",children:(0,z.jsx)(PillButton,{onClick:handleOpenPageMarkdown,children:(0,z.jsxs)("span",{className:"flex flex-row items-center justify-center gap-x-1",children:[(0,z.jsx)(nm.Z,{className:"h-3 w-3"}),(0,z.jsx)("span",{className:"opacity-70",children:o.hostname})]})})}),(0,z.jsxs)(CompactTooltip,{id:n,className:"max-w-[80vw] space-y-1 whitespace-normal p-2 sm:max-w-[400px]",clickable:!0,children:[(null===(t=r.webDocument)||void 0===t?void 0:t.title)&&(0,z.jsx)("p",{className:"break-all",children:(0,z.jsx)("b",{children:r.webDocument.title})}),(0,z.jsx)("p",{className:"break-all",children:(0,z.jsx)("a",{href:r.resolvedUrl||r.url,target:"_blank",className:"underline",children:r.resolvedUrl||r.url})}),(null===(s=r.webDocument)||void 0===s?void 0:s.summary)&&(0,z.jsx)("p",{children:(0,z.jsx)("i",{className:"italic",children:r.webDocument.summary})}),(0,z.jsx)("p",{className:"mt-2 opacity-70",children:i>1?(0,z.jsxs)(z.Fragment,{children:["Long pages like this one will be broken down into outlines and read as needed. Read more at our"," ",(0,z.jsx)("a",{href:"https://docs.codeium.com",className:"underline",children:"docs.codeium.com"})]}):"Page was short enough to be read as a single document. This uses 1 credit."})]})]})},cta:()=>(0,z.jsx)("a",{href:r.resolvedUrl||r.url,target:"_blank",className:"cursor-pointer text-sm underline underline-offset-2",title:"View Page",children:"View Page"}),supplementaryView:null}},useListDirToolStepContribution=e=>{let t=(0,X.useId)(),{homeDir:s,workspaceUris:a}=useWorkspaceInfoContext();if("listDirectory"!==e.step.case)return null;let n=e.step.value.directoryPathUri,r=prettyPath(n,s,a);return{icon:()=>(0,z.jsx)(ToolStatus,{step:e}),title:()=>(0,z.jsxs)("div",{className:"flex flex-row items-center gap-1",children:[(0,z.jsx)("span",{className:"flex-shrink-0",children:"Analyzed"}),(0,z.jsx)("div",{className:"min-w-0 flex-1",children:(0,z.jsx)("span",{className:"block truncate text-left text-sm opacity-70","data-tooltip-id":t,style:{direction:"rtl"},children:(0,z.jsx)("bdi",{children:r})})}),(0,z.jsx)(CompactTooltip,{id:t,children:r})]}),cta:null,supplementaryView:null}},useViewFileToolStepContribution=e=>{let{openFilePointer:t}=useServerConnectionContext();if("viewFile"!==e.step.case)return null;let s=e.step.value.absolutePathUri,a=e.step.value.startLine,n=e.step.value.endLine,r="".concat(getBaseName(s),":(").concat(a+1,"-").concat(n,")");return{icon:()=>(0,z.jsx)(ToolStatus,{step:e}),title:()=>(0,z.jsxs)("div",{className:"flex flex-row items-center gap-1 overflow-hidden whitespace-nowrap",children:[(0,z.jsx)("p",{children:"Analyzed"}),(0,z.jsx)("div",{className:"overflow-hidden",children:(0,z.jsx)(PillButton,{onClick:()=>{t(new OpenFilePointer({fileUri:s,startLine:a,endLine:n-1}))},children:(0,z.jsx)("span",{className:"opacity-70",children:r})})})]}),supplementaryView:null,cta:null}},useMcpToolStepContribution=e=>{if("mcpTool"!==e.step.case)return null;let t=e.step.value,formatJson=e=>{try{return"```json\n"+JSON.stringify(JSON.parse(e),null,2)+"\n```"}catch(t){return"```json\n"+e+"\n```"}},s=t.toolCall,a=null==s||!s.argumentsJson||0===Object.keys(JSON.parse(s.argumentsJson)).length;return{icon:()=>(0,z.jsx)(ToolStatus,{step:e}),title:()=>(0,z.jsxs)("div",{children:[(0,z.jsx)("span",{className:"opacity-70",children:"MCP Tool: "}),t.serverName," ",s&&"/ ".concat(s.name)]}),supplementaryView:(null==s?void 0:s.argumentsJson)&&!a?()=>(0,z.jsx)("div",{className:"px-2 pt-1",children:(0,z.jsxs)("div",{className:"flex flex-col",children:[(0,z.jsx)("span",{className:"opacity-70",children:"Ran with these arguments:"}),(0,z.jsx)(e5,{className:"text-[color:var(--codeium-text-color)] prose-a:text-[color:var(--codeium-link-color)]",hideToolbar:!0,children:formatJson(s.argumentsJson)})]})}):null,cta:null}},CascadeCodeBlock=e=>{var t;let{code:s,markdownLanguage:a=""}=e,n=(null===(t=eW.YC['pre[class*="language-"]'])||void 0===t?void 0:t.background)||"rgb(30 30 30)";return(0,z.jsx)("div",{className:"max-h-[250px] w-full overflow-x-auto overflow-y-auto",style:{background:n},children:(0,z.jsx)(eY.ErrorBoundary,{title:"Error rendering code block",children:(0,z.jsx)(eJ.Z,{style:eW.YC,language:a,PreTag:"div",customStyle:{margin:0,overflow:"initial"},codeTagProps:{style:{fontSize:"0.75rem",background:"none"}},children:s})})})},useProposedCodeStepContribution=e=>{var t;let s,a;let{state:{cascadeConversationState:n}}=useCascadeContext(),r=null==n?void 0:n.cascadeId,{extensionClient:o}=useServerConnectionContext(),i=isCodeActionHeuristicFailure(e);if("proposeCode"===e.step.case)s=e.step.value;else{if("codeAction"!==e.step.case||!i)return null;s=e.step.value}let{actionSpec:l,actionResult:c,codeInstruction:d,markdownLanguage:u}=s;if((null==l?void 0:l.spec.case)!=="command")return console.warn("Propose code step with unknown action spec:",e),null;{let e=l.spec.value.target;if("file"!==e.case)return console.warn("Propose code with unknown command target type:",e),null;a=e.value.absoluteUri}let m=isLoadingStatus(e.status)||""===d,p=null==c?void 0:null===(t=c.result.value)||void 0===t?void 0:t.diff,x=m?"Proposing edit:":"Proposed edit:";return{icon:()=>(0,z.jsx)(ToolStatus,{step:e}),title:()=>(0,z.jsxs)("div",{className:"flex items-center gap-1",children:[(0,z.jsx)("span",{className:"flex-shrink-0",children:x}),a&&(0,z.jsx)(FileUriPill,{uri:a}),p&&(0,z.jsx)(DiffLineCount,{diff:p})]}),cta:()=>{if(m)return(0,z.jsx)("div",{className:"loader mx-2 h-4 w-4 flex-none"});let e=null==p?void 0:p.unifiedDiff;return void 0===e?null:(0,z.jsx)(sZ.X,{className:"cursor-pointer whitespace-nowrap font-sans !text-ide-editor-color !no-underline !opacity-100",onClick:()=>{null==o||o.openDiffZones(new OpenDiffZonesRequest({cascadeId:r,validationStates:[new ei.YgU({uri:a,lastAcknowledgedState:getAppliedDiff(e,!1),currentState:getAppliedDiff(e,!0)})],writeNewState:!0}))},children:"Apply"})},supplementaryView:d.length>0?()=>(0,z.jsxs)("div",{className:"flex flex-col",children:[i&&(0,z.jsx)("span",{className:"border-b-[1px] border-gray-500/25 px-2 py-1 text-sm text-[color:var(--codeium-text-color)] opacity-90 prose-a:text-[color:var(--codeium-link-color)]",children:"This edit was meant to be applied directly but violated a heuristic for unhelpful changes. You may choose to apply it yourself."}),(0,z.jsx)(CascadeCodeBlock,{code:d,markdownLanguage:u})]}):null}};var np=s(67258),nx=s(98977);let ProxyWebServerMenuDots=()=>{let{extensionClient:e}=useServerConnectionContext(),t=(0,X.useId)(),s=(0,X.useCallback)(()=>{if(!e)return;let t=new OpenExternalUrlRequest({url:"https://codeium.canny.io/feature-requests/",useIdeBrowser:!1});e.openExternalUrl(t)},[e]);return(0,z.jsx)("div",{className:"relative flex items-center",children:(0,z.jsxs)(sz.v,{as:X.Fragment,children:[(0,z.jsxs)(sz.v.Button,{className:"group relative flex items-center justify-center","data-tooltip-id":t,children:[(0,z.jsx)(nx.Z,{className:"h-4 w-4 fill-ide-text-color"}),(0,z.jsx)("div",{className:"absolute -bottom-1 -left-1 -right-1 -top-1 rounded bg-gray-500 opacity-0 group-hover:opacity-20"}),(0,z.jsx)(CompactTooltip,{id:t,place:"top-start",children:"Additional options"})]}),(0,z.jsx)(sD.u,{as:X.Fragment,enter:"transition ease-out duration-100",enterFrom:"transform opacity-0 scale-95",enterTo:"transform opacity-100 scale-100",leave:"transition ease-in duration-75",leaveFrom:"transform opacity-100 scale-100",leaveTo:"transform opacity-0 scale-95",children:(0,z.jsx)(sz.v.Items,{className:(0,np.classNames)("absolute right-0 top-full z-20 mt-2 origin-top-right rounded-md border border-gray-500/25 text-right shadow-lg ring-1 ring-opacity-5 focus:outline-none","bg-ide-editor-background text-sm text-ide-editor-color ring-ide-editor-background"),children:(0,z.jsx)("div",{className:"flex flex-col items-start justify-center space-y-1 py-1",children:(0,z.jsx)(sz.v.Item,{children:e=>{let{active:t}=e;return(0,z.jsx)("button",{onClick:s,className:(0,np.classNames)(t?"bg-gray-500/10":"","w-full whitespace-nowrap px-4 py-1 text-left text-sm"),children:"Send feedback"})}})})})})]})})},useProxyWebServerStepContribution=(e,t)=>{let{extensionClient:s}=useServerConnectionContext(),a=(0,X.useId)(),n=(0,X.useCallback)(t=>{if("proxyWebServer"!==e.step.case)return;let a=e.step.value;if(!a.proxyUrl||!s)return;let n=new OpenExternalUrlRequest({url:a.proxyUrl,useIdeBrowser:t});s.openExternalUrl(n)},[s,e]);if("proxyWebServer"!==e.step.case)return null;let r=e.step.value,o=e.status===eS.V_N.RUNNING,i=(0,z.jsxs)("div",{className:"flex-1",children:[(0,z.jsxs)("span",{className:"flex flex-row items-center gap-x-2 text-sm text-[color:var(--codeium-text-color)] opacity-90",children:[(0,z.jsxs)("p",{children:[(0,z.jsx)("span",{className:"mr-1 rounded bg-gray-500/10 p-0.5 text-xs",children:"Beta"}),o?"Running Preview":"Ran Preview",":"," "]}),(0,z.jsx)("div",{"data-tooltip-id":a,className:"overflow-hidden",children:(0,z.jsx)("p",{className:"opacity-70",children:r.name})})]}),(0,z.jsx)(CompactTooltip,{id:a,className:"max-w-[80vw] space-y-1 whitespace-normal p-2 sm:max-w-[400px]",clickable:!0,children:r.targetUrl})]}),l=(0,z.jsxs)("div",{className:"flex justify-between pb-1 pt-2",children:[(0,z.jsxs)("div",{className:"flex flex-row justify-start gap-x-2 px-2 pb-1",children:[(0,z.jsx)("button",{onClick:()=>{n(!0)},className:"hover:bg-ide-button-hover-background cursor-pointer rounded bg-ide-button-background px-1 py-[1px] text-ide-button-color transition-[background]",children:"Open Preview"}),(0,z.jsx)("button",{onClick:()=>{n(!1)},className:"hover:bg-ide-button-secondary-hover-background bg-ide-button-secondary-background cursor-pointer rounded px-1 py-[1px] text-ide-button-color transition-[background]",children:"Open in External Browser"})]}),o&&(0,z.jsx)("div",{className:"mr-2 flex items-center",children:(0,z.jsx)(ProxyWebServerMenuDots,{})})]});return{icon:()=>(0,z.jsx)(ToolStatus,{step:e}),title:()=>i,cta:()=>o?(0,z.jsx)(ToolCancel,{onCancel:t.onCancelStep}):(0,z.jsx)(ProxyWebServerMenuDots,{}),supplementaryView:o?()=>l:null}},CascadeDeployInteractionView=e=>{let{headerText:t,trajectoryId:s,stepIndex:a,options:n,projectName:r}=e,{events:{sendUserInteraction:o}}=useCascadeContext(),[i,l]=(0,X.useState)(n[0]),handleSelect=e=>{l(e)};return(0,z.jsxs)("div",{className:"mt-2 flex w-full flex-wrap items-center justify-between",children:[(0,z.jsx)("p",{className:"overflow-hidden text-ellipsis whitespace-nowrap text-sm",children:t}),(0,z.jsxs)("div",{className:"flex flex-row justify-end gap-2",children:[(0,z.jsx)(sz.v,{as:X.Fragment,children:(0,z.jsxs)("div",{className:"relative",children:[(0,z.jsxs)("button",{onClick:e=>{e.stopPropagation(),e.preventDefault(),o(new eS.JEm({trajectoryId:s,stepIndex:a,interaction:{case:"deploy",value:new eS.iE7({provider:i,projectName:r})}}))},className:"hover:bg-ide-button-hover-background flex cursor-pointer items-center gap-2 whitespace-nowrap rounded border-[1px] border-gray-500/25 bg-ide-button-background px-1 py-[1px] text-ide-button-color transition-[background]","aria-label":"Deploy to ".concat(i),children:["Deploy ",i?" to ".concat(i):"",n.length>1?(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)("div",{className:"h-2 w-[1px] rounded bg-ide-button-color opacity-50"}),(0,z.jsxs)(sz.v.Button,{onClick:e=>{e.stopPropagation()},className:"group relative","aria-label":"Select deployment provider",children:[(0,z.jsx)("div",{className:"absolute inset-[-2px] rounded group-hover:bg-gray-500/50"}),(0,z.jsx)(nn.Z,{className:"relative h-3 w-3 flex-none"})]})]}):null]}),n.length>0&&(0,z.jsx)(sD.u,{as:X.Fragment,enter:"transition ease-out duration-100",enterFrom:"transform opacity-0 scale-95",enterTo:"transform opacity-100 scale-100",leave:"transition ease-in duration-75",leaveFrom:"transform opacity-100 scale-100",leaveTo:"transform opacity-0 scale-95",children:(0,z.jsx)(sz.v.Items,{className:(0,eG.classNames)("absolute right-0 z-20 mt-2 origin-top-right rounded-md border border-gray-500/25 text-right shadow-lg ring-1 ring-opacity-5 focus:outline-none","bg-ide-editor-background text-sm text-ide-editor-color ring-ide-editor-background"),children:(0,z.jsx)("div",{className:"flex flex-col items-start justify-center space-y-1 py-1",children:n.map(e=>(0,z.jsx)(sz.v.Item,{children:t=>{let{active:s}=t;return(0,z.jsx)("button",{onClick:()=>{handleSelect(e)},className:(0,eG.classNames)("flex w-full flex-row items-center justify-start gap-1 px-2 py-1",s?"bg-ide-tooltip-background":"bg-none"),children:(0,z.jsx)("span",{className:"whitespace-nowrap",children:e})})}},e))})})})]})}),(0,z.jsx)("button",{onClick:()=>{o(new eS.JEm({trajectoryId:s,stepIndex:a,interaction:{case:"deploy",value:new eS.iE7({cancel:!0})}}))},className:"hover:bg-ide-button-secondary-hover-background bg-ide-button-secondary-background text-ide-button-secondary-color cursor-pointer rounded px-1 py-[1px] transition-[background]",children:"Cancel"})]})]})};var nh=s(52329);let ProjectNameInput=e=>{let{projectName:t,onSave:s,onCancel:a,validateWindsurfJSAppProjectName:n,suffix:r=".windsurf.app",autoFocus:o=!0,placeholder:i="Enter project name"}=e,[l,c]=(0,X.useState)(t),[d,u]=(0,X.useState)(!1),[m,p]=(0,X.useState)([]),[x,h]=(0,X.useState)(null),g=X.useRef(null);(0,X.useEffect)(()=>{c(t)},[t]),(0,X.useEffect)(()=>{o&&g.current&&(g.current.focus(),g.current.select())},[o]);let validateInput=e=>e.trim()?!!/^[a-zA-Z0-9-]+$/.test(e)||(h("Project name can only contain letters, numbers, and hyphens"),!1):(h("Project name cannot be empty"),!1),handleSaveProject=async()=>{if(validateInput(l)&&l!==t){u(!0);try{let e=await n(l);if(!e){h("Failed to validate project name. Please try again.");return}e.status===et.zcD.AVAILABLE||e.status===et.zcD.IN_USE?s(l):e.alternativeNames.length>0?(p(e.alternativeNames),h("This project name is already taken")):h("Invalid project name")}catch(e){h("Failed to validate project name"),console.error("Project name validation error:",e)}finally{u(!1)}}},handleSuggestionClick=e=>{c(e),h(null),g.current&&(g.current.focus(),g.current.select())};return(0,z.jsxs)("div",{children:[(0,z.jsxs)("div",{className:"flex items-center gap-4",children:[(0,z.jsxs)("div",{className:"relative flex grow items-center",children:[(0,z.jsx)("input",{ref:g,onClick:e=>{e.stopPropagation()},className:(0,eG.classNames)("border-gray-500-10 min-w-[4rem] shrink grow rounded border bg-gray-500/25 px-1 text-sm",x?"border-red-500/50":""),value:l,onChange:e=>{let t=e.target.value;c(t),x&&h(null),m.length>0&&p([])},onKeyDown:e=>{"Enter"===e.key?handleSaveProject():"Escape"===e.key&&a()},placeholder:i,"aria-invalid":!!x}),(0,z.jsx)("div",{children:r})]}),(0,z.jsxs)("div",{className:"flex items-center gap-1",children:[(0,z.jsxs)("button",{onClick:()=>{handleSaveProject()},disabled:d,className:"hover:bg-ide-button-hover-background relative cursor-pointer rounded bg-ide-button-background px-1 py-[1px] text-ide-button-color transition-[background] disabled:cursor-not-allowed disabled:opacity-50",children:[(0,z.jsx)("span",{className:(0,eG.classNames)("transition-[opacity]",d?"opacity-0":""),children:"Save"}),(0,z.jsx)("div",{className:(0,eG.classNames)("absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 transition-[opacity]",d?"":"opacity-0"),children:(0,z.jsx)("div",{className:"loader h-3 w-3"})})]}),(0,z.jsx)("button",{onClick:a,className:"hover:bg-ide-button-secondary-hover-background bg-ide-button-secondary-background text-ide-button-secondary-color cursor-pointer rounded px-1 py-[1px] transition-[background]",children:"Cancel"})]})]}),x&&(0,z.jsx)("div",{className:"text-sm text-red-400",children:x}),m.length>0&&(0,z.jsxs)("div",{className:"mt-2 text-sm",children:[(0,z.jsx)("div",{className:"opacity-70",children:"Alternative names:"}),(0,z.jsx)("div",{className:"flex flex-wrap gap-1 rounded py-1",children:m.map(e=>(0,z.jsx)("button",{onClick:()=>{handleSuggestionClick(e)},className:"hover:bg-ide-button-secondary-hover-background bg-ide-button-secondary-background text-ide-button-secondary-color cursor-pointer rounded px-1 py-[1px] text-xs transition-[background]","aria-label":"Use suggested name: ".concat(e),children:e},e))})]})]})},getAppDeploymentStatusPageURL=e=>"https://codeium-windsurf-deploys-exafunction.vercel.app/redirect/deployments/".concat(e,"/status"),DeploymentStatus=e=>{let{deployment:t,claimUrl:s}=e,a=(0,X.useId)(),n=useChatParamsContext(),{lsClient:r}=useServerConnectionContext(),o=(0,X.useCallback)(async()=>{let e=await (null==r?void 0:r.getWindsurfJSAppDeployment({metadata:getMetadata(n),deploymentId:t.windsurfDeploymentId}));return e},[r,t.windsurfDeploymentId,n]),{data:i,isLoading:l,stopPolling:c}=(0,ao.usePoller)(o,1e4,6e5,[t.windsurfDeploymentId]);(0,X.useEffect)(()=>{((null==i?void 0:i.buildStatus)===et.ejj.ERROR||(null==i?void 0:i.buildStatus)===et.ejj.CANCELED||(null==i?void 0:i.buildStatus)===et.ejj.READY)&&c()},[c,i]);let d=(0,X.useMemo)(()=>{let e=(0,ec.enumToString)(t.deploymentProvider,et.$5R);return e?e.toLowerCase().replace(/\b\w/g,e=>e.toUpperCase()):"Unknown"},[t.deploymentProvider]),u=(0,z.jsxs)("div",{children:[(0,z.jsxs)("div",{className:"mb-2 flex items-center gap-1 px-2 text-sm",children:[(0,z.jsx)(aq.Z,{className:"h-4 w-4 text-green-500"}),"Deploy successful -"," ",(0,z.jsx)("a",{href:getAppDeploymentStatusPageURL(t.windsurfDeploymentId),target:"_blank",rel:"noopener noreferrer",className:"underline",children:"View Logs"})]}),(0,z.jsxs)("p",{className:"mb-1 flex items-center justify-between px-2 text-sm",children:[(0,z.jsx)("span",{children:"Deployment is live."}),(0,z.jsx)("a",{href:t.projectUrl,target:"_blank",rel:"noopener noreferrer",children:(0,z.jsx)("button",{className:"hover:bg-ide-button-hover-background hover:text-ide-button-hover-color rounded bg-ide-button-background px-1 py-[2px] text-sm text-ide-button-color",children:"View Deployment"})})]}),s&&(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)("div",{className:"my-2 w-full border-t-[1px] border-gray-500/25 text-sm"}),t.expiresAt&&t.expiresAt.toDate()>new Date&&!t.deprovisionedAt&&(0,z.jsxs)(z.Fragment,{children:[(0,z.jsxs)("p",{className:"px-2 text-sm",children:["You must claim your app by"," ",(0,z.jsx)("span",{className:"underline","data-tooltip-id":a,children:eP()(t.expiresAt.toDate()).format("lll")}),". After that, your app will permanently expire."]}),(0,z.jsx)(CompactTooltip,{id:a,children:(0,z.jsxs)("div",{className:"flex max-w-[90vw] flex-col gap-1",children:[(0,z.jsx)("div",{children:"Unclaimed apps serve as a preview of your app. You should claim your app if you do not want it to expire."}),(0,z.jsx)("div",{children:"We are unable to recover your app if the expiration window has passed."})]})})]}),t.deprovisionedAt&&(0,z.jsxs)("p",{className:"px-2 text-sm",children:["Your app has expired and been deprovisioned at"," ",eP()(t.deprovisionedAt.toDate()).format("lll"),"."]}),(0,z.jsxs)("div",{className:"mt-1 flex items-center justify-between px-2",children:[(0,z.jsxs)("span",{className:"text-sm",children:["Claim app to transfer it to your own ",d," account"]}),(0,z.jsx)("a",{href:s,target:"_blank",rel:"noopener noreferrer",children:(0,z.jsx)("button",{className:"bg-ide-button-secondary-background text-ide-button-secondary-color hover:bg-ide-button-secondary-hover-background hover:text-ide-button-secondary-hover-color rounded px-1 py-[2px] text-sm",children:"Claim here"})})]})]})]});if(l&&!i)return(0,z.jsxs)("div",{className:"flex items-center gap-1 px-2 text-sm",children:[(0,z.jsx)("div",{className:"loader h-4 w-4"}),"Loading deployment status -"," ",(0,z.jsx)("a",{href:getAppDeploymentStatusPageURL(t.windsurfDeploymentId),target:"_blank",rel:"noopener noreferrer",className:"underline",children:"View Status"})]});if(!i)return u;switch(i.buildStatus){case et.ejj.QUEUED:return(0,z.jsxs)("div",{className:"flex items-center gap-1 px-2 text-sm",children:[(0,z.jsx)("div",{className:"loader h-4 w-4"}),"App build queued -"," ",(0,z.jsx)("a",{href:getAppDeploymentStatusPageURL(t.windsurfDeploymentId),target:"_blank",rel:"noopener noreferrer",className:"underline",children:"View Status"})]});case et.ejj.BUILDING:case et.ejj.INITIALIZING:return(0,z.jsxs)("div",{className:"flex items-center gap-1 px-2 text-sm",children:[(0,z.jsx)("div",{className:"loader h-4 w-4"}),"Deploying app -"," ",(0,z.jsx)("a",{href:getAppDeploymentStatusPageURL(t.windsurfDeploymentId),target:"_blank",rel:"noopener noreferrer",className:"underline",children:"View Logs"})]});case et.ejj.ERROR:return(0,z.jsxs)("div",{className:"flex items-center gap-1 text-sm",children:[(0,z.jsx)(tL.Z,{className:"h-4 w-4 text-red-500"}),"Deploy failed -"," ",(0,z.jsx)("a",{href:getAppDeploymentStatusPageURL(t.windsurfDeploymentId),target:"_blank",rel:"noopener noreferrer",className:"underline",children:"View Logs"})]});case et.ejj.CANCELED:return(0,z.jsxs)("div",{className:"flex items-center gap-1 px-2 text-sm",children:[(0,z.jsx)("div",{className:"loader h-4 w-4"}),"Deploy canceled -"," ",(0,z.jsx)("a",{href:getAppDeploymentStatusPageURL(t.windsurfDeploymentId),target:"_blank",rel:"noopener noreferrer",className:"underline",children:"View Logs"})]});case et.ejj.READY:default:return u}},FileUploadProgress=e=>{let{step:t}=e,s=(0,X.useMemo)(()=>Object.values(t.fileUploadStatus).filter(e=>e===eS.w8x.SUCCESS).length,[t.fileUploadStatus]),[a,n]=(0,X.useState)(!1),r=(0,X.useMemo)(()=>Object.entries(t.fileUploadStatus).map(e=>{let[s,a]=e,n=s.replace(t.projectPath+"/",""),r=null;switch(a){case eS.w8x.IN_PROGRESS:case eS.w8x.PENDING:r=(0,z.jsx)("div",{className:"loader h-3 w-3"});break;case eS.w8x.SUCCESS:r=(0,z.jsx)(aq.Z,{className:"h-3 w-3 text-green-500"});break;case eS.w8x.FAILURE:r=(0,z.jsx)(tL.Z,{className:"h-3 w-3 text-red-500"});break;default:r=(0,z.jsx)("span",{className:"h-3 w-3 text-gray-500",children:"-"})}return(0,z.jsxs)("li",{className:"flex items-center gap-1",children:[r," ",(0,z.jsx)("span",{className:"opacity-50",children:n})]},s)}),[t.fileUploadStatus,t.projectPath]);return(0,z.jsxs)("div",{className:"mt-2",children:[(0,z.jsxs)("button",{onClick:()=>{n(!a)},className:"flex w-full items-center justify-between text-left text-sm transition-colors",children:[(0,z.jsx)("div",{className:"flex items-center gap-1",children:0===s?"Preparing to upload ".concat(r.length," files"):s<r.length?(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)("div",{className:"loader h-4 w-4"}),"Uploading files ",s,"/",r.length]}):(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(aq.Z,{className:"h-4 w-4 text-green-500"})," Uploaded files ",s,"/",r.length]})}),(0,z.jsx)(az.Z,{className:"h-5 w-5 transition-transform ".concat(a?"rotate-180 transform":"")})]}),(0,z.jsx)("div",{className:(0,eG.classNames)("max-h-0 overflow-auto rounded bg-gray-500/10 px-2 transition-[padding,max-height]",a?"max-h-48 py-1":""),children:(0,z.jsx)("ul",{className:"flex list-inside list-disc flex-col gap-1 text-sm",children:r})})]})},getWindsurfAppDeploymentUrl=(e,t)=>{switch(t){case et.$5R.VERCEL:return"https://".concat(e,".vercel.app");case et.$5R.NETLIFY:return"https://".concat(e,".windsurf.app");default:return"unknown"}},DeployStepSupplementaryView=e=>{var t,s;let{trajectoryStep:a,step:n,status:r,stepIndex:o,trajectoryId:i,validateWindsurfJSAppProjectName:l,saveWindsurfJSAppProjectName:c}=e,d=(0,X.useId)(),[u,m]=(0,X.useState)(!1),[p,x]=(0,X.useState)(n.projectNameUsed||"");(0,X.useEffect)(()=>{x(n.projectNameUsed||"")},[n.projectNameUsed]);let handleSave=async e=>{if(n.projectName===e){m(!1);return}if(c&&n.projectPath)try{await c(n.projectPath,e)}catch(e){console.error("Failed to save project name:",e)}x(e),m(!1)},h=null===(t=a.requestedInteraction)||void 0===t?void 0:t.interaction;if((null==h?void 0:h.case)!=="deploy")return null;let g=h.value.providerOptions;return(0,z.jsxs)("div",{className:"flex flex-col gap-1 py-1",children:[(0,z.jsx)("p",{className:"px-2",children:"Your app will be deployed to the following domain."}),u?(0,z.jsx)("div",{className:"px-2",children:(0,z.jsx)(ProjectNameInput,{projectName:p,onSave:e=>{handleSave(e)},onCancel:()=>{m(!1)},validateWindsurfJSAppProjectName:l,suffix:".windsurf.app"})}):(0,z.jsxs)(z.Fragment,{children:[(0,z.jsxs)("div",{className:"px-2",children:[(0,z.jsxs)("div",{className:"relative flex gap-1 rounded bg-gray-500/10 p-1 text-sm",children:[(null===(s=n.deployment)||void 0===s?void 0:s.projectUrl)||getWindsurfAppDeploymentUrl(p,et.$5R.NETLIFY),r===eS.V_N.WAITING&&(0,z.jsxs)("div",{children:[(0,z.jsx)(nh.Z,{onClick:()=>{m(!0)},"data-tooltip-id":d,className:"absolute right-1 top-1/2 h-5 w-5 -translate-y-1/2 cursor-pointer rounded p-1 transition-[background] hover:bg-gray-500/25"}),(0,z.jsx)(CompactTooltip,{id:d,children:(0,z.jsx)("div",{className:"text-sm opacity-70",children:"Edit domain"})})]})]}),(0,z.jsx)(FileUploadProgress,{step:n})]}),r===eS.V_N.WAITING&&(0,z.jsx)("div",{className:"px-2",children:(0,z.jsx)(CascadeDeployInteractionView,{headerText:"Do you want to deploy this web app?",trajectoryId:i,stepIndex:o,options:g,projectName:p})}),n.deployment&&(0,z.jsx)(DeploymentStatus,{deployment:n.deployment,claimUrl:n.claimUrl})]})]})},useDeployStepContribution=(e,t)=>{let{events:{validateWindsurfJSAppProjectName:s,saveWindsurfJSAppProjectName:a}}=useCascadeContext();if("deployWebApp"!==e.step.case)return null;let n=e.step.value,r=e.status===eS.V_N.RUNNING,o=(0,z.jsx)("div",{className:"flex-1",children:(0,z.jsxs)("span",{className:"flex flex-row items-center gap-x-2 text-sm text-[color:var(--codeium-text-color)] opacity-90",children:[isLoadingStatus(e.status)?"Deploying":"Deployed"," ",n.framework||"HTML"," ","app to Netlify"]})});return{icon:()=>(0,z.jsx)(ToolStatus,{step:e}),title:()=>o,cta:()=>r?(0,z.jsx)(ToolCancel,{onCancel:t.onCancelStep}):null,supplementaryView:(t,r)=>(0,z.jsx)(DeployStepSupplementaryView,{trajectoryStep:e,step:n,status:e.status,trajectoryId:t,stepIndex:r,validateWindsurfJSAppProjectName:s,saveWindsurfJSAppProjectName:a})}};var ng=s(43553);let ReadDeploymentConfigStepSupplementaryView=e=>{let{step:t}=e,{openFilePointer:s}=useServerConnectionContext(),[a,n]=(0,X.useState)(!1);return(0,z.jsxs)("div",{className:"flex flex-col px-2 py-1",children:[(0,z.jsxs)("button",{onClick:()=>{n(!a)},className:"flex w-full items-center justify-between text-left text-sm transition-colors",children:[(0,z.jsxs)("div",{className:"flex items-center gap-1",children:[(0,z.jsx)("span",{className:"text-sm opacity-50",children:"Project Path"}),(0,z.jsx)("span",{className:"direction-[rtl] overflow-hidden text-ellipsis break-all px-0.5 text-left text-sm opacity-70",children:t.projectPath||"Unknown Project Path"})]}),(0,z.jsx)(ng.Z,{className:"h-5 w-5 transition-transform ".concat(a?"rotate-180 transform":"")})]}),(0,z.jsx)("div",{className:(0,eG.classNames)("max-h-0 overflow-auto rounded bg-gray-500/10 px-2 transition-[padding,max-height]",a?"max-h-48 py-1":""),children:(0,z.jsxs)("div",{className:"flex flex-col items-start justify-start gap-1",children:[t.deploymentConfig?(0,z.jsxs)(z.Fragment,{children:[(0,z.jsxs)("div",{className:"flex items-center gap-1",children:[(0,z.jsx)("span",{className:"text-sm opacity-50",children:"Project Name"}),(0,z.jsx)("span",{className:"direction-[rtl] overflow-hidden text-ellipsis break-all px-0.5 text-left text-sm opacity-70",children:t.deploymentConfig.projectName||"No project found"}),t.deploymentConfig.projectName&&t.deploymentConfigUri&&(0,z.jsx)("button",{onClick:()=>{s(new OpenFilePointer({fileUri:t.deploymentConfigUri}))},className:"cursor-pointer text-sm opacity-50",children:(0,z.jsx)(s4.Z,{className:"h-3 w-3"})})]}),(0,z.jsxs)("div",{className:"flex items-center gap-1",children:[(0,z.jsx)("span",{className:"text-sm opacity-50",children:"Framework"}),(0,z.jsx)("span",{className:"direction-[rtl] overflow-hidden text-ellipsis break-all px-0.5 text-left text-sm opacity-70",children:t.deploymentConfig.framework||"No framework found"}),t.deploymentConfig.framework&&t.deploymentConfigUri&&(0,z.jsx)("button",{onClick:()=>{s(new OpenFilePointer({fileUri:t.deploymentConfigUri}))},className:"cursor-pointer text-sm opacity-50",children:(0,z.jsx)(s4.Z,{className:"h-3 w-3"})})]})]}):(0,z.jsx)("p",{className:"text-sm opacity-50",children:"New deployment will be created"}),t.missingFiles.length>0&&(0,z.jsxs)("div",{className:"flex items-center gap-1",children:[(0,z.jsx)("span",{className:"text-sm opacity-50",children:"Missing Files"}),(0,z.jsx)("span",{className:"direction-[rtl] overflow-hidden text-ellipsis break-all px-0.5 text-left text-sm opacity-70",children:(0,z.jsx)("bdi",{children:t.missingFiles.map(e=>e.replace(t.projectPath+"/","")).join(", ")})})]})]})})]})},useReadDeploymentConfigToolStepContribution=e=>{if("readDeploymentConfig"!==e.step.case)return null;let t=e.step.value;return{icon:()=>(0,z.jsx)(ToolStatus,{step:e}),title:()=>(0,z.jsx)("div",{children:isLoadingStatus(e.status)?"Analyzing deployment config":"Deployment config analyzed"}),supplementaryView:()=>(0,z.jsx)(ReadDeploymentConfigStepSupplementaryView,{trajectoryStep:e,step:t,status:e.status}),cta:null}},useToolStepContributions=(e,t)=>{let s=useErrorStepContribution(e),a=useCodeActionToolStepContribution(e,t),n=useWorkflowStepContribution(e),r=useGrepSearchStepContribution(e),o=useFindStepContribution(e),i=useViewCodeItemToolStepContribution(e),l=useCommandToolStepContribution(e),c=useCommandStatusToolStepContribution(e),d=useMQueryStepContribution(e),u=useSearchWebStepContribution(e),m=useViewContentChunkToolStepContribution(e),p=useCreateWorkflowToolStepContribution(e),x=useListDirToolStepContribution(e),h=useReadUrlContentStepContribution(e),g=useViewFileToolStepContribution(e),f=useMcpToolStepContribution(e),y=useProposedCodeStepContribution(e),v=useProxyWebServerStepContribution(e,t),C=useDeployStepContribution(e,t),w=useReadDeploymentConfigToolStepContribution(e),b=[s,a,n,r,o,i,l,c,d,y,u,m,p,x,h,g,f,v,C,w].find(e=>null!==e);return null!=b?b:null},useNonStandardCreditReason=e=>{let t=(0,X.useId)();if(!e||0===e.length)return{element:null};let s=null;return e.includes(eS.Oxl.LINT_FIXING_DISCOUNT)&&(s=()=>(0,z.jsxs)("div",{className:"flex items-center",children:[(0,z.jsx)("span",{className:"text-sm opacity-80",children:"No credits consumed by lint-fixing edit"}),(0,z.jsx)(ns.Z,{className:"ml-1 h-4 w-4 opacity-50 hover:opacity-100","data-tooltip-id":t}),(0,z.jsx)(CompactTooltip,{id:t,children:(0,z.jsx)("div",{className:"max-w-[80vw] space-y-2 p-1 sm:max-w-[400px]",children:"Cascade made this edit intending to fix lints it auto-detected previously. The model decides when an edit is fixing lints; if it is, no credits are consumed."})})]})),{element:s}},RenderedToolStepContribution=e=>{let{contribution:t,stepMetadata:s,debugMode:a,trajectoryId:n,stepIndex:r}=e,o=null==s?void 0:s.nonStandardCreditReasons,i=useNonStandardCreditReason(o).element;return(0,z.jsxs)("div",{className:"flex flex-col rounded border-[1px] border-gray-500/25",children:[(0,z.jsxs)("div",{className:(0,ti.classNames)("group flex w-full min-w-0 items-center justify-between py-1 pl-1 pr-2",t.supplementaryView?"border-b-[1px] border-gray-500/25":""),children:[(0,z.jsxs)("div",{className:"flex min-w-0 flex-1 items-center gap-2",children:[t.icon(),(0,z.jsx)("div",{className:"truncate",children:t.title()})]}),t.cta&&(0,z.jsx)("div",{className:"ml-1 flex-shrink-0",children:t.cta(r)})]}),(0,z.jsxs)("div",{className:"bg-gray-500/10",children:[i&&!t.omitNonStandardCreditReasons&&(0,z.jsx)("div",{className:(0,ti.classNames)("px-2 py-1 text-sm",t.supplementaryView?"border-b-[1px] border-gray-500/25":""),children:i()}),t.supplementaryView&&t.supplementaryView(n,r,a)]})]})},getInteraction=(e,t,s)=>{switch(s.step.case){case"runCommand":return(0,z.jsx)(CascadeBinaryInteraction,{headerText:"Do you want to run this command?",trajectoryId:e,stepIndex:t});case"deployWebApp":return(0,z.jsx)(CascadeBinaryInteraction,{headerText:"Do you want to deploy this web app?",trajectoryId:e,stepIndex:t});default:return null}},CascadeStepItem=e=>{let{step:t,stepIndex:s,startingStepIndex:a,trajectoryId:n,debugMode:r,onCancelStep:o,nuxRef:i,sendMessage:l}=e,{hasDevExtension:c}=useChatParamsContext(),d=a+s,onCancel=()=>{o([d])},u=useToolStepContributions(t,{absoluteStepIndex:d,onCancelStep:onCancel});if(null!==u)return(0,z.jsxs)("div",{ref:i,className:"relative",children:[(0,z.jsx)(RenderedToolStepContribution,{contribution:u,stepMetadata:t.metadata,debugMode:r,stepIndex:d,trajectoryId:n}),r&&c&&(0,z.jsx)(aV,{step:t})]});let m=null;return t.status===eS.V_N.WAITING&&(m=getInteraction(n,a+s,t)),(0,z.jsx)("div",{ref:i,className:"relative min-h-8 rounded border-[1px] border-gray-500/25 py-1 pl-1 pr-2",children:(0,z.jsxs)("div",{className:"group flex flex-row items-start gap-2",children:[(0,z.jsx)(ToolStatus,{step:t}),(0,z.jsxs)("div",{className:"flex w-full min-w-0 flex-col items-start",children:[(0,z.jsx)(aY,{step:t,stepIndex:a+s,debugMode:r,sendMessage:l}),m&&(0,z.jsx)("div",{className:"mt-1",children:m})]}),isCancelableStatus(t.status)&&(0,z.jsx)(ToolCancel,{onCancel:onCancel})]})})};var nf=s(81260);let CascadeInlineNUX=e=>{let{render:t,componentRef:s,children:a,place:n="below",dismissNux:r,activeNux:o}=e,{layout:{scrollRef:i,containerRef:l}}=useCascadeContext(),{logEvent:c}=useServerConnectionContext(),[d,u]=(0,X.useState)(0),m=(0,X.useRef)(null);return((0,tO.O)(m,()=>{r()}),(0,X.useEffect)(()=>{let e=null==s?void 0:s.current;if(t&&e){var a;let t=e.getBoundingClientRect(),s=window.innerWidth/100*2.5,n=t.left-s;if(u(n),i.current&&l.current){let e=l.current.getBoundingClientRect().top,s=t.top-e;i.current.scrollTo({top:s-window.innerHeight/3,behavior:"smooth"})}c(et.tbr.CASCADE_IMPRESSION_EVENT,{type:o&&null!==(a=(0,ti.enumToString)(o,et.NQJ))&&void 0!==a?a:"unknown"})}},[t,s,i,l,o,c]),t&&(null==s?void 0:s.current))?(0,z.jsx)(z.Fragment,{children:(0,nf.createPortal)((0,z.jsxs)("div",{ref:m,className:(0,eG.classNames)("absolute left-0 z-[10001] w-[95vw] rounded bg-gray-500 text-ide-button-color shadow-sm","above"===n?"top-0 -translate-y-[calc(100%_+_1rem)]":"translate-y-4"),style:{marginLeft:"".concat(-1*d,"px")},children:[(0,z.jsx)("div",{className:"absolute inset-0 rounded bg-ide-button-background"}),(0,z.jsxs)("div",{className:(0,eG.classNames)("absolute z-[-1]","above"===n?"bottom-0.5":"-top-[calc(0.45rem)]"),style:{left:"".concat(Math.max(8,d),"px")},children:[(0,z.jsx)("div",{className:(0,eG.classNames)("absolute left-1 top-0 h-0 w-0","above"===n?"border-l-[8px] border-r-[8px] border-t-[8px] border-l-transparent border-r-transparent border-t-gray-500":"border-b-[8px] border-l-[8px] border-r-[8px] border-b-gray-500 border-l-transparent border-r-transparent")}),(0,z.jsx)("div",{className:(0,eG.classNames)("absolute left-1 top-0 h-0 w-0","above"===n?"border-l-[8px] border-r-[8px] border-t-[8px] border-l-transparent border-r-transparent border-t-ide-button-background":"border-b-[8px] border-l-[8px] border-r-[8px] border-b-ide-button-background border-l-transparent border-r-transparent")})]}),(0,z.jsx)("div",{className:"relative",children:a})]}),s.current)}):null},isRenderedToolStep=e=>{switch(e.type){case eS.prY.PROPOSE_CODE:case eS.prY.PLAN_INPUT:case eS.prY.GIT_COMMIT:case eS.prY.INFORM:case eS.prY.USER_INPUT:case eS.prY.PLANNER_RESPONSE:case eS.prY.CHECKPOINT:case eS.prY.SUGGESTED_RESPONSES:case eS.prY.MEMORY:case eS.prY.MANAGER_FEEDBACK:case eS.prY.FINISH:case eS.prY.UNSPECIFIED:case eS.prY.DUMMY:case eS.prY.ERROR_MESSAGE:case eS.prY.AUTO_CASCADE_BROADCAST:return!1;case eS.prY.MQUERY:case eS.prY.CODE_ACTION:case eS.prY.GREP_SEARCH:case eS.prY.VIEW_FILE:case eS.prY.LIST_DIRECTORY:case eS.prY.COMPILE:case eS.prY.FILE_BREAKDOWN:case eS.prY.VIEW_CODE_ITEM:case eS.prY.WRITE_TO_FILE:case eS.prY.CLUSTER_QUERY:case eS.prY.LIST_CLUSTERS:case eS.prY.INSPECT_CLUSTER:case eS.prY.RUN_COMMAND:case eS.prY.RELATED_FILES:case eS.prY.FIND:case eS.prY.SEARCH_KNOWLEDGE_BASE:case eS.prY.LOOKUP_KNOWLEDGE_BASE:case eS.prY.COMMAND_STATUS:case eS.prY.CUSTOM_TOOL:case eS.prY.READ_URL_CONTENT:case eS.prY.VIEW_CONTENT_CHUNK:case eS.prY.SEARCH_WEB:case eS.prY.CREATE_RECIPE:case eS.prY.MCP_TOOL:case eS.prY.MCP_TOOL:case eS.prY.FIND:case eS.prY.RELATED_FILES:case eS.prY.SEARCH_KNOWLEDGE_BASE:case eS.prY.RUN_COMMAND:case eS.prY.COMMAND_STATUS:case eS.prY.READ_URL_CONTENT:case eS.prY.VIEW_CONTENT_CHUNK:case eS.prY.SEARCH_WEB:return!0;default:return!1}},CollapsedCascadeSteps=e=>{var t;let{trajectoryId:s,startingStepIndex:a,steps:n,debugMode:r,sendMessage:o}=e,{state:{activeNux:i},events:{dismissNux:l}}=useCascadeUIStateContext(),{layout:{scrollRef:c,containerRef:d},events:{cancelStepIndices:u},state:{cascadeState:m,isRunning:p}}=useCascadeContext(),{unleash:x}=useServerConnectionContext(),{handleShowNux:h}=useNux(),g=(0,X.useRef)(null),f=(0,X.useMemo)(()=>{var e;if(!(null==m?void 0:null===(e=m.trajectory)||void 0===e?void 0:e.steps))return null;for(let e=m.trajectory.steps.length-1;e>=0;e--){let t=m.trajectory.steps[e];if(t&&isRenderedToolStep(t)){if(e<a+n.length&&e>=a)return e;break}}return null},[null==m?void 0:null===(t=m.trajectory)||void 0===t?void 0:t.steps,a,n.length]);(0,X.useEffect)(()=>{if(null!==f){let e=x.isEnabled(et.rpR.CASCADE_TOOL_CALL_NUX);e&&h([et.NQJ.CASCADE_NUX_EVENT_TOOL_CALL])}},[f,h,x]);let y=(0,X.useMemo)(()=>n.filter(e=>e.status!==eS.V_N.CLEARED).filter(e=>null!==getContentForStep(e,()=>{},r)).map((e,t)=>e.status===eS.V_N.CLEARED||null===getContentForStep(e,()=>{},r,o)?null:(0,z.jsx)(CascadeStepItem,{step:e,stepIndex:t,startingStepIndex:a,trajectoryId:s,debugMode:r,onCancelStep:u,nuxRef:f&&a+t===f?g:null,sendMessage:o},a+t)),[n,a,r,s,u,f,o]);if(0===y.length)return null;let handleDismissNux=()=>{d.current&&c.current&&c.current.scrollTo({top:d.current.clientHeight,behavior:"smooth"}),l()};return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(CascadeInlineNUX,{render:!p&&i===et.NQJ.CASCADE_NUX_EVENT_TOOL_CALL&&null!==f&&f>=0,componentRef:g,dismissNux:handleDismissNux,activeNux:i,children:(0,z.jsxs)("div",{className:"z-[1000] flex w-full gap-2 rounded p-2",children:[(0,z.jsx)("div",{className:"grow leading-tight",children:"To view the cost and status of a tool call, hover over the tool call's status icon on the left."}),(0,z.jsx)(tL.Z,{onClick:handleDismissNux,className:"h-4 w-4 flex-none cursor-pointer opacity-50 hover:opacity-100"})]})}),(0,z.jsx)("div",{className:"flex flex-col gap-2",children:y})]})};(b=H||(H={})).USER="user",b.AGGREGATED="aggregated",b.SINGLE_PLANNER="planner_response",b.SUGGESTIONS="suggestions";let CascadeConversationSection=class CascadeConversationSection{static getSectionType(e,t){switch(e.step.case){case"suggestedResponses":return"suggestions";case"userInput":return"user";case"codeAction":case"gitCommit":case"runCommand":case"viewFile":case"retrieveMemory":var s;let a=null===(s=e.metadata)||void 0===s?void 0:s.source;if(a===eS.Kl5.USER_EXPLICIT&&(t===eS.fjq.CASCADE||t===eS.fjq.AUTO_CASCADE))return"user";return"aggregated";case"plannerResponse":case"planInput":return"planner_response";default:return"aggregated"}}size(){return this.steps.length}isEmpty(e){return 0===this.steps.map(t=>null!==getContentForStep(t,()=>{},e,()=>{})).filter(Boolean).length}addStep(e){this.steps.push(e)}getUserStep(){for(let e of this.steps)if("userInput"===e.step.case)return e}getCodeActionSteps(){let e=[];for(let t of this.steps)"codeAction"===t.step.case&&e.push(t);return e}getRunCommandSteps(){let e=[];for(let t of this.steps)"runCommand"===t.step.case&&e.push(t);return e}render(e,t,s,a,n){switch(this.sectionType){case"planner_response":case"suggestions":return(0,z.jsx)(aY,{step:this.firstStep,stepIndex:this.firstStepIndex,revertToStepFn:a,sendMessage:n,debugMode:s},t);case"user":{let e=this.getUserStep();if(!e)return(0,z.jsx)(z.Fragment,{});return(0,z.jsx)(CascadeUserSection,{userStep:e,startingStepIndex:this.firstStepIndex,codeActionSteps:this.getCodeActionSteps(),runCommandSteps:this.getRunCommandSteps(),createdAt:this.createdAt},t)}default:return(0,z.jsx)(CollapsedCascadeSteps,{trajectoryId:e,startingStepIndex:this.firstStepIndex,steps:this.steps,debugMode:s,sendMessage:n},t)}}constructor(e,t,s){var a;this.steps=[],this.firstStep=e,this.steps=[e],this.firstStepIndex=t,this.sectionType=CascadeConversationSection.getSectionType(e,s),this.createdAt=null===(a=e.metadata)||void 0===a?void 0:a.createdAt}};var ny=s(85200),nv=s(14555),nC=s(87893),nw=s(65087);let nb=(0,X.memo)(e=>{var t,s,a,n;let{isExpanded:r,steps:o}=e,{state:{cascadeState:i}}=useCascadeContext(),l=(0,X.useId)(),c=(0,X.useMemo)(()=>{var e,t;if(!i||!o)return!0;let s=o[0],a=null==s?void 0:null===(t=s.metadata)||void 0===t?void 0:null===(e=t.createdAt)||void 0===e?void 0:e.seconds;return!a||a<new Date(2025,1,5).getTime()/1e3},[i,o]),d=(0,X.useMemo)(()=>{var e,t,s;if(!r||!i||!o)return null;let a=o.filter(e=>e.type===eS.prY.RUN_COMMAND).length,n=o.filter(e=>e.type===eS.prY.CODE_ACTION).map(e=>getPathFromCodeAction(e.step.value)).reduce((e,t)=>(t&&e.add(t),e),new Set),l=(null!==(s=null===(t=o.find(e=>e.type===eS.prY.USER_INPUT))||void 0===t?void 0:null===(e=t.metadata)||void 0===e?void 0:e.promptCreditsUsed)&&void 0!==s?s:0)/100;return{creditsSpent:o.reduce((e,t)=>{var s,a;return e+(null!==(a=null===(s=t.metadata)||void 0===s?void 0:s.flowCreditsUsed)&&void 0!==a?a:0)/100},0)+l,toolCalls:o.reduce((e,t)=>e+(isRenderedToolStep(t)?1:0),0),filesChanged:n.size,terminalsCreated:a}},[o,i,r]);return r?(0,z.jsxs)("div",{className:"mt-2 w-full rounded-md border border-gray-500/10 bg-ide-editor-background text-sm shadow-sm",children:[(0,z.jsx)("div",{className:"px-2 pt-2",children:(0,z.jsx)("div",{className:"pb-1 text-[0.6rem] font-medium text-ide-editor-color",children:"RESPONSE SUMMARY"})}),(0,z.jsxs)("div",{className:"grid grid-cols-3 gap-4 border-b border-gray-500/10 px-2 pb-2",children:[c?null:(0,z.jsxs)("div",{children:[(0,z.jsx)("div",{className:"opacity-70",children:"Credits spent"}),(0,z.jsxs)("div",{className:"flex items-center",children:[null==d?void 0:d.creditsSpent," ",(null==d?void 0:d.creditsSpent)===1?"credit":"credits",(0,z.jsx)(nl.Z,{className:"ml-1 inline-block h-3.5 w-3.5","data-tooltip-id":l}),(0,z.jsx)(CompactTooltip,{id:l,children:(0,z.jsx)("div",{className:"max-w-[300px]",children:"Note: Credits spent on background processes will be added upon completion."})})]})]}),(0,z.jsxs)("div",{children:[(0,z.jsx)("div",{className:"opacity-70",children:"Tool calls"}),(0,z.jsxs)("div",{children:[null==d?void 0:d.toolCalls," ",(null==d?void 0:d.toolCalls)===1?"call":"calls"]})]}),c&&1e3*Number(null!==(n=null==o?void 0:null===(a=o[0])||void 0===a?void 0:null===(s=a.metadata)||void 0===s?void 0:null===(t=s.createdAt)||void 0===t?void 0:t.seconds)&&void 0!==n?n:Number.MAX_SAFE_INTEGER)<new Date(2025,1,5).getTime()?(0,z.jsxs)("div",{className:"col-span-2",children:[(0,z.jsx)("div",{className:"opacity-70",children:"Credits spent"}),(0,z.jsx)("div",{className:"text-sm",children:"Available to responses created after Windsurf version 1.3.0."})]}):null]}),(0,z.jsx)("div",{className:"px-2 pb-1 pt-2",children:(0,z.jsx)("div",{className:"text-[0.6rem] font-medium",children:"TOOL CALL SUMMARY"})}),(0,z.jsxs)("div",{className:"grid grid-cols-3 gap-4 px-2 pb-2",children:[(0,z.jsxs)("div",{children:[(0,z.jsx)("div",{className:"opacity-70",children:"Files changed"}),(0,z.jsxs)("div",{children:[null==d?void 0:d.filesChanged," ",(null==d?void 0:d.filesChanged)===1?"file":"files"," ","changed"]})]}),(0,z.jsxs)("div",{children:[(0,z.jsx)("div",{className:"opacity-70",children:"Terminals created"}),(0,z.jsxs)("div",{children:[null==d?void 0:d.terminalsCreated," ",(null==d?void 0:d.terminalsCreated)===1?"process":"processes"," run"]})]})]})]}):null});nb.displayName="CascadeResponseSummary";var nN=s(10113);let CascadeSystemMessageToolbar=e=>{let{endIndex:t}=e,s=(0,X.useId)(),{state:{currentModelConfig:a,conversationalPlannerMode:n,cascadeState:r,cascadeConversationState:o}}=useCascadeContext(),i=null==o?void 0:o.cascadeId,{logEvent:l,props:{openCascadeMemoriesPanel:c,openGenericUrl:d}}=useServerConnectionContext(),[u,m]=(0,X.useState)(""),[p,x]=(0,X.useState)(!1),[h,g]=(0,X.useState)(!1),f=(0,X.useId)(),y=(0,X.useCallback)(e=>{d(e)},[d]),v=(0,X.useCallback)(e=>{var s;p||(l(et.tbr.PROVIDE_MESSAGE_FEEDBACK,{feedback:e,model:a.label,conversationalPlannerMode:n.toString(),trajectoryId:(null==r?void 0:null===(s=r.trajectory)||void 0===s?void 0:s.trajectoryId)||"",cascadeId:i||"",stepIndex:t.toString()}),x(!1))},[l,a.label,n,r,i,p,t]),C=(0,X.useMemo)(()=>sO().debounce(v,3e3),[v]);(0,X.useEffect)(()=>()=>{C.flush()},[C]);let w=(0,X.useCallback)(()=>{C("positive"),m("positive")},[C]),b=(0,X.useCallback)(()=>{C("negative"),m("negative")},[C]),N=(0,X.useMemo)(()=>{var e,s,a;let n=null==r?void 0:null===(s=r.trajectory)||void 0===s?void 0:null===(e=s.steps.slice(0,t+1).map((e,t)=>({step:e,index:t})).reverse().find(e=>{let{step:t}=e;return t.type===eS.prY.USER_INPUT}))||void 0===e?void 0:e.index;if(void 0!==n&&!(n<0))return null==r?void 0:null===(a=r.trajectory)||void 0===a?void 0:a.steps.slice(n,t+1)},[r,t]),{autogeneratedMemoryTitles:S}=(0,X.useMemo)(()=>{if(!N)return{autogeneratedMemoryTitles:[]};let e=N.filter(e=>e.type===eS.prY.MEMORY),t=[];if(e.length>0){for(let s of e)if("memory"===s.step.case){let e=s.step.value,a=e.memory;if(a){let s=a.memory;a.source===eS.Szv.CASCADE&&"textMemory"===s.case&&t.push({title:a.title,action:e.action})}}}return{autogeneratedMemoryTitles:t}},[N]),j=S.length>0?(0,z.jsxs)("div",{className:"mt-4 flex flex-col justify-between rounded bg-gray-500/15",children:[(0,z.jsxs)("div",{className:"flex items-center justify-between border-b border-gray-500/25 px-2 py-1",children:[(0,z.jsxs)("div",{className:"flex items-center gap-1 overflow-hidden pr-2",children:[(0,z.jsx)(nl.Z,{onClick:()=>{y("https://codeium.com/redirect/windsurf/autogenerated-memories")},"data-tooltip-id":f,className:"h-3.5 w-3.5 flex-none cursor-pointer opacity-50 transition-[opacity] hover:opacity-100"}),(0,z.jsx)("div",{className:"overflow-hidden text-ellipsis whitespace-nowrap opacity-70",children:S.length>1?"Auto-generated memories were updated":"Auto-generated memory was updated"}),(0,z.jsx)(CompactTooltip,{id:f,children:(0,z.jsxs)("div",{className:"flex max-w-[90vw] flex-col gap-1",children:[(0,z.jsx)("div",{children:"Cascade can automatically generate and store memories if it encounters context that it believes is useful to remember."}),(0,z.jsx)("div",{children:"Additionally, you can ask Cascade to create a memory at any time. Just prompt Cascade to create a memory of ."})]})})]}),(0,z.jsxs)("div",{onClick:c,className:"group flex cursor-pointer items-center gap-1 opacity-70 transition-[opacity] hover:opacity-100",children:["Manage",(0,z.jsx)(ny.Z,{className:"h-3.5 w-3.5 translate-x-0 transition-[transform] group-hover:translate-x-[0.125rem]"})]})]}),(0,z.jsx)("div",{className:"px-2 py-1",children:S.map((e,t)=>(0,z.jsxs)("div",{className:"opacity-50",children:[e.action===eS.o2G.CREATE?"Created":e.action===eS.o2G.DELETE?"Deleted":"Updated"," ",'"'+e.title+'"'," memory."]},t))})]}):null;return(0,z.jsxs)("div",{children:[(0,z.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,z.jsxs)("div",{className:"flex flex-row items-center justify-between gap-1",children:[(0,z.jsxs)("div",{className:"ws-xs:flex relative hidden h-4 w-[10rem] text-xs opacity-50",children:[(0,z.jsx)("span",{className:(0,nN.A)("absolute left-0 top-1/2 transition-[transform,opacity] duration-200",u?"-translate-y-[150%] opacity-0":"-translate-y-1/2 opacity-100"),children:"Done"}),(0,z.jsx)("span",{className:(0,nN.A)("absolute left-0 top-1/2 whitespace-nowrap transition-[transform,opacity] duration-200",u?"-translate-y-1/2 opacity-100":"translate-y-1/2 opacity-0"),children:"Feedback has been submitted"})]}),(0,z.jsxs)("div",{className:"flex flex-row items-center gap-1",children:[(0,z.jsx)(nv.Z,{onClick:b,"data-tooltip-id":"down-".concat(s),className:(0,nN.A)("h-4 w-4 cursor-pointer transition-[opacity,transform] duration-200",""===u?"opacity-70 hover:opacity-100":"","negative"===u?"opacity-100":"","positive"===u?"opacity-30":"")}),(0,z.jsx)(nC.Z,{onClick:w,"data-tooltip-id":"up-".concat(s),className:(0,nN.A)("h-4 w-4 cursor-pointer transition-[opacity,transform] duration-200",""===u?"opacity-70 hover:opacity-100":"","positive"===u?"opacity-100":"","negative"===u?"opacity-30":"")}),!u&&(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(CompactTooltip,{id:"up-".concat(s),children:"Good response"}),(0,z.jsx)(CompactTooltip,{id:"down-".concat(s),children:"Bad response"})]}),(0,z.jsx)("div",{className:"mx-1 h-4 w-px bg-gray-200 dark:bg-gray-700"}),(0,z.jsxs)("div",{className:"flex items-center",children:[(0,z.jsx)(nw.Z,{onClick:()=>{g(e=>!e)},className:(0,nN.A)("h-4 w-4 cursor-pointer transition-opacity",h?"opacity-100":"opacity-70 hover:opacity-100"),"data-tooltip-id":"chart-summary"}),(0,z.jsx)(CompactTooltip,{id:"chart-summary",children:"View response summary"})]})]})]}),(0,z.jsx)(nb,{isExpanded:h,steps:N})]}),j]})},CortexTrajectory=e=>{let{trajectory:t,defaultIsOpen:s,revertToStepFn:a,isRunning:n=!1,debugMode:r=!1,isSubtrajectory:o=!1,triggerScroll:i}=e,{layout:{focusEditor:l},state:{hasChanged:c,showIdSwitchModal:d},events:{hideIdSwitchModal:u,clearCascadeId:m,sendMessage:p}}=useCascadeContext(),x=(0,X.useRef)(null),[h,g]=(0,X.useState)(0);(0,X.useEffect)(()=>{let e=setInterval(()=>{g(e=>e+1)},100);return()=>{clearInterval(e)}},[]),useHandleOpenDiffZones(t.cascadeId);let{stepNodes:f,lastUpdate:y,lastUserStepIndex:v}=(0,X.useMemo)(()=>{let e=t.steps.reduce((e,s,a)=>{if(0===e.length)e.push(new CascadeConversationSection(s,a,t.trajectoryType));else{let n=e[e.length-1];n&&("retrieveMemory"===s.step.case||"checkpoint"===s.step.case)?n.addStep(s):(null==n?void 0:n.getUserStep())&&"userInput"===s.step.case?e.push(new CascadeConversationSection(s,a,t.trajectoryType)):n&&CascadeConversationSection.getSectionType(s,t.trajectoryType)===n.sectionType&&n.sectionType!==H.SINGLE_PLANNER?n.addStep(s):e.push(new CascadeConversationSection(s,a,t.trajectoryType))}return e},[]),s=-1;return e.forEach((e,t)=>{e.sectionType===H.USER&&(s=t)}),{stepNodes:e.map((n,i)=>{if(n.sectionType===H.SUGGESTIONS)for(let t=i+1;t<e.length;t++){let s=e[t];if(s&&s.sectionType===H.USER)return null}if(n.isEmpty(r))return null;let l=e.findIndex(e=>e.sectionType===H.USER);return(0,z.jsxs)(X.Fragment,{children:[n.sectionType!==H.USER||i===l||o?null:(0,z.jsx)(CascadeSystemMessageToolbar,{endIndex:n.firstStepIndex-1}),(0,z.jsx)("div",{ref:i===s?x:null,children:n.render(t.trajectoryId,i,r,a,p)})]},i)}),lastUpdate:Date.now(),lastUserStepIndex:s}},[n,c,s,a,r,t.trajectoryId,o]);(0,X.useEffect)(()=>{i&&x.current&&i(x.current)},[v,i]);let{isLoading:C}=(0,X.useMemo)(()=>{if(!n)return{isLoading:!1};let e=t.steps[t.steps.length-1];if(!e)return{isLoading:!1};let s=new Date().getTime();return s-y<500?{isLoading:!1}:{isLoading:!0,lastStepStatus:e.status}},[t.steps,y,n,h]),w=t.steps.filter(e=>e.type!==eS.prY.CHECKPOINT),b=w.length>0?w[w.length-1]:void 0;return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(aW.Modal,{open:d,handleClose:u,hideCloseButton:!0,className:"bg-ide-editor-background text-ide-text-color",children:(0,z.jsxs)("div",{className:"bg-ide-editor-background p-2 text-center",children:[(0,z.jsx)("h2",{className:"mb-3 text-xl font-semibold text-ide-text-color",children:"Are you sure?"}),(0,z.jsx)("p",{className:"mb-5 text-sm text-ide-caption-color",children:"Switching workflows will automatically accept all pending changes and terminate all running commands."}),(0,z.jsxs)("div",{className:"flex justify-center space-x-4",children:[(0,z.jsx)("button",{onClick:u,className:"bg-ide-button-secondary-background hover:bg-ide-button-secondary-hover-background text-ide-button-secondary-color hover:text-ide-button-secondary-hover-color rounded border  px-4 py-2 text-sm",children:"Cancel"}),(0,z.jsx)("button",{onClick:()=>{m(!0),u(),setTimeout(()=>{l()},50)},className:"rounded bg-ide-button-background px-4 py-2 text-sm text-ide-button-color transition-colors",children:"Confirm"})]})]})}),r&&(0,z.jsxs)("div",{className:"ml-2 mt-2 flex flex-col text-sm opacity-50",children:[(0,z.jsxs)("span",{children:["Trajectory ID:"," ",(0,z.jsx)("a",{className:"text-blue-500 underline hover:text-blue-700",href:"https://exafunction.retool.com/app/trajectory?_releaseVersion=latest#detailOnly=true&trajectoryId=".concat(t.trajectoryId,"&genMetadataIter=").concat(t.generatorMetadata.length||1),target:"_blank",rel:"noopener noreferrer",children:t.trajectoryId})]}),(0,z.jsxs)("span",{children:["Cascade ID: ",t.cascadeId]})]}),(0,z.jsxs)("div",{className:"flex flex-col gap-y-4 px-4",children:[f,!x.current||n||o?null:(0,z.jsx)(CascadeSystemMessageToolbar,{endIndex:t.steps.length-1}),(0,z.jsx)(CascadeLoading,{isLoading:C,lastStep:b,lastUpdate:y})]})]})},CortexDebug=()=>{let{lsClient:e}=useServerConnectionContext(),[t,s]=(0,X.useState)([]),[a,n]=(0,X.useState)(void 0),r=useChatParamsContext(),{homeDir:o,workspaceUris:i}=useWorkspaceInfoContext(),l=(0,X.useCallback)(()=>{null==e||e.getUserTrajectoryDebug(new ei.dTT({})).then(e=>{s(e.mainline),n(e.granular)}).catch(e=>{console.error(e)})},[e,s,n]),c=(0,X.useMemo)(()=>(console.log("mainline_trajectories: ",t),t.reverse().map((t,s)=>{if(void 0===t.trajectory)return null;let a=void 0!==t.trajectoryScope?getHeaderFromTrajectoryScope(t.trajectoryScope,o,i):getHeaderForTrajectory(t.trajectory),n=(0,z.jsxs)(z.Fragment,{children:[(0,z.jsxs)("div",{className:"flex flex-row gap-2",children:[(0,z.jsx)(su.Button,{size:"tiny",kind:"outlined",onClick:()=>{var s;e&&(null===(s=t.trajectory)||void 0===s?void 0:s.trajectoryId)&&e.forceBackgroundResearchRefresh({metadata:getMetadata(r),mainlineTrajectoryId:t.trajectory.trajectoryId,blocking:!0,fullRefresh:!1}).then(()=>{l()}).catch(e=>{console.error(e)})},children:"Update Research (Fast)"}),(0,z.jsx)(su.Button,{size:"tiny",kind:"outlined",color:"gray",onClick:()=>{var s;e&&(null===(s=t.trajectory)||void 0===s?void 0:s.trajectoryId)&&e.forceBackgroundResearchRefresh({metadata:getMetadata(r),mainlineTrajectoryId:t.trajectory.trajectoryId,blocking:!1,fullRefresh:!0}).then(()=>{l()}).catch(e=>{console.error(e)})},children:"Update Research (Full)"})]}),(0,z.jsx)(aM.Accordion,{title:getHeaderForTrajectory(t.trajectory),children:(0,z.jsx)(CortexTrajectory,{trajectory:t.trajectory,debugMode:!0})},s)]}),c=null;if(void 0!==t.backgroundResearch){var d;let e=t.backgroundResearch,a=0;if(e.parentReferences.length>0){let t=e.parentReferences[e.parentReferences.length-1];t&&(a=Math.min(t.stepIndex+1,e.steps.length-1))}let n=new eS.yPW(structuredClone(e));n.steps=n.steps.slice(a),c=(0,z.jsxs)(aM.Accordion,{title:getHeaderForTrajectory(n),children:[n.parentReferences.length>0&&(0,z.jsxs)("span",{children:["branched at"," ",null===(d=n.parentReferences[n.parentReferences.length-1])||void 0===d?void 0:d.stepIndex]}),(0,z.jsx)(CortexTrajectory,{trajectory:n,debugMode:!0})]},s)}return(0,z.jsxs)(aM.Accordion,{title:a,defaultIsOpen:0===s,children:[n,c]},s)})),[t,l,e,r,o,i]),d=(0,X.useMemo)(()=>{if(a)return(0,z.jsx)(aM.Accordion,{title:getHeaderForTrajectory(a),children:(0,z.jsx)(CortexTrajectory,{trajectory:a})})},[a]);return(0,z.jsx)("div",{children:(0,z.jsx)(aM.Accordion,{title:(0,z.jsx)("h4",{className:"m-2",children:"Cortex Debug"}),defaultIsOpen:!0,children:(0,z.jsxs)("div",{className:"ml-2",children:[(0,z.jsx)(su.Button,{size:"tiny",color:"primary",onClick:l,children:"Refresh Trajectories"}),(0,z.jsx)("h6",{className:"mt-4",children:"Mainline Trajectories"}),0===t.length?(0,z.jsx)("div",{className:"m-2",children:"No mainline trajectories"}):(0,z.jsx)("div",{className:"m-2 flex flex-col",children:c}),(0,z.jsx)("h6",{className:"mt-4",children:"Granular Trajectory"}),a?(0,z.jsx)("div",{className:"m-2 flex flex-col",children:d}):(0,z.jsx)("div",{className:"m-2",children:"No granular trajectory"})]})})})},Debug=()=>{let{handleOpenChat:e}=useNavigationContext();return(0,z.jsxs)("div",{className:"flex w-full flex-grow flex-col overflow-auto p-2",children:[(0,z.jsx)("div",{className:"mb-4 flex flex-row items-end justify-end px-2",children:(0,z.jsx)(tL.Z,{onClick:e,className:"h-6 w-6 cursor-pointer rounded p-1 hover:bg-gray-500/20"})}),(0,z.jsx)(CortexDebug,{})]})},useDragImage=e=>{let{onImageDrop:t}=e,[s,a]=(0,X.useState)(!1),n=(0,X.useCallback)(e=>{var t;e.preventDefault();let s=Array.from((null===(t=e.dataTransfer)||void 0===t?void 0:t.items)||[]).some(e=>"file"===e.kind&&e.type.startsWith("image/"));a(s)},[]),r=(0,X.useCallback)(e=>{var s;e.preventDefault(),e.stopPropagation(),a(!1);let n=Array.from((null===(s=e.dataTransfer)||void 0===s?void 0:s.files)||[]),r=n.find(e=>e.type.startsWith("image/"));r&&t&&t(r)},[t]),o=(0,X.useCallback)(e=>{e.preventDefault(),a(!1)},[]);return(0,X.useEffect)(()=>(window.addEventListener("dragover",n),window.addEventListener("drop",r),window.addEventListener("dragleave",o),()=>{window.removeEventListener("dragover",n),window.removeEventListener("drop",r),window.removeEventListener("dragleave",o)}),[n,r,o]),{isDraggingImage:s}};var nS=s(86590),nj=s(87683);let TocMessageCard=e=>{let{userStep:t,timestamp:s,revert:a,close:n,scroll:r}=e,[o,i]=(0,X.useState)(!1),{editor:{parsingConfig:l}}=useCascadeContext(),{state:{profilePictureUrl:c},logEvent:d}=useServerConnectionContext(),u=(0,X.useId)(),m=(0,z.jsxs)("div",{className:"flex items-center border-[1px] border-gray-500/25 bg-ide-chat-background",children:[(0,z.jsx)("div",{className:"cursor-pointer p-1 opacity-70 hover:opacity-100",onClick:()=>{a(),i(!1),d(et.tbr.CASCADE_CLICK_EVENT,{type:"revert-step"})},"data-tooltip-id":"".concat(u,"-confirm"),children:(0,z.jsx)(aq.Z,{className:"h-4 w-4 text-green-500"})}),(0,z.jsx)("div",{className:"cursor-pointer p-1 opacity-70 hover:opacity-100",onClick:()=>{i(!1)},"data-tooltip-id":"".concat(u,"-cancel"),children:(0,z.jsx)(aG.Z,{className:"h-4 w-4 text-red-500"})}),(0,z.jsx)(CompactTooltip,{place:"bottom",id:"".concat(u,"-confirm"),children:"Confirm revert"}),(0,z.jsx)(CompactTooltip,{place:"bottom",id:"".concat(u,"-cancel"),children:"Cancel revert"})]});return(0,z.jsxs)("div",{className:"flex h-min flex-col rounded border-[1px] border-gray-500/25 bg-ide-editor-background",children:[(0,z.jsxs)("div",{className:"flex items-center justify-between border-b-[1px] border-gray-500/25 px-2 py-1",children:[(0,z.jsx)("span",{className:"whitespace-nowrap text-sm opacity-50",children:s?eP()(s.toDate()).format("MMM D, LT"):""}),(0,z.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,z.jsxs)("div",{className:"relative",children:[(0,z.jsxs)(HeaderButton,{onClick:()=>{i(e=>!e)},children:[(0,z.jsx)("span",{className:"hidden [@media(min-width:500px)]:inline",children:"Revert to"}),(0,z.jsx)(nS.Z,{className:"h-4 w-4"})]}),o&&(0,z.jsx)("div",{className:"absolute -top-1.5 left-[50%] -translate-x-1/2 -translate-y-full",children:m})]}),(0,z.jsxs)(HeaderButton,{onClick:r,children:[(0,z.jsx)("span",{className:"hidden [@media(min-width:500px)]:inline",children:"Scroll to"}),(0,z.jsx)(nj.Z,{className:"h-4 w-4"})]}),(0,z.jsxs)(HeaderButton,{onClick:n,children:[(0,z.jsx)("span",{className:"hidden [@media(min-width:500px)]:inline",children:"Close"}),(0,z.jsx)(as.Z,{className:"h-4 w-4 [@media(min-width:500px)]:hidden"})]})]})]}),(0,z.jsxs)("div",{className:"flex items-start gap-2 px-2 py-2",children:[(0,z.jsx)("div",{className:"flex h-5 min-h-[1.25rem] w-5 min-w-[1.25rem] grow-0 flex-row items-center justify-center overflow-hidden rounded-full bg-ide-message-block-user-background bg-clip-content text-ide-message-block-user-color",children:c?(0,z.jsx)("img",{src:c,alt:"Me",className:"h-full w-full object-cover"}):(0,z.jsx)("p",{className:"m-0 flex w-full flex-row items-center justify-center text-center text-[0.5rem] font-bold",children:"Me"})}),(0,z.jsx)(TextOrScopeItemView,{value:t.items,parsingConfig:l})]})]})},HeaderButton=e=>{let{onClick:t,children:s}=e;return(0,z.jsx)("span",{role:"button",onClick:t,className:"flex cursor-pointer select-none items-center gap-0.5 whitespace-nowrap opacity-50 hover:opacity-80",children:s})};function rangeQuery(e,t,s){let a=[];if(t<0||t>=e.length)return a;let n=e[t];if(void 0===n)return a;let r=n.value;for(let t=0;t<e.length;t++){let n=e[t];if(void 0!==n){let e=Math.abs(n.value-r);e<=s&&a.push(t)}}return a}let TableOfContents=e=>{let{trajectory:t}=e,[s,a]=(0,X.useState)(null),{state:{userSectionRefs:n}}=useCascadeUIStateContext(),{layout:{scrollRef:r}}=useCascadeContext(),{events:{revertToStep:o}}=useCascadeContext(),i=(0,X.useMemo)(()=>t.steps.map((e,t)=>{if("userInput"===e.step.case){var s;let a=null===(s=e.metadata)||void 0===s?void 0:s.createdAt;return void 0===a?(console.warn("No timestamp found for step",e),null):{userStep:e.step.value,timestamp:a,index:t,revert:()=>{o(t-1)},scroll:()=>{let e=n.get(t);if(null==e?void 0:e.current){var s;null===(s=r.current)||void 0===s||s.scrollTo({behavior:"smooth",top:e.current.offsetTop-32})}}}}return null}).filter(e=>null!==e),[t.steps,o,n,r]),l=(0,X.useMemo)(()=>{let e=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;if(0===e.length)return[];let a=Date.now(),n=e.map(e=>(a-e.toDate().getTime())/6e4),r=n.map(e=>Math.log(1+e)),o=r.map((e,t)=>({value:e,originalIndex:t}));o.sort((e,t)=>e.value-t.value);let i=Array(o.length);for(let e=0;e<i.length;e++)i[e]=!1;let l=Array(o.length);for(let e=0;e<l.length;e++)l[e]=-1;let c=0;for(let e=0;e<o.length;e++){if(i[e])continue;i[e]=!0;let a=rangeQuery(o,e,t);if(a.length<s)l[e]=-1;else{l[e]=c;let n=[...a],r=0;for(;r<n.length;){let e=n[r];if(void 0===e){r++;continue}if(!i[e]){i[e]=!0;let a=rangeQuery(o,e,t);a.length>=s&&n.push(...a.filter(e=>!n.includes(e)))}-1===l[e]&&(l[e]=c),r++}c++}}let d=[];for(let e=0;e<c;e++)d.push([]);let u=[];for(let e=0;e<o.length;e++){let t=l[e],s=o[e];if(void 0!==s&&void 0!==t){if(-1===t)u.push(s.originalIndex);else if(t>=0&&t<d.length){let e=d[t];void 0!==e&&e.push(s.originalIndex)}}}let m=[...d];for(let e of u)m.push([e]);return m}(i.map(e=>e.timestamp));return e.map(e=>Math.min(...e))},[i]),handleMouseOver=e=>{a(e)};return(0,z.jsxs)("div",{className:"relative px-1 py-2 pl-2",children:[(0,z.jsx)("div",{className:"absolute inset-0 rounded border-[1px] border-gray-500/15 bg-ide-editor-background"}),(0,z.jsxs)("div",{className:"flex flex-col items-stretch",children:[(0,z.jsx)("div",{className:"relative flex items-center justify-between gap-2 text-xs",children:(0,z.jsx)("span",{children:"Messages"})}),i.map((e,t)=>{let{userStep:n,timestamp:r,index:o,revert:i,scroll:c}=e,d=s&&s===n,u=l.includes(t);return(0,z.jsxs)("div",{onMouseOver:()=>{handleMouseOver(n)},onMouseLeave:()=>{a(null)},className:"group relative flex items-center justify-end opacity-30 transition-[opacity] hover:opacity-100",children:[(0,z.jsxs)("div",{className:"flex cursor-pointer items-center gap-1",onClick:c,children:[u&&(0,z.jsx)("div",{className:"text-xs",children:eP()(1e3*Number(r.seconds)).fromNow()}),(0,z.jsx)("div",{className:(0,eG.classNames)("my-1 h-[1px] min-w-[2rem] bg-ide-editor-color",d&&!u?"w-[2.5rem]":"")})]}),d&&(0,z.jsx)("div",{className:"absolute -top-2 right-0 w-[64vw] translate-x-full py-2 pl-4 pr-2",children:(0,z.jsx)(TocMessageCard,{userStep:n,timestamp:r,revert:i,scroll:()=>{c(),a(null)},close:()=>{a(null)}})})]},o)})]})]})};var nE=s(39262),nI=s(63996),nT=s(24938);let parseAtMentionsAndMarkdownNodes=(e,t)=>{let s=t.flatMap(t=>{let s=t.findMatches(e);return s?s.map(e=>({match:e})):[]}),a=Array.from(e.matchAll(/@\[(.*?)\]/g));s.push(...a.map(e=>({match:e[0]}))),s.sort((t,s)=>e.indexOf(t.match)-e.indexOf(s.match));let n=[],r=e;for(let{match:e}of s){let t=r.indexOf(e);if(-1===t)continue;let s=r.substring(0,t);if(s&&n.push({type:"text",content:s}),e){var o;let t=null===(o=e.match(/\[(.*?)\]/))||void 0===o?void 0:o[1];t&&n.push({type:"pill",content:t})}r=r.substring(t+e.length)}return r&&n.push({type:"text",content:r}),n},formatDistanceToNow=e=>{let t=(0,nT.Z)(e);for(let[e,s]of Object.entries({hour:"h",day:"d",week:"w",minute:"m",second:"s"}))if(t.endsWith(" ".concat(e,"s"))||t.endsWith(" ".concat(e)))return t.replace(new RegExp("\\s*".concat(e,"s?$")),s);return t},CascadeConversationPill=e=>{let{cascadeConversationState:t,summary:s,onClick:a}=e,{events:{deleteConversation:n,deleteAsyncConversation:r},editor:{parsingConfig:o}}=useCascadeContext(),i=null==t?void 0:t.cascadeId,{logEvent:l}=useServerConnectionContext(),[c,d]=(0,X.useState)(!1),u=s.lastModifiedTime?formatDistanceToNow(new Date(s.lastModifiedTime.toDate())):void 0;return(0,z.jsxs)("button",{onClick:()=>{l(et.tbr.CASCADE_CLICK_EVENT,{type:"open-past-conversation"}),a()},className:"group flex h-[30px] w-full flex-grow flex-row items-center justify-between rounded bg-gray-500/5 px-2 text-left hover:bg-gray-500/25 md:w-[calc((100%-1.5rem)/3)] md:max-w-[calc((100%-1.5rem)/3)]",title:s.summary,children:[(0,z.jsx)("div",{className:"flex w-[calc(100%-30px)] flex-row items-center",children:(0,z.jsx)("div",{className:"truncate px-1 opacity-60",children:parseAtMentionsAndMarkdownNodes(s.summary,o.getParsers()).map((e,t)=>"text"===e.type?(0,z.jsx)("span",{children:e.content},t):(0,z.jsx)(tU,{value:e.content,className:"!bg-ide-message-block-bot-background !text-ide-message-block-bot-color"},t))})}),u&&!c&&(0,z.jsx)("p",{className:"text-nowrap opacity-30 group-hover:hidden",children:u}),c&&(0,z.jsxs)("div",{className:"flex flex-row items-center gap-2",children:[(0,z.jsx)(to.Z,{onClick:e=>{e.preventDefault(),e.stopPropagation(),(null==t?void 0:t.type)==="sync"?n(t.cascadeId):(null==t?void 0:t.type)==="async"&&r(t.asyncSessionKey),d(!1)},className:"h-3 w-3 opacity-70 hover:opacity-100","data-tooltip-id":"".concat(i,"-confirm-delete")}),(0,z.jsx)(tL.Z,{onClick:e=>{e.preventDefault(),e.stopPropagation(),d(!1)},className:"h-3 w-3 opacity-70 hover:opacity-100","data-tooltip-id":"".concat(i,"-cancel-delete")})]}),!c&&(0,z.jsx)("p",{className:"hidden stroke-ide-text-color opacity-70 hover:opacity-100 group-hover:block",children:(0,z.jsx)(nI.Z,{onClick:e=>{l(et.tbr.CASCADE_CLICK_EVENT,{type:"delete-past-conversation"}),e.preventDefault(),e.stopPropagation(),d(!0)},className:"h-3 w-3","data-tooltip-id":"".concat(i,"-delete-conversation")})}),(0,z.jsx)(e7.u,{opacity:1,id:"".concat(i,"-confirm-delete"),positionStrategy:"fixed",className:"max-w-[350px] !bg-ide-editor-background !p-2 !py-0 !text-ide-tooltip-color",border:"1px solid var(--codeium-chat-background-color, rgba(255, 255, 255, 0.1))",children:"Confirm Delete Conversation"}),(0,z.jsx)(e7.u,{opacity:1,id:"".concat(i,"-cancel-delete"),positionStrategy:"fixed",className:"max-w-[350px] !bg-ide-editor-background !p-2 !py-0 !text-ide-tooltip-color",border:"1px solid var(--codeium-chat-background-color, rgba(255, 255, 255, 0.1))",children:"Cancel Delete Conversation"}),(0,z.jsx)(e7.u,{opacity:1,id:"".concat(i,"-delete-conversation"),positionStrategy:"fixed",className:"max-w-[350px] !bg-ide-editor-background !p-2 !py-0 !text-ide-tooltip-color",border:"1px solid var(--codeium-chat-background-color, rgba(255, 255, 255, 0.1))",children:"Delete Conversation"})]})},useAsyncSessions=()=>({sessions:[]}),CascadeSuggestion=e=>{let{nextStep:t,onClick:s}=e;return(0,z.jsxs)("button",{onClick:s,className:"group relative flex h-[30px] flex-shrink flex-grow flex-row items-center justify-between overflow-hidden text-ellipsis whitespace-nowrap rounded bg-gray-500/5 px-2 pr-8 pr-8 text-left hover:bg-gray-500/25 md:w-[calc((100%-1.5rem)/3)] md:max-w-[calc((100%-1.5rem)/3)]",title:t,children:[(0,z.jsxs)("div",{className:"flex flex-row items-center gap-1 overflow-hidden",children:[(0,z.jsx)(tl.Z,{className:"h-4 w-4 flex-none opacity-80"}),(0,z.jsx)("p",{className:"truncate px-1 opacity-60",children:t})]}),(0,z.jsx)(ny.Z,{className:"absolute right-2 h-3 w-3 -translate-x-1 opacity-50 transition-[opacity] transition-[transform] group-hover:translate-x-0 group-hover:opacity-100"})]})},nextStepPredictionsFromImplicitTrajectory=e=>{if(!e.trajectory||!e.backgroundResearch||0===e.backgroundResearch.steps.length)return;let t=e.backgroundResearch,s=t.steps.map((e,s)=>t.steps[t.steps.length-1-s]).findIndex(e=>(null==e?void 0:e.type)===eS.prY.PLAN_INPUT),a=-1===s?-1:t.steps.length-1-s,n=t.steps[a];if(!n)return;let r="planInput"===n.step.case?n.step.value.planInput:null;if(r&&0!==r.nextSteps.length)return r.nextSteps},createCascadeSuggestionsFromImplicitTrajectory=(e,t,s)=>{let a=nextStepPredictionsFromImplicitTrajectory(e);if(!a||0===a.length||!e.trajectoryScope||!e.backgroundResearch)return[];let n=[];for(let r=0;r<Math.min(a.length,t);r++){let t=a[r];t&&n.push((0,z.jsx)(CascadeSuggestion,{nextStep:t,onClick:()=>{s(e,t)}},e.backgroundResearch.trajectoryId+r))}return n};var nk=s(69127),nR=s(75807);function Skeleton(e){let{className:t,...s}=e;return(0,z.jsx)("div",{className:function(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,nR.m6)((0,nk.W)(t))}("bg-muted animate-pulse rounded-md",t),...s})}let CascadeSelector=e=>{let{activeConfig:t,setCascadeConversationState:s}=e,a=useChatParamsContext(),{sessions:n}=useAsyncSessions(),[r,o]=(0,X.useState)(!1),{homeDir:i,workspaceUris:l}=useWorkspaceInfoContext(),[c,d]=(0,X.useState)(!1),[u,m]=(0,X.useState)(!1),{lsClient:p,props:{triggerAutoCascade:x}}=useServerConnectionContext(),{events:{getAllCascadeTrajectories:h,getUserImplicitTrajectories:g,refreshBackgroundResearch:f,startCascadeFromBaseTrajectory:y},state:{trajectories:v,implicitTrajectoryResponse:C,refreshingTrajectories:w,hasDevExtension:b},layout:{resetScroll:N}}=useCascadeContext(),S=(0,X.useCallback)(async e=>{if(e.trajectoryScope)try{let t=new eS.RaJ({identifier:{case:"implicitTrajectoryFileUri",value:e.trajectoryScope.workspaceUri}});return y(t)}catch(e){console.error(e)}},[y]),j=(0,X.useCallback)(async(e,n)=>{let r=[new et.QVo({chunk:{case:"text",value:"Please help me with my coding goal: "+n}})];try{let n=await S(e);if(!n)return;await (null==p?void 0:p.sendUserCascadeMessage(new ei.RGt({metadata:getMetadata(a),cascadeId:n,items:r,cascadeConfig:t}))),s({type:"sync",cascadeId:n})}catch(e){console.error(e)}},[p,t,a,S,s]);(0,X.useEffect)(()=>{(async()=>{let e=h(),t=g();await Promise.all([e,t]),o(!0)})()},[h,g]),(0,X.useEffect)(()=>{if(!C)return;let e=C.mainline;0!==e.length&&e.slice(0,3).forEach(e=>{if(!e.trajectory)return;let t=e.trajectory;if(!e.backgroundResearch||0===e.backgroundResearch.steps.length)return;let s=t.steps.length,a=e.mainlineStepCountAtLastResearch>0?e.mainlineStepCountAtLastResearch:s;s-a>10&&!w.has(t.trajectoryId)&&f(t.trajectoryId)})},[w,C,f]);let E=(0,X.useMemo)(()=>{if(!C)return null;let e=C.mainline;if(0===e.length)return null;let t=[],s=[],a=[];if(e.slice(0,3).forEach(e=>{if(!e.trajectory||!e.backgroundResearch||0===e.backgroundResearch.steps.length)return;let t=createCascadeSuggestionsFromImplicitTrajectory(e,3,j);0!==t.length&&(s.push(t),a.push(e))}),0===a.length)return null;let n=a.length>1;for(let e=0;e<s.length;e++){let r=s[e],o=a[e];if(!o||!o.trajectory)continue;let c=o.trajectory,d=o.trajectoryScope&&(0,z.jsx)("div",{className:"mb-1 flex items-center justify-between text-xs opacity-60",children:getHeaderFromTrajectoryScope(o.trajectoryScope,i,l)});t.push((0,z.jsxs)("div",{className:"mb-3",children:[n&&d,(0,z.jsx)("div",{className:"flex max-w-full flex-col gap-3 overflow-hidden md:flex-row md:flex-nowrap",children:w.has(c.trajectoryId)?(0,z.jsxs)("div",{className:"flex w-full flex-col gap-3 opacity-50",children:[(0,z.jsx)("div",{className:"h-[30px] w-full animate-pulse rounded bg-gray-500/15"}),(0,z.jsx)("div",{className:"h-[30px] w-full animate-pulse rounded bg-gray-500/15"}),(0,z.jsx)("div",{className:"h-[30px] w-full animate-pulse rounded bg-gray-500/15"})]}):r})]},c.trajectoryId))}let r=(0,z.jsxs)("div",{className:"mb-3 flex items-center",children:[(0,z.jsx)("h2",{className:"text-base font-medium",children:"Suggested next steps"}),(0,z.jsx)("button",{className:"ml-2 rounded p-1 opacity-70 hover:bg-gray-500/20 hover:opacity-100",onClick:()=>{a.forEach(e=>{e.trajectory&&f(e.trajectory.trajectoryId)})},"data-tooltip-id":"refresh-tooltip",children:(0,z.jsx)(aa.ArrowPathIcon,{className:"h-4 w-4 ".concat(w.size>0?"animate-spin":"")})})]});return(0,z.jsxs)(z.Fragment,{children:[r,t]})},[C,w,f,j,i,l]),I=(0,X.useMemo)(()=>{if(!v||0===Object.keys(v.trajectorySummaries).length)return null;let e=Object.entries(v.trajectorySummaries),t=e.sort((e,t)=>{var s,a,n,r;return Number(null!==(n=null===(s=t[1].lastModifiedTime)||void 0===s?void 0:s.seconds)&&void 0!==n?n:0)-Number(null!==(r=null===(a=e[1].lastModifiedTime)||void 0===a?void 0:a.seconds)&&void 0!==r?r:0)}),a=t.slice(0,c?t.length:3).map(e=>{let[t,a]=e,n={type:"sync",cascadeId:t};return(0,z.jsx)(CascadeConversationPill,{cascadeConversationState:n,summary:a,onClick:()=>{s(n),setTimeout(()=>{N()},50)}},t)});return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)("div",{className:"flex max-w-full flex-col gap-3 overflow-hidden md:flex-row md:flex-wrap",children:a}),t.length>3&&!E&&(0,z.jsx)("div",{className:"mt-6 cursor-pointer text-left text-sm opacity-30 hover:underline hover:opacity-60",onClick:()=>{d(e=>!e)},children:c?"Show less":"Show ".concat(t.length-3," more...")},"show-more")]})},[v,s,c,E,N]),T=(0,X.useMemo)(()=>{if(0===n.length)return null;let e=n.slice(0,u?n.length:3).map(e=>{let t=e.sessionId,a=e.trajectory,n=e.createdAt;if(!a){let e=new eS.DAb({summary:"Initializing...",stepCount:1,lastModifiedTime:n,trajectoryId:t});return(0,z.jsx)(CascadeConversationPill,{cascadeConversationState:{type:"async",cascadeId:t,asyncSessionKey:t},summary:e,onClick:()=>{}},t)}let r=a.cascadeId,o=e.summary||"Setting up...",i=a.steps.length,l=n;if(a.steps.length>0){var c;let e=a.steps[i-1],t=null==e?void 0:null===(c=e.metadata)||void 0===c?void 0:c.createdAt;l=null!=t?t:l}let d=new eS.DAb({summary:o,stepCount:i,lastModifiedTime:l}),u={type:"async",cascadeId:r,asyncSessionKey:e.sessionKey};return(0,z.jsx)(CascadeConversationPill,{summary:d,cascadeConversationState:u,onClick:()=>{s(u),setTimeout(()=>{N()},50)}},r)});return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)("div",{className:"flex max-w-full flex-col gap-3 overflow-hidden md:flex-row md:flex-wrap",children:e}),n.length>3&&(0,z.jsx)("div",{className:"mt-6 cursor-pointer text-left text-sm opacity-30 hover:underline hover:opacity-60",onClick:()=>{m(e=>!e)},children:u?"Show less":"Show ".concat(n.length-3," more...")},"show-more")]})},[n,s,u,N]),k=(0,X.useMemo)(()=>(0,z.jsxs)("div",{className:"mt-3 flex cursor-pointer items-center gap-1",onClick:()=>{null==x||x()},children:[(0,z.jsx)(nE.Z,{className:"h-4 w-4 opacity-70 transition-[opacity] hover:opacity-100"}),(0,z.jsx)("span",{className:"text-xs opacity-70 transition-[opacity] hover:opacity-100",children:"Start Session"})]}),[x]),[R,_]=(0,X.useState)(!1);return(0,z.jsxs)(z.Fragment,{children:[!r&&(0,z.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,z.jsx)(Skeleton,{className:"h-3 w-[30%] rounded-sm bg-gray-500/15 duration-[5000ms]"}),(0,z.jsx)(Skeleton,{className:"h-4 w-full rounded-sm bg-gray-500/15 duration-[5000ms]"}),(0,z.jsx)(Skeleton,{className:"h-4 w-full rounded-sm bg-gray-500/15 duration-[5000ms]"}),(0,z.jsx)(Skeleton,{className:"h-4 w-full rounded-sm bg-gray-500/15 duration-[5000ms]"})]}),(0,z.jsxs)("div",{className:(0,eG.classNames)("flex flex-col gap-3 transition-[opacity]",r?"opacity-100":"opacity-0"),children:[E&&(0,z.jsxs)("div",{children:[E,I&&(0,z.jsxs)("div",{className:"mt-12",children:[(0,z.jsxs)("button",{className:"flex w-full items-center gap-2",onClick:()=>{_(!R),d(!R)},children:[(0,z.jsx)("span",{className:"text-base font-medium",children:R?"Hide past workflows":"See past workflows"}),(0,z.jsx)(nn.Z,{className:(0,eG.classNames)("h-4 w-4 transition-transform",R?"rotate-180":"")})]}),R&&(0,z.jsx)("div",{className:"mt-2",children:I})]})]}),I&&!E&&(0,z.jsxs)("div",{children:[(0,z.jsx)("h2",{className:"mb-3 text-base font-medium",children:"Past Conversations"}),I]}),b&&(0,z.jsxs)("div",{children:[(0,z.jsx)("h2",{className:"mb-3 text-base font-medium",children:"Async Sessions"}),n.length>0&&T,k]})]})]})};var n_=s(51152);function getWindowHeight(){let e=window.innerHeight;return e<640?0:e<768?1:e<1024?2:e<1280?3:4}function useWindowHeight(){let[e,t]=(0,X.useState)(getWindowHeight());return(0,X.useEffect)(()=>{function handleResize(){let s=getWindowHeight();s!==e&&t(s)}return window.addEventListener("resize",handleResize),handleResize(),()=>{window.removeEventListener("resize",handleResize)}},[e]),e}(N=V||(V={}))[N.xs=0]="xs",N[N.sm=1]="sm",N[N.md=2]="md",N[N.lg=3]="lg",N[N.xl=4]="xl";let CascadeIntro=()=>{let{events:{toggleConversationalPlannerMode:e},state:{conversationalPlannerMode:t,userLoaded:s,remainingToolAndFlexCredits:a}}=useCascadeContext(),[n,r]=(0,X.useState)(!1);(0,X.useEffect)(()=>{s&&r(!0)},[s,r]);let o=useWindowHeight()<=V.md?"h-10 w-10":"h-12 w-12",i=useWindowHeight()<=V.md?"text-lg":"text-xl";return(0,z.jsxs)("div",{className:"mt-16 flex flex-col gap-1",children:[(0,z.jsx)(n_.I,{className:(0,eG.classNames)("".concat(o," cursor-pointer ").concat(n?"transition-all duration-300":""," hover:scale-105 [&>*]:transition-[fill] [&>*]:duration-300"),t===et.FLT.READ_ONLY?"-rotate-90 [&>*]:fill-ide-message-block-bot-color":"[&>*]:fill-ide-message-block-bot-color"),onClick:()=>{e(t)}}),(0,z.jsxs)("div",{className:"mt-4 grid grid-cols-1 grid-rows-1",children:[(0,z.jsx)("div",{className:(0,eG.classNames)("col-start-1 row-start-1 ".concat(n?"transition-all duration-300":""),t===et.FLT.NO_TOOL?"":"translate-x-[5rem] opacity-0"),children:(0,z.jsxs)("div",{className:"h-[7.5rem]",children:[(0,z.jsx)("h1",{className:"".concat(i," mb-0.5 font-medium"),children:"Legacy Mode"}),(0,z.jsxs)("p",{className:"opacity-60",children:[a<=0?(0,z.jsx)("b",{children:"You have no Flow Action credits left. "}):"","Cascade will not be able to use any premium Flow Action credits to answer your questions or assist you and will have reduced contextual awareness.",a>0?" You can re-enable this using the Windsurf Settings menu in the status bar.":" You will not be able to re-enable tools until you have more premium Flow Action or Flex credits."]})]})}),(0,z.jsx)("div",{className:(0,eG.classNames)("col-start-1 row-start-1 ".concat(n?"transition-all duration-300":""),t===et.FLT.DEFAULT?"":"translate-x-[5rem] opacity-0"),children:(0,z.jsxs)("div",{className:"h-[7.5rem]",children:[(0,z.jsx)("h1",{className:"".concat(i," mb-0.5 font-medium"),children:"Write with Cascade"}),(0,z.jsx)("p",{className:"opacity-60",children:"Kick off a new project or make changes across your entire codebase"})]})}),(0,z.jsxs)("div",{className:(0,eG.classNames)("col-start-1 row-start-1 text-start ".concat(n?"transition-all duration-300":""),t===et.FLT.READ_ONLY?"":"-translate-x-[5rem] opacity-0"),children:[(0,z.jsx)("h1",{className:"".concat(i," mb-0.5 font-medium"),children:"Chat with Cascade"}),(0,z.jsx)("p",{className:"opacity-60",children:"Ask questions or request suggestions for your codebase or coding in general"})]})]})]})};var nD=s(53521),nA=s(54278),nP=s(26089),nM=s(76416),nL=s(20080);let CascadeHeaderDevMenu=()=>{let{handleOpenChat:e,handleOpenDebug:t}=useNavigationContext(),{state:{userSettings:s},updateUserSettings:a}=useServerConnectionContext();return(0,z.jsx)("div",{className:"relative",children:(0,z.jsxs)(sz.v,{as:X.Fragment,children:[(0,z.jsxs)(sz.v.Button,{className:"group relative flex items-center justify-center","data-tooltip-id":"overflow-header-menu",children:[(0,z.jsx)(nP.Z,{className:"h-4 w-4 stroke-1 !text-ide-icon-color"}),(0,z.jsx)("div",{className:"absolute -bottom-1 -left-1 -right-1 -top-1 rounded bg-gray-500 opacity-0 group-hover:opacity-20"}),(0,z.jsx)(e7.u,{id:"overflow-header-menu",place:"bottom-start",className:"z-[200] max-w-[350px] !bg-ide-editor-background !px-1 !py-0.5 !text-sm !text-ide-editor-color",opacity:"1",border:"1px solid rgba(128,128,128,0.5)",children:"Developer Menu"})]}),(0,z.jsx)(sD.u,{as:X.Fragment,children:(0,z.jsx)(sz.v.Items,{className:(0,eG.classNames)("absolute right-0 top-full z-20 mt-2 origin-top-right rounded-md border border-gray-500/25 text-right shadow-lg ring-1 ring-opacity-5 focus:outline-none","bg-ide-editor-background text-sm text-ide-editor-color ring-ide-editor-background"),children:(0,z.jsxs)("div",{className:"flex flex-col items-start justify-center space-y-1 py-1",children:[(0,z.jsx)(sz.v.Item,{as:X.Fragment,children:t=>{let{active:s,disabled:a}=t;return(0,z.jsxs)("a",{className:(0,eG.classNames)("flex w-full cursor-pointer flex-row items-center justify-start gap-1 px-2 py-1",s?"bg-ide-tooltip-background":"bg-none",a?"cursor-default opacity-50":"cursor-pointer opacity-100"),onClick:e,children:[(0,z.jsx)(nM.ChatIcon,{className:"h-3.5 w-3.5"}),(0,z.jsx)("span",{className:"whitespace-nowrap",children:"Open Legacy Chat"})]})}}),(0,z.jsx)(sz.v.Item,{as:X.Fragment,children:e=>{let{active:s,disabled:a}=e;return(0,z.jsxs)("a",{className:(0,eG.classNames)("flex w-full cursor-pointer flex-row items-center justify-start gap-1 px-2 py-1",s?"bg-ide-tooltip-background":"bg-none",a?"cursor-default opacity-50":"cursor-pointer opacity-100"),onClick:t,children:[(0,z.jsx)(s5.Z,{className:"h-3.5 w-3.5"}),(0,z.jsx)("span",{className:"whitespace-nowrap",children:"Open Debug View"})]})}}),(0,z.jsx)(sz.v.Item,{as:X.Fragment,children:e=>{let{active:t,disabled:n}=e;return(0,z.jsxs)("a",{className:(0,eG.classNames)("flex w-full cursor-pointer flex-row items-center justify-start gap-1 px-2 py-1",t?"bg-ide-tooltip-background":"bg-none",n?"cursor-default opacity-50":"cursor-pointer opacity-100"),onClick:()=>{let e=new et.PGO({...s,cascadeNuxStates:[]});a(e)},children:[(0,z.jsx)(nL.Z,{className:"h-3.5 w-3.5"}),(0,z.jsx)("span",{className:"whitespace-nowrap",children:"Clear onboarding state"})]})}})]})})})]})})},VSCodeToggle=e=>{let{element:t,value:s,onChange:a}=e;return(0,z.jsx)("button",{className:(0,ti.classNames)("flex items-center justify-center rounded-sm",s?"bg-ide-active-selection-background":"hover:bg-gray-500/20"),onClick:()=>{a(!s)},children:t})},VSCodeToggleIcon=e=>{let{Icon:t,value:s,onChange:a}=e;return(0,z.jsx)(VSCodeToggle,{element:(0,z.jsx)(t,{className:"h-6 w-6 p-1"}),value:s,onChange:a})};(S=Y||(Y={})).Keybindings="keybindings",S.Settings="settings",S.PlanInfo="planInfo";let CascadeHeader=()=>{let{props:{handleClosePanel:e,handlePopup:t,openQuickSettings:s,downloadDiagnostics:a,openCascadeMemoriesPanel:n},isInitialized:r,logEvent:o}=useServerConnectionContext(),{debug:{debugMode:i,setDebugMode:l},events:{clearCascadeId:c},validate:{validateView:d,setValidateView:u},layout:{resetScroll:m,focusEditor:p},state:{cascadeConversationState:x,conversationalPlannerMode:h,cascadeState:g}}=useCascadeContext(),f=null==x?void 0:x.cascadeId,{hasDevExtension:y,ideName:v}=useChatParamsContext(),C=(0,tx.useIsMac)(),{getLogs:w}=useDebuggingContext(),b=!f,N=null==g?void 0:g.trajectory,handleNewConversation=()=>{c(),m(),setTimeout(()=>{p()},50)};return(0,z.jsxs)("div",{className:"z-[60] flex min-h-[35px] w-full flex-row items-center justify-between bg-ide-chat-background pl-[20px] pr-3",children:[(0,z.jsxs)("p",{className:"min-w-0 overflow-hidden text-ellipsis whitespace-nowrap text-xs text-ide-sidebar-title-color",children:["Cascade |"," ",h===et.FLT.NO_TOOL?"Legacy mode":h===et.FLT.READ_ONLY?"Chat mode":"Write mode"," ",h!==et.FLT.NO_TOOL&&(0,z.jsxs)("span",{className:"opacity-50",children:["(","jetbrains"===v?C?"":"Ctrl + ":C?"":"Ctrl + ",".)"]})]}),(0,z.jsxs)("div",{className:"flex flex-row items-center justify-center gap-x-2",children:[y&&(0,z.jsxs)(z.Fragment,{children:[(null==N?void 0:N.trajectoryId)&&(0,z.jsx)(z.Fragment,{children:(0,z.jsxs)(sZ.X,{className:"!hover:text-ide-icon-color flex w-4 items-center justify-center !text-ide-icon-color",href:"https://exafunction.retool.com/app/trajectory?_releaseVersion=latest#detailOnly=true&trajectoryId=".concat(N.trajectoryId,"&genMetadataIter=").concat(N.generatorMetadata.length||1),target:"_blank",rel:"noopener noreferrer","data-tooltip-id":"open-trajectory-link-tooltip",children:[(0,z.jsx)(st.Z,{className:"h-4 w-4"}),(0,z.jsx)(e7.u,{id:"open-trajectory-link-tooltip",place:"bottom-start",className:"z-[200] max-w-[350px] !bg-ide-editor-background !px-1 !py-0.5 !text-sm !text-ide-editor-color",opacity:"1",border:"1px solid rgba(128,128,128,0.5)",children:"Open Trajectory Dashboard"})]})}),(0,z.jsx)("div",{className:"stroke-1 text-ide-icon-color","data-tooltip-id":"debug-mode-tooltip",children:(0,z.jsx)(VSCodeToggleIcon,{Icon:aH.Z,value:i,onChange:l})}),(0,z.jsx)(e7.u,{id:"debug-mode-tooltip",place:"bottom-start",className:"z-[200] max-w-[350px] !bg-ide-editor-background !px-1 !py-0.5 !text-sm !text-ide-editor-color",opacity:"1",border:"1px solid rgba(128,128,128,0.5)",children:"Toggle Debug Mode"}),(0,z.jsx)(CascadeHeaderDevMenu,{}),f&&(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)("div",{className:"stroke-1 text-ide-icon-color","data-tooltip-id":"validate-view-tooltip",children:(0,z.jsx)(VSCodeToggleIcon,{Icon:nA.Z,value:d,onChange:u})}),(0,z.jsx)(e7.u,{id:"validate-view-tooltip",place:"bottom-start",className:"z-[200] max-w-[350px] !bg-ide-editor-background !px-1 !py-0.5 !text-sm !text-ide-editor-color",opacity:"1",border:"1px solid rgba(128,128,128,0.5)",children:"Toggle Validate View"})]})]}),(0,z.jsxs)(sZ.X,{disabled:b,onClick:()=>{o(et.tbr.CASCADE_CLICK_EVENT,{type:"new-conversation"}),handleNewConversation()},className:"!hover:text-ide-icon-color flex w-4 items-center justify-center !text-ide-icon-color","data-tooltip-id":"new-conversation-tooltip",children:[(0,z.jsx)(sG.Z,{className:"h-4 w-4"}),(0,z.jsxs)(e7.u,{id:"new-conversation-tooltip",place:"bottom-start",className:"z-[200] max-w-[350px] !bg-ide-editor-background !px-1 !py-0.5 !text-sm !text-ide-editor-color",opacity:"1",border:"1px solid rgba(128,128,128,0.5)",children:["Start a New Conversation"," ",(0,z.jsxs)("span",{className:"opacity-50",children:[C?"":"Ctrl + Shift ","L"]})]})]}),(0,z.jsxs)(sZ.X,{disabled:b,onClick:()=>{o(et.tbr.CASCADE_CLICK_EVENT,{type:"past-conversations"}),handleNewConversation()},className:"flex w-4 items-center justify-center !fill-ide-icon-color","data-tooltip-id":"history-tooltip",children:[(0,z.jsx)(sY.HistoryIcon,{className:"h-4 w-4"}),(0,z.jsx)(e7.u,{id:"history-tooltip",place:"bottom-start",className:"z-[200] max-w-[350px] !bg-ide-editor-background !px-1 !py-0.5 !text-sm !text-ide-editor-color",opacity:"1",border:"1px solid rgba(128,128,128,0.5)",children:"Past Conversations"})]}),t&&(0,z.jsxs)(sZ.X,{disabled:!r,onClick:()=>{t()},className:"!hover:text-ide-icon-color flex w-4 items-center justify-center !text-ide-icon-color","data-tooltip-id":"new-window-tooltip",children:[(0,z.jsx)(s4.Z,{className:"h-4 w-4"}),(0,z.jsx)(e7.u,{id:"new-window-tooltip",place:"bottom-start",className:"z-[200] max-w-[350px] !bg-ide-editor-background !px-1 !py-0.5 !text-sm !text-ide-editor-color",opacity:"1",border:"1px solid rgba(128,128,128,0.5)",children:"Open in New Window"})]}),s||a||n?(0,z.jsx)("div",{className:"relative",children:(0,z.jsxs)(sz.v,{as:X.Fragment,children:[(0,z.jsxs)(sz.v.Button,{className:"group relative flex items-center justify-center","data-tooltip-id":"cascade-header-menu",children:[(0,z.jsx)(nD.Z,{className:"h-4 w-4 fill-ide-text-color"}),(0,z.jsx)("div",{className:"absolute -bottom-1 -left-1 -right-1 -top-1 rounded bg-gray-500 opacity-0 group-hover:opacity-20"}),(0,z.jsx)(CompactTooltip,{id:"cascade-header-menu",place:"bottom-start",children:"Additional options"})]}),(0,z.jsx)(sD.u,{as:X.Fragment,enter:"transition ease-out duration-100",enterFrom:"transform opacity-0 scale-95",enterTo:"transform opacity-100 scale-100",leave:"transition ease-in duration-75",leaveFrom:"transform opacity-100 scale-100",leaveTo:"transform opacity-0 scale-95",children:(0,z.jsx)(sz.v.Items,{className:(0,eG.classNames)("absolute right-0 top-full z-20 mt-2 origin-top-right rounded-md border border-gray-500/25 text-right shadow-lg ring-1 ring-opacity-5 focus:outline-none","bg-ide-editor-background text-sm text-ide-editor-color ring-ide-editor-background"),children:(0,z.jsxs)("div",{className:"flex flex-col items-start justify-center space-y-1 py-1",children:[n&&(0,z.jsx)(sz.v.Item,{children:e=>{let{active:t}=e;return(0,z.jsx)("button",{onClick:()=>{o(et.tbr.CASCADE_CLICK_EVENT,{type:"header-manage-memories"}),n()},className:(0,eG.classNames)(t?"bg-ide-tooltip-background":"","flex w-full items-center space-x-2 whitespace-nowrap px-2 py-1 text-left text-sm text-ide-editor-color"),children:(0,z.jsx)("span",{children:"Manage Memories"})})}}),s&&(0,z.jsx)(sz.v.Item,{children:e=>{let{active:t}=e;return(0,z.jsx)("button",{onClick:()=>{s("planInfo"),o(et.tbr.CASCADE_CLICK_EVENT,{type:"header-open-settings"})},className:(0,eG.classNames)(t?"bg-ide-tooltip-background":"","flex w-full items-center space-x-2 whitespace-nowrap px-2 py-1 text-left text-sm text-ide-editor-color"),children:(0,z.jsx)("span",{children:"Cascade usage"})})}}),a&&(0,z.jsx)(sz.v.Item,{children:e=>{let{active:t}=e;return(0,z.jsx)("button",{onClick:()=>{a({cascadeId:f,currentLatestStepIndex:(null==N?void 0:N.steps)?N.steps.length:0,trajectoryId:(null==N?void 0:N.trajectoryId)?N.trajectoryId:"",consoleLogs:w()})},className:(0,eG.classNames)(t?"bg-ide-tooltip-background":"","flex w-full items-center space-x-2 whitespace-nowrap px-2 py-1 text-left text-sm text-ide-editor-color"),children:(0,z.jsx)("span",{children:"Download Diagnostics"})})}})]})})})]})}):null,e&&(0,z.jsxs)(sZ.X,{onClick:()=>{e()},className:"!hover:text-ide-icon-color flex w-4 items-center justify-center !text-ide-icon-color","data-tooltip-id":"close-tooltip",children:[(0,z.jsx)(tL.Z,{className:"h-4 w-4"}),(0,z.jsx)(e7.u,{id:"close-tooltip",place:"bottom-start",className:"z-[200] max-w-[350px] !bg-ide-editor-background !px-1 !py-0.5 !text-sm !text-ide-editor-color",opacity:"1",border:"1px solid rgba(128,128,128,0.5)",children:"Close Cascade View"})]})]})]})};var nO=s(94188),nF=s.n(nO),nB=s(92061);let ValidateView=()=>{let{lsClient:e}=useServerConnectionContext(),{state:{cascadeState:t,cascadeConversationState:s}}=useCascadeContext(),a=null==s?void 0:s.cascadeId,[n,r]=(0,X.useState)(),o=null==t?void 0:t.trajectory,i=(0,tx.useIsMac)(),l=useChatParamsContext(),c=(0,X.useCallback)(async()=>{if(a){let t=new ei.hOF({cascadeId:a}),s=await (null==e?void 0:e.getCodeValidationStates(t));r(s)}},[a,e]);(0,X.useEffect)(()=>{c()},[c]);let d=(0,X.useCallback)(async(t,s)=>{await (null==e?void 0:e.acknowledgeCascadeCodeEdit(new ei.j1V({cascadeId:a,absoluteUri:t,accept:s,metadata:getMetadata(l)}))),c()},[e,a,c,l]),[u,m]=(0,X.useState)([]),p=(0,X.useCallback)((e,t)=>{let s=t.altKey;m(t=>{if(s){let s=(null==n?void 0:n.states.map(e=>e.uri))||[];return t.includes(e)?[]:s}return t.includes(e)?t.filter(t=>t!==e):[...t,e]})},[n]);return o?(0,z.jsxs)("div",{className:"relative flex w-full flex-col gap-y-1 overflow-y-auto overflow-x-clip",children:[(0,z.jsx)("div",{className:"flex flex-row items-center justify-between px-1 py-3",children:(0,z.jsxs)("span",{className:"text-ide-caption-color",children:["Changes in ",null==n?void 0:n.states.length," files"]})}),null==n?void 0:n.states.map(e=>{let t=e.uri.split(/[\/\\]/).pop();return t?(0,z.jsxs)("div",{className:"border-y-[2px]",children:[(0,z.jsxs)("div",{className:"sticky top-0 z-20 flex cursor-pointer flex-row justify-between border-y bg-ide-chat-background",onClick:t=>{p(e.uri,t)},children:[(0,z.jsxs)("div",{className:"flex flex-row items-center",children:[(0,z.jsx)(az.Z,{className:(0,eG.classNames)("mr-1 h-4 w-4 cursor-pointer",u.includes(e.uri)?"rotate-0":"rotate-180")}),(0,z.jsx)("span",{className:"flex items-center font-mono",children:t})]}),(0,z.jsxs)("div",{className:"flex flex-row items-center",children:[(0,z.jsx)("button",{className:"px-1 py-1 text-green-300 hover:text-green-500",onClick:()=>{d(e.uri,!0)},children:(0,z.jsx)(aq.Z,{className:"h-6 w-6"})}),(0,z.jsx)("button",{className:"px-1 py-1 text-red-300 hover:text-red-500",onClick:()=>{d(e.uri,!1)},children:(0,z.jsx)(aG.Z,{className:"h-6 w-6"})}),(0,z.jsx)("button",{className:"px-1 py-1",onClick:e=>{e.preventDefault()},children:(0,z.jsx)(nB.Z,{className:"h-6 w-6"})})]})]}),u.includes(e.uri)&&(0,z.jsx)(nF(),{oldValue:e.lastAcknowledgedState,newValue:e.currentState,splitView:!1,disableWordDiff:!0,extraLinesSurroundingDiff:2,style:{maxWidth:"100%"},styles:{variables:{light:{diffViewerBackground:"var(--codeium-chat-background)",diffViewerColor:"var(--codeium-text-color)",addedBackground:"#23863633",addedColor:"var(--codeium-text-color)",removedBackground:"#da363333",removedColor:"var(--codeium-text-color)",addedGutterBackground:"#4ae16833",removedGutterBackground:"#ff6e6e33",gutterBackground:"var(--codeium-chat-background)",gutterBackgroundDark:"var(--codeium-input-background)",codeFoldGutterBackground:"var(--codeium-message-block-tooltip-background)",codeFoldBackground:"var(--codeium-message-block-tooltip-background)",emptyLineBackground:"var(--codeium-chat-background)",gutterColor:"var(--codeium-text-color)",addedGutterColor:"var(--codeium-text-color)",removedGutterColor:"var(--codeium-text-color)",codeFoldContentColor:"var(--codeium-text-color)"}},gutter:{minWidth:"0px",paddingLeft:"3px",":hover":{cursor:"default"}},line:{padding:"0px"},codeFold:{borderTop:"1px solid white",borderBottom:"1px solid white",textDecoration:"none !important"},contentText:{textDecoration:"none !important"}}})]},e.uri):null}),(0,z.jsxs)("div",{className:"flex w-full flex-row items-center justify-center px-2 py-3 italic text-ide-caption-color",children:["Tip: ",i?"":"Alt"," press to collapse or expand all"]})]}):(0,z.jsx)("div",{children:"No trajectory found."})};var nq=s(25739);let nU=[new et.Bfb({label:"windsurf-help-docs",value:{case:"docsUrl",value:"https://docs.codeium.com"},synonyms:["codeium","codium"],isFeatured:!0}),new et.Bfb({label:"anthropic-api-docs",value:{case:"docsUrl",value:"https://docs.anthropic.com"},synonyms:["claude","haiku","sonnet"],isFeatured:!0}),new et.Bfb({label:"perplexity-api-docs",value:{case:"docsUrl",value:"https://docs.perplexity.ai"},isFeatured:!0}),new et.Bfb({label:"pinecone-api-docs",value:{case:"docsUrl",value:"https://docs.pinecone.io"}}),new et.Bfb({label:"x-api-docs",value:{case:"docsUrl",value:"https://docs.x.com"},synonyms:["twitter"],isFeatured:!0}),new et.Bfb({label:"mintlify-docs",value:{case:"docsUrl",value:"https://docs.mintlify.com"},isFeatured:!0}),new et.Bfb({label:"zapier-api-docs",value:{case:"docsUrl",value:"https://docs.zapier.com"}}),new et.Bfb({label:"sardine-api-docs",value:{case:"docsUrl",value:"https://docs.sardine.ai"}}),new et.Bfb({label:"envoyer-api-docs",value:{case:"docsUrl",value:"https://docs.envoyer.io"},synonyms:["laravel"]}),new et.Bfb({label:"writer-ai-docs",value:{case:"docsUrl",value:"https://dev.writer.com"}}),new et.Bfb({label:"openphone-api-docs",value:{case:"docsUrl",value:"https://openphone.com/docs/api-reference/introduction"}}),new et.Bfb({label:"dune-analytics-api-docs",value:{case:"docsUrl",value:"https://docs.dune.com/home"}}),new et.Bfb({label:"elevenlabs-docs",value:{case:"docsUrl",value:"https://elevenlabs.io/docs/product/introduction"},isFeatured:!0}),new et.Bfb({label:"dub-co-docs",value:{case:"docsUrl",value:"https://dub.co/docs/introduction"}}),new et.Bfb({label:"basehub-docs",value:{case:"docsUrl",value:"https://docs.basehub.com"}}),new et.Bfb({label:"hypermode-docs",value:{case:"docsUrl",value:"https://docs.hypermode.com"}}),new et.Bfb({label:"coinbase-docs",value:{case:"docsUrl",value:"https://docs.cdp.coinbase.com"}}),new et.Bfb({label:"vercel-ai-docs",value:{case:"docsUrl",value:"https://sdk.vercel.ai/"}}),new et.Bfb({label:"model-context-protocol-docs",value:{case:"docsUrl",value:"https://modelcontextprotocol.io"},synonyms:["mcp","modelcontextprotocol"],isFeatured:!0}),new et.Bfb({label:"nextjs-docs",value:{case:"docsSearchDomain",value:"nextjs.org"},synonyms:["next"],isFeatured:!0}),new et.Bfb({label:"supabase-docs",value:{case:"docsSearchDomain",value:"supabase.com/docs"}}),new et.Bfb({label:"together-ai-docs",value:{case:"docsSearchDomain",value:"docs.together.ai"},isFeatured:!0})],organizeWebDocsOptions=e=>{let t=[],s=[];return e.forEach(e=>{e.isFeatured?t.push(e):s.push(e)}),{featured:t,rest:s.sort((e,t)=>e.label.localeCompare(t.label))}},docOptionsMatchesQuery=(e,t)=>!!e.label.toLowerCase().includes(t.toLowerCase())||e.synonyms.some(e=>e.toLowerCase().includes(t.toLowerCase()));let DocsCategory=class DocsCategory extends AbstractCustomCategory{async refreshOptions(){try{this.isLoading=!0,this.error=null;let e=await this.getWebDocsOptions();e.length>0?this.webDocsOptions=organizeWebDocsOptions(e):this.webDocsOptions=organizeWebDocsOptions(nU)}catch(e){e instanceof Error?this.error=e:this.error=Error("Unknown error: ".concat(String(e))),console.error(e)}finally{this.isLoading=!1}}getCategory(){return{data:{trigger:this.trigger,category:this.categoryName,optionType:A.CATEGORY,data:"Docs",dataType:P.STRING,displayTitle:"Docs",displayMetadata:this.isLoading?"Loading...":this.error?"Error: ".concat(this.error.message):"",mentionText:this.categoryName},renderData:{displayIcon:this.getDisplayIcon()}}}handleQuery(e){let t=[...this.webDocsOptions.featured,...this.webDocsOptions.rest];return(null==e?void 0:e.length)&&(t=t.filter(t=>docOptionsMatchesQuery(t,e))),Promise.resolve(t.map(e=>{let t="docsUrl"===e.value.case?e.value.value:"search for docs on ".concat(e.value.value," to answer this query");return DocsNodeParser.createDocsNode(e.label,t)}))}getNodeType(){return MarkdownNode.getType()}getDisplayIcon(){return(0,z.jsx)(tu.Z,{className:"w-3 stroke-ide-message-block-bot-color"})}constructor(e,t){super(e,"docs"),this.getWebDocsOptions=t,this.webDocsOptions=organizeWebDocsOptions(nU),this.isLoading=!1,this.error=null,this.refreshOptions()}};var nG=s(64272);let WorkflowCategory=class WorkflowCategory extends AbstractCustomCategory{async refreshOptions(){try{this.error=null;let e=await this.getAllWorkflows();this.workflowOptions=e.map(e=>{var t,s,a,n;return ContextScopeItemNodeData.fromContextScopeItem(new et.igh({scopeItem:{case:"recipe",value:new et.iHm({recipeId:e.recipeId,title:null!==(a=null===(t=e.toolDefinition)||void 0===t?void 0:t.name)&&void 0!==a?a:"",description:null!==(n=null===(s=e.toolDefinition)||void 0===s?void 0:s.description)&&void 0!==n?n:"",systemPrompt:e.systemPrompt})}}))})}catch(e){e instanceof Error?this.error=e:this.error=Error("Unknown error: ".concat(String(e))),console.error(e)}}getCategory(){return{data:{trigger:this.trigger,category:this.categoryName,optionType:A.CATEGORY,data:"Workflows",dataType:P.STRING,displayTitle:"Workflows",displayMetadata:this.error?"Error: ".concat(this.error.message):"",mentionText:this.categoryName},renderData:{displayIcon:this.getDisplayIcon()}}}handleQuery(e){let t=this.workflowOptions;return(null==e?void 0:e.length)&&(t=t.filter(t=>t.getMenuItemProps().data.displayTitle.toLowerCase().includes(e.toLowerCase()))),Promise.resolve(t)}getNodeType(){return ContextScopeItemNode.getType()}getDisplayIcon(){return(0,z.jsx)(nG.Z,{className:"w-3 stroke-ide-message-block-bot-color"})}constructor(e,t){super(e,"workflows"),this.getAllWorkflows=t,this.error=null,this.workflowOptions=[],this.refreshOptions()}};let nQ="cascade-input",CascadeInput=e=>{let t,{handleCancel:s,className:a}=e,n=(0,tx.useIsMac)(),r=(0,X.useRef)(null),o=(0,X.useId)(),{props:{handleClosePanel:i},logEvent:l,getWebDocsOptions:c,lsClient:d}=useServerConnectionContext(),{layout:{lexicalRef:u,resetScroll:m,focusEditor:p},events:{sendMessage:x,onModifierChange:h,toggleConversationalPlannerMode:g,cancelInvocation:f,setInterruptConfirmation:y,clearSelectedImages:v,setErrorMessage:C,handleImage:w,clearCascadeId:b},state:{currentModelConfig:N,conversationalPlannerMode:S,hasDevExtension:j,selectedImages:E,isRunning:I,interruptConfirmation:T,remainingPromptAndFlexCredits:k,remainingToolAndFlexCredits:R,isPremiumUser:_,webSearchEnabled:D}}=useCascadeContext(),{ideName:A}=useChatParamsContext(),{query:P,isWindsurf:M}=useContextMention(),L=(0,X.useCallback)(async()=>{let e=await (null==d?void 0:d.getAllWorkflows(new ei.xev));return(null==e?void 0:e.workflows)||[]},[d]),O=(0,X.useMemo)(()=>{let e=[];return D&&S!==et.FLT.NO_TOOL&&e.push(new DocsCategory(AtMentionService.trigger,c)),S!==et.FLT.NO_TOOL&&e.push(new WorkflowCategory(AtMentionService.trigger,L)),e},[D,c,S,L]),F=(0,X.useMemo)(()=>new AtMentionService(P,O,j,M,{webSearchEnabled:D&&S!==et.FLT.NO_TOOL},void 0),[P,j,M,D,O,S]),B=(0,X.useMemo)(()=>({...createConfig("edit",tY),editorState:createEmptyEditorState()}),[]),q=(0,X.useMemo)(()=>[F],[F]),[U,G]=(0,X.useState)(null);(0,X.useEffect)(()=>{!I&&U?setTimeout(()=>{x(void 0,{startFromImplicit:U.startFromImplicit,images:E}),G(null)},1e3):I||y(!1)},[I,U,E,x,y,G]);let Q=(0,X.useCallback)(function(){var e;let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return!!u.current&&(I?isEditorEmpty(u.current)||(T?(f(),G({timestamp:Date.now(),startFromImplicit:t}),y(!1)):y(!0)):E.length>0&&!0!=N.supportsImages?C("This model does not support images. You can remove them or switch to a model that does."):(l(et.tbr.CASCADE_MESSAGE_SENT,{model_id:null!==(e=(0,ec.enumToString)(N.value,et.Hnr))&&void 0!==e?e:"",model_name:N.label,num_images:E.length.toFixed(0),start_from_implicit:t?"true":"false"}),C(""),x(void 0,{startFromImplicit:t,images:E}),y(!1),v()),!0)},[u,x,I,T,f,y,l,E,v,C,N]),W=(0,X.useCallback)(async e=>{let t=e.getAsFile();t&&await w(t)},[w]),H=(0,X.useCallback)(()=>{var e;let t=document.getElementById(nQ);(null===(e=r.current)||void 0===e?void 0:e.contains(document.activeElement))?null==i||i():null==t||t.focus()},[r,i]),V=(0,X.useCallback)(e=>{"toggleFocus"===e.actionType&&H()},[H]);useRegisterChatClientRequestHandler("sendActionToChatPanel",V);let Y=getCascadeSendMessageError(k,R,N,S,null==_||_);switch(Y.code){case J.WRITE_CHAT_INSUFFICIENT_USER_PROMPT_CREDITS:case J.WRITE_CHAT_INSUFFICIENT_FLOW_ACTION_CREDITS:case J.WRITE_CASCADE_BASE_ON_FREE_PLAN:case J.WRITE_CHAT_UPGRADE_FOR_CREDITS:case J.LEGACY_NOT_ENOUGH_CREDITS:case J.LEGACY_NOT_SUPPORTED:t=(0,z.jsx)(z.Fragment,{children:(0,z.jsx)("div",{className:"text-sm",children:Y.message})})}let Z=!!t,K=(0,X.useCallback)(e=>!Z&&!e.shiftKey&&((e.preventDefault(),n?e.metaKey:e.ctrlKey)?Q(!0):Q()),[Q,n,Z]);return(0,z.jsx)(EditorContext,{editorConfig:B,children:(0,z.jsxs)("div",{ref:r,className:"relative",children:[(0,z.jsx)(ContextMentionEditor,{id:nQ,containerRef:r,editorRef:u,onEnter:K,onEditorChange:()=>{},onKeyDown:e=>{if(h(e,!0),"Escape"===e.key&&T){y(!1),e.preventDefault(),e.stopPropagation();return}"l"===e.key&&(n?e.metaKey:e.ctrlKey)&&e.shiftKey&&(e.stopPropagation(),e.preventDefault(),b(),m(),setTimeout(()=>{p()},50)),"l"===e.key&&(n?e.metaKey:e.ctrlKey)&&!e.shiftKey&&(e.stopPropagation(),e.preventDefault(),H()),"."===e.key&&(n?e.metaKey:e.ctrlKey)&&(g(S),e.stopPropagation(),e.preventDefault()),I&&"c"===e.key&&e.ctrlKey&&(n||e.altKey)&&(s(),e.stopPropagation(),e.preventDefault())},onKeyUp:e=>{h(e,!1)},onImagePaste:e=>{W(e)},className:(0,eG.classNames)("max-h-[300px] cursor-text overflow-y-auto !bg-ide-input-background pr-7 text-sm !text-ide-input-color outline outline-gray-500/10 focus:outline-ide-active-selection-background",a),triggerServices:q,menuClassName:"absolute left-0 right-0 top-0 -translate-y-full z-100 !bg-ide-input-background !text-ide-input-color max-h-[14.5rem] overflow-auto",menuItemOptions:{selectedClassName:"bg-ide-active-selection-background text-ide-active-selection-color",unselectedClassName:"!bg-ide-editor-background text-ide-editor-color"},placeholderClassName:"!text-ide-input-color",placeholder:"Ask anything (".concat("jetbrains"===A?n?"L":"Ctrl+L":n?"L":"Ctrl+L","), @ to mention code blocks")}),(0,z.jsxs)("div",{className:"absolute right-2 top-[50%] flex -translate-y-[50%] items-center space-x-2",children:[(0,z.jsx)("button",{className:(0,eG.classNames)("group h-[24px] w-[24px] items-center justify-center text-sm text-ide-input-color",Z?"cursor-not-allowed opacity-50":"cursor-pointer"),type:"submit",onClick:()=>{I?(s(),l(et.tbr.CASCADE_CLICK_EVENT,{type:"cancel-response"})):Z||(Q(),l(et.tbr.CASCADE_CLICK_EVENT,{type:"send-message"}))},"data-tooltip-id":o,children:I?(0,z.jsx)(z.Fragment,{children:(0,z.jsx)(sk.Z,{className:"z-[100] h-5 w-5 fill-red-500 stroke-red-500"})}):(0,z.jsx)(z.Fragment,{children:(0,z.jsx)("span",{className:"flex justify-center",children:(0,z.jsx)(nq.Z,{className:"h-3 w-3"})})})}),(0,z.jsx)(CompactTooltip,{id:o,place:"left",children:I?"Cancel (".concat(n?"C":"Ctrl + Alt + C",")"):Z?(0,z.jsx)("div",{className:"flex flex-col items-start justify-start space-y-1",children:t}):"Send"})]})]})})},CascadeModelTag=e=>{let{option:t}=e,s=(0,X.useId)();return t.isBeta&&t.betaWarningMessage?(0,z.jsxs)(z.Fragment,{children:[(0,z.jsxs)("div",{"data-tooltip-id":s,className:"flex items-center gap-1 rounded-full bg-gray-500/15 px-1.5 text-xs",children:[(0,z.jsx)("span",{children:"Beta"}),(0,z.jsx)(nl.Z,{className:"h-3 w-3 flex-none"})]}),(0,z.jsx)(CompactTooltip,{id:s,children:(0,z.jsx)("div",{className:"max-w-[300px]",children:t.betaWarningMessage})})]}):t.isBeta?(0,z.jsx)("div",{className:"rounded-full bg-gray-500/15 px-1.5 text-xs",children:"Beta"}):null},CascadeModelOption=e=>{let{option:t,showCreditCost:s}=e,a=(0,X.useMemo)(()=>t.creditMultiplier?0===t.creditMultiplier?"free":"".concat(t.creditMultiplier,"x credit"):null,[t]);return(0,z.jsx)(s_.R.Option,{className:"cursor-default select-none list-none border-ide-tooltip-color text-sm text-ide-tooltip-color",value:t.label,disabled:t.disabled,children:e=>{let{selected:n,active:r,disabled:o}=e;return(0,z.jsx)("div",{className:(0,eG.classNames)("flex flex-col px-2 py-1",o?"cursor-not-allowed opacity-30":"cursor-pointer opacity-100",r?"bg-gray-500/20":""),children:(0,z.jsxs)("div",{className:"flex items-center justify-between",children:[(0,z.jsxs)("div",{className:"flex flex-row items-center justify-start gap-x-1",children:[(0,z.jsx)("p",{className:(0,eG.classNames)("whitespace-nowrap text-xs",r||n?"opacity-100":"opacity-80"),children:t.label}),a&&s?(0,z.jsx)("div",{className:"whitespace-nowrap rounded text-xs opacity-50",children:a}):null,!o&&(0,z.jsx)(CascadeModelTag,{option:t})]}),n&&(0,z.jsx)("div",{className:"h-2 w-2 rounded-full bg-ide-button-background"})]})})}},t.label)};var nJ=s(4784),nW=s.n(nJ);let CascadeModelSelect=e=>{let{className:t,isLoading:s=!1}=e,{unleash:a,logEvent:n}=useServerConnectionContext(),{state:{activeNux:r},events:{dismissNux:o}}=useCascadeUIStateContext(),{events:{handleModelChange:i},state:{visibleModelConfigs:l,currentModelConfig:c,isLoadingModels:d}}=useCascadeContext(),u=(0,X.useRef)(null),m=(0,X.useRef)(null),{handleShowNux:p}=useNux(),[x,h]=(0,X.useState)({transform:"translate(-6px, -100px)"});(0,X.useEffect)(()=>{let updatePosition=()=>{if(!m.current)return;let e=m.current.getBoundingClientRect(),t=window.innerWidth;if(t<550){let t=-e.left;h({transform:"translate(".concat(t+16,"px, -100%)")});return}h({transform:"translate(-16px, -100%)"})},e=new ResizeObserver(updatePosition);return m.current&&e.observe(m.current),e.observe(document.body),updatePosition(),()=>{e.disconnect()}},[]),(0,X.useEffect)(()=>{let e=a.isEnabled(et.rpR.CASCADE_NEW_WAVE_2_MODELS_NUX);if(e){let e=l.filter(e=>!e.disabled&&!aj.find(t=>t.value===e.value));e.length>0&&p([et.NQJ.CASCADE_NUX_EVENT_NEW_MODELS_WAVE2])}},[a,p,l]);let{premiumModels:g,nonPremiumModels:f}=(0,X.useMemo)(()=>{let[e,t]=nW()(l,e=>e.isPremium);return{premiumModels:e,nonPremiumModels:t}},[l]),y=(0,X.useMemo)(()=>{let e=new Set;for(let t of l)e.add(t.creditMultiplier);return e.size>1},[l]);return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(CascadeInlineNUX,{componentRef:u,render:r===et.NQJ.CASCADE_NUX_EVENT_NEW_MODELS_WAVE2,place:"above",dismissNux:o,activeNux:r,children:(0,z.jsxs)("div",{className:"z-[1000] flex w-full items-center gap-2 rounded p-2",children:[(0,z.jsx)("div",{className:"grow whitespace-normal leading-tight",children:"New model available! Click on the model selector to view available models."}),(0,z.jsx)(tL.Z,{className:"h-4 w-4 flex-none cursor-pointer",onClick:o})]})}),(0,z.jsx)(s_.R,{value:c.label,onChange:e=>{n(et.tbr.CASCADE_CLICK_EVENT,{type:"model-select",value:e}),i(e)},children:e=>{let{open:a}=e;return(0,z.jsx)(z.Fragment,{children:(0,z.jsxs)("div",{ref:u,className:"relative min-w-0 flex-shrink",children:[(0,z.jsxs)(s_.R.Button,{ref:m,className:"relative m-0 flex w-full cursor-pointer flex-row items-center justify-start gap-x-0.5 rounded p-0.5 text-ide-text-color opacity-70 hover:bg-gray-500/20 hover:opacity-100",children:[s?(0,z.jsx)("span",{className:"h-2 w-[5rem] animate-pulse rounded-full bg-gray-500/70"}):(0,z.jsx)("p",{className:"flex-grow overflow-hidden text-ellipsis whitespace-nowrap text-xs leading-none",children:c.label}),(0,z.jsx)(sP.Z,{className:"h-3.5 fill-none stroke-ide-text-color"})]}),(0,z.jsx)(sD.u,{show:a,as:X.Fragment,leave:"transition ease-in duration-100",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,z.jsx)("div",{style:x,className:(0,eG.classNames)("absolute -top-1 z-40 w-80 max-w-[90vw] origin-top-right overflow-hidden rounded-md border border-gray-500/50 bg-ide-chat-background opacity-100 focus:outline-none",t),children:(0,z.jsx)(s_.R.Options,{className:"max-h-[15rem] overflow-auto",children:d?(0,z.jsxs)("div",{className:"flex flex-col gap-2 p-4",children:[(0,z.jsx)("div",{className:"h-3 w-32 animate-pulse rounded-full bg-gray-500/30"}),(0,z.jsx)("div",{className:"h-3 w-48 animate-pulse rounded-full bg-gray-500/30"}),(0,z.jsx)("div",{className:"h-3 w-40 animate-pulse rounded-full bg-gray-500/30"})]}):(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)("div",{className:"flex items-center gap-1 px-2 py-1 text-xs font-medium",children:"Premium"}),g.map((e,t)=>(0,z.jsx)(CascadeModelOption,{option:e,showCreditCost:y},t)),(0,z.jsx)("hr",{className:"mb-2 opacity-30"}),(0,z.jsx)("div",{className:"flex items-center gap-1 px-2 py-1 text-xs font-medium",children:"Non-premium"}),f.map((e,t)=>(0,z.jsx)(CascadeModelOption,{option:e,showCreditCost:y},t))]})})})})]})})}})]})};var nH=s(37939);let SendModeSelector=e=>{let{}=e,{events:{toggleConversationalPlannerMode:t},state:{isRunning:s,conversationalPlannerMode:a,remainingToolAndFlexCredits:n,remainingPromptCredits:r,remainingToolCredits:o,cascadePanelState:i,isPremiumUser:l,currentModelConfig:c}}=useCascadeContext(),{state:{userSettings:d},userStatus:u,updateUserSettings:m,logEvent:p}=useServerConnectionContext(),{hasDevExtension:x,apiKey:h,ideName:g}=useChatParamsContext(),f=(0,tx.useIsMac)(),y=getCascadeSendMessageError(r,o,c,a,l),v=(0,X.useMemo)(()=>{var e,t,s,n;if(!x)return(0,z.jsx)(z.Fragment,{});let renderCredits=e=>void 0===e?"N/A":isLimitUnlimited(e)?"":(e/100).toFixed(0),l=null==i?void 0:i.planStatus,c="border border-ide-text-color px-2 py-1";return(0,z.jsxs)("div",{className:"mt-4 flex flex-col items-start justify-start gap-y-1 pb-2",children:[(0,z.jsx)("p",{className:"font-medium",children:"Dev Extension Only"}),(0,z.jsxs)("p",{children:["Email: ",(null==u?void 0:u.email)||"N/A"]}),(0,z.jsxs)("p",{children:["API Key: ",h||"N/A"]}),(0,z.jsxs)("p",{children:["Planner Mode: ",(0,ec.enumToString)(a,et.FLT)]}),(0,z.jsxs)("p",{children:["Send message error: ",null!==(n=y.message)&&void 0!==n?n:"None"]}),(0,z.jsxs)("table",{className:"w-full table-auto border-collapse",children:[(0,z.jsx)("thead",{children:(0,z.jsxs)("tr",{children:[(0,z.jsx)("th",{className:c,children:"Type"}),(0,z.jsx)("th",{className:c,children:"Used"}),(0,z.jsx)("th",{className:c,children:"Allowed"}),(0,z.jsx)("th",{className:c,children:"Remaining"})]})}),(0,z.jsxs)("tbody",{children:[(0,z.jsxs)("tr",{children:[(0,z.jsx)("td",{className:c,children:"Prompt"}),(0,z.jsx)("td",{className:c,children:renderCredits(null==l?void 0:l.usedPromptCredits)}),(0,z.jsx)("td",{className:c,children:renderCredits(null==l?void 0:null===(e=l.planInfo)||void 0===e?void 0:e.monthlyPromptCredits)}),(0,z.jsx)("td",{className:c,children:(null==l?void 0:null===(t=l.planInfo)||void 0===t?void 0:t.monthlyPromptCredits)===-1?"":renderCredits(r)})]}),(0,z.jsxs)("tr",{children:[(0,z.jsx)("td",{className:c,children:"Flow"}),(0,z.jsx)("td",{className:c,children:renderCredits(null==l?void 0:l.usedFlowCredits)}),(0,z.jsx)("td",{className:c,children:renderCredits(null==l?void 0:null===(s=l.planInfo)||void 0===s?void 0:s.monthlyFlowCredits)}),(0,z.jsx)("td",{className:c,children:renderCredits(o)})]}),(0,z.jsxs)("tr",{children:[(0,z.jsx)("td",{className:c,children:"Flex"}),(0,z.jsx)("td",{className:c,children:renderCredits(null==l?void 0:l.usedFlexCredits)}),(0,z.jsx)("td",{className:c,children:renderCredits(null==l?void 0:l.availableFlexCredits)}),(0,z.jsx)("td",{className:c,children:"-"})]})]})]})]})},[x,u,i,r,o,a,h,y.message]),C=a===et.FLT.READ_ONLY,w=a===et.FLT.NO_TOOL,b=(0,eG.classNames)("h-5 flex items-center relative gap-2 px-2",s?"cursor-not-allowed":"cursor-pointer"),handleOptionChange=e=>{if(!s){var a;let s=t(e);p(et.tbr.CASCADE_CLICK_EVENT,{type:"toggle-conversational-planner-mode",value:null!==(a=(0,ec.enumToString)(s,et.FLT))&&void 0!==a?a:"unknown"})}},onEnableTools=e=>{var t;if(!w)return;e.preventDefault(),e.stopPropagation();let s=d.clone();s.cascadePlannerMode=et.FLT.DEFAULT,m(s),p(et.tbr.CASCADE_CLICK_EVENT,{type:"toggle-conversational-planner-mode",value:null!==(t=(0,ec.enumToString)(et.FLT.DEFAULT,et.FLT))&&void 0!==t?t:"unknown"})};return(0,z.jsxs)("div",{className:(0,eG.classNames)("group my-0.5 mr-1 flex cursor-pointer flex-row items-stretch gap-1",s?"!cursor-not-allowed":""),onClick:e=>{handleOptionChange(a),e.stopPropagation(),e.preventDefault()},"data-tooltip-id":"write-mode-tooltip",children:[(0,z.jsxs)("label",{className:b,children:[(0,z.jsx)("input",{className:"hidden",type:"checkbox",checked:!C,disabled:s,onChange:()=>{handleOptionChange(a)}}),(0,z.jsx)("span",{onClick:e=>{e.preventDefault(),e.stopPropagation(),w?onEnableTools(e):handleOptionChange(a)},className:"absolute left-0 right-0 top-1/2 block h-4 -translate-y-1/2 rounded-full bg-gray-500/10 transition-[opacity] group-hover:bg-gray-500/20"}),(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)("span",{onClick:e=>{e.preventDefault(),e.stopPropagation(),w?onEnableTools(e):handleOptionChange(a)},className:(0,eG.classNames)("mr-5 flex items-center justify-center gap-1 text-[0.55rem] opacity-50"),children:"Write"}),(0,z.jsx)("span",{className:(0,eG.classNames)("flex items-center justify-center gap-1 overflow-hidden text-[0.55rem] opacity-50 transition-[width]",w?"w-0":"w-min"),children:"Chat"}),(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(nD.Z,{className:"h-3.5 w-3.5"}),(0,z.jsx)("span",{onClick:e=>{var t;e.preventDefault(),e.stopPropagation();let s=d.clone();s.cascadePlannerMode=et.FLT.NO_TOOL,m(s),p(et.tbr.CASCADE_CLICK_EVENT,{type:"toggle-conversational-planner-mode",value:null!==(t=(0,ec.enumToString)(et.FLT.NO_TOOL,et.FLT))&&void 0!==t?t:"unknown"})},className:"absolute bottom-0 right-0 right-0 top-0 w-5"})]})]}),(0,z.jsxs)("span",{onClick:e=>{e.preventDefault(),e.stopPropagation(),w?onEnableTools(e):handleOptionChange(a)},className:(0,eG.classNames)("absolute flex h-5 w-[3.25rem] translate-x-0 flex-row items-center justify-center overflow-hidden rounded-full border border-gray-500/25 bg-ide-editor-background px-0.5 text-[0.6rem] font-medium text-ide-message-block-user-color transition-[left,opacity,translate,width] group-hover:opacity-100",C?"left-[2.125rem] group-hover:left-[calc(2.125rem_-_1px)]":"",a===et.FLT.DEFAULT?"left-0 group-hover:left-[1px]":"",w?"left-[calc(2.25rem)] group-hover:left-[calc(2.25rem_-_1px)]":""),children:[(0,z.jsx)("div",{className:"absolute inset-0 z-0 bg-ide-message-block-user-background"}),(0,z.jsxs)("span",{className:(0,eG.classNames)("absolute left-1/2 top-1/2 flex -translate-y-1/2 items-center gap-1 opacity-0 transition-[opacity,transform]",C?"-translate-x-1/2 opacity-100":"translate-x-1/2"),children:[(0,z.jsx)(nH.Z,{className:"h-3 w-3 stroke-1"}),"Chat"]}),(0,z.jsxs)("span",{className:(0,eG.classNames)("absolute left-1/2 top-1/2 flex -translate-y-1/2 items-center gap-1 opacity-0 transition-[opacity,transform]",C||w?"-translate-x-[150%]":"-translate-x-1/2 opacity-100"),children:[(0,z.jsx)(nh.Z,{className:"h-3 w-3 stroke-1"}),"Write"]}),(0,z.jsx)("span",{className:(0,eG.classNames)("absolute left-1/2 top-1/2 flex -translate-y-1/2 items-center gap-1 opacity-0 transition-[opacity,transform]",w?"-translate-x-1/2 opacity-100":"-translate-x-[150%]"),children:"Legacy"})]})]}),(0,z.jsx)(CompactTooltip,{id:"write-mode-tooltip",children:(0,z.jsx)("div",{className:"max-w-[16rem]",children:w?(0,z.jsxs)(z.Fragment,{children:[n<=0?(0,z.jsx)("b",{children:"You have no premium Flow Action credits left. "}):"","In Legacy mode, Cascade will not be able to use any premium Flow Action credits to answer your questions and will have reduced contextual awareness.",n>0?"":" You will not be able to re-enable tools until you have more premium Flow Action or Flex credits.",v]}):(0,z.jsx)(z.Fragment,{children:s?(0,z.jsx)("span",{children:"Cascade mode cannot be changed when running."}):(0,z.jsxs)("span",{children:["When Write mode is turned on, Cascade will be able to make changes to your code."," ",(0,z.jsxs)("span",{className:"opacity-50",children:["Toggle with (","jetbrains"===g?f?"":"Ctrl + ":f?"":"Ctrl + ",".)"]})]})})})})]})},Attachments=()=>{let{state:{selectedImages:e},events:{setSelectedImages:t}}=useCascadeContext(),[s,a]=(0,X.useState)(null);if(!e.length)return null;let handleRemoveImage=s=>{t(e.filter((e,t)=>t!==s))},onSelectImage=t=>{let s=e[t];s&&a(s)};return(0,z.jsxs)("div",{className:"mx-1 -mb-2 flex flex-row gap-1 rounded-t bg-gray-500/10 p-2 pb-4",children:[e.map((e,t)=>(0,z.jsxs)("div",{className:"group relative cursor-pointer",children:[(0,z.jsx)("img",{src:"data:".concat(e.mimeType,";base64,").concat(e.base64Data),alt:"User uploaded image ".concat(t+1),className:"h-8 w-8 rounded-md border border-gray-500/25 object-cover",onClick:onSelectImage.bind(void 0,t)}),(0,z.jsx)("button",{onClick:e=>{e.stopPropagation(),handleRemoveImage(t)},className:"absolute -right-1 -top-1 rounded-full bg-gray-700 p-0.5 opacity-0 hover:bg-gray-600 group-hover:opacity-100",children:(0,z.jsx)(tL.Z,{className:"h-3 w-3 text-white"})})]},"".concat(t,"-").concat(e.base64Data))),s&&(0,z.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",onClick:()=>{a(null)},children:(0,z.jsxs)("div",{className:"relative max-h-[90vh] max-w-[90vw]",children:[(0,z.jsx)("img",{src:"data:".concat(s.mimeType,";base64,").concat(s.base64Data),alt:"Enlarged image",className:"max-h-[90vh] max-w-[90vw]"}),(0,z.jsx)("button",{className:"absolute -right-4 -top-4 rounded-full bg-ide-editor-background p-2 text-ide-tooltip-color hover:bg-opacity-80",onClick:e=>{e.stopPropagation(),a(null)},children:(0,z.jsx)(tL.Z,{className:"h-4 w-4"})})]})})]})};var nV=s(14189);let ImageUpload=()=>{let{logEvent:e}=useServerConnectionContext(),{events:{handleImages:t}}=useCascadeContext(),s=(0,X.useRef)(null),handleImageUpload=async e=>{let s=e.target.files;s&&0!==s.length&&(await t(s),e.target.value="")};return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)("input",{type:"file",ref:s,onChange:e=>{handleImageUpload(e)},accept:".png,.jpg,.jpeg,.gif,image/png,image/jpeg,image/gif",multiple:!0,className:"hidden"}),(0,z.jsxs)("button",{className:"group relative flex cursor-pointer items-center justify-center gap-x-0.5 rounded px-1 py-0.5 text-xs hover:bg-gray-500/20",type:"submit",onClick:()=>{var t;null===(t=s.current)||void 0===t||t.click(),e(et.tbr.CASCADE_CLICK_EVENT,{type:"image-upload"})},children:[(0,z.jsx)(nV.Z,{className:"h-3.5 w-3.5 flex-none opacity-70 transition-[opacity] group-hover:opacity-100"}),(0,z.jsx)("div",{className:"ws-sm:block hidden whitespace-nowrap leading-none opacity-70 transition-[opacity] group-hover:opacity-100",children:"Image"})]})]})};var nY=s(38980);let CascadeInputWithConfig=()=>{let{events:{cancelInvocation:e},state:{hasSetInitialModel:t,cascadeConversationState:s},layout:{lexicalRef:a,focusEditor:n}}=useCascadeContext(),r=null==s?void 0:s.cascadeId,{props:{openGenericUrl:o},logEvent:i}=useServerConnectionContext(),l=(0,X.useId)(),c=(0,X.useRef)(null);return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(Attachments,{}),(0,z.jsx)("div",{className:"w-full pb-1",children:(0,z.jsx)(CascadeInput,{handleCancel:e,activeCascadeId:r})}),(0,z.jsx)("div",{className:"flex flex-row py-1 pt-0",children:(0,z.jsxs)("div",{ref:c,className:"flex w-full items-center gap-0.5",children:[(0,z.jsx)(SendModeSelector,{}),(0,z.jsx)(CascadeModelSelect,{isLoading:!t}),(0,z.jsx)(ns.Z,{"data-tooltip-id":l,onClick:()=>{o("https://codeium.com/redirect/windsurf/models")},className:"h-3.5 w-3.5 flex-none cursor-pointer opacity-30 transition-[opacity] hover:opacity-100",tabIndex:0}),(0,z.jsx)(CompactTooltip,{place:"bottom",id:l,children:"Click here to learn more about the available models."}),(0,z.jsx)("div",{className:"flex-grow"}),(0,z.jsx)("div",{className:"ws-xs:flex flex hidden shrink-0 cursor-pointer flex-row items-center gap-1 overflow-hidden rounded p-0.5 opacity-70 hover:bg-gray-500/20 hover:opacity-100",onClick:()=>{n(),requestAnimationFrame(()=>{var e;null===(e=a.current)||void 0===e||e.update(()=>{(0,sQ.Lh)(["@"],"","@","",{})})}),i(et.tbr.CASCADE_CLICK_EVENT,{type:"insert-at-mention"})},role:"button","aria-label":"Add mention",children:(0,z.jsxs)("p",{className:"ws-xs:flex hidden items-center gap-x-0.5 text-xs leading-none",children:[(0,z.jsx)(nY.Z,{className:"h-3.5 w-3.5"})," "]})}),(0,z.jsx)(ImageUpload,{})]})})]})};var nZ=s(67976),nK=s(7714);let CascadeFloatingNotif=e=>{let{anchorRef:t,children:s}=e,[a,n]=(0,X.useState)({top:0,left:0}),[r,o]=(0,X.useState)(0),i=(0,X.useRef)(null),l=(0,X.useCallback)(()=>{if(!t.current||!i.current){requestAnimationFrame(l);return}let e=t.current.getBoundingClientRect(),s=e.top-8,a=e.left;o(e.width),n({top:s,left:a})},[t]);return(0,X.useEffect)(()=>{l();let handleResize=()=>{l()};return window.addEventListener("resize",handleResize),window.addEventListener("scroll",handleResize,!0),()=>{window.removeEventListener("resize",handleResize),window.removeEventListener("scroll",handleResize,!0)}},[l]),(0,X.useEffect)(()=>{let e;if(!t.current)return;let s=t.current.getBoundingClientRect(),trackPositionChanges=()=>{if(!t.current)return;let a=t.current.getBoundingClientRect();(s.top!==a.top||s.left!==a.left||s.width!==a.width||s.height!==a.height)&&(l(),s=a),e=requestAnimationFrame(trackPositionChanges)};e=requestAnimationFrame(trackPositionChanges);let handleViewportChange=()=>{t.current&&l()};return window.addEventListener("scroll",handleViewportChange,!0),window.addEventListener("resize",handleViewportChange),()=>{cancelAnimationFrame(e),window.removeEventListener("scroll",handleViewportChange,!0),window.removeEventListener("resize",handleViewportChange)}},[t,l]),(0,z.jsx)("div",{ref:i,style:{position:"fixed",top:a.top,left:a.left,zIndex:1e4,width:r,transform:"translateY(-100%)"},children:s})},CascadeTooltip=e=>{let t,{withEvergreenToolbar:s}=e,{state:{lastDateWarnedRunningOutOfCredits:a,activeNux:n},events:{dismissWarningRunningOutOfCredits:r,dismissNux:o}}=useCascadeUIStateContext(),{layout:{cascadeTooltipRef:i},state:{remainingPromptAndFlexCredits:l,remainingToolAndFlexCredits:c,interruptConfirmation:d,cascadeState:u,isPremiumUser:m,currentModelConfig:p,cascadePanelState:x,isModifierPressed:h,hasDismissedEditHistory:g,errorMessage:f,conversationalPlannerMode:y,canBuyMoreCredits:v},events:{setHasDismissedEditHistory:C,setInterruptConfirmation:w,setErrorMessage:b,toggleConversationalPlannerMode:N}}=useCascadeContext(),{props:{openQuickSettings:S,updateIdePlanInfo:j},logEvent:E}=useServerConnectionContext(),I=null==u?void 0:u.status,T=null==x?void 0:x.planStatus,k=null==u?void 0:u.cascadeId,[R,_]=(0,X.useState)(I),[D,A]=(0,X.useState)(void 0),[P,M]=(0,X.useState)(!1),[L,O]=(0,X.useState)({});(0,X.useEffect)(()=>{!h||g||k?k&&M(!1):M(!0)},[h,g,k]),(0,X.useEffect)(()=>{I!==R&&(_(I),I===eS.xDu.RUNNING?A("Running"):I===eS.xDu.IDLE?(A("Done"),null==j||j(),setTimeout(()=>{A(void 0)},5e3)):I===eS.xDu.CANCELING?A("Canceling"):I===eS.xDu.BUSY&&A("Busy"))},[I,R,j]);let F=(0,tx.useIsMac)(),B=(0,eG.classNames)("top-0 w-min-content left-[50%] -translate-x-1/2 bg-ide-chat-background rounded-full px-2 py-1 absolute whitespace-nowrap","-translate-y-1/2 transition-[opacity] transition-[transform] opacity-0","whitespace-wrap text-xs text-ide-editor-color","border-[1px] border-gray-500/25 shadow-[0_2px_2px_0_rgba(0,0,0,0.05)]"),q=(0,eG.classNames)(B,D?"opacity-100 -translate-y-[calc(100%_+_0.5rem)]":""),U=(0,eG.classNames)(B,"!bg-ide-button-background !text-ide-button-color max-w-[90vw] font-medium",d?"opacity-100 -translate-y-[calc(100%_+_0.5rem)]":""),G=(0,eG.classNames)(B,"!left-[unset] !right-2 !translate-x-0 flex flex-row items-center gap-2",!P||D||d?"":"!flex opacity-100 -translate-y-[calc(100%_+_0.5rem)]"),Q=y!==et.FLT.NO_TOOL&&(0,z.jsxs)("div",{className:G,"data-tooltip-id":"edit-with-history-tooltip",children:[(0,z.jsxs)("span",{className:"opacity-70",children:["Start with History ",F?"":"Ctrl + ",""]}),(0,z.jsx)("div",{className:"cursor-pointer",onClick:()=>{M(!1),C(!0)},children:(0,z.jsx)(tL.Z,{className:"h-3 w-3"})})]});switch(I){case eS.xDu.RUNNING:t=s7.BadgeStatus.Green;break;case eS.xDu.IDLE:t=s7.BadgeStatus.Gray;break;case eS.xDu.BUSY:t=s7.BadgeStatus.Yellow;break;case eS.xDu.CANCELING:t=s7.BadgeStatus.Red}let W="Cascade Base"===p.label,H="absolute -top-2 -translate-y-full left-1 right-1 rounded bg-red-600 px-2 pb-1 pt-1.5 text-sm text-red-100",V="absolute -top-2 -translate-y-full left-1 right-1 rounded bg-yellow-600 px-2 pb-1 pt-1.5 text-sm text-yellow-100",Z="absolute -top-2 -translate-y-full left-1 right-1 rounded bg-ide-button-background px-2 pb-1 pt-1.5 text-sm text-ide-button-color",K=(0,X.useMemo)(()=>void 0!==T&&void 0!==T.planInfo&&isCreditRunningLow(T.planInfo,T),[T]),onDismissWebSearchNUX=()=>{o(),O({...L,webSearch:0})};if(n===et.NQJ.CASCADE_NUX_EVENT_WEB_SEARCH&&I===eS.xDu.IDLE){if(!L.webSearch)return(0,z.jsxs)("div",{className:Z,children:[(0,z.jsxs)("div",{className:"flex items-center gap-2",children:[(0,z.jsx)(st.Z,{className:"h-3.5 w-3.5 flex-none stroke-ide-button-color"}),(0,z.jsxs)("p",{className:"leading-tight",children:[(0,z.jsx)("strong",{children:"New"}),": Web search is a configurable tool call that can access the web for you. It'll be used to answer questions that need real-time context."]})]}),(0,z.jsx)("div",{className:"mb-1 mt-2 flex justify-end",children:(0,z.jsxs)("div",{className:"group flex cursor-pointer items-center gap-1 hover:opacity-70",onClick:()=>{O({...L,webSearch:1})},children:[(0,z.jsx)("span",{children:"Next"}),(0,z.jsx)(ny.Z,{className:"h-3.5 w-3.5 flex-none stroke-ide-button-color transition-[transform] group-hover:translate-x-[2px]"})]})})]});if(1===L.webSearch)return(0,z.jsxs)("div",{className:Z,children:[(0,z.jsxs)("div",{className:"flex items-center gap-2",children:[(0,z.jsx)(st.Z,{className:"h-3.5 w-3.5 flex-none stroke-ide-button-color"}),(0,z.jsx)("p",{className:"leading-tight",children:"Web search may run many sequential searches and consume many credits. To turn it off, go to your settings."})]}),(0,z.jsxs)("div",{className:"mb-1 mt-2 flex justify-between",children:[(0,z.jsxs)("div",{onClick:()=>{O({...L,webSearch:0})},className:"ml-1 flex cursor-pointer items-center gap-1 opacity-50 transition-[opacity] hover:opacity-100",children:[(0,z.jsx)(nZ.Z,{className:"h-3.5 w-3.5 flex-none stroke-ide-button-color"}),"Previous"]}),(0,z.jsxs)("div",{className:"flex items-center gap-4",children:[(0,z.jsx)("div",{className:"group flex cursor-pointer items-center gap-1 opacity-70 transition-[opacity] hover:opacity-100",onClick:()=>{onDismissWebSearchNUX(),null==S||S(Y.Settings)},children:(0,z.jsx)("span",{children:"Settings"})}),(0,z.jsx)("div",{className:"flex cursor-pointer items-center gap-1 opacity-70 transition-[opacity] hover:opacity-100",onClick:onDismissWebSearchNUX,children:"Dismiss"})]})]})]})}let $=getCascadeSendMessageError(l,c,p,y,m);if($.code===J.LEGACY_NOT_SUPPORTED)return(0,z.jsx)("div",{className:H,children:(0,z.jsxs)("div",{className:"flex items-center justify-between gap-1",children:[(0,z.jsxs)("div",{className:"flex items-center gap-1",children:[(0,z.jsx)(nK.Z,{className:"h-6 w-6 flex-none stroke-red-100"}),(0,z.jsx)("p",{children:$.message})]}),(0,z.jsx)("div",{onClick:()=>{N(et.FLT.NO_TOOL),E(et.tbr.CASCADE_CLICK_EVENT,{element:"cascade-tooltip",type:J.LEGACY_NOT_SUPPORTED})},className:"cursor-pointer underline hover:text-red-200 hover:opacity-70",children:"Switch"})]})});if($.code===J.WRITE_CHAT_INSUFFICIENT_USER_PROMPT_CREDITS||$.code===J.WRITE_CHAT_INSUFFICIENT_FLOW_ACTION_CREDITS||$.code===J.LEGACY_NOT_ENOUGH_CREDITS||$.code===J.WRITE_CHAT_UPGRADE_FOR_CREDITS)return(0,z.jsx)("div",{className:H,children:(0,z.jsxs)("div",{className:"flex items-center justify-between gap-1",children:[(0,z.jsxs)("div",{className:"flex items-center gap-1",children:[(0,z.jsx)(nK.Z,{className:"h-6 w-6 flex-none stroke-red-100"}),(0,z.jsx)("p",{children:$.message})]}),(0,z.jsx)("a",{href:"https://codeium.com/redirect/windsurf/".concat($.code===J.WRITE_CHAT_UPGRADE_FOR_CREDITS?"upgrade":"add-credits"),className:"cursor-pointer underline hover:text-red-200 hover:opacity-70",onClick:()=>{var e;E(et.tbr.CASCADE_CLICK_EVENT,{element:"cascade-tooltip",type:null!==(e=$.code)&&void 0!==e?e:""})},children:$.code===J.WRITE_CHAT_UPGRADE_FOR_CREDITS?"Upgrade":"Purchase"})]})});if($.code===J.WRITE_CASCADE_BASE_ON_FREE_PLAN)return(0,z.jsx)("div",{className:H,children:(0,z.jsxs)("div",{className:"flex items-center justify-between gap-1",children:[(0,z.jsxs)("div",{className:"flex items-center gap-1",children:[(0,z.jsx)(nK.Z,{className:"h-6 w-6 flex-none stroke-red-100"}),(0,z.jsx)("p",{children:$.message})]}),(0,z.jsx)("a",{href:"https://codeium.com/redirect/windsurf/upgrade",className:"cursor-pointer underline hover:text-red-200 hover:opacity-70",onClick:()=>{E(et.tbr.CASCADE_CLICK_EVENT,{element:"cascade-tooltip",type:J.WRITE_CASCADE_BASE_ON_FREE_PLAN})},children:"Upgrade"})]})});if(f)return(0,z.jsx)(CascadeFloatingNotif,{anchorRef:i,children:(0,z.jsxs)("div",{className:"flex w-full items-center justify-between gap-1 rounded bg-red-600 px-2 pb-1 pt-1.5 text-sm text-red-100",children:[f,(0,z.jsx)(aG.Z,{className:"h-4 w-4 flex-shrink-0 cursor-pointer stroke-red-100 hover:opacity-70",onClick:()=>{b("")}})]})});if(K&&!a&&!W){let onDismiss=()=>{r()};return v?(0,z.jsx)("div",{className:V,children:(0,z.jsxs)("div",{className:"flex items-center gap-1",children:[(0,z.jsx)(nK.Z,{className:"h-6 w-6 flex-none stroke-yellow-100"}),(0,z.jsx)("p",{children:"You're running low on credits. Purchase more credits to continue using premium models."}),(0,z.jsx)("div",{className:"grow"}),(0,z.jsx)("a",{href:"https://codeium.com/redirect/windsurf/add-credits",className:"cursor-pointer underline hover:text-red-200 hover:opacity-70",onClick:()=>{E(et.tbr.CASCADE_CLICK_EVENT,{element:"cascade-tooltip",type:"low-on-credits"})},children:"Purchase"}),(0,z.jsx)("div",{className:"cursor-pointer hover:opacity-70",onClick:onDismiss,children:(0,z.jsx)(tL.Z,{className:"h-3 w-3"})})]})}):(0,z.jsx)("div",{className:V,children:(0,z.jsxs)("div",{className:"flex items-center gap-1",children:[(0,z.jsx)(nK.Z,{className:"h-6 w-6 flex-none stroke-yellow-100"}),(0,z.jsx)("p",{children:"You're running low on credits. Upgrade to access more credits."}),(0,z.jsx)("div",{className:"grow"}),(0,z.jsx)("a",{href:"https://codeium.com/redirect/windsurf/upgrade",className:"cursor-pointer underline hover:text-red-200 hover:opacity-70",onClick:()=>{E(et.tbr.CASCADE_CLICK_EVENT,{element:"cascade-tooltip",type:"low-on-credits-free-user"})},children:"Upgrade"}),(0,z.jsx)("div",{className:"cursor-pointer hover:opacity-70",onClick:onDismiss,children:(0,z.jsx)(tL.Z,{className:"h-3 w-3"})})]})})}return(0,z.jsxs)(z.Fragment,{children:[Q,P&&!D&&!d&&(0,z.jsx)(e7.u,{opacity:1,id:"edit-with-history-tooltip",positionStrategy:"fixed",className:"z-[1] max-w-[350px] !bg-ide-editor-background !p-2 !py-1 !text-ide-tooltip-color",border:"1px solid var(--codeium-chat-background-color, rgba(255, 255, 255, 0.1))",children:"Start with History will start Cascade with full awareness of the recent changes you have been making to your codebase."}),k&&!d&&!s&&(0,z.jsx)("div",{className:q,children:(0,z.jsxs)("div",{className:"flex flex-row items-center gap-2",children:[(0,z.jsx)(s9.Badge,{status:t,label:""}),(0,z.jsx)("span",{className:"opacity-70",children:D}),(0,z.jsx)("div",{className:"cursor-pointer",onClick:()=>{A(void 0)},children:(0,z.jsx)(tL.Z,{className:"h-3 w-3"})})]})}),(0,z.jsx)("div",{className:U,children:(0,z.jsxs)("div",{className:"flex flex-row items-center gap-2",children:[(0,z.jsx)("span",{className:"w-full overflow-hidden text-ellipsis",children:"Press Enter again to interrupt and send a new message"}),(0,z.jsx)("div",{className:"flex-none cursor-pointer",onClick:()=>{w(!1)},children:(0,z.jsx)(tL.Z,{className:"h-3 w-3"})})]})}),!d&&Q]})};var nz=s(52853);let isValidBackgroundStep=e=>{var t;if(e.status!==eS.V_N.RUNNING&&(!(null===(t=e.metadata)||void 0===t?void 0:t.completedAt)||eP().duration(eP()().diff(eP()(e.metadata.completedAt.toDate()))).asSeconds()>10))return!1;if("runCommand"===e.step.case){let t=e.step.value;return!t.blocking}return!1},useBackgroundCommands=()=>{let{state:{cascadeState:e},events:{cancelStepIndices:t}}=useCascadeContext(),s=null==e?void 0:e.trajectory,a=(0,X.useMemo)(()=>{if(!s)return{backgroundCommands:[],runningCount:0};let e=[],a=0;for(let[o,i]of s.steps.entries())if(isValidBackgroundStep(i)&&(i.status===eS.V_N.RUNNING&&a++,"runCommand"===i.step.case)){var n,r;let s=i.metadata,a=(null==s?void 0:null===(n=s.toolCall)||void 0===n?void 0:n.argumentsJson)||"{}",l=(null===(r=JSON.parse(a))||void 0===r?void 0:r.CommandLine)||"";e.push({cascadeStepIndex:o,command:l,status:i.status,cancel:()=>{t([o])}})}return{backgroundCommands:e,runningCount:a}},[s,t]);return a},CascadeBackgroundCommands=()=>{let{state:{cascadeConversationState:e}}=useCascadeContext(),t=null==e?void 0:e.cascadeId,[s,a]=(0,X.useState)(!1),{backgroundCommands:n,runningCount:r}=useBackgroundCommands(),o=(0,X.useMemo)(()=>n.reverse().map(e=>(0,z.jsxs)("div",{className:"flex h-fit flex-row items-center gap-x-2 overflow-hidden py-0.5 transition-[height]",children:[e.status===eS.V_N.RUNNING?(0,z.jsx)("div",{className:"loader h-4 w-4 flex-shrink-0"}):e.status===eS.V_N.DONE?(0,z.jsx)(to.Z,{className:"h-4 w-4 flex-shrink-0 opacity-50"}):(0,z.jsx)(nz.Z,{className:"h-4 w-4 flex-shrink-0 opacity-50"}),(0,z.jsx)("span",{className:"overflow-hidden text-ellipsis whitespace-nowrap font-mono",children:e.command}),e.status===eS.V_N.RUNNING&&(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)("button",{className:"ml-auto opacity-50 hover:opacity-100",type:"submit",onClick:()=>{e.cancel()},"data-tooltip-id":"".concat(e.cascadeStepIndex,"-cancel-step"),children:(0,z.jsx)(tL.Z,{className:"z-[100] h-4 w-4"})}),(0,z.jsx)(e7.u,{opacity:1,id:"".concat(e.cascadeStepIndex,"-cancel-step"),positionStrategy:"fixed",className:"max-w-[350px] !bg-ide-editor-background !p-2 !py-0 !text-ide-tooltip-color",border:"1px solid var(--codeium-chat-background-color, rgba(255, 255, 255, 0.1))",children:"Cancel this step"})]})]},e.cascadeStepIndex)),[n]);if(!t)return null;let i=n.length;return(0,z.jsxs)("div",{className:(0,eG.classNames)("text-ide-chat-color relative z-[100] w-full bg-ide-chat-background py-1 pr-3",0===i?"hidden":""),children:[(0,z.jsxs)("div",{onClick:()=>{a(e=>!e)},className:"group flex cursor-pointer flex-row items-center ",children:[(0,z.jsx)("div",{className:"flex w-[20px] animate-pulse flex-row justify-center",children:r>0&&(0,z.jsx)(s9.Badge,{status:s7.BadgeStatus.Yellow,label:"",className:"!justify-center rounded-full"})}),(0,z.jsxs)("p",{className:"text-sm opacity-50 transition-[opacity] group-hover:opacity-100",children:["Background Process",i>1?"es":""," (",r," running,"," ",i-r," done)"]}),(0,z.jsx)(nn.Z,{className:(0,eG.classNames)("ml-auto h-4 w-4 transition-[transform]",s?"rotate-180 group-hover:rotate-[175deg]":"group-hover:rotate-[5deg]")})]}),s&&(0,z.jsx)("div",{className:"text-ide-chat-color absolute bottom-1 left-0 right-0 flex max-h-[300px] translate-y-full flex-col overflow-y-auto rounded-b-lg border-b border-gray-500/25 bg-ide-chat-background py-1 pl-[20px] pr-3 shadow-[0_0px_2px_0_rgba(0,0,0,0.1)]",children:o})]})},CascadeUnauthedScreen=()=>{let{props:{handleLogin:e}}=useServerConnectionContext();return(0,z.jsxs)("div",{className:"flex h-full w-full flex-col items-start justify-center px-8 py-12",children:[(0,z.jsx)("div",{className:"text-xl font-medium",children:"Get started with Cascade"}),(0,z.jsx)("div",{className:"text-lg opacity-70",children:"To use Cascade, please sign in to your Codeium account."}),(0,z.jsx)("button",{className:"hover:bg-ide-button-hover-background hover:text-ide-button-hover-color mt-4 rounded bg-ide-button-background px-4 py-2 font-medium text-ide-button-color transition-[background]",onClick:e,children:"Login with Codeium"})]})},CascadeHeaderWarning=()=>{let{state:{isPremiumUser:e,remainingPromptAndFlexCredits:t,remainingToolAndFlexCredits:s}}=useCascadeContext(),{state:{lastDateWarningOutOfCredit:a},events:{dismissWarningOutOfCredit:n}}=useCascadeUIStateContext();return e&&t<=0&&s<=0&&!a?(0,z.jsxs)("div",{className:"bg-ide-button-secondary-background text-ide-button-secondary-color stroke-ide-button-secondary-color flex items-center justify-between py-1 pl-[20px] pr-3 text-sm",children:[(0,z.jsxs)("span",{className:"flex items-center gap-1",children:[(0,z.jsx)(nK.Z,{className:"inline h-5 w-5 fill-yellow-600 stroke-yellow-800"}),(0,z.jsx)("span",{"data-tooltip-id":"out-of-credit-id",className:"underline decoration-dotted",children:"You're out of credits"})]}),(0,z.jsxs)("div",{className:"flex items-center gap-4",children:[(0,z.jsx)("a",{href:"https://codeium.com/redirect/windsurf/out-of-credits",className:"font-medium no-underline hover:text-ide-active-selection-color hover:underline",children:"Purchase more"}),(0,z.jsx)(tL.Z,{onClick:n,className:"h-4 w-4 cursor-pointer opacity-70 hover:stroke-ide-active-selection-color hover:opacity-100"})]}),(0,z.jsx)(CompactTooltip,{id:"out-of-credit-id",place:"bottom",children:(0,z.jsx)("div",{className:"max-w-[90vw]",children:"When out of premium User Prompt or Flow Action credits, Cascade can continue to be used with the Cascade Base model in Write and Chat mode. If you'd like to continue using premium models, purchase additional Flex credits which can be used as User Prompt or Flow Action credits."})})]}):null},HorizontallyCollapsibleItem=e=>{let{children:t,shouldShow:s}=e;return(0,z.jsx)("div",{className:"grid transition-[grid-template-columns] duration-150 ease-in-out",style:{gridTemplateColumns:s?"1fr":"0fr"},children:(0,z.jsx)("div",{className:"min-w-0 overflow-hidden",children:(0,z.jsx)("div",{className:"w-fit",children:t})})})},EvergreenToolbarStatusIndicator=e=>{let t,{compactify:s,cascadeRunStatus:a}=e,{state:{cascadeState:n}}=useCascadeContext(),[r,o]=(0,X.useState)("Idle"),i=(0,X.useMemo)(()=>null!=a?a:null==n?void 0:n.status,[a,n]);switch((0,X.useEffect)(()=>{i===eS.xDu.RUNNING?o("Running"):i===eS.xDu.IDLE?o("Done"):i===eS.xDu.CANCELING?o("Canceling"):i===eS.xDu.BUSY&&o("Busy")},[i]),i){case eS.xDu.RUNNING:t=s7.BadgeStatus.Green;break;case eS.xDu.IDLE:t=s7.BadgeStatus.Gray;break;case eS.xDu.BUSY:t=s7.BadgeStatus.Yellow;break;case eS.xDu.CANCELING:t=s7.BadgeStatus.Red}return(0,z.jsxs)("div",{className:"mx-1 flex items-center justify-center gap-1.5",children:[(0,z.jsx)(HorizontallyCollapsibleItem,{shouldShow:!s,children:(0,z.jsx)("span",{className:"ml-2 flex select-none items-center text-sm opacity-60",children:r})}),(0,z.jsx)("div",{"data-tooltip-id":"status-indicator",children:(0,z.jsx)(s9.Badge,{status:t,label:""})}),s&&(0,z.jsxs)(CompactTooltip,{place:"top",id:"status-indicator",children:["Cascade status: ",r]})]})};(j=Z||(Z={})).HOME="home",j.CHANGES_OVERVIEW="changesOverview",j.TERMINAL="terminal",j.MCP="mcp",j.WEB="web",j.ASYNC="async",j.DEPLOY="deploy";let useEvergreenToolbarHome=()=>({id:Z.HOME,icon:null,tooltip:()=>void 0,titleContent:()=>(0,z.jsx)(z.Fragment,{}),actionsContent:()=>(0,z.jsx)(EvergreenToolbarStatusIndicator,{compactify:!1})});var nX=s(8917);(E=K||(K={})).Addition="addition",E.Deletion="deletion",E.Move="move",E.Modified="modified";let ChangesOverviewExpandedContent=e=>{let{fileDiffData:t}=e,{openFilePointer:s}=useServerConnectionContext(),{homeDir:a,workspaceUris:n}=useWorkspaceInfoContext();return(0,z.jsx)("div",{className:"flex flex-col",children:t.map((e,t)=>{let{uri:r,diffType:o,numInsertions:i,numDeletions:l}=e;return(0,z.jsxs)("div",{className:"flex cursor-pointer select-none flex-row items-center gap-x-2 border-gray-500/10 p-1 px-2 hover:bg-gray-500/10",onClick:e=>{s(new OpenFilePointer({fileUri:r})),e.stopPropagation(),e.preventDefault()},children:[(0,z.jsx)("div",{className:(0,eG.classNames)("flex aspect-square h-3 w-3 flex-none items-center justify-center rounded border",o===K.Addition?"border-green text-green":"border-orange text-orange"),children:o===K.Addition?(0,z.jsx)(nX.Z,{}):(0,z.jsx)("span",{className:"h-1 w-1 flex-none rounded-full border-[1px] border-orange bg-orange"})}),(0,z.jsxs)("div",{className:"flex flex-row items-center gap-x-1",children:[(0,z.jsxs)("span",{className:"min-w-5 text-xs text-green-500",children:["+",i]}),(0,z.jsxs)("span",{className:"min-w-5 text-xs text-red-500",children:["-",l]})]}),(0,z.jsx)("span",{className:"whitespace-nowrap text-sm opacity-80",children:getBaseName(r)}),(0,z.jsxs)("span",{"data-tooltip-id":"changes-overview-".concat(t),className:"min-w-0 overflow-hidden text-ellipsis whitespace-nowrap text-xs opacity-50",dir:"rtl",children:[(0,z.jsx)("bdi",{children:prettyPath(r,a,n)}),(0,z.jsx)(CompactTooltip,{id:"changes-overview-".concat(t),children:(0,z.jsx)("bdi",{children:prettyPath(r,a,n)})})]})]},t)})})};let FileDiffData=class FileDiffData{static fromValidationState(e){let t=""===e.lastAcknowledgedState?K.Addition:K.Modified,{numInsertions:s,numDeletions:a}=countLinesInLineDiff(e.lastAcknowledgedState,e.currentState);return new FileDiffData(e.uri,t,s,a)}static fromFileDiffState(e){let t=e.fileCreatedAlongsideDiffZone?K.Addition:K.Modified,{numInsertions:s,numDeletions:a}=countLinesInLineDiff(e.originalText,e.currentText);return new FileDiffData(e.uri,t,s,a)}constructor(e,t,s,a){this.uri=e,this.diffType=t,this.numInsertions=s,this.numDeletions=a}};let useFileDiffData=()=>{let[e,t]=(0,X.useState)([]),s=(0,X.useMemo)(()=>e.map(e=>FileDiffData.fromFileDiffState(e)),[e]),a=(0,X.useCallback)(e=>{if("updateStateForCascadeFilesWithInIdeDiffs"!==e.actionType)return;let s=new TextDecoder().decode(e.payload[0]);try{let e=JSON.parse(s);t(e)}catch(e){console.error("Error parsing file diff JSON data:",e)}},[]);return useRegisterChatClientRequestHandler("sendActionToChatPanel",a),(0,X.useEffect)(()=>{let handleMessage=e=>{"updateStateForCascadeFilesWithInIdeDiffs"===e.data.type&&t(e.data.fileDiffInfo)};return window.addEventListener("message",handleMessage),()=>{window.removeEventListener("message",handleMessage)}},[]),{fileDiffData:s}},ToolbarTitleText=e=>{let{text:t}=e,[s,a]=(0,X.useState)(!1),n=(0,X.useRef)(null);return(0,X.useLayoutEffect)(()=>{let checkOverflow=()=>{n.current&&a(n.current.scrollWidth>n.current.clientWidth)};checkOverflow();let e=new ResizeObserver(checkOverflow);return n.current&&e.observe(n.current),()=>{e.disconnect()}},[t]),(0,z.jsxs)(z.Fragment,{children:[s&&(0,z.jsx)(CompactTooltip,{place:"top",id:"toolbar-title-tooltip",children:t}),(0,z.jsx)("span",{ref:n,className:"block w-full select-none overflow-hidden text-ellipsis whitespace-nowrap text-sm opacity-70","data-tooltip-id":"toolbar-title-tooltip",children:t})]})},AcceptRejectButtons=e=>{let{onAcceptAll:t,onRejectAll:s}=e;return(0,z.jsxs)("div",{className:"flex flex-row items-center gap-1",children:[(0,z.jsx)("span",{className:"cursor-pointer select-none rounded-sm px-1 text-sm opacity-50 hover:opacity-70",onClick:s,children:"Reject all"}),(0,z.jsx)("span",{className:"hover:text-ide-button-hover-color hover:bg-ide-button-hover-background cursor-pointer select-none rounded-sm bg-ide-button-background px-1 text-sm text-ide-button-color",onClick:t,children:"Accept all"})]})},IconWithNotification=e=>{let{icon:t,showNotification:s}=e;return(0,z.jsxs)("div",{className:"relative",children:[(0,z.jsx)("div",{className:"absolute -bottom-0 -right-0 z-10 h-2 w-2 origin-center rounded-full bg-gray-500 transition-all duration-200 ease-out ".concat(s?"scale-100 opacity-100":"scale-0 opacity-0")}),(0,z.jsx)("div",{className:"absolute -bottom-0 -right-0 z-20 h-2 w-2 origin-center rounded-full bg-ide-button-background transition-all duration-200 ease-out ".concat(s?"scale-100 opacity-100":"scale-0 opacity-0")}),t]})},useChangesOverview=e=>{let{setSelectedId:t}=e,{props:{handleCloseAllDiffZones:s}}=useServerConnectionContext(),{state:{cascadeConversationState:a,cascadeState:n}}=useCascadeContext(),r=null==a?void 0:a.cascadeId,{fileDiffData:o}=useFileDiffData(),i=null==n?void 0:n.status,l=(0,X.useRef)(i);(0,X.useEffect)(()=>{i===eS.xDu.IDLE&&i!==l.current&&o.length>0&&t(Z.CHANGES_OVERVIEW),l.current=i},[i,o.length,t]);let closeAllDiffZones=e=>{s&&r&&s(r,e)},c="".concat(o.length," file").concat(1===o.length?"":"s"," with changes");return{id:Z.CHANGES_OVERVIEW,icon:e=>(0,z.jsx)(IconWithNotification,{icon:(0,z.jsx)(a1.Z,{className:"h-4 w-4 opacity-60"}),showNotification:e===Z.HOME&&o.length>0}),tooltip:()=>"Changes overview (".concat(c,")"),titleContent:()=>(0,z.jsx)(ToolbarTitleText,{text:c}),actionsContent:()=>0===o.length?(0,z.jsx)(EvergreenToolbarStatusIndicator,{compactify:!0}):(0,z.jsx)(AcceptRejectButtons,{onAcceptAll:()=>{closeAllDiffZones(!0)},onRejectAll:()=>{closeAllDiffZones(!1)}}),expandedContent:0===o.length?void 0:()=>(0,z.jsx)(ChangesOverviewExpandedContent,{fileDiffData:o})}},TerminalExpandedContent=e=>{let{runningBackgroundCommands:t}=e;return(0,z.jsx)("div",{className:"flex flex-col",children:t.map((e,t)=>(0,z.jsxs)("div",{className:"flex select-none flex-row items-center justify-between gap-x-2 border-gray-500/20 p-1 px-2",children:[(0,z.jsxs)("div",{className:"flex min-w-0 flex-1 items-center gap-x-2",children:[(0,z.jsx)("span",{className:"loader h-4 w-4 flex-shrink-0"}),(0,z.jsx)("span",{className:"overflow-hidden text-ellipsis whitespace-nowrap font-mono text-sm opacity-80",children:e.command})]}),(0,z.jsxs)("div",{"data-tooltip-id":"".concat(e.command,"-").concat(t),className:"flex items-center text-gray-500/55",children:[(0,z.jsx)("button",{onClick:()=>{e.cancel()},children:(0,z.jsx)(aG.Z,{size:16})}),(0,z.jsx)(CompactTooltip,{id:"".concat(e.command,"-").concat(t),children:(0,z.jsx)("span",{children:"Cancel command"})})]})]},t))})},useTerminal=()=>{let{backgroundCommands:e}=useBackgroundCommands(),t=e.filter(e=>e.status===eS.V_N.RUNNING),s=t.length,a="".concat(s," background process").concat(1===s?"":"es"," running");return{id:Z.TERMINAL,icon:e=>(0,z.jsx)(IconWithNotification,{icon:(0,z.jsx)(a3.Z,{className:"h-4 w-4 opacity-60"}),showNotification:e===Z.HOME&&s>0}),titleContent:()=>(0,z.jsx)(ToolbarTitleText,{text:a}),tooltip:()=>"Terminal (".concat(a,")"),expandedContent:t.length>0?()=>(0,z.jsx)(TerminalExpandedContent,{runningBackgroundCommands:t}):void 0,actionsContent:()=>(0,z.jsx)(EvergreenToolbarStatusIndicator,{compactify:!0})}},useMcp=()=>{let{lsClient:e}=useServerConnectionContext(),[t,s]=(0,X.useState)([]),[a,n]=(0,X.useState)(!1),r=(0,X.useRef)(null),o=(0,X.useCallback)(()=>{null===r.current&&(r.current=setInterval(()=>{null==e||e.getMcpServerStates(new ei.kgI({})).then(e=>{e.isLoading||(null!==r.current&&(clearInterval(r.current),r.current=null),n(!1)),s(e.states)})},300))},[e]),i=(0,X.useCallback)(()=>{let refresh=async()=>{try{await (null==e?void 0:e.refreshMcpServers(new ei.FHn({})))}catch(e){}o()};n(!0),refresh()},[e,o]);return(0,X.useEffect)(()=>{o()},[o]),(0,X.useEffect)(()=>()=>{null!==r.current&&(clearInterval(r.current),r.current=null)},[]),{mcpServerStates:t,refreshMcpServerStates:i,isLoading:a}},McpStateDetailedView=e=>{let{state:t}=e,s=t.tools.map((e,t)=>(0,z.jsxs)("div",{className:"px-2.5 pt-1.5",children:[(0,z.jsx)("div",{children:e.name}),(0,z.jsx)("div",{className:"text-sm opacity-60",children:e.description})]},"".concat(e.name,"-").concat(t)));return(0,z.jsx)("div",{className:"flex max-h-56 flex-col gap-y-1 overflow-y-auto border-x-[1px] border-gray-500/25 bg-ide-editor-background pb-1.5",children:s})},McpExpandedContent=e=>{let{mcpServerStates:t}=e,[s,a]=(0,X.useState)(null),n=t.map((e,t)=>{let n="";return n=e.error.length>0?e.error:"".concat(e.tools.length," tool").concat(1===e.tools.length?"":"s"),(0,z.jsx)(VerticallyCollapsibleItem,{shouldShow:s===e.spec.serverName||null===s,children:(0,z.jsxs)("div",{className:"flex flex-col",children:[(0,z.jsxs)("div",{className:"flex cursor-pointer select-none flex-row items-center gap-x-2 p-1 px-2 hover:bg-gray-500/25",onClick:()=>{s===e.spec.serverName?a(null):a(e.spec.serverName)},children:[(0,z.jsx)(StatusIndicator,{status:e.status}),e.spec.serverName,(0,z.jsx)("div",{className:"text-sm opacity-70",children:n})]}),(0,z.jsx)(VerticallyCollapsibleItem,{shouldShow:s===e.spec.serverName,children:(0,z.jsx)(McpStateDetailedView,{state:e})})]})},"".concat(e.spec.serverName,"-").concat(t))});return(0,z.jsx)("div",{className:"flex flex-col",children:n})},StatusIndicator=e=>{let{status:t}=e,s=s7.BadgeStatus.Gray;switch(t){case eS.LUM.ERROR:s=s7.BadgeStatus.Red;break;case eS.LUM.PENDING:s=s7.BadgeStatus.Yellow;break;case eS.LUM.READY:s=s7.BadgeStatus.Green}return(0,z.jsx)(s9.Badge,{status:s,label:""})},n$="Configure",useMcpContribution=()=>{let e=useMcp(),{mcpServerStates:t,refreshMcpServerStates:s,isLoading:a}=e,{props:{openMcpConfigFile:n,openGenericUrl:r},logEvent:o}=useServerConnectionContext(),i=t.filter(e=>void 0!==e.spec),l="".concat(i.length," available MCP server").concat(1===i.length?"":"s");return{id:Z.MCP,icon:()=>(0,z.jsx)(a8.Z,{className:"h-4 w-4 opacity-60"}),titleContent:()=>(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(ToolbarTitleText,{text:l}),(0,z.jsx)(ns.Z,{className:"ml-0.5 h-4 w-4 cursor-pointer opacity-30 hover:opacity-100","data-tooltip-id":"mcp-info-tooltip",onClick:()=>{r("https://codeium.com/redirect/windsurf/mcp")}}),(0,z.jsxs)(CompactTooltip,{id:"mcp-info-tooltip",place:"top",children:["MCP grants Cascade access to custom tools. Click to read",(0,z.jsx)("br",{}),'the docs, or click "',n$,'" to get started with setup.']})]}),tooltip:()=>"MCP (".concat(l,")"),actionsContent:()=>(0,z.jsxs)("div",{className:"flex items-center gap-1",children:[(0,z.jsx)("span",{className:(0,ti.classNames)("select-none rounded-sm px-1 text-sm opacity-50",a?"":"cursor-pointer hover:opacity-70"),onClick:()=>{a||s()},children:(0,z.jsxs)("div",{className:"flex items-center gap-[0.2rem]",children:[a?"Loading...":"Refresh",(0,z.jsx)(sR.ArrowPathIcon,{className:(0,ti.classNames)("h-4 w-4",a?"animate-spin":"")})]})}),n&&(0,z.jsx)("span",{className:"cursor-pointer select-none rounded-sm px-1 text-sm opacity-50 hover:opacity-70",onClick:()=>{n(),o(et.tbr.CLICKED_TO_CONFIGURE_MCP)},children:n$})]}),expandedContent:i.length>0?()=>(0,z.jsx)(McpExpandedContent,{mcpServerStates:i}):void 0,mcpHookInstance:e}},WebToolExpandedContent=e=>{let{runningProxyWebServers:t}=e,{events:{insertText:s}}=useCascadeUIStateContext(),{updateUserSettings:a}=useServerConnectionContext(),{state:{userSettings:n,conversationalPlannerMode:r},events:{setErrorMessage:o}}=useCascadeContext(),i=!n.disableCascadeBrowserPreviews,setBrowserPreviewEnabled=e=>{let t=n.clone();t.disableCascadeBrowserPreviews=!e,a(t)};return(0,z.jsxs)("div",{children:[(0,z.jsxs)("div",{className:"px-2 py-1",children:[(0,z.jsxs)("div",{className:"flex items-center gap-1",children:[(0,z.jsx)("span",{children:"Preview"}),(0,z.jsx)("span",{className:"mr-1 rounded bg-gray-500/20 p-0.5 text-xs",children:"Beta"})]}),(0,z.jsx)("div",{className:"text-sm opacity-70",children:"Preview allows you to send elements and additional context from a local website to Cascade."}),(0,z.jsxs)("div",{className:"mt-2 flex min-h-[1.5rem] items-center gap-2",children:[i&&(0,z.jsx)("span",{onClick:()=>{if(r!==et.FLT.DEFAULT){o("Switch to Write mode to allow Cascade to run Preview.");return}s("Open a browser preview of my website.")},className:"group flex cursor-pointer items-center gap-1 rounded-sm bg-ide-button-background px-1 py-0.5 text-sm text-ide-button-color opacity-70 transition-[opacity] duration-75 hover:opacity-90",children:"Run Preview"}),i?(0,z.jsx)("span",{className:"cursor-pointer text-sm opacity-70 transition-[opacity] duration-100 hover:opacity-100",onClick:()=>{setBrowserPreviewEnabled(!1)},children:"Disable Preview"}):(0,z.jsx)("div",{children:(0,z.jsx)("span",{className:"cursor-pointer text-sm opacity-70 transition-[opacity] duration-100 hover:opacity-100",onClick:()=>{setBrowserPreviewEnabled(!0)},children:"Enable previews"})})]})]}),t.length>0&&(0,z.jsxs)("div",{className:"border-t-[1px] border-gray-500/25 px-2 py-1",children:[(0,z.jsx)("span",{children:"Active previews"}),(0,z.jsx)("div",{className:"mt-1 flex flex-col gap-0.5",children:t.map((e,t)=>(0,z.jsxs)("div",{className:"flex items-center justify-between",children:[(0,z.jsxs)("div",{className:"flex items-center gap-1",children:[(0,z.jsx)("div",{className:"loader h-4 w-4 flex-none"}),(0,z.jsx)("span",{className:"text-sm opacity-70",children:e.name})]}),(0,z.jsx)(ToolCancel,{onCancel:()=>{e.cancel()}})]},"".concat(e.name,"-").concat(t)))})]})]})},useProxyWebServers=()=>{let{state:{cascadeState:e},events:{cancelStepIndices:t}}=useCascadeContext(),s=null==e?void 0:e.trajectory,a=(0,X.useMemo)(()=>{if(!s)return[];let e=[];for(let[a,n]of s.steps.entries())if(n.status===eS.V_N.RUNNING&&"proxyWebServer"===n.step.case){let s=n.step.value.name;e.push({name:s,cancel:()=>{t([a])}})}return e},[s,t]);return{runningProxyWebServers:a}},useWebContribution=()=>{let{props:{openGenericUrl:e}}=useServerConnectionContext(),{runningProxyWebServers:t}=useProxyWebServers(),s=t.length;return{id:Z.WEB,icon:e=>(0,z.jsx)(IconWithNotification,{icon:(0,z.jsx)(so.Z,{className:"h-4 w-4 opacity-60"}),showNotification:s>0&&e===Z.HOME}),titleContent:()=>(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(ToolbarTitleText,{text:"Website Preview"}),(0,z.jsx)(ns.Z,{className:"ml-0.5 h-4 w-4 cursor-pointer opacity-30 hover:opacity-100","data-tooltip-id":"mcp-info-tooltip",onClick:()=>{e("https://codeium.com/redirect/windsurf/web-tools")}}),(0,z.jsx)(CompactTooltip,{id:"mcp-info-tooltip",place:"top",children:(0,z.jsxs)("div",{className:"text-sm",children:[(0,z.jsx)("div",{className:"font-medium",children:"Preview"}),(0,z.jsx)("div",{className:"opacity-70",children:"A preview enables you to send Cascade context from a locally running website."})]})})]}),tooltip:()=>"Website Preview".concat(s>0?" (".concat(s," active preview").concat(1===s?"":"s",")"):""),actionsContent:()=>(0,z.jsx)("div",{className:"flex items-center gap-1"}),expandedContent:()=>(0,z.jsx)(WebToolExpandedContent,{runningProxyWebServers:t})}},AsyncExpandedContent=e=>{let{sessions:t,ideName:s}=e,{props:{openGenericUrl:a}}=useServerConnectionContext();return(0,z.jsx)("div",{className:"flex flex-col",children:t.map((e,t)=>{var n,r,o;let i=(n=e.sshUrl,r="/home/windsurf/workspace",o=s,"".concat("windsurf-insiders"===o?"windsurf-insiders":"windsurf","://vscode-remote/ssh-remote+").concat("windsurf","@").concat(n,":").concat(22).concat(r,"/")),l=e.explanation.replace(/^Status:\s*/,"");return(0,z.jsxs)("div",{className:"flex flex-col border-gray-500/20 p-1 px-2",children:[(0,z.jsxs)("div",{className:"flex select-none flex-row items-center justify-between gap-x-2",children:[(0,z.jsx)("div",{className:"flex min-w-0 flex-1 items-center gap-x-2",children:(0,z.jsx)("span",{className:"overflow-hidden text-ellipsis whitespace-nowrap font-mono text-sm opacity-80",children:"".concat(e.sessionId.slice(0,5)," ").concat(e.summary)})}),(0,z.jsxs)("div",{"data-tooltip-id":"".concat(e.sessionId,"-").concat(t),className:"flex items-center text-gray-500/55",children:[e.sshUrl&&(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)("button",{onClick:()=>{a(i)},children:(0,z.jsx)(nc.Z,{size:16})}),(0,z.jsx)(CompactTooltip,{id:"".concat(e.sessionId,"-").concat(t),children:(0,z.jsx)("span",{children:"SSH Into"})})]}),(0,z.jsx)(EvergreenToolbarStatusIndicator,{compactify:!0,cascadeRunStatus:e.status})]})]}),e.explanation&&(0,z.jsxs)("div",{className:"mt-1 pl-2",children:[(0,z.jsx)("span",{className:"mr-1.5 inline-block text-gray-500",children:""}),(0,z.jsx)("span",{className:"block max-w-full overflow-hidden text-ellipsis whitespace-nowrap font-mono text-sm opacity-80",children:l})]})]},t)})})},useAsyncContribution=()=>{let{sessions:e}=useAsyncSessions(),{ideName:t}=useChatParamsContext();return{id:Z.ASYNC,icon:t=>(0,z.jsx)(IconWithNotification,{icon:(0,z.jsx)(nE.Z,{className:"h-4 w-4 opacity-60"}),showNotification:t===Z.HOME&&e.length>0}),tooltip:()=>"Async (".concat(e.length," ").concat(1===e.length?"session":"sessions"," running)"),titleContent:()=>(0,z.jsx)("div",{className:"text-sm font-medium",children:"Async"}),actionsContent:()=>(0,z.jsx)("div",{}),expandedContent:e.length>0?()=>(0,z.jsx)(AsyncExpandedContent,{sessions:e,ideName:t}):void 0}};var n0=s(8367);let EvergreenToolbarNavManager=e=>{let{selectedId:t,setSelectedId:s,setShowExpandedIfExists:a,iconProvider:n}=e,{logEvent:r}=useServerConnectionContext(),o=t===Z.HOME,i=(0,X.useMemo)(()=>n.filter(e=>e.id!==Z.HOME).map(e=>(0,z.jsxs)(HorizontallyCollapsibleItem,{shouldShow:!!o||e.id===t,children:[o&&(0,z.jsx)(CompactTooltip,{id:"tooltip-".concat(e.id),place:"top-start",delayHide:0,children:e.tooltip()}),(0,z.jsx)("div",{onClick:()=>{o?(s(e.id),a(!0),e.id===Z.MCP&&r(et.tbr.ENTERED_MCP_TOOLBAR_TAB)):s(Z.HOME)},className:(0,eG.classNames)("cursor-pointer rounded-sm p-[2px]",o?"hover:bg-gray-500/25":""),"data-tooltip-id":"tooltip-".concat(e.id),children:e.icon&&e.icon(t)})]},e.id)),[n,t,o,s,a,r]);return(0,z.jsxs)("div",{className:(0,eG.classNames)("flex flex-row items-center rounded-sm",o?"":"group cursor-pointer hover:bg-gray-500/25"),children:[(0,z.jsx)(BackArrow,{returnToUnselectedState:()=>{s(Z.HOME)},shouldShow:!o}),(0,z.jsx)("div",{className:(0,eG.classNames)("flex flex-row items-center transition-[gap] duration-150",o?"gap-1":"gap-0"),children:i})]})},BackArrow=e=>{let{returnToUnselectedState:t,shouldShow:s}=e;return(0,z.jsx)(HorizontallyCollapsibleItem,{shouldShow:s,children:(0,z.jsx)("div",{className:"flex flex-row items-center gap-1",children:(0,z.jsx)("div",{className:(0,eG.classNames)("translate-x-[0.07rem] transform opacity-50 transition-transform group-hover:-translate-x-[0.01rem]",s?"cursor-pointer":""),onClick:t,children:(0,z.jsx)(n0.Z,{size:16})})})})},ToolbarExpandedContentContainer=e=>{let{children:t,shouldShow:s}=e,{layout:{cascadeTooltipRef:a}}=useCascadeContext();return(0,z.jsx)("div",{className:"pointer-events-none absolute bottom-full left-[-1px] w-[calc(100%+2px)]",style:{maskImage:"linear-gradient(to bottom, white, white)",WebkitMaskImage:"linear-gradient(to bottom, white, white)"},children:(0,z.jsx)("div",{className:(0,ti.classNames)("pointer-events-auto w-full overflow-hidden rounded-t-md bg-ide-editor-background transition-all duration-150 ease-in-out",s?"":"translate-y-full"),children:(0,z.jsx)("div",{className:"max-h-64 overflow-y-auto rounded-t-md border-x-[1px] border-t-[1px] border-gray-500/25 bg-gray-500/10",ref:a,children:t})})})};var n1=s(15630);let EvergreenToolbarView=e=>{var t,s;let{contributions:a,selectedId:n,setSelectedId:r}=e,[o,i]=(0,X.useState)(!1),l=null===(s=a.find(e=>e.id===n))||void 0===s?void 0:null===(t=s.expandedContent)||void 0===t?void 0:t.call(s),c=void 0!==l,d=o&&c;return(0,z.jsxs)("div",{className:(0,eG.classNames)("relative z-20 mx-5 flex min-h-[1.8rem] justify-between border-x-[1px] border-t-[1px] border-gray-500/25 px-1 py-1",d?"":"rounded-t-md"),children:[(0,z.jsxs)("div",{className:"flex min-w-0 gap-x-2 overflow-hidden",children:[(0,z.jsx)("div",{className:"flex-none",children:(0,z.jsx)(EvergreenToolbarNavManager,{selectedId:n,setSelectedId:r,setShowExpandedIfExists:i,iconProvider:a})}),(0,z.jsx)("div",{className:"flex min-w-0 flex-shrink items-center overflow-hidden",children:(0,z.jsx)(ToolbarTitle,{selectedId:n,contentProvider:a})})]}),(0,z.jsxs)("div",{className:"flex flex-none items-center gap-1",children:[(0,z.jsx)(ToolbarActions,{selectedId:n,contentProvider:a}),(0,z.jsx)(ExpandButton,{onClick:()=>{i(e=>!e)},currentTabHasExpandedContent:c,toolbarExpanded:d})]}),(0,z.jsx)(ToolbarExpandedContentContainer,{shouldShow:d,children:l})]})},ToolbarTitle=e=>{var t;let{selectedId:s,contentProvider:a}=e,n=null===(t=a.find(e=>e.id===s))||void 0===t?void 0:t.titleContent();return(0,z.jsx)("div",{className:"flex min-w-0 flex-shrink items-center overflow-hidden",children:n})},ToolbarActions=e=>{var t;let{selectedId:s,contentProvider:a}=e,n=null===(t=a.find(e=>e.id===s))||void 0===t?void 0:t.actionsContent();return(0,z.jsx)("div",{className:"flex items-center",children:n})},ExpandButton=e=>{let{onClick:t,currentTabHasExpandedContent:s,toolbarExpanded:a}=e;return(0,z.jsx)(HorizontallyCollapsibleItem,{shouldShow:s,children:(0,z.jsx)("div",{className:"flex cursor-pointer items-center justify-center opacity-70",children:(0,z.jsx)(n1.Z,{size:18,className:(0,eG.classNames)(a?"rotate-180":""),onClick:t})})})},useDeployContribution=()=>{let{lsClient:e}=useServerConnectionContext(),{workspaceUris:t}=useWorkspaceInfoContext(),s=useChatParamsContext(),{events:{sendMessage:a,validateWindsurfJSAppProjectName:n,saveWindsurfJSAppProjectName:r}}=useCascadeContext(),[o,i]=(0,X.useState)(null),[l,c]=(0,X.useState)(null),[d,u]=(0,X.useState)(!1),[m,p]=(0,X.useState)(!1),[x,h]=(0,X.useState)(null),g=(0,X.useCallback)(async(t,s)=>{if(e){u(!0);try{let a=getMetadata(t),n=await e.getActiveAppDeploymentForWorkspace(new ei.Hcm({metadata:a,workspaceUri:s}));i(n.deploymentConfig||null),c(n.deployment||null)}catch(e){console.error("Failed to get active app deployment:",e)}finally{u(!1)}}},[e]);(0,X.useEffect)(()=>{if(t.length>0){let e=t[0];e&&g(s,e)}},[t,s,g]);let handleSaveProjectName=async e=>{if(e===(null==o?void 0:o.projectName)){p(!1);return}let a=t[0];if(!a){console.error("No workspace URI available"),p(!1);return}try{let n=await r(a,e);n&&n.deploymentConfig&&i(n.deploymentConfig),p(!1),t.length>0&&await g(s,a)}catch(e){console.error("Failed to save project name:",e),h("Failed to save project name")}};return{id:"deploy",icon:(0,z.jsx)(ne.Z,{className:"h-4 w-4"}),title:"Deploy",view:(0,z.jsx)("div",{className:"flex flex-col",children:d?(0,z.jsx)("div",{className:"flex items-center justify-center p-4",children:(0,z.jsx)("div",{className:"h-5 w-5 animate-spin rounded-full border-2 border-gray-500 border-t-transparent"})}):m?(0,z.jsxs)("div",{className:"px-2 py-1",children:[(0,z.jsx)("p",{className:"mb-1 text-sm opacity-70",children:"Your website will be deployed to the following domain:"}),(0,z.jsx)(ProjectNameInput,{projectName:(null==o?void 0:o.projectName)||"",onCancel:()=>{p(!1)},validateWindsurfJSAppProjectName:n,onSave:e=>{handleSaveProjectName(e)}}),x&&(0,z.jsx)("div",{className:"text-sm text-red-500",children:x})]}):o?(0,z.jsxs)(z.Fragment,{children:[(0,z.jsxs)("div",{className:"flex flex-col items-stretch gap-1 px-2 py-1",children:[(0,z.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,z.jsx)("div",{className:"opacity-70",children:o.projectName||"No project name"}),(0,z.jsx)("button",{onClick:e=>{e.preventDefault(),p(!0)},className:"cursor-pointer border-0 bg-transparent p-0 underline opacity-70 transition-[opacity] hover:opacity-100 focus:outline-none",children:"Edit project name"})]}),(0,z.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,z.jsx)("div",{className:"opacity-70",children:(null==l?void 0:l.createdAt)?"Last deployed ".concat(new Date(1e3*Number(l.createdAt.seconds)).toLocaleString()):"Not yet deployed"}),(0,z.jsx)("button",{onClick:e=>{e.preventDefault()},className:"cursor-pointer border-0 bg-transparent p-0 underline opacity-70 transition-[opacity] hover:opacity-100 focus:outline-none",children:"View history"})]})]}),(0,z.jsx)("div",{className:"flex flex-col gap-1 border-t-[1px] border-gray-500/15 px-2 py-1",children:(0,z.jsxs)("div",{className:"text-xs opacity-30",children:["Hosted on Netlify.",(null==l?void 0:l.createdAt)&&" Created at ".concat(new Date(1e3*Number(l.createdAt.seconds)).toLocaleString(),".")]})})]}):(0,z.jsxs)("div",{className:"flex items-center justify-between p-2 text-sm",children:[(0,z.jsx)("div",{children:"No active deployment"}),(0,z.jsx)("div",{className:"cursor-pointer font-medium text-ide-link-color opacity-70 transition-[opacity] hover:underline hover:opacity-100 focus:outline-none",onClick:e=>{e.preventDefault(),a([new et.QVo({chunk:{case:"text",value:"Deploy my application"}})])},children:"Deploy website"})]})})}},Deploy_useDeployContribution=()=>{let e=useDeployContribution();return{id:Z.DEPLOY,icon:()=>(0,z.jsx)(ne.Z,{className:"h-4 w-4 opacity-60"}),titleContent:()=>(0,z.jsx)(z.Fragment,{children:(0,z.jsx)(ToolbarTitleText,{text:"Deploy"})}),tooltip:()=>"Deploy your application",actionsContent:()=>(0,z.jsx)(z.Fragment,{}),expandedContent:()=>(0,z.jsx)("div",{className:"flex flex-col",children:null==e?void 0:e.view})}},EvergreenToolbar=()=>{let{userStatus:e,unleash:t}=useServerConnectionContext(),{state:{hasDevExtension:s}}=useCascadeContext(),[a,n]=(0,X.useState)(Z.HOME),r=(0,X.useMemo)(()=>t.isEnabled(et.rpR.CASCADE_ENABLE_MCP_TOOLS),[t]),o=(0,X.useMemo)(()=>{var t;return!(null==e?void 0:null===(t=e.teamConfig)||void 0===t?void 0:t.allowMcpServers)},[e]),i=useEvergreenToolbarHome(),l=useChangesOverview({setSelectedId:n}),c=useTerminal(),d=useMcpContribution(),u=useWebContribution(),m=useAsyncContribution(),p=Deploy_useDeployContribution(),x=[i,l,c,u];return r&&!o&&x.push(d),s&&x.push(m),s&&x.push(p),(0,z.jsx)(EvergreenToolbarView,{contributions:x,selectedId:a,setSelectedId:n})},useMcpToolbarContribution=()=>{var e,t;let{props:{openMcpConfigFile:s,openGenericUrl:a},logEvent:n,unleash:r,userStatus:o}=useServerConnectionContext(),i=(0,X.useMemo)(()=>r.isEnabled(et.rpR.CASCADE_ENABLE_MCP_TOOLS),[r]),l=(0,X.useMemo)(()=>{var e;return!(null==o?void 0:null===(e=o.teamConfig)||void 0===e?void 0:e.allowMcpServers)},[o]),c=useMcpContribution(),d=c.mcpHookInstance;return!i||l?null:{id:"mcp",icon:(0,z.jsx)(a8.Z,{className:"h-4 w-4"}),title:"MCP Servers",view:(0,z.jsxs)("div",{className:"flex flex-col px-2 py-1",children:[(0,z.jsxs)("div",{className:"flex items-center justify-between",children:[(0,z.jsxs)("div",{className:"flex items-center gap-0.5",children:[(0,z.jsxs)("span",{className:"opacity-70",children:[d.mcpServerStates.length," available MCP server",1===d.mcpServerStates.length?"":"s"]}),(0,z.jsx)(ns.Z,{className:"ml-0.5 h-4 w-4 cursor-pointer opacity-30 hover:opacity-100","data-tooltip-id":"mcp-info-tooltip",onClick:()=>{a("https://codeium.com/redirect/windsurf/mcp")}}),(0,z.jsxs)(CompactTooltip,{id:"mcp-info-tooltip",place:"top",children:["MCP grants Cascade access to custom tools. Click to read",(0,z.jsx)("br",{}),"the docs, or click Configure to get started with setup."]})]}),(0,z.jsxs)("div",{className:"flex items-center gap-1",children:[(0,z.jsxs)("div",{className:"flex cursor-pointer items-center gap-1 opacity-50 transition-[opacity] hover:opacity-100",onClick:d.refreshMcpServerStates,children:[(0,z.jsx)("span",{className:"text-xs",children:"Refresh"}),(0,z.jsx)(tc.Z,{className:(0,eG.classNames)("h-4 w-4",d.isLoading?"animate-spin":"")})]}),(0,z.jsxs)("div",{className:"flex cursor-pointer items-center gap-1 opacity-50 transition-[opacity] hover:opacity-100",onClick:()=>{null==s||s(),n(et.tbr.CLICKED_TO_CONFIGURE_MCP)},children:[(0,z.jsx)("span",{className:"text-xs",children:"Configure"}),(0,z.jsx)(a8.Z,{className:"h-4 w-4"})]})]})]}),(0,z.jsx)("div",{className:"mt-1 overflow-hidden",children:null!==(t=null===(e=c.expandedContent)||void 0===e?void 0:e.call(c))&&void 0!==t?t:null})]})}},WebPreviewContent=e=>{let{runningProxyWebServers:t}=e,{events:{insertText:s}}=useCascadeUIStateContext(),{updateUserSettings:a}=useServerConnectionContext(),{state:{userSettings:n}}=useCascadeContext(),r=(0,X.useId)(),o=!n.disableCascadeBrowserPreviews,setBrowserPreviewEnabled=e=>{let t=n.clone();t.disableCascadeBrowserPreviews=!e,a(t)};return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsxs)("div",{className:"flex items-center justify-between",children:[(0,z.jsxs)("div",{className:"flex items-center gap-1",children:[(0,z.jsx)("span",{className:"opacity-70",children:"Preview"}),(0,z.jsx)("span",{className:"mr-1 rounded bg-gray-500/20 p-0.5 text-xs",children:"Beta"}),(0,z.jsx)(ns.Z,{"data-tooltip-id":r,className:"ml-0.5 h-4 w-4 cursor-pointer opacity-30 hover:opacity-100"})]}),(0,z.jsx)(CompactTooltip,{id:r,place:"top",children:(0,z.jsxs)("div",{className:"text-sm",children:[(0,z.jsx)("div",{className:"font-medium opacity-70",children:"Preview"}),(0,z.jsx)("div",{className:"opacity-70",children:"A preview enables you to send Cascade context from a locally running website."})]})}),(0,z.jsxs)("div",{className:"flex min-h-[1.5rem] items-center gap-1",children:[o&&(0,z.jsxs)("span",{onClick:()=>{s("Open a browser preview of my website.")},className:"flex cursor-pointer items-center gap-1 text-xs opacity-50 transition-[opacity] duration-75 hover:opacity-100",children:["Add Preview Prompt",(0,z.jsx)(sG.Z,{className:"h-4 w-4"})]}),o?(0,z.jsxs)(sz.v,{as:X.Fragment,children:[(0,z.jsx)(sz.v.Button,{className:"relative cursor-pointer text-sm opacity-70 transition-[opacity] duration-100 hover:opacity-100",children:(0,z.jsx)(nx.Z,{className:"h-4 w-4"})}),(0,z.jsx)(sD.u,{as:X.Fragment,enter:"transition ease-out duration-100",enterFrom:"transform opacity-0 scale-95",enterTo:"transform opacity-100 scale-100",leave:"transition ease-in duration-75",leaveFrom:"transform opacity-100 scale-100",leaveTo:"transform opacity-0 scale-95",children:(0,z.jsx)(sz.v.Items,{className:"absolute right-0 mt-1 w-40 origin-top-right translate-y-full rounded-md border border-gray-500/25 bg-ide-editor-background py-1 shadow-lg ring-1 ring-ide-editor-background ring-opacity-5 focus:outline-none",children:(0,z.jsx)(sz.v.Item,{children:e=>{let{active:t}=e;return(0,z.jsx)("button",{className:"flex w-full items-center px-2 py-1 text-sm ".concat(t?"bg-ide-tooltip-background":""),onClick:()=>{setBrowserPreviewEnabled(!1)},children:"Disable Preview"})}})})})]}):(0,z.jsx)("div",{children:(0,z.jsx)("span",{className:"cursor-pointer text-sm opacity-70 transition-[opacity] duration-100 hover:opacity-100",onClick:()=>{setBrowserPreviewEnabled(!0)},children:"Enable previews"})})]})]}),t.length>0&&(0,z.jsxs)("div",{className:"border-t-[1px] border-gray-500/25 px-2 py-1",children:[(0,z.jsx)("span",{children:"Active previews"}),(0,z.jsx)("div",{className:"mt-1 flex flex-col gap-0.5",children:t.map((e,t)=>(0,z.jsxs)("div",{className:"flex items-center justify-between",children:[(0,z.jsxs)("div",{className:"flex items-center gap-1",children:[(0,z.jsx)("div",{className:"loader h-4 w-4 flex-none"}),(0,z.jsx)("span",{className:"text-sm opacity-70",children:e.name})]}),(0,z.jsx)(ToolCancel,{onCancel:()=>{e.cancel()}})]},"".concat(e.name,"-").concat(t)))})]})]})},useWebToolbarContribution=()=>({id:"web",icon:(0,z.jsx)(so.Z,{className:"h-4 w-4"}),title:"Preview",view:(0,z.jsx)("div",{className:"flex flex-col px-2 py-1",children:(0,z.jsx)(WebPreviewContent,{runningProxyWebServers:[]})})}),CascadeTools=()=>{let{state:{hasDevExtension:e}}=useCascadeContext(),{state:{userSettings:t},updateUserSettings:s}=useServerConnectionContext(),[a,n]=(0,X.useState)(""),r=useMcpToolbarContribution(),o=useWebToolbarContribution(),i=useDeployContribution(),l=(0,X.useMemo)(()=>{let t=[];return r&&t.push(r),o&&t.push(o),i&&e&&t.push(i),t},[r,o,i,e]),c=l.find(e=>e.id===a);if((0,X.useEffect)(()=>{t.lastSelectedNewConvoTab&&l.some(e=>e.id===t.lastSelectedNewConvoTab)&&n(t.lastSelectedNewConvoTab)},[t.lastSelectedNewConvoTab,l]),0===l.length)return null;let updateTab=e=>{n(e);let a=t.clone();a.lastSelectedNewConvoTab=e,s(a)};return(0,z.jsxs)("div",{className:"mx-1 mt-4 flex flex-col overflow-hidden rounded border border-gray-500/5",children:[(0,z.jsxs)("div",{className:"flex justify-between bg-gray-500/5 p-1",children:[(0,z.jsx)("div",{className:"flex items-center gap-0.5",children:l.map(e=>(0,z.jsxs)("div",{className:(0,eG.classNames)("cursor-pointer p-1 opacity-60 hover:opacity-100",a===e.id?"!opacity-100":""),onClick:()=>{updateTab(e.id)},"data-tooltip-id":"toolbar-".concat(e.id),children:[e.icon,e.title&&(0,z.jsx)(CompactTooltip,{id:"toolbar-".concat(e.id),place:"top",children:e.title})]},e.id))}),(0,z.jsxs)("div",{className:(0,eG.classNames)("flex items-center gap-1 transition-[opacity]",a?"opacity-100":"opacity-0"),children:[(0,z.jsx)("span",{className:"text-xs opacity-50",children:null==c?void 0:c.title}),(0,z.jsx)(tL.Z,{className:"mr-1 h-4 w-4 cursor-pointer opacity-30 transition-[opacity] hover:opacity-100",onClick:()=>{updateTab("")}})]})]}),(0,z.jsx)("div",{className:(0,eG.classNames)("overflow-y-auto transition-[height]",a?"h-min":"h-0"),children:null==c?void 0:c.view})]})},Cascade=()=>{let{apiKey:e}=useChatParamsContext(),{debug:{debugMode:t},events:{revertToStep:s,setCascadeConversationState:a,handleImage:n,clearCascadeId:r},validate:{validateView:o},state:{cascadeConversationState:i,cascadeState:l,activeConfig:c,isRunning:d,userLoaded:u},layout:{scrollRef:m,containerRef:p,triggerScroll:x,focusEditor:h,resetScroll:g,cascadeTooltipRef:f}}=useCascadeContext(),{unleash:y}=useServerConnectionContext(),v=y.isEnabled(et.rpR.CASCADE_USE_EVERGREEN_TOOLBAR),C=null==l?void 0:l.trajectory,[w,b]=(0,X.useState)(!0),[N,S]=(0,X.useState)(!0),[j,E]=(0,X.useState)(0),[I,T]=(0,X.useState)(!1),k=useWindowHeight()<=V.md?"gap-8":"gap-12",[R,_]=(0,X.useState)(!1),{hasDevExtension:D,ideName:A}=useChatParamsContext(),{isDraggingImage:P}=useDragImage({onImageDrop:n});(0,X.useEffect)(()=>{i&&setTimeout(()=>{h()},100)},[i,h]);let M=(0,X.useCallback)(e=>{if("setCascadeId"!==e.actionType)return;let t=new TextDecoder().decode(e.payload[0]);(null==i?void 0:i.cascadeId)!==t&&(r(),a({type:"sync",cascadeId:t})),g()},[a,g,r,i]);useRegisterChatClientRequestHandler("sendActionToChatPanel",M);let L=(0,X.useCallback)(e=>{if(!m.current)return;let t=e.currentTarget.scrollTop,s=t>=m.current.scrollHeight-m.current.clientHeight-64;b(s),T(!0);let a=t<j;a?S(!1):s&&S(!0),E(t)},[j,m]),O=(0,X.useCallback)(()=>{m.current&&m.current.scrollTo({behavior:"smooth",top:m.current.scrollHeight-m.current.clientHeight})},[m]);(0,X.useLayoutEffect)(()=>{N&&w&&setTimeout(()=>{O()},0)},[C,w,N,O]),(0,X.useEffect)(()=>{let e=null;return I&&!R&&D&&(e=setTimeout(()=>{T(!1)},2e3)),()=>{e&&clearTimeout(e)}},[I,R,D]);let F=(0,X.useCallback)(()=>{var e;if(null===(e=window.getSelection())||void 0===e?void 0:e.toString())return;let t=document.getElementById(nQ);null==t||t.focus()},[]);return e?o?(0,z.jsxs)("div",{className:"flex h-full w-full flex-col overflow-y-clip",children:[(0,z.jsx)(CascadeHeader,{}),(0,z.jsx)(ValidateView,{})]}):(0,z.jsxs)("div",{className:(0,eG.classNames)("flex h-full w-full flex-col overflow-x-clip overflow-y-clip pr-[1px]",u?"opacity-100":"opacity-0"),children:[(0,z.jsx)(CascadeHeader,{}),(0,z.jsx)(CascadeHeaderWarning,{}),!v&&(0,z.jsx)(CascadeBackgroundCommands,{}),P&&(0,z.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-[4px]",children:(0,z.jsxs)("div",{className:"flex items-center gap-2 rounded text-lg font-medium text-white",children:[(0,z.jsx)(nV.Z,{className:"h-5 w-5 flex-none stroke-white"}),"Upload to Cascade"]})}),C&&(0,z.jsx)("div",{onScroll:L,ref:m,className:"flex w-full flex-grow flex-col overflow-clip overflow-y-auto",onClick:F,children:(0,z.jsxs)("div",{ref:p,children:[(0,z.jsx)(CortexTrajectory,{isRunning:d,trajectory:C,defaultIsOpen:!0,revertToStepFn:s,debugMode:t,triggerScroll:x}),D&&(0,z.jsx)("div",{onMouseOver:()=>{_(!0)},onMouseLeave:()=>{_(!1)},className:(0,eG.classNames)("fixed left-0 top-10 z-50 transition-[transform]",I?R?"translate-x-0":"translate-x-[calc(-100%_+_1rem)]":"translate-x-[-100%]"),children:(0,z.jsx)(TableOfContents,{trajectory:C})}),(0,z.jsx)("div",{className:"min-h-[64px]"})]})}),(0,z.jsxs)("div",{className:(0,eG.classNames)("relative flex flex-col px-4 text-ide-message-block-bot-color",k),children:[!C&&(0,z.jsx)(CascadeIntro,{}),(0,z.jsxs)("div",{className:"relative mt-4 flex flex-col",ref:f,children:[(0,z.jsx)(CascadeTooltip,{withEvergreenToolbar:!0}),C&&(0,z.jsx)(EvergreenToolbar,{}),(0,z.jsx)(CascadeInputWithConfig,{}),!C&&isWindsurf(A)&&(0,z.jsx)(CascadeTools,{})]}),!C&&(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(CascadeSelector,{activeConfig:c,setCascadeConversationState:a}),(0,z.jsx)("div",{className:"mt-auto pb-4 text-xs opacity-30",children:"AI may make mistakes. Double-check all generated code."})]})]})]}):(0,z.jsx)(CascadeUnauthedScreen,{})},ExtensionContent=e=>{let t,{}=e,{view:s,tab:a}=useNavigationContext(),[n,r]=(0,X.useState)(!1);return(!function(){let{retrigger:e}=useBrainContext(),{handlers:{focusNextStep:t,focusPrevStep:s}}=useCortexContext(),a=(0,X.useCallback)(ar()(()=>{e()},500),[e]);(0,X.useEffect)(()=>{let onMessage=e=>{switch(e.data.type){case et.twY.ACTIVE_EDITOR_CHANGED:a();break;case et.twY.SHOW_NEXT_CORTEX_STEP:t();break;case et.twY.SHOW_PREVIOUS_CORTEX_STEP:s()}};return window.addEventListener("message",onMessage),()=>{window.removeEventListener("message",onMessage)}},[a,e,t,s])}(),useInitPanel(),(0,X.useEffect)(()=>{let onMessage=e=>{"toggleFocus"===e.data.type&&a===et.q80.CHAT&&n&&r(!1)};return window.addEventListener("message",onMessage),()=>{window.removeEventListener("message",onMessage)}},[a,n]),s===R.SETTINGS)?(0,z.jsx)(Profile,{}):s===R.CONTEXT_SETTINGS?(0,z.jsx)(BrainView,{}):s===R.CASCADE?(0,z.jsx)(CascadeContextProvider,{children:(0,z.jsx)(CascadeUIStateContextProvider,{children:(0,z.jsx)(Cascade,{})})}):s===R.DEBUG?(0,z.jsx)(Debug,{}):(t=n?(0,z.jsx)(ConversationHistory,{onClose:()=>{r(!1)}}):s===R.CONTEXT_SETTINGS?(0,z.jsx)(BrainView,{}):(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(ConversationSettings,{onShowConversationHistory:()=>{r(!0)}}),(0,z.jsx)(ChatView,{}),(0,z.jsx)(ChatFooter,{})]}),(0,z.jsx)(ConversationContextProvider,{children:t}))},ErrorScreen=e=>{let t,{error:s,displayError:a=!0}=e,{ideName:n}=useChatParamsContext(),{clearCapturedError:r}=useDebuggingContext(),{hasDevExtension:o}=useChatParamsContext(),[i,l]=(0,X.useState)(!1),{props:c}=useServerConnectionContext(),[d,u]=(0,X.useState)(!1),[m,p]=(0,X.useState)(!1),x="vscode"==n||"windsurf"==n?(0,z.jsxs)("div",{className:"mt-8 w-full",children:[(0,z.jsx)("h6",{className:"text-base font-medium",children:"3. Resetting Cascade"}),(0,z.jsx)("p",{className:"text-sm",children:"After sending the IDE logs, reload your window to resume Cascade use."}),(0,z.jsx)("button",{onClick:c.handleReload,className:(0,eG.classNames)("mt-2 cursor-pointer rounded px-2 py-0.5 text-sm font-medium",m?"bg-ide-button-background text-ide-button-color":"text-ide-button-secondary-color bg-ide-button-secondary-background"),children:"Reload Cascade"})]}):null,h=null;return"object"==typeof s&&null!==s&&"message"in s&&(t=s.message),o&&!t&&(t="Error has no message field."),a&&t&&(h=(0,z.jsx)("p",{className:"mb-2 mt-2 flex-grow font-mono opacity-80",children:t})),(0,z.jsxs)("div",{className:"flex h-full w-full flex-col items-center justify-center",children:[i&&(0,z.jsx)(s6.DangerModal,{isOpen:i,title:"Confirm dismiss?",description:"Did you make sure to report this error on Slack?",confirmText:"I did",onConfirm:()=>{r(),l(!1)},onCancel:()=>{l(!1)}}),(0,z.jsxs)("div",{className:"flex flex-col items-start justify-center px-8 py-4",children:[(0,z.jsx)("h4",{className:"mb-2 mt-4 text-lg font-medium",children:"Something went wrong"}),h,(0,z.jsx)("h6",{className:"mt-2 text-base font-medium",children:"1. Gathering Logs"}),(0,z.jsxs)("p",{className:"mb-2 flex-grow",children:["If you are having difficulty using ","windsurf"===n?"Windsurf":"Codeium",", please gather the IDE logs to help us diagnose the issue."]}),(0,z.jsxs)("div",{className:"mb-2 flex gap-2",children:[(0,z.jsx)("button",{onClick:()=>{u(!0),c.openGenericUrl("https://docs.codeium.com/troubleshooting/gathering-logs")},className:(0,eG.classNames)("cursor-pointer rounded px-2 py-0.5 text-sm font-medium",d?"text-ide-button-secondary-color bg-ide-button-secondary-background":"bg-ide-button-background text-ide-button-color"),children:"Gather IDE logs"}),o&&(0,z.jsx)("button",{onClick:()=>{o?l(!0):r()},className:"px-2 py-0.5 font-medium",children:"Dismiss"})]}),(0,z.jsxs)("div",{className:"mt-4",children:[(0,z.jsx)("h6",{className:"text-base font-medium",children:"2. Sending Logs"}),(0,z.jsxs)("div",{children:["Send the gathered logs to our team by creating a ticket at"," ",(0,z.jsx)("span",{onClick:()=>{c.openGenericUrl("https://codeium.com/support")},className:"cursor-pointer underline",tabIndex:0,children:"codeium.com/support"})," ","as a technical issue."]}),(0,z.jsx)("button",{onClick:()=>{c.openGenericUrl("https://codeium.com/support"),p(!0)},className:(0,eG.classNames)("mt-4 cursor-pointer rounded px-2 py-0.5 text-sm font-medium",!m&&d?"bg-ide-button-background text-ide-button-color":"text-ide-button-secondary-color bg-ide-button-secondary-background"),children:"Send IDE Logs"})]}),x]})]})},OfflineScreen=()=>{let{props:{handleReload:e}}=useServerConnectionContext();return(0,z.jsxs)("div",{className:"flex h-full w-full flex-col items-start justify-center px-8 py-8",children:[(0,z.jsx)("h6",{className:"text-base font-medium",children:"Offline screen"}),(0,z.jsx)("div",{children:"No internet connection was found. Please reconnect to the internet to use Cascade and then try again by reloading the window."}),(0,z.jsx)("button",{onClick:e,className:"mt-4 rounded bg-ide-button-background px-2 py-1 text-ide-button-color",children:"Try again"})]})},ExtensionPanel=e=>{let{}=e,{capturedError:t}=useDebuggingContext(),{ideName:s}=useChatParamsContext();return isWindsurf(s)&&!window.navigator.onLine?(0,z.jsx)(OfflineScreen,{}):void 0!==t?(0,z.jsx)(ErrorScreen,{error:t}):(0,z.jsx)(eY.ErrorBoundary,{FallbackComponent:ErrorScreen,children:(0,z.jsx)(NavigationContextProvider,{children:(0,z.jsx)(BrainContextProvider,{children:(0,z.jsx)(CortexContextProvider,{children:(0,z.jsx)(WorkspaceInfoProvider,{children:(0,z.jsx)(ExtensionContent,{})})})})})})},n2="1rem",FontSizeProvider=e=>{let{children:t}=e,{state:{userSettings:{fontSize:s}}}=useServerConnectionContext();return(0,X.useEffect)(()=>{let e=document.documentElement;e.style.fontSize=function(e){switch(e){case et.Bf8.SMALL:return"0.8rem";case et.Bf8.DEFAULT:return n2;case et.Bf8.LARGE:return"1.25rem";default:return n2}}(s)},[s]),t},n5={typeName:"exa.extension_server_pb.ExtensionServerService",methods:{languageServerStarted:{name:"LanguageServerStarted",I:LanguageServerStartedRequest,O:LanguageServerStartedResponse,kind:eb.t.Unary},openSetting:{name:"OpenSetting",I:OpenSettingRequest,O:OpenSettingResponse,kind:eb.t.Unary},openFilePointer:{name:"OpenFilePointer",I:OpenFilePointerRequest,O:OpenFilePointerResponse,kind:eb.t.Unary},insertCodeAtCursor:{name:"InsertCodeAtCursor",I:InsertCodeAtCursorRequest,O:InsertCodeAtCursorResponse,kind:eb.t.Unary},logEvent:{name:"LogEvent",I:LogEventRequest,O:LogEventResponse,kind:eb.t.Unary},checkTerminalShellSupport:{name:"CheckTerminalShellSupport",I:CheckTerminalShellSupportRequest,O:CheckTerminalShellSupportResponse,kind:eb.t.Unary},executeCommand:{name:"ExecuteCommand",I:ExecuteCommandRequest,O:et.$Kb,kind:eb.t.ServerStreaming},showTerminal:{name:"ShowTerminal",I:ShowTerminalRequest,O:ShowTerminalResponse,kind:eb.t.Unary},openVirtualFile:{name:"OpenVirtualFile",I:OpenVirtualFileRequest,O:OpenVirtualFileResponse,kind:eb.t.Unary},saveDocument:{name:"SaveDocument",I:SaveDocumentRequest,O:SaveDocumentResponse,kind:eb.t.Unary},getLintErrors:{name:"GetLintErrors",I:GetLintErrorsRequest,O:GetLintErrorsResponse,kind:eb.t.Unary},openDiffZones:{name:"OpenDiffZones",I:OpenDiffZonesRequest,O:OpenDiffZonesResponse,kind:eb.t.Unary},openExternalUrl:{name:"OpenExternalUrl",I:OpenExternalUrlRequest,O:OpenExternalUrlResponse,kind:eb.t.Unary},handleAsyncPostMessage:{name:"HandleAsyncPostMessage",I:HandleAsyncPostMessageRequest,O:HandleAsyncPostMessageResponse,kind:eb.t.Unary}}};let StartChatClientRequestStreamRequest=class StartChatClientRequestStreamRequest extends er.v{static fromBinary(e,t){return new StartChatClientRequestStreamRequest().fromBinary(e,t)}static fromJson(e,t){return new StartChatClientRequestStreamRequest().fromJson(e,t)}static fromJsonString(e,t){return new StartChatClientRequestStreamRequest().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(StartChatClientRequestStreamRequest,e,t)}constructor(e){super(),en.w.util.initPartial(e,this)}};StartChatClientRequestStreamRequest.runtime=en.w,StartChatClientRequestStreamRequest.typeName="exa.chat_client_server_pb.StartChatClientRequestStreamRequest",StartChatClientRequestStreamRequest.fields=en.w.util.newFieldList(()=>[]);let ChatClientRequest=class ChatClientRequest extends er.v{static fromBinary(e,t){return new ChatClientRequest().fromBinary(e,t)}static fromJson(e,t){return new ChatClientRequest().fromJson(e,t)}static fromJsonString(e,t){return new ChatClientRequest().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(ChatClientRequest,e,t)}constructor(e){super(),this.request={case:void 0},en.w.util.initPartial(e,this)}};ChatClientRequest.runtime=en.w,ChatClientRequest.typeName="exa.chat_client_server_pb.ChatClientRequest",ChatClientRequest.fields=en.w.util.newFieldList(()=>[{no:1,name:"add_cascade_input",kind:"message",T:AddCascadeInputRequest,oneof:"request"},{no:2,name:"send_action_to_chat_panel",kind:"message",T:SendActionToChatPanelRequest,oneof:"request"}]);let AddCascadeInputRequest=class AddCascadeInputRequest extends er.v{static fromBinary(e,t){return new AddCascadeInputRequest().fromBinary(e,t)}static fromJson(e,t){return new AddCascadeInputRequest().fromJson(e,t)}static fromJsonString(e,t){return new AddCascadeInputRequest().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(AddCascadeInputRequest,e,t)}constructor(e){super(),this.items=[],this.images=[],en.w.util.initPartial(e,this)}};AddCascadeInputRequest.runtime=en.w,AddCascadeInputRequest.typeName="exa.chat_client_server_pb.AddCascadeInputRequest",AddCascadeInputRequest.fields=en.w.util.newFieldList(()=>[{no:1,name:"items",kind:"message",T:et.QVo,repeated:!0},{no:2,name:"images",kind:"message",T:et.RT3,repeated:!0}]);let SendActionToChatPanelRequest=class SendActionToChatPanelRequest extends er.v{static fromBinary(e,t){return new SendActionToChatPanelRequest().fromBinary(e,t)}static fromJson(e,t){return new SendActionToChatPanelRequest().fromJson(e,t)}static fromJsonString(e,t){return new SendActionToChatPanelRequest().fromJsonString(e,t)}static equals(e,t){return en.w.util.equals(SendActionToChatPanelRequest,e,t)}constructor(e){super(),this.actionType="",this.payload=[],en.w.util.initPartial(e,this)}};SendActionToChatPanelRequest.runtime=en.w,SendActionToChatPanelRequest.typeName="exa.chat_client_server_pb.SendActionToChatPanelRequest",SendActionToChatPanelRequest.fields=en.w.util.newFieldList(()=>[{no:1,name:"action_type",kind:"scalar",T:9},{no:2,name:"payload",kind:"scalar",T:12,repeated:!0}]);let n3={typeName:"exa.chat_client_server_pb.ChatClientServerService",methods:{startChatClientRequestStream:{name:"StartChatClientRequestStream",I:StartChatClientRequestStreamRequest,O:ChatClientRequest,kind:eb.t.ServerStreaming}}};function Home(){let{apiKey:e,csrfToken:t,extensionName:s,extensionVersion:a,ideName:n,ideVersion:r,locale:o,ideTelemetryEnabled:i,hasDevExtension:l,hasEnterpriseExtension:c,hasIndexService:d,appName:u,webServerUrl:m,diffViewEnabled:p,openFilePointerEnabled:x,insertAtCursorEnabled:h,disableLexicalEditor:g,defaultViewToCascade:f,lsUrl:y}=(0,ek.Q)(),v=(0,eF.useSearchParams)(),C=(0,X.useMemo)(()=>{let e=Array.from(v.keys());return e.length>0},[v]),runIfExists=function(e,t){for(var s=arguments.length,a=Array(s>2?s-2:0),n=2;n<s;n++)a[n-2]=arguments[n];if(C)try{e(...a)}catch(e){console.error(e),t(...a)}},w=(0,X.useMemo)(()=>{let e=[];if(t){let s=createCsrfInterceptor(t);e.push(s)}return e},[t]),b=(0,X.useMemo)(()=>{if(y)return(0,$.Hb)(es.c,(0,ey.B)({baseUrl:"http://".concat(y),useBinaryFormat:!0,interceptors:w}))},[y,w]),N=(0,$.Hb)(n5,(0,ey.B)({baseUrl:"http://".concat(y),useBinaryFormat:!0})),S=(0,X.useMemo)(()=>(0,$.Hb)(n3,(0,ey.B)({baseUrl:"http://".concat(y),useBinaryFormat:!0})),[y]);return(0,z.jsx)(ChatParamsManager,{ready:C,apiKey:null!=e?e:void 0,csrfToken:null!=t?t:void 0,extensionName:null!=s?s:void 0,extensionVersion:null!=a?a:void 0,ideName:null!=n?n:void 0,ideVersion:null!=r?r:void 0,locale:null!=o?o:void 0,ideTelemetryEnabled:null!=i&&i,hasDevExtension:null!=l&&l,hasEnterpriseExtension:null!=c&&c,hasIndexService:null!=d&&d,appName:null!=u?u:void 0,webServerUrl:null!=m?m:void 0,diffViewEnabled:null!=p&&p,openFilePointerEnabled:null!=x&&x,insertAtCursorEnabled:null!=h&&h,disableLexicalEditor:null!=g&&g,defaultView:f?R.CASCADE:R.CHAT,children:(0,z.jsx)(ServerConnectionManager,{handleLogin:()=>{runIfExists(window.login,()=>{})},openGenericUrl:e=>{if(!e.includes("blob")){runIfExists(window.openGenericUrl,()=>{window.open(e,"_blank")},e);return}window.open(e,"_blank")},...f?{handleOpenReadOnlyDiff:(e,t,s)=>{runIfExists(window.openReadOnlyDiff,()=>{console.error("openReadOnlyDiff not available")},JSON.stringify({fileName:e,oldContent:t,newContent:s}))},openQuickSettings:e=>{runIfExists(window.openQuickSettings,()=>{console.error("openQuickSettings not available")},e)},downloadDiagnostics:e=>{runIfExists(window.downloadDiagnostics,()=>{console.error("downloadDiagnostics not available")},JSON.stringify(e))},extensionClient:N}:{},serverAddress:m?"".concat(m,"/connect/chat"):"ws://127.0.0.1:42101/connect/chat",lsClient:b,disableWebSocket:!!y,children:(0,z.jsx)(ChatClientServerContextProvider,{client:S,children:(0,z.jsx)(DebuggingContextProvider,{children:(0,z.jsx)(FontSizeProvider,{children:(0,z.jsx)(ThemeProvider,{className:"relative flex h-screen w-full flex-col items-center justify-between bg-ide-chat-background text-ide-text-color",children:(0,z.jsx)(ExtensionPanel,{})})})})})})})}}},function(e){e.O(0,[981,93,57,503,443,361,158,188,479,868,955,961,365,744],function(){return e(e.s=64296)}),_N_E=e.O()}]);